var Zm=Object.defineProperty;var Jm=(e,t,s)=>t in e?Zm(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s;var X=(e,t,s)=>(Jm(e,typeof t!="symbol"?t+"":t,s),s);function hh(e,t){const s=Object.create(null),r=e.split(",");for(let i=0;i<r.length;i++)s[r[i]]=!0;return t?i=>!!s[i.toLowerCase()]:i=>!!s[i]}const Ut={},Lr=[],He=()=>{},Qm=()=>!1,tg=/^on[^a-z]/,Ao=e=>tg.test(e),ch=e=>e.startsWith("onUpdate:"),re=Object.assign,uh=(e,t)=>{const s=e.indexOf(t);s>-1&&e.splice(s,1)},eg=Object.prototype.hasOwnProperty,St=(e,t)=>eg.call(e,t),ft=Array.isArray,Nr=e=>Io(e)==="[object Map]",Gf=e=>Io(e)==="[object Set]",gt=e=>typeof e=="function",Yt=e=>typeof e=="string",fh=e=>typeof e=="symbol",Gt=e=>e!==null&&typeof e=="object",Hf=e=>Gt(e)&&gt(e.then)&&gt(e.catch),$f=Object.prototype.toString,Io=e=>$f.call(e),sg=e=>Io(e).slice(8,-1),Wf=e=>Io(e)==="[object Object]",dh=e=>Yt(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,Gn=hh(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Co=e=>{const t=Object.create(null);return s=>t[s]||(t[s]=e(s))},rg=/-(\w)/g,os=Co(e=>e.replace(rg,(t,s)=>s?s.toUpperCase():"")),ig=/\B([A-Z])/g,ni=Co(e=>e.replace(ig,"-$1").toLowerCase()),Ro=Co(e=>e.charAt(0).toUpperCase()+e.slice(1)),na=Co(e=>e?`on${Ro(e)}`:""),ki=(e,t)=>!Object.is(e,t),oa=(e,t)=>{for(let s=0;s<e.length;s++)e[s](t)},eo=(e,t,s)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:s})},ng=e=>{const t=parseFloat(e);return isNaN(t)?e:t};let mc;const il=()=>mc||(mc=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function ph(e){if(ft(e)){const t={};for(let s=0;s<e.length;s++){const r=e[s],i=Yt(r)?hg(r):ph(r);if(i)for(const n in i)t[n]=i[n]}return t}else{if(Yt(e))return e;if(Gt(e))return e}}const og=/;(?![^(]*\))/g,ag=/:([^]+)/,lg=/\/\*[^]*?\*\//g;function hg(e){const t={};return e.replace(lg,"").split(og).forEach(s=>{if(s){const r=s.split(ag);r.length>1&&(t[r[0].trim()]=r[1].trim())}}),t}function mh(e){let t="";if(Yt(e))t=e;else if(ft(e))for(let s=0;s<e.length;s++){const r=mh(e[s]);r&&(t+=r+" ")}else if(Gt(e))for(const s in e)e[s]&&(t+=s+" ");return t.trim()}const cg="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",ug=hh(cg);function Xf(e){return!!e||e===""}const M1=e=>Yt(e)?e:e==null?"":ft(e)||Gt(e)&&(e.toString===$f||!gt(e.toString))?JSON.stringify(e,zf,2):String(e),zf=(e,t)=>t&&t.__v_isRef?zf(e,t.value):Nr(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((s,[r,i])=>(s[`${r} =>`]=i,s),{})}:Gf(t)?{[`Set(${t.size})`]:[...t.values()]}:Gt(t)&&!ft(t)&&!Wf(t)?String(t):t;let Ee;class Vf{constructor(t=!1){this.detached=t,this._active=!0,this.effects=[],this.cleanups=[],this.parent=Ee,!t&&Ee&&(this.index=(Ee.scopes||(Ee.scopes=[])).push(this)-1)}get active(){return this._active}run(t){if(this._active){const s=Ee;try{return Ee=this,t()}finally{Ee=s}}}on(){Ee=this}off(){Ee=this.parent}stop(t){if(this._active){let s,r;for(s=0,r=this.effects.length;s<r;s++)this.effects[s].stop();for(s=0,r=this.cleanups.length;s<r;s++)this.cleanups[s]();if(this.scopes)for(s=0,r=this.scopes.length;s<r;s++)this.scopes[s].stop(!0);if(!this.detached&&this.parent&&!t){const i=this.parent.scopes.pop();i&&i!==this&&(this.parent.scopes[this.index]=i,i.index=this.index)}this.parent=void 0,this._active=!1}}}function fg(e){return new Vf(e)}function dg(e,t=Ee){t&&t.active&&t.effects.push(e)}function jf(){return Ee}function pg(e){Ee&&Ee.cleanups.push(e)}const gh=e=>{const t=new Set(e);return t.w=0,t.n=0,t},Yf=e=>(e.w&Gs)>0,Kf=e=>(e.n&Gs)>0,mg=({deps:e})=>{if(e.length)for(let t=0;t<e.length;t++)e[t].w|=Gs},gg=e=>{const{deps:t}=e;if(t.length){let s=0;for(let r=0;r<t.length;r++){const i=t[r];Yf(i)&&!Kf(i)?i.delete(e):t[s++]=i,i.w&=~Gs,i.n&=~Gs}t.length=s}},nl=new WeakMap;let Ei=0,Gs=1;const ol=30;let Ne;const nr=Symbol(""),al=Symbol("");class _h{constructor(t,s=null,r){this.fn=t,this.scheduler=s,this.active=!0,this.deps=[],this.parent=void 0,dg(this,r)}run(){if(!this.active)return this.fn();let t=Ne,s=Ns;for(;t;){if(t===this)return;t=t.parent}try{return this.parent=Ne,Ne=this,Ns=!0,Gs=1<<++Ei,Ei<=ol?mg(this):gc(this),this.fn()}finally{Ei<=ol&&gg(this),Gs=1<<--Ei,Ne=this.parent,Ns=s,this.parent=void 0,this.deferStop&&this.stop()}}stop(){Ne===this?this.deferStop=!0:this.active&&(gc(this),this.onStop&&this.onStop(),this.active=!1)}}function gc(e){const{deps:t}=e;if(t.length){for(let s=0;s<t.length;s++)t[s].delete(e);t.length=0}}let Ns=!0;const qf=[];function oi(){qf.push(Ns),Ns=!1}function ai(){const e=qf.pop();Ns=e===void 0?!0:e}function _e(e,t,s){if(Ns&&Ne){let r=nl.get(e);r||nl.set(e,r=new Map);let i=r.get(s);i||r.set(s,i=gh()),Zf(i)}}function Zf(e,t){let s=!1;Ei<=ol?Kf(e)||(e.n|=Gs,s=!Yf(e)):s=!e.has(Ne),s&&(e.add(Ne),Ne.deps.push(e))}function bs(e,t,s,r,i,n){const o=nl.get(e);if(!o)return;let a=[];if(t==="clear")a=[...o.values()];else if(s==="length"&&ft(e)){const l=Number(r);o.forEach((h,c)=>{(c==="length"||c>=l)&&a.push(h)})}else switch(s!==void 0&&a.push(o.get(s)),t){case"add":ft(e)?dh(s)&&a.push(o.get("length")):(a.push(o.get(nr)),Nr(e)&&a.push(o.get(al)));break;case"delete":ft(e)||(a.push(o.get(nr)),Nr(e)&&a.push(o.get(al)));break;case"set":Nr(e)&&a.push(o.get(nr));break}if(a.length===1)a[0]&&ll(a[0]);else{const l=[];for(const h of a)h&&l.push(...h);ll(gh(l))}}function ll(e,t){const s=ft(e)?e:[...e];for(const r of s)r.computed&&_c(r);for(const r of s)r.computed||_c(r)}function _c(e,t){(e!==Ne||e.allowRecurse)&&(e.scheduler?e.scheduler():e.run())}const _g=hh("__proto__,__v_isRef,__isVue"),Jf=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(fh)),yg=yh(),vg=yh(!1,!0),xg=yh(!0),yc=Eg();function Eg(){const e={};return["includes","indexOf","lastIndexOf"].forEach(t=>{e[t]=function(...s){const r=Rt(this);for(let n=0,o=this.length;n<o;n++)_e(r,"get",n+"");const i=r[t](...s);return i===-1||i===!1?r[t](...s.map(Rt)):i}}),["push","pop","shift","unshift","splice"].forEach(t=>{e[t]=function(...s){oi();const r=Rt(this)[t].apply(this,s);return ai(),r}}),e}function bg(e){const t=Rt(this);return _e(t,"has",e),t.hasOwnProperty(e)}function yh(e=!1,t=!1){return function(r,i,n){if(i==="__v_isReactive")return!e;if(i==="__v_isReadonly")return e;if(i==="__v_isShallow")return t;if(i==="__v_raw"&&n===(e?t?Ug:rd:t?sd:ed).get(r))return r;const o=ft(r);if(!e){if(o&&St(yc,i))return Reflect.get(yc,i,n);if(i==="hasOwnProperty")return bg}const a=Reflect.get(r,i,n);return(fh(i)?Jf.has(i):_g(i))||(e||_e(r,"get",i),t)?a:ue(a)?o&&dh(i)?a:a.value:Gt(a)?e?bh(a):Eh(a):a}}const wg=Qf(),Tg=Qf(!0);function Qf(e=!1){return function(s,r,i,n){let o=s[r];if(Yr(o)&&ue(o)&&!ue(i))return!1;if(!e&&(!so(i)&&!Yr(i)&&(o=Rt(o),i=Rt(i)),!ft(s)&&ue(o)&&!ue(i)))return o.value=i,!0;const a=ft(s)&&dh(r)?Number(r)<s.length:St(s,r),l=Reflect.set(s,r,i,n);return s===Rt(n)&&(a?ki(i,o)&&bs(s,"set",r,i):bs(s,"add",r,i)),l}}function Sg(e,t){const s=St(e,t);e[t];const r=Reflect.deleteProperty(e,t);return r&&s&&bs(e,"delete",t,void 0),r}function Ag(e,t){const s=Reflect.has(e,t);return(!fh(t)||!Jf.has(t))&&_e(e,"has",t),s}function Ig(e){return _e(e,"iterate",ft(e)?"length":nr),Reflect.ownKeys(e)}const td={get:yg,set:wg,deleteProperty:Sg,has:Ag,ownKeys:Ig},Cg={get:xg,set(e,t){return!0},deleteProperty(e,t){return!0}},Rg=re({},td,{get:vg,set:Tg}),vh=e=>e,Po=e=>Reflect.getPrototypeOf(e);function on(e,t,s=!1,r=!1){e=e.__v_raw;const i=Rt(e),n=Rt(t);s||(t!==n&&_e(i,"get",t),_e(i,"get",n));const{has:o}=Po(i),a=r?vh:s?Th:Gi;if(o.call(i,t))return a(e.get(t));if(o.call(i,n))return a(e.get(n));e!==i&&e.get(t)}function an(e,t=!1){const s=this.__v_raw,r=Rt(s),i=Rt(e);return t||(e!==i&&_e(r,"has",e),_e(r,"has",i)),e===i?s.has(e):s.has(e)||s.has(i)}function ln(e,t=!1){return e=e.__v_raw,!t&&_e(Rt(e),"iterate",nr),Reflect.get(e,"size",e)}function vc(e){e=Rt(e);const t=Rt(this);return Po(t).has.call(t,e)||(t.add(e),bs(t,"add",e,e)),this}function xc(e,t){t=Rt(t);const s=Rt(this),{has:r,get:i}=Po(s);let n=r.call(s,e);n||(e=Rt(e),n=r.call(s,e));const o=i.call(s,e);return s.set(e,t),n?ki(t,o)&&bs(s,"set",e,t):bs(s,"add",e,t),this}function Ec(e){const t=Rt(this),{has:s,get:r}=Po(t);let i=s.call(t,e);i||(e=Rt(e),i=s.call(t,e)),r&&r.call(t,e);const n=t.delete(e);return i&&bs(t,"delete",e,void 0),n}function bc(){const e=Rt(this),t=e.size!==0,s=e.clear();return t&&bs(e,"clear",void 0,void 0),s}function hn(e,t){return function(r,i){const n=this,o=n.__v_raw,a=Rt(o),l=t?vh:e?Th:Gi;return!e&&_e(a,"iterate",nr),o.forEach((h,c)=>r.call(i,l(h),l(c),n))}}function cn(e,t,s){return function(...r){const i=this.__v_raw,n=Rt(i),o=Nr(n),a=e==="entries"||e===Symbol.iterator&&o,l=e==="keys"&&o,h=i[e](...r),c=s?vh:t?Th:Gi;return!t&&_e(n,"iterate",l?al:nr),{next(){const{value:u,done:f}=h.next();return f?{value:u,done:f}:{value:a?[c(u[0]),c(u[1])]:c(u),done:f}},[Symbol.iterator](){return this}}}}function Is(e){return function(...t){return e==="delete"?!1:this}}function Pg(){const e={get(n){return on(this,n)},get size(){return ln(this)},has:an,add:vc,set:xc,delete:Ec,clear:bc,forEach:hn(!1,!1)},t={get(n){return on(this,n,!1,!0)},get size(){return ln(this)},has:an,add:vc,set:xc,delete:Ec,clear:bc,forEach:hn(!1,!0)},s={get(n){return on(this,n,!0)},get size(){return ln(this,!0)},has(n){return an.call(this,n,!0)},add:Is("add"),set:Is("set"),delete:Is("delete"),clear:Is("clear"),forEach:hn(!0,!1)},r={get(n){return on(this,n,!0,!0)},get size(){return ln(this,!0)},has(n){return an.call(this,n,!0)},add:Is("add"),set:Is("set"),delete:Is("delete"),clear:Is("clear"),forEach:hn(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(n=>{e[n]=cn(n,!1,!1),s[n]=cn(n,!0,!1),t[n]=cn(n,!1,!0),r[n]=cn(n,!0,!0)}),[e,s,t,r]}const[Mg,Og,Bg,Dg]=Pg();function xh(e,t){const s=t?e?Dg:Bg:e?Og:Mg;return(r,i,n)=>i==="__v_isReactive"?!e:i==="__v_isReadonly"?e:i==="__v_raw"?r:Reflect.get(St(s,i)&&i in r?s:r,i,n)}const Fg={get:xh(!1,!1)},Lg={get:xh(!1,!0)},Ng={get:xh(!0,!1)},ed=new WeakMap,sd=new WeakMap,rd=new WeakMap,Ug=new WeakMap;function kg(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Gg(e){return e.__v_skip||!Object.isExtensible(e)?0:kg(sg(e))}function Eh(e){return Yr(e)?e:wh(e,!1,td,Fg,ed)}function Hg(e){return wh(e,!1,Rg,Lg,sd)}function bh(e){return wh(e,!0,Cg,Ng,rd)}function wh(e,t,s,r,i){if(!Gt(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const n=i.get(e);if(n)return n;const o=Gg(e);if(o===0)return e;const a=new Proxy(e,o===2?r:s);return i.set(e,a),a}function Ur(e){return Yr(e)?Ur(e.__v_raw):!!(e&&e.__v_isReactive)}function Yr(e){return!!(e&&e.__v_isReadonly)}function so(e){return!!(e&&e.__v_isShallow)}function id(e){return Ur(e)||Yr(e)}function Rt(e){const t=e&&e.__v_raw;return t?Rt(t):e}function nd(e){return eo(e,"__v_skip",!0),e}const Gi=e=>Gt(e)?Eh(e):e,Th=e=>Gt(e)?bh(e):e;function od(e){Ns&&Ne&&(e=Rt(e),Zf(e.dep||(e.dep=gh())))}function ad(e,t){e=Rt(e);const s=e.dep;s&&ll(s)}function ue(e){return!!(e&&e.__v_isRef===!0)}function Pi(e){return ld(e,!1)}function $g(e){return ld(e,!0)}function ld(e,t){return ue(e)?e:new Wg(e,t)}class Wg{constructor(t,s){this.__v_isShallow=s,this.dep=void 0,this.__v_isRef=!0,this._rawValue=s?t:Rt(t),this._value=s?t:Gi(t)}get value(){return od(this),this._value}set value(t){const s=this.__v_isShallow||so(t)||Yr(t);t=s?t:Rt(t),ki(t,this._rawValue)&&(this._rawValue=t,this._value=s?t:Gi(t),ad(this))}}function hd(e){return ue(e)?e.value:e}const Xg={get:(e,t,s)=>hd(Reflect.get(e,t,s)),set:(e,t,s,r)=>{const i=e[t];return ue(i)&&!ue(s)?(i.value=s,!0):Reflect.set(e,t,s,r)}};function cd(e){return Ur(e)?e:new Proxy(e,Xg)}class zg{constructor(t,s,r,i){this._setter=s,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this._dirty=!0,this.effect=new _h(t,()=>{this._dirty||(this._dirty=!0,ad(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!i,this.__v_isReadonly=r}get value(){const t=Rt(this);return od(t),(t._dirty||!t._cacheable)&&(t._dirty=!1,t._value=t.effect.run()),t._value}set value(t){this._setter(t)}}function Vg(e,t,s=!1){let r,i;const n=gt(e);return n?(r=e,i=He):(r=e.get,i=e.set),new zg(r,i,n||!i,s)}function Us(e,t,s,r){let i;try{i=r?e(...r):e()}catch(n){Zi(n,t,s)}return i}function $e(e,t,s,r){if(gt(e)){const n=Us(e,t,s,r);return n&&Hf(n)&&n.catch(o=>{Zi(o,t,s)}),n}const i=[];for(let n=0;n<e.length;n++)i.push($e(e[n],t,s,r));return i}function Zi(e,t,s,r=!0){const i=t?t.vnode:null;if(t){let n=t.parent;const o=t.proxy,a=s;for(;n;){const h=n.ec;if(h){for(let c=0;c<h.length;c++)if(h[c](e,o,a)===!1)return}n=n.parent}const l=t.appContext.config.errorHandler;if(l){Us(l,null,10,[e,o,a]);return}}jg(e,s,i,r)}function jg(e,t,s,r=!0){console.error(e)}let Hi=!1,hl=!1;const ce=[];let ss=0;const kr=[];let ms=null,tr=0;const ud=Promise.resolve();let Sh=null;function Ah(e){const t=Sh||ud;return e?t.then(this?e.bind(this):e):t}function Yg(e){let t=ss+1,s=ce.length;for(;t<s;){const r=t+s>>>1;$i(ce[r])<e?t=r+1:s=r}return t}function Mo(e){(!ce.length||!ce.includes(e,Hi&&e.allowRecurse?ss+1:ss))&&(e.id==null?ce.push(e):ce.splice(Yg(e.id),0,e),fd())}function fd(){!Hi&&!hl&&(hl=!0,Sh=ud.then(pd))}function Kg(e){const t=ce.indexOf(e);t>ss&&ce.splice(t,1)}function qg(e){ft(e)?kr.push(...e):(!ms||!ms.includes(e,e.allowRecurse?tr+1:tr))&&kr.push(e),fd()}function wc(e,t=Hi?ss+1:0){for(;t<ce.length;t++){const s=ce[t];s&&s.pre&&(ce.splice(t,1),t--,s())}}function dd(e){if(kr.length){const t=[...new Set(kr)];if(kr.length=0,ms){ms.push(...t);return}for(ms=t,ms.sort((s,r)=>$i(s)-$i(r)),tr=0;tr<ms.length;tr++)ms[tr]();ms=null,tr=0}}const $i=e=>e.id==null?1/0:e.id,Zg=(e,t)=>{const s=$i(e)-$i(t);if(s===0){if(e.pre&&!t.pre)return-1;if(t.pre&&!e.pre)return 1}return s};function pd(e){hl=!1,Hi=!0,ce.sort(Zg);const t=He;try{for(ss=0;ss<ce.length;ss++){const s=ce[ss];s&&s.active!==!1&&Us(s,null,14)}}finally{ss=0,ce.length=0,dd(),Hi=!1,Sh=null,(ce.length||kr.length)&&pd()}}function Jg(e,t,...s){if(e.isUnmounted)return;const r=e.vnode.props||Ut;let i=s;const n=t.startsWith("update:"),o=n&&t.slice(7);if(o&&o in r){const c=`${o==="modelValue"?"model":o}Modifiers`,{number:u,trim:f}=r[c]||Ut;f&&(i=s.map(p=>Yt(p)?p.trim():p)),u&&(i=s.map(ng))}let a,l=r[a=na(t)]||r[a=na(os(t))];!l&&n&&(l=r[a=na(ni(t))]),l&&$e(l,e,6,i);const h=r[a+"Once"];if(h){if(!e.emitted)e.emitted={};else if(e.emitted[a])return;e.emitted[a]=!0,$e(h,e,6,i)}}function md(e,t,s=!1){const r=t.emitsCache,i=r.get(e);if(i!==void 0)return i;const n=e.emits;let o={},a=!1;if(!gt(e)){const l=h=>{const c=md(h,t,!0);c&&(a=!0,re(o,c))};!s&&t.mixins.length&&t.mixins.forEach(l),e.extends&&l(e.extends),e.mixins&&e.mixins.forEach(l)}return!n&&!a?(Gt(e)&&r.set(e,null),null):(ft(n)?n.forEach(l=>o[l]=null):re(o,n),Gt(e)&&r.set(e,o),o)}function Oo(e,t){return!e||!Ao(t)?!1:(t=t.slice(2).replace(/Once$/,""),St(e,t[0].toLowerCase()+t.slice(1))||St(e,ni(t))||St(e,t))}let Te=null,Bo=null;function ro(e){const t=Te;return Te=e,Bo=e&&e.type.__scopeId||null,t}function O1(e){Bo=e}function B1(){Bo=null}function Qg(e,t=Te,s){if(!t||e._n)return e;const r=(...i)=>{r._d&&Dc(-1);const n=ro(t);let o;try{o=e(...i)}finally{ro(n),r._d&&Dc(1)}return o};return r._n=!0,r._c=!0,r._d=!0,r}function aa(e){const{type:t,vnode:s,proxy:r,withProxy:i,props:n,propsOptions:[o],slots:a,attrs:l,emit:h,render:c,renderCache:u,data:f,setupState:p,ctx:d,inheritAttrs:m}=e;let g,y;const E=ro(e);try{if(s.shapeFlag&4){const v=i||r;g=Je(c.call(v,v,u,n,p,f,d)),y=l}else{const v=t;g=Je(v.length>1?v(n,{attrs:l,slots:a,emit:h}):v(n,null)),y=t.props?l:t_(l)}}catch(v){Bi.length=0,Zi(v,e,1),g=ae(ur)}let _=g;if(y&&m!==!1){const v=Object.keys(y),{shapeFlag:S}=_;v.length&&S&7&&(o&&v.some(ch)&&(y=e_(y,o)),_=Kr(_,y))}return s.dirs&&(_=Kr(_),_.dirs=_.dirs?_.dirs.concat(s.dirs):s.dirs),s.transition&&(_.transition=s.transition),g=_,ro(E),g}const t_=e=>{let t;for(const s in e)(s==="class"||s==="style"||Ao(s))&&((t||(t={}))[s]=e[s]);return t},e_=(e,t)=>{const s={};for(const r in e)(!ch(r)||!(r.slice(9)in t))&&(s[r]=e[r]);return s};function s_(e,t,s){const{props:r,children:i,component:n}=e,{props:o,children:a,patchFlag:l}=t,h=n.emitsOptions;if(t.dirs||t.transition)return!0;if(s&&l>=0){if(l&1024)return!0;if(l&16)return r?Tc(r,o,h):!!o;if(l&8){const c=t.dynamicProps;for(let u=0;u<c.length;u++){const f=c[u];if(o[f]!==r[f]&&!Oo(h,f))return!0}}}else return(i||a)&&(!a||!a.$stable)?!0:r===o?!1:r?o?Tc(r,o,h):!0:!!o;return!1}function Tc(e,t,s){const r=Object.keys(t);if(r.length!==Object.keys(e).length)return!0;for(let i=0;i<r.length;i++){const n=r[i];if(t[n]!==e[n]&&!Oo(s,n))return!0}return!1}function r_({vnode:e,parent:t},s){for(;t&&t.subTree===e;)(e=t.vnode).el=s,t=t.parent}const i_=e=>e.__isSuspense;function n_(e,t){t&&t.pendingBranch?ft(e)?t.effects.push(...e):t.effects.push(e):qg(e)}const un={};function Mi(e,t,s){return gd(e,t,s)}function gd(e,t,{immediate:s,deep:r,flush:i,onTrack:n,onTrigger:o}=Ut){var a;const l=jf()===((a=Jt)==null?void 0:a.scope)?Jt:null;let h,c=!1,u=!1;if(ue(e)?(h=()=>e.value,c=so(e)):Ur(e)?(h=()=>e,r=!0):ft(e)?(u=!0,c=e.some(v=>Ur(v)||so(v)),h=()=>e.map(v=>{if(ue(v))return v.value;if(Ur(v))return rr(v);if(gt(v))return Us(v,l,2)})):gt(e)?t?h=()=>Us(e,l,2):h=()=>{if(!(l&&l.isUnmounted))return f&&f(),$e(e,l,3,[p])}:h=He,t&&r){const v=h;h=()=>rr(v())}let f,p=v=>{f=E.onStop=()=>{Us(v,l,4)}},d;if(Zr)if(p=He,t?s&&$e(t,l,3,[h(),u?[]:void 0,p]):h(),i==="sync"){const v=sy();d=v.__watcherHandles||(v.__watcherHandles=[])}else return He;let m=u?new Array(e.length).fill(un):un;const g=()=>{if(E.active)if(t){const v=E.run();(r||c||(u?v.some((S,A)=>ki(S,m[A])):ki(v,m)))&&(f&&f(),$e(t,l,3,[v,m===un?void 0:u&&m[0]===un?[]:m,p]),m=v)}else E.run()};g.allowRecurse=!!t;let y;i==="sync"?y=g:i==="post"?y=()=>me(g,l&&l.suspense):(g.pre=!0,l&&(g.id=l.uid),y=()=>Mo(g));const E=new _h(h,y);t?s?g():m=E.run():i==="post"?me(E.run.bind(E),l&&l.suspense):E.run();const _=()=>{E.stop(),l&&l.scope&&uh(l.scope.effects,E)};return d&&d.push(_),_}function o_(e,t,s){const r=this.proxy,i=Yt(e)?e.includes(".")?_d(r,e):()=>r[e]:e.bind(r,r);let n;gt(t)?n=t:(n=t.handler,s=t);const o=Jt;qr(this);const a=gd(i,n.bind(r),s);return o?qr(o):or(),a}function _d(e,t){const s=t.split(".");return()=>{let r=e;for(let i=0;i<s.length&&r;i++)r=r[s[i]];return r}}function rr(e,t){if(!Gt(e)||e.__v_skip||(t=t||new Set,t.has(e)))return e;if(t.add(e),ue(e))rr(e.value,t);else if(ft(e))for(let s=0;s<e.length;s++)rr(e[s],t);else if(Gf(e)||Nr(e))e.forEach(s=>{rr(s,t)});else if(Wf(e))for(const s in e)rr(e[s],t);return e}function D1(e,t){const s=Te;if(s===null)return e;const r=No(s)||s.proxy,i=e.dirs||(e.dirs=[]);for(let n=0;n<t.length;n++){let[o,a,l,h=Ut]=t[n];o&&(gt(o)&&(o={mounted:o,updated:o}),o.deep&&rr(a),i.push({dir:o,instance:r,value:a,oldValue:void 0,arg:l,modifiers:h}))}return e}function Vs(e,t,s,r){const i=e.dirs,n=t&&t.dirs;for(let o=0;o<i.length;o++){const a=i[o];n&&(a.oldValue=n[o].value);let l=a.dir[r];l&&(oi(),$e(l,s,8,[e.el,a,e,t]),ai())}}function a_(e,t){return gt(e)?(()=>re({name:e.name},t,{setup:e}))():e}const Hn=e=>!!e.type.__asyncLoader;function F1(e){gt(e)&&(e={loader:e});const{loader:t,loadingComponent:s,errorComponent:r,delay:i=200,timeout:n,suspensible:o=!0,onError:a}=e;let l=null,h,c=0;const u=()=>(c++,l=null,f()),f=()=>{let p;return l||(p=l=t().catch(d=>{if(d=d instanceof Error?d:new Error(String(d)),a)return new Promise((m,g)=>{a(d,()=>m(u()),()=>g(d),c+1)});throw d}).then(d=>p!==l&&l?l:(d&&(d.__esModule||d[Symbol.toStringTag]==="Module")&&(d=d.default),h=d,d)))};return a_({name:"AsyncComponentWrapper",__asyncLoader:f,get __asyncResolved(){return h},setup(){const p=Jt;if(h)return()=>la(h,p);const d=E=>{l=null,Zi(E,p,13,!r)};if(o&&p.suspense||Zr)return f().then(E=>()=>la(E,p)).catch(E=>(d(E),()=>r?ae(r,{error:E}):null));const m=Pi(!1),g=Pi(),y=Pi(!!i);return i&&setTimeout(()=>{y.value=!1},i),n!=null&&setTimeout(()=>{if(!m.value&&!g.value){const E=new Error(`Async component timed out after ${n}ms.`);d(E),g.value=E}},n),f().then(()=>{m.value=!0,p.parent&&Ih(p.parent.vnode)&&Mo(p.parent.update)}).catch(E=>{d(E),g.value=E}),()=>{if(m.value&&h)return la(h,p);if(g.value&&r)return ae(r,{error:g.value});if(s&&!y.value)return ae(s)}}})}function la(e,t){const{ref:s,props:r,children:i,ce:n}=t.vnode,o=ae(e,r,i);return o.ref=s,o.ce=n,delete t.vnode.ce,o}const Ih=e=>e.type.__isKeepAlive;function l_(e,t){yd(e,"a",t)}function h_(e,t){yd(e,"da",t)}function yd(e,t,s=Jt){const r=e.__wdc||(e.__wdc=()=>{let i=s;for(;i;){if(i.isDeactivated)return;i=i.parent}return e()});if(Do(t,r,s),s){let i=s.parent;for(;i&&i.parent;)Ih(i.parent.vnode)&&c_(r,t,s,i),i=i.parent}}function c_(e,t,s,r){const i=Do(t,e,r,!0);xd(()=>{uh(r[t],i)},s)}function Do(e,t,s=Jt,r=!1){if(s){const i=s[e]||(s[e]=[]),n=t.__weh||(t.__weh=(...o)=>{if(s.isUnmounted)return;oi(),qr(s);const a=$e(t,s,e,o);return or(),ai(),a});return r?i.unshift(n):i.push(n),n}}const Ts=e=>(t,s=Jt)=>(!Zr||e==="sp")&&Do(e,(...r)=>t(...r),s),u_=Ts("bm"),vd=Ts("m"),f_=Ts("bu"),d_=Ts("u"),p_=Ts("bum"),xd=Ts("um"),m_=Ts("sp"),g_=Ts("rtg"),__=Ts("rtc");function y_(e,t=Jt){Do("ec",e,t)}const Ch="components";function L1(e,t){return bd(Ch,e,!0,t)||e}const Ed=Symbol.for("v-ndc");function N1(e){return Yt(e)?bd(Ch,e,!1)||e:e||Ed}function bd(e,t,s=!0,r=!1){const i=Te||Jt;if(i){const n=i.type;if(e===Ch){const a=J_(n,!1);if(a&&(a===t||a===os(t)||a===Ro(os(t))))return n}const o=Sc(i[e]||n[e],t)||Sc(i.appContext[e],t);return!o&&r?n:o}}function Sc(e,t){return e&&(e[t]||e[os(t)]||e[Ro(os(t))])}function U1(e,t,s,r){let i;const n=s&&s[r];if(ft(e)||Yt(e)){i=new Array(e.length);for(let o=0,a=e.length;o<a;o++)i[o]=t(e[o],o,void 0,n&&n[o])}else if(typeof e=="number"){i=new Array(e);for(let o=0;o<e;o++)i[o]=t(o+1,o,void 0,n&&n[o])}else if(Gt(e))if(e[Symbol.iterator])i=Array.from(e,(o,a)=>t(o,a,void 0,n&&n[a]));else{const o=Object.keys(e);i=new Array(o.length);for(let a=0,l=o.length;a<l;a++){const h=o[a];i[a]=t(e[h],h,a,n&&n[a])}}else i=[];return s&&(s[r]=i),i}const cl=e=>e?Dd(e)?No(e)||e.proxy:cl(e.parent):null,Oi=re(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>cl(e.parent),$root:e=>cl(e.root),$emit:e=>e.emit,$options:e=>Rh(e),$forceUpdate:e=>e.f||(e.f=()=>Mo(e.update)),$nextTick:e=>e.n||(e.n=Ah.bind(e.proxy)),$watch:e=>o_.bind(e)}),ha=(e,t)=>e!==Ut&&!e.__isScriptSetup&&St(e,t),v_={get({_:e},t){const{ctx:s,setupState:r,data:i,props:n,accessCache:o,type:a,appContext:l}=e;let h;if(t[0]!=="$"){const p=o[t];if(p!==void 0)switch(p){case 1:return r[t];case 2:return i[t];case 4:return s[t];case 3:return n[t]}else{if(ha(r,t))return o[t]=1,r[t];if(i!==Ut&&St(i,t))return o[t]=2,i[t];if((h=e.propsOptions[0])&&St(h,t))return o[t]=3,n[t];if(s!==Ut&&St(s,t))return o[t]=4,s[t];ul&&(o[t]=0)}}const c=Oi[t];let u,f;if(c)return t==="$attrs"&&_e(e,"get",t),c(e);if((u=a.__cssModules)&&(u=u[t]))return u;if(s!==Ut&&St(s,t))return o[t]=4,s[t];if(f=l.config.globalProperties,St(f,t))return f[t]},set({_:e},t,s){const{data:r,setupState:i,ctx:n}=e;return ha(i,t)?(i[t]=s,!0):r!==Ut&&St(r,t)?(r[t]=s,!0):St(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(n[t]=s,!0)},has({_:{data:e,setupState:t,accessCache:s,ctx:r,appContext:i,propsOptions:n}},o){let a;return!!s[o]||e!==Ut&&St(e,o)||ha(t,o)||(a=n[0])&&St(a,o)||St(r,o)||St(Oi,o)||St(i.config.globalProperties,o)},defineProperty(e,t,s){return s.get!=null?e._.accessCache[t]=0:St(s,"value")&&this.set(e,t,s.value,null),Reflect.defineProperty(e,t,s)}};function Ac(e){return ft(e)?e.reduce((t,s)=>(t[s]=null,t),{}):e}let ul=!0;function x_(e){const t=Rh(e),s=e.proxy,r=e.ctx;ul=!1,t.beforeCreate&&Ic(t.beforeCreate,e,"bc");const{data:i,computed:n,methods:o,watch:a,provide:l,inject:h,created:c,beforeMount:u,mounted:f,beforeUpdate:p,updated:d,activated:m,deactivated:g,beforeDestroy:y,beforeUnmount:E,destroyed:_,unmounted:v,render:S,renderTracked:A,renderTriggered:w,errorCaptured:b,serverPrefetch:R,expose:F,inheritAttrs:U,components:H,directives:B,filters:C}=t;if(h&&E_(h,r,null),o)for(const G in o){const rt=o[G];gt(rt)&&(r[G]=rt.bind(s))}if(i){const G=i.call(s,s);Gt(G)&&(e.data=Eh(G))}if(ul=!0,n)for(const G in n){const rt=n[G],Ct=gt(rt)?rt.bind(s,s):gt(rt.get)?rt.get.bind(s,s):He,L=!gt(rt)&&gt(rt.set)?rt.set.bind(s):He,N=ty({get:Ct,set:L});Object.defineProperty(r,G,{enumerable:!0,configurable:!0,get:()=>N.value,set:Y=>N.value=Y})}if(a)for(const G in a)wd(a[G],r,s,G);if(l){const G=gt(l)?l.call(s):l;Reflect.ownKeys(G).forEach(rt=>{I_(rt,G[rt])})}c&&Ic(c,e,"c");function Q(G,rt){ft(rt)?rt.forEach(Ct=>G(Ct.bind(s))):rt&&G(rt.bind(s))}if(Q(u_,u),Q(vd,f),Q(f_,p),Q(d_,d),Q(l_,m),Q(h_,g),Q(y_,b),Q(__,A),Q(g_,w),Q(p_,E),Q(xd,v),Q(m_,R),ft(F))if(F.length){const G=e.exposed||(e.exposed={});F.forEach(rt=>{Object.defineProperty(G,rt,{get:()=>s[rt],set:Ct=>s[rt]=Ct})})}else e.exposed||(e.exposed={});S&&e.render===He&&(e.render=S),U!=null&&(e.inheritAttrs=U),H&&(e.components=H),B&&(e.directives=B)}function E_(e,t,s=He){ft(e)&&(e=fl(e));for(const r in e){const i=e[r];let n;Gt(i)?"default"in i?n=$n(i.from||r,i.default,!0):n=$n(i.from||r):n=$n(i),ue(n)?Object.defineProperty(t,r,{enumerable:!0,configurable:!0,get:()=>n.value,set:o=>n.value=o}):t[r]=n}}function Ic(e,t,s){$e(ft(e)?e.map(r=>r.bind(t.proxy)):e.bind(t.proxy),t,s)}function wd(e,t,s,r){const i=r.includes(".")?_d(s,r):()=>s[r];if(Yt(e)){const n=t[e];gt(n)&&Mi(i,n)}else if(gt(e))Mi(i,e.bind(s));else if(Gt(e))if(ft(e))e.forEach(n=>wd(n,t,s,r));else{const n=gt(e.handler)?e.handler.bind(s):t[e.handler];gt(n)&&Mi(i,n,e)}}function Rh(e){const t=e.type,{mixins:s,extends:r}=t,{mixins:i,optionsCache:n,config:{optionMergeStrategies:o}}=e.appContext,a=n.get(t);let l;return a?l=a:!i.length&&!s&&!r?l=t:(l={},i.length&&i.forEach(h=>io(l,h,o,!0)),io(l,t,o)),Gt(t)&&n.set(t,l),l}function io(e,t,s,r=!1){const{mixins:i,extends:n}=t;n&&io(e,n,s,!0),i&&i.forEach(o=>io(e,o,s,!0));for(const o in t)if(!(r&&o==="expose")){const a=b_[o]||s&&s[o];e[o]=a?a(e[o],t[o]):t[o]}return e}const b_={data:Cc,props:Rc,emits:Rc,methods:bi,computed:bi,beforeCreate:pe,created:pe,beforeMount:pe,mounted:pe,beforeUpdate:pe,updated:pe,beforeDestroy:pe,beforeUnmount:pe,destroyed:pe,unmounted:pe,activated:pe,deactivated:pe,errorCaptured:pe,serverPrefetch:pe,components:bi,directives:bi,watch:T_,provide:Cc,inject:w_};function Cc(e,t){return t?e?function(){return re(gt(e)?e.call(this,this):e,gt(t)?t.call(this,this):t)}:t:e}function w_(e,t){return bi(fl(e),fl(t))}function fl(e){if(ft(e)){const t={};for(let s=0;s<e.length;s++)t[e[s]]=e[s];return t}return e}function pe(e,t){return e?[...new Set([].concat(e,t))]:t}function bi(e,t){return e?re(Object.create(null),e,t):t}function Rc(e,t){return e?ft(e)&&ft(t)?[...new Set([...e,...t])]:re(Object.create(null),Ac(e),Ac(t??{})):t}function T_(e,t){if(!e)return t;if(!t)return e;const s=re(Object.create(null),e);for(const r in t)s[r]=pe(e[r],t[r]);return s}function Td(){return{app:null,config:{isNativeTag:Qm,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let S_=0;function A_(e,t){return function(r,i=null){gt(r)||(r=re({},r)),i!=null&&!Gt(i)&&(i=null);const n=Td(),o=new Set;let a=!1;const l=n.app={_uid:S_++,_component:r,_props:i,_container:null,_context:n,_instance:null,version:ry,get config(){return n.config},set config(h){},use(h,...c){return o.has(h)||(h&&gt(h.install)?(o.add(h),h.install(l,...c)):gt(h)&&(o.add(h),h(l,...c))),l},mixin(h){return n.mixins.includes(h)||n.mixins.push(h),l},component(h,c){return c?(n.components[h]=c,l):n.components[h]},directive(h,c){return c?(n.directives[h]=c,l):n.directives[h]},mount(h,c,u){if(!a){const f=ae(r,i);return f.appContext=n,c&&t?t(f,h):e(f,h,u),a=!0,l._container=h,h.__vue_app__=l,No(f.component)||f.component.proxy}},unmount(){a&&(e(null,l._container),delete l._container.__vue_app__)},provide(h,c){return n.provides[h]=c,l},runWithContext(h){no=l;try{return h()}finally{no=null}}};return l}}let no=null;function I_(e,t){if(Jt){let s=Jt.provides;const r=Jt.parent&&Jt.parent.provides;r===s&&(s=Jt.provides=Object.create(r)),s[e]=t}}function $n(e,t,s=!1){const r=Jt||Te;if(r||no){const i=r?r.parent==null?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides:no._context.provides;if(i&&e in i)return i[e];if(arguments.length>1)return s&&gt(t)?t.call(r&&r.proxy):t}}function C_(e,t,s,r=!1){const i={},n={};eo(n,Lo,1),e.propsDefaults=Object.create(null),Sd(e,t,i,n);for(const o in e.propsOptions[0])o in i||(i[o]=void 0);s?e.props=r?i:Hg(i):e.type.props?e.props=i:e.props=n,e.attrs=n}function R_(e,t,s,r){const{props:i,attrs:n,vnode:{patchFlag:o}}=e,a=Rt(i),[l]=e.propsOptions;let h=!1;if((r||o>0)&&!(o&16)){if(o&8){const c=e.vnode.dynamicProps;for(let u=0;u<c.length;u++){let f=c[u];if(Oo(e.emitsOptions,f))continue;const p=t[f];if(l)if(St(n,f))p!==n[f]&&(n[f]=p,h=!0);else{const d=os(f);i[d]=dl(l,a,d,p,e,!1)}else p!==n[f]&&(n[f]=p,h=!0)}}}else{Sd(e,t,i,n)&&(h=!0);let c;for(const u in a)(!t||!St(t,u)&&((c=ni(u))===u||!St(t,c)))&&(l?s&&(s[u]!==void 0||s[c]!==void 0)&&(i[u]=dl(l,a,u,void 0,e,!0)):delete i[u]);if(n!==a)for(const u in n)(!t||!St(t,u))&&(delete n[u],h=!0)}h&&bs(e,"set","$attrs")}function Sd(e,t,s,r){const[i,n]=e.propsOptions;let o=!1,a;if(t)for(let l in t){if(Gn(l))continue;const h=t[l];let c;i&&St(i,c=os(l))?!n||!n.includes(c)?s[c]=h:(a||(a={}))[c]=h:Oo(e.emitsOptions,l)||(!(l in r)||h!==r[l])&&(r[l]=h,o=!0)}if(n){const l=Rt(s),h=a||Ut;for(let c=0;c<n.length;c++){const u=n[c];s[u]=dl(i,l,u,h[u],e,!St(h,u))}}return o}function dl(e,t,s,r,i,n){const o=e[s];if(o!=null){const a=St(o,"default");if(a&&r===void 0){const l=o.default;if(o.type!==Function&&!o.skipFactory&&gt(l)){const{propsDefaults:h}=i;s in h?r=h[s]:(qr(i),r=h[s]=l.call(null,t),or())}else r=l}o[0]&&(n&&!a?r=!1:o[1]&&(r===""||r===ni(s))&&(r=!0))}return r}function Ad(e,t,s=!1){const r=t.propsCache,i=r.get(e);if(i)return i;const n=e.props,o={},a=[];let l=!1;if(!gt(e)){const c=u=>{l=!0;const[f,p]=Ad(u,t,!0);re(o,f),p&&a.push(...p)};!s&&t.mixins.length&&t.mixins.forEach(c),e.extends&&c(e.extends),e.mixins&&e.mixins.forEach(c)}if(!n&&!l)return Gt(e)&&r.set(e,Lr),Lr;if(ft(n))for(let c=0;c<n.length;c++){const u=os(n[c]);Pc(u)&&(o[u]=Ut)}else if(n)for(const c in n){const u=os(c);if(Pc(u)){const f=n[c],p=o[u]=ft(f)||gt(f)?{type:f}:re({},f);if(p){const d=Bc(Boolean,p.type),m=Bc(String,p.type);p[0]=d>-1,p[1]=m<0||d<m,(d>-1||St(p,"default"))&&a.push(u)}}}const h=[o,a];return Gt(e)&&r.set(e,h),h}function Pc(e){return e[0]!=="$"}function Mc(e){const t=e&&e.toString().match(/^\s*(function|class) (\w+)/);return t?t[2]:e===null?"null":""}function Oc(e,t){return Mc(e)===Mc(t)}function Bc(e,t){return ft(t)?t.findIndex(s=>Oc(s,e)):gt(t)&&Oc(t,e)?0:-1}const Id=e=>e[0]==="_"||e==="$stable",Ph=e=>ft(e)?e.map(Je):[Je(e)],P_=(e,t,s)=>{if(t._n)return t;const r=Qg((...i)=>Ph(t(...i)),s);return r._c=!1,r},Cd=(e,t,s)=>{const r=e._ctx;for(const i in e){if(Id(i))continue;const n=e[i];if(gt(n))t[i]=P_(i,n,r);else if(n!=null){const o=Ph(n);t[i]=()=>o}}},Rd=(e,t)=>{const s=Ph(t);e.slots.default=()=>s},M_=(e,t)=>{if(e.vnode.shapeFlag&32){const s=t._;s?(e.slots=Rt(t),eo(t,"_",s)):Cd(t,e.slots={})}else e.slots={},t&&Rd(e,t);eo(e.slots,Lo,1)},O_=(e,t,s)=>{const{vnode:r,slots:i}=e;let n=!0,o=Ut;if(r.shapeFlag&32){const a=t._;a?s&&a===1?n=!1:(re(i,t),!s&&a===1&&delete i._):(n=!t.$stable,Cd(t,i)),o=t}else t&&(Rd(e,t),o={default:1});if(n)for(const a in i)!Id(a)&&!(a in o)&&delete i[a]};function pl(e,t,s,r,i=!1){if(ft(e)){e.forEach((f,p)=>pl(f,t&&(ft(t)?t[p]:t),s,r,i));return}if(Hn(r)&&!i)return;const n=r.shapeFlag&4?No(r.component)||r.component.proxy:r.el,o=i?null:n,{i:a,r:l}=e,h=t&&t.r,c=a.refs===Ut?a.refs={}:a.refs,u=a.setupState;if(h!=null&&h!==l&&(Yt(h)?(c[h]=null,St(u,h)&&(u[h]=null)):ue(h)&&(h.value=null)),gt(l))Us(l,a,12,[o,c]);else{const f=Yt(l),p=ue(l);if(f||p){const d=()=>{if(e.f){const m=f?St(u,l)?u[l]:c[l]:l.value;i?ft(m)&&uh(m,n):ft(m)?m.includes(n)||m.push(n):f?(c[l]=[n],St(u,l)&&(u[l]=c[l])):(l.value=[n],e.k&&(c[e.k]=l.value))}else f?(c[l]=o,St(u,l)&&(u[l]=o)):p&&(l.value=o,e.k&&(c[e.k]=o))};o?(d.id=-1,me(d,s)):d()}}}const me=n_;function B_(e){return D_(e)}function D_(e,t){const s=il();s.__VUE__=!0;const{insert:r,remove:i,patchProp:n,createElement:o,createText:a,createComment:l,setText:h,setElementText:c,parentNode:u,nextSibling:f,setScopeId:p=He,insertStaticContent:d}=e,m=(x,T,I,M=null,D=null,$=null,K=!1,W=null,V=!!T.dynamicChildren)=>{if(x===T)return;x&&!fi(x,T)&&(M=ct(x),Y(x,D,$,!0),x=null),T.patchFlag===-2&&(V=!1,T.dynamicChildren=null);const{type:k,ref:ot,shapeFlag:et}=T;switch(k){case Fo:g(x,T,I,M);break;case ur:y(x,T,I,M);break;case ca:x==null&&E(T,I,M,K);break;case gs:H(x,T,I,M,D,$,K,W,V);break;default:et&1?S(x,T,I,M,D,$,K,W,V):et&6?B(x,T,I,M,D,$,K,W,V):(et&64||et&128)&&k.process(x,T,I,M,D,$,K,W,V,Lt)}ot!=null&&D&&pl(ot,x&&x.ref,$,T||x,!T)},g=(x,T,I,M)=>{if(x==null)r(T.el=a(T.children),I,M);else{const D=T.el=x.el;T.children!==x.children&&h(D,T.children)}},y=(x,T,I,M)=>{x==null?r(T.el=l(T.children||""),I,M):T.el=x.el},E=(x,T,I,M)=>{[x.el,x.anchor]=d(x.children,T,I,M,x.el,x.anchor)},_=({el:x,anchor:T},I,M)=>{let D;for(;x&&x!==T;)D=f(x),r(x,I,M),x=D;r(T,I,M)},v=({el:x,anchor:T})=>{let I;for(;x&&x!==T;)I=f(x),i(x),x=I;i(T)},S=(x,T,I,M,D,$,K,W,V)=>{K=K||T.type==="svg",x==null?A(T,I,M,D,$,K,W,V):R(x,T,D,$,K,W,V)},A=(x,T,I,M,D,$,K,W)=>{let V,k;const{type:ot,props:et,shapeFlag:at,transition:pt,dirs:xt}=x;if(V=x.el=o(x.type,$,et&&et.is,et),at&8?c(V,x.children):at&16&&b(x.children,V,null,M,D,$&&ot!=="foreignObject",K,W),xt&&Vs(x,null,M,"created"),w(V,x,x.scopeId,K,M),et){for(const Dt in et)Dt!=="value"&&!Gn(Dt)&&n(V,Dt,null,et[Dt],$,x.children,M,D,_t);"value"in et&&n(V,"value",null,et.value),(k=et.onVnodeBeforeMount)&&Ye(k,M,x)}xt&&Vs(x,null,M,"beforeMount");const Nt=(!D||D&&!D.pendingBranch)&&pt&&!pt.persisted;Nt&&pt.beforeEnter(V),r(V,T,I),((k=et&&et.onVnodeMounted)||Nt||xt)&&me(()=>{k&&Ye(k,M,x),Nt&&pt.enter(V),xt&&Vs(x,null,M,"mounted")},D)},w=(x,T,I,M,D)=>{if(I&&p(x,I),M)for(let $=0;$<M.length;$++)p(x,M[$]);if(D){let $=D.subTree;if(T===$){const K=D.vnode;w(x,K,K.scopeId,K.slotScopeIds,D.parent)}}},b=(x,T,I,M,D,$,K,W,V=0)=>{for(let k=V;k<x.length;k++){const ot=x[k]=W?Ps(x[k]):Je(x[k]);m(null,ot,T,I,M,D,$,K,W)}},R=(x,T,I,M,D,$,K)=>{const W=T.el=x.el;let{patchFlag:V,dynamicChildren:k,dirs:ot}=T;V|=x.patchFlag&16;const et=x.props||Ut,at=T.props||Ut;let pt;I&&js(I,!1),(pt=at.onVnodeBeforeUpdate)&&Ye(pt,I,T,x),ot&&Vs(T,x,I,"beforeUpdate"),I&&js(I,!0);const xt=D&&T.type!=="foreignObject";if(k?F(x.dynamicChildren,k,W,I,M,xt,$):K||rt(x,T,W,null,I,M,xt,$,!1),V>0){if(V&16)U(W,T,et,at,I,M,D);else if(V&2&&et.class!==at.class&&n(W,"class",null,at.class,D),V&4&&n(W,"style",et.style,at.style,D),V&8){const Nt=T.dynamicProps;for(let Dt=0;Dt<Nt.length;Dt++){const zt=Nt[Dt],Pe=et[zt],xr=at[zt];(xr!==Pe||zt==="value")&&n(W,zt,Pe,xr,D,x.children,I,M,_t)}}V&1&&x.children!==T.children&&c(W,T.children)}else!K&&k==null&&U(W,T,et,at,I,M,D);((pt=at.onVnodeUpdated)||ot)&&me(()=>{pt&&Ye(pt,I,T,x),ot&&Vs(T,x,I,"updated")},M)},F=(x,T,I,M,D,$,K)=>{for(let W=0;W<T.length;W++){const V=x[W],k=T[W],ot=V.el&&(V.type===gs||!fi(V,k)||V.shapeFlag&70)?u(V.el):I;m(V,k,ot,null,M,D,$,K,!0)}},U=(x,T,I,M,D,$,K)=>{if(I!==M){if(I!==Ut)for(const W in I)!Gn(W)&&!(W in M)&&n(x,W,I[W],null,K,T.children,D,$,_t);for(const W in M){if(Gn(W))continue;const V=M[W],k=I[W];V!==k&&W!=="value"&&n(x,W,k,V,K,T.children,D,$,_t)}"value"in M&&n(x,"value",I.value,M.value)}},H=(x,T,I,M,D,$,K,W,V)=>{const k=T.el=x?x.el:a(""),ot=T.anchor=x?x.anchor:a("");let{patchFlag:et,dynamicChildren:at,slotScopeIds:pt}=T;pt&&(W=W?W.concat(pt):pt),x==null?(r(k,I,M),r(ot,I,M),b(T.children,I,ot,D,$,K,W,V)):et>0&&et&64&&at&&x.dynamicChildren?(F(x.dynamicChildren,at,I,D,$,K,W),(T.key!=null||D&&T===D.subTree)&&Pd(x,T,!0)):rt(x,T,I,ot,D,$,K,W,V)},B=(x,T,I,M,D,$,K,W,V)=>{T.slotScopeIds=W,x==null?T.shapeFlag&512?D.ctx.activate(T,I,M,K,V):C(T,I,M,D,$,K,V):ht(x,T,V)},C=(x,T,I,M,D,$,K)=>{const W=x.component=V_(x,M,D);if(Ih(x)&&(W.ctx.renderer=Lt),Y_(W),W.asyncDep){if(D&&D.registerDep(W,Q),!x.el){const V=W.subTree=ae(ur);y(null,V,T,I)}return}Q(W,x,T,I,D,$,K)},ht=(x,T,I)=>{const M=T.component=x.component;if(s_(x,T,I))if(M.asyncDep&&!M.asyncResolved){G(M,T,I);return}else M.next=T,Kg(M.update),M.update();else T.el=x.el,M.vnode=T},Q=(x,T,I,M,D,$,K)=>{const W=()=>{if(x.isMounted){let{next:ot,bu:et,u:at,parent:pt,vnode:xt}=x,Nt=ot,Dt;js(x,!1),ot?(ot.el=xt.el,G(x,ot,K)):ot=xt,et&&oa(et),(Dt=ot.props&&ot.props.onVnodeBeforeUpdate)&&Ye(Dt,pt,ot,xt),js(x,!0);const zt=aa(x),Pe=x.subTree;x.subTree=zt,m(Pe,zt,u(Pe.el),ct(Pe),x,D,$),ot.el=zt.el,Nt===null&&r_(x,zt.el),at&&me(at,D),(Dt=ot.props&&ot.props.onVnodeUpdated)&&me(()=>Ye(Dt,pt,ot,xt),D)}else{let ot;const{el:et,props:at}=T,{bm:pt,m:xt,parent:Nt}=x,Dt=Hn(T);if(js(x,!1),pt&&oa(pt),!Dt&&(ot=at&&at.onVnodeBeforeMount)&&Ye(ot,Nt,T),js(x,!0),et&&Mt){const zt=()=>{x.subTree=aa(x),Mt(et,x.subTree,x,D,null)};Dt?T.type.__asyncLoader().then(()=>!x.isUnmounted&&zt()):zt()}else{const zt=x.subTree=aa(x);m(null,zt,I,M,x,D,$),T.el=zt.el}if(xt&&me(xt,D),!Dt&&(ot=at&&at.onVnodeMounted)){const zt=T;me(()=>Ye(ot,Nt,zt),D)}(T.shapeFlag&256||Nt&&Hn(Nt.vnode)&&Nt.vnode.shapeFlag&256)&&x.a&&me(x.a,D),x.isMounted=!0,T=I=M=null}},V=x.effect=new _h(W,()=>Mo(k),x.scope),k=x.update=()=>V.run();k.id=x.uid,js(x,!0),k()},G=(x,T,I)=>{T.component=x;const M=x.vnode.props;x.vnode=T,x.next=null,R_(x,T.props,M,I),O_(x,T.children,I),oi(),wc(),ai()},rt=(x,T,I,M,D,$,K,W,V=!1)=>{const k=x&&x.children,ot=x?x.shapeFlag:0,et=T.children,{patchFlag:at,shapeFlag:pt}=T;if(at>0){if(at&128){L(k,et,I,M,D,$,K,W,V);return}else if(at&256){Ct(k,et,I,M,D,$,K,W,V);return}}pt&8?(ot&16&&_t(k,D,$),et!==k&&c(I,et)):ot&16?pt&16?L(k,et,I,M,D,$,K,W,V):_t(k,D,$,!0):(ot&8&&c(I,""),pt&16&&b(et,I,M,D,$,K,W,V))},Ct=(x,T,I,M,D,$,K,W,V)=>{x=x||Lr,T=T||Lr;const k=x.length,ot=T.length,et=Math.min(k,ot);let at;for(at=0;at<et;at++){const pt=T[at]=V?Ps(T[at]):Je(T[at]);m(x[at],pt,I,null,D,$,K,W,V)}k>ot?_t(x,D,$,!0,!1,et):b(T,I,M,D,$,K,W,V,et)},L=(x,T,I,M,D,$,K,W,V)=>{let k=0;const ot=T.length;let et=x.length-1,at=ot-1;for(;k<=et&&k<=at;){const pt=x[k],xt=T[k]=V?Ps(T[k]):Je(T[k]);if(fi(pt,xt))m(pt,xt,I,null,D,$,K,W,V);else break;k++}for(;k<=et&&k<=at;){const pt=x[et],xt=T[at]=V?Ps(T[at]):Je(T[at]);if(fi(pt,xt))m(pt,xt,I,null,D,$,K,W,V);else break;et--,at--}if(k>et){if(k<=at){const pt=at+1,xt=pt<ot?T[pt].el:M;for(;k<=at;)m(null,T[k]=V?Ps(T[k]):Je(T[k]),I,xt,D,$,K,W,V),k++}}else if(k>at)for(;k<=et;)Y(x[k],D,$,!0),k++;else{const pt=k,xt=k,Nt=new Map;for(k=xt;k<=at;k++){const ve=T[k]=V?Ps(T[k]):Je(T[k]);ve.key!=null&&Nt.set(ve.key,k)}let Dt,zt=0;const Pe=at-xt+1;let xr=!1,fc=0;const ui=new Array(Pe);for(k=0;k<Pe;k++)ui[k]=0;for(k=pt;k<=et;k++){const ve=x[k];if(zt>=Pe){Y(ve,D,$,!0);continue}let je;if(ve.key!=null)je=Nt.get(ve.key);else for(Dt=xt;Dt<=at;Dt++)if(ui[Dt-xt]===0&&fi(ve,T[Dt])){je=Dt;break}je===void 0?Y(ve,D,$,!0):(ui[je-xt]=k+1,je>=fc?fc=je:xr=!0,m(ve,T[je],I,null,D,$,K,W,V),zt++)}const dc=xr?F_(ui):Lr;for(Dt=dc.length-1,k=Pe-1;k>=0;k--){const ve=xt+k,je=T[ve],pc=ve+1<ot?T[ve+1].el:M;ui[k]===0?m(null,je,I,pc,D,$,K,W,V):xr&&(Dt<0||k!==dc[Dt]?N(je,I,pc,2):Dt--)}}},N=(x,T,I,M,D=null)=>{const{el:$,type:K,transition:W,children:V,shapeFlag:k}=x;if(k&6){N(x.component.subTree,T,I,M);return}if(k&128){x.suspense.move(T,I,M);return}if(k&64){K.move(x,T,I,Lt);return}if(K===gs){r($,T,I);for(let et=0;et<V.length;et++)N(V[et],T,I,M);r(x.anchor,T,I);return}if(K===ca){_(x,T,I);return}if(M!==2&&k&1&&W)if(M===0)W.beforeEnter($),r($,T,I),me(()=>W.enter($),D);else{const{leave:et,delayLeave:at,afterLeave:pt}=W,xt=()=>r($,T,I),Nt=()=>{et($,()=>{xt(),pt&&pt()})};at?at($,xt,Nt):Nt()}else r($,T,I)},Y=(x,T,I,M=!1,D=!1)=>{const{type:$,props:K,ref:W,children:V,dynamicChildren:k,shapeFlag:ot,patchFlag:et,dirs:at}=x;if(W!=null&&pl(W,null,I,x,!0),ot&256){T.ctx.deactivate(x);return}const pt=ot&1&&at,xt=!Hn(x);let Nt;if(xt&&(Nt=K&&K.onVnodeBeforeUnmount)&&Ye(Nt,T,x),ot&6)dt(x.component,I,M);else{if(ot&128){x.suspense.unmount(I,M);return}pt&&Vs(x,null,T,"beforeUnmount"),ot&64?x.type.remove(x,T,I,D,Lt,M):k&&($!==gs||et>0&&et&64)?_t(k,T,I,!1,!0):($===gs&&et&384||!D&&ot&16)&&_t(V,T,I),M&&it(x)}(xt&&(Nt=K&&K.onVnodeUnmounted)||pt)&&me(()=>{Nt&&Ye(Nt,T,x),pt&&Vs(x,null,T,"unmounted")},I)},it=x=>{const{type:T,el:I,anchor:M,transition:D}=x;if(T===gs){tt(I,M);return}if(T===ca){v(x);return}const $=()=>{i(I),D&&!D.persisted&&D.afterLeave&&D.afterLeave()};if(x.shapeFlag&1&&D&&!D.persisted){const{leave:K,delayLeave:W}=D,V=()=>K(I,$);W?W(x.el,$,V):V()}else $()},tt=(x,T)=>{let I;for(;x!==T;)I=f(x),i(x),x=I;i(T)},dt=(x,T,I)=>{const{bum:M,scope:D,update:$,subTree:K,um:W}=x;M&&oa(M),D.stop(),$&&($.active=!1,Y(K,x,T,I)),W&&me(W,T),me(()=>{x.isUnmounted=!0},T),T&&T.pendingBranch&&!T.isUnmounted&&x.asyncDep&&!x.asyncResolved&&x.suspenseId===T.pendingId&&(T.deps--,T.deps===0&&T.resolve())},_t=(x,T,I,M=!1,D=!1,$=0)=>{for(let K=$;K<x.length;K++)Y(x[K],T,I,M,D)},ct=x=>x.shapeFlag&6?ct(x.component.subTree):x.shapeFlag&128?x.suspense.next():f(x.anchor||x.el),vt=(x,T,I)=>{x==null?T._vnode&&Y(T._vnode,null,null,!0):m(T._vnode||null,x,T,null,null,null,I),wc(),dd(),T._vnode=x},Lt={p:m,um:Y,m:N,r:it,mt:C,mc:b,pc:rt,pbc:F,n:ct,o:e};let Pt,Mt;return t&&([Pt,Mt]=t(Lt)),{render:vt,hydrate:Pt,createApp:A_(vt,Pt)}}function js({effect:e,update:t},s){e.allowRecurse=t.allowRecurse=s}function Pd(e,t,s=!1){const r=e.children,i=t.children;if(ft(r)&&ft(i))for(let n=0;n<r.length;n++){const o=r[n];let a=i[n];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=i[n]=Ps(i[n]),a.el=o.el),s||Pd(o,a)),a.type===Fo&&(a.el=o.el)}}function F_(e){const t=e.slice(),s=[0];let r,i,n,o,a;const l=e.length;for(r=0;r<l;r++){const h=e[r];if(h!==0){if(i=s[s.length-1],e[i]<h){t[r]=i,s.push(r);continue}for(n=0,o=s.length-1;n<o;)a=n+o>>1,e[s[a]]<h?n=a+1:o=a;h<e[s[n]]&&(n>0&&(t[r]=s[n-1]),s[n]=r)}}for(n=s.length,o=s[n-1];n-- >0;)s[n]=o,o=t[o];return s}const L_=e=>e.__isTeleport,gs=Symbol.for("v-fgt"),Fo=Symbol.for("v-txt"),ur=Symbol.for("v-cmt"),ca=Symbol.for("v-stc"),Bi=[];let Ue=null;function N_(e=!1){Bi.push(Ue=e?null:[])}function U_(){Bi.pop(),Ue=Bi[Bi.length-1]||null}let Wi=1;function Dc(e){Wi+=e}function Md(e){return e.dynamicChildren=Wi>0?Ue||Lr:null,U_(),Wi>0&&Ue&&Ue.push(e),e}function k1(e,t,s,r,i,n){return Md(Bd(e,t,s,r,i,n,!0))}function k_(e,t,s,r,i){return Md(ae(e,t,s,r,i,!0))}function ml(e){return e?e.__v_isVNode===!0:!1}function fi(e,t){return e.type===t.type&&e.key===t.key}const Lo="__vInternal",Od=({key:e})=>e??null,Wn=({ref:e,ref_key:t,ref_for:s})=>(typeof e=="number"&&(e=""+e),e!=null?Yt(e)||ue(e)||gt(e)?{i:Te,r:e,k:t,f:!!s}:e:null);function Bd(e,t=null,s=null,r=0,i=null,n=e===gs?0:1,o=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&Od(t),ref:t&&Wn(t),scopeId:Bo,slotScopeIds:null,children:s,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:n,patchFlag:r,dynamicProps:i,dynamicChildren:null,appContext:null,ctx:Te};return a?(Mh(l,s),n&128&&e.normalize(l)):s&&(l.shapeFlag|=Yt(s)?8:16),Wi>0&&!o&&Ue&&(l.patchFlag>0||n&6)&&l.patchFlag!==32&&Ue.push(l),l}const ae=G_;function G_(e,t=null,s=null,r=0,i=null,n=!1){if((!e||e===Ed)&&(e=ur),ml(e)){const a=Kr(e,t,!0);return s&&Mh(a,s),Wi>0&&!n&&Ue&&(a.shapeFlag&6?Ue[Ue.indexOf(e)]=a:Ue.push(a)),a.patchFlag|=-2,a}if(Q_(e)&&(e=e.__vccOpts),t){t=H_(t);let{class:a,style:l}=t;a&&!Yt(a)&&(t.class=mh(a)),Gt(l)&&(id(l)&&!ft(l)&&(l=re({},l)),t.style=ph(l))}const o=Yt(e)?1:i_(e)?128:L_(e)?64:Gt(e)?4:gt(e)?2:0;return Bd(e,t,s,r,i,o,n,!0)}function H_(e){return e?id(e)||Lo in e?re({},e):e:null}function Kr(e,t,s=!1){const{props:r,ref:i,patchFlag:n,children:o}=e,a=t?W_(r||{},t):r;return{__v_isVNode:!0,__v_skip:!0,type:e.type,props:a,key:a&&Od(a),ref:t&&t.ref?s&&i?ft(i)?i.concat(Wn(t)):[i,Wn(t)]:Wn(t):i,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:o,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==gs?n===-1?16:n|16:n,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:e.transition,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&Kr(e.ssContent),ssFallback:e.ssFallback&&Kr(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce}}function $_(e=" ",t=0){return ae(Fo,null,e,t)}function G1(e="",t=!1){return t?(N_(),k_(ur,null,e)):ae(ur,null,e)}function Je(e){return e==null||typeof e=="boolean"?ae(ur):ft(e)?ae(gs,null,e.slice()):typeof e=="object"?Ps(e):ae(Fo,null,String(e))}function Ps(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:Kr(e)}function Mh(e,t){let s=0;const{shapeFlag:r}=e;if(t==null)t=null;else if(ft(t))s=16;else if(typeof t=="object")if(r&65){const i=t.default;i&&(i._c&&(i._d=!1),Mh(e,i()),i._c&&(i._d=!0));return}else{s=32;const i=t._;!i&&!(Lo in t)?t._ctx=Te:i===3&&Te&&(Te.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else gt(t)?(t={default:t,_ctx:Te},s=32):(t=String(t),r&64?(s=16,t=[$_(t)]):s=8);e.children=t,e.shapeFlag|=s}function W_(...e){const t={};for(let s=0;s<e.length;s++){const r=e[s];for(const i in r)if(i==="class")t.class!==r.class&&(t.class=mh([t.class,r.class]));else if(i==="style")t.style=ph([t.style,r.style]);else if(Ao(i)){const n=t[i],o=r[i];o&&n!==o&&!(ft(n)&&n.includes(o))&&(t[i]=n?[].concat(n,o):o)}else i!==""&&(t[i]=r[i])}return t}function Ye(e,t,s,r=null){$e(e,t,7,[s,r])}const X_=Td();let z_=0;function V_(e,t,s){const r=e.type,i=(t?t.appContext:e.appContext)||X_,n={uid:z_++,vnode:e,type:r,parent:t,appContext:i,root:null,next:null,subTree:null,effect:null,update:null,scope:new Vf(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(i.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Ad(r,i),emitsOptions:md(r,i),emit:null,emitted:null,propsDefaults:Ut,inheritAttrs:r.inheritAttrs,ctx:Ut,data:Ut,props:Ut,attrs:Ut,slots:Ut,refs:Ut,setupState:Ut,setupContext:null,attrsProxy:null,slotsProxy:null,suspense:s,suspenseId:s?s.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return n.ctx={_:n},n.root=t?t.root:n,n.emit=Jg.bind(null,n),e.ce&&e.ce(n),n}let Jt=null;const j_=()=>Jt||Te;let Oh,Er,Fc="__VUE_INSTANCE_SETTERS__";(Er=il()[Fc])||(Er=il()[Fc]=[]),Er.push(e=>Jt=e),Oh=e=>{Er.length>1?Er.forEach(t=>t(e)):Er[0](e)};const qr=e=>{Oh(e),e.scope.on()},or=()=>{Jt&&Jt.scope.off(),Oh(null)};function Dd(e){return e.vnode.shapeFlag&4}let Zr=!1;function Y_(e,t=!1){Zr=t;const{props:s,children:r}=e.vnode,i=Dd(e);C_(e,s,i,t),M_(e,r);const n=i?K_(e,t):void 0;return Zr=!1,n}function K_(e,t){const s=e.type;e.accessCache=Object.create(null),e.proxy=nd(new Proxy(e.ctx,v_));const{setup:r}=s;if(r){const i=e.setupContext=r.length>1?Z_(e):null;qr(e),oi();const n=Us(r,e,0,[e.props,i]);if(ai(),or(),Hf(n)){if(n.then(or,or),t)return n.then(o=>{Lc(e,o,t)}).catch(o=>{Zi(o,e,0)});e.asyncDep=n}else Lc(e,n,t)}else Fd(e,t)}function Lc(e,t,s){gt(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:Gt(t)&&(e.setupState=cd(t)),Fd(e,s)}let Nc;function Fd(e,t,s){const r=e.type;if(!e.render){if(!t&&Nc&&!r.render){const i=r.template||Rh(e).template;if(i){const{isCustomElement:n,compilerOptions:o}=e.appContext.config,{delimiters:a,compilerOptions:l}=r,h=re(re({isCustomElement:n,delimiters:a},o),l);r.render=Nc(i,h)}}e.render=r.render||He}qr(e),oi(),x_(e),ai(),or()}function q_(e){return e.attrsProxy||(e.attrsProxy=new Proxy(e.attrs,{get(t,s){return _e(e,"get","$attrs"),t[s]}}))}function Z_(e){const t=s=>{e.exposed=s||{}};return{get attrs(){return q_(e)},slots:e.slots,emit:e.emit,expose:t}}function No(e){if(e.exposed)return e.exposeProxy||(e.exposeProxy=new Proxy(cd(nd(e.exposed)),{get(t,s){if(s in t)return t[s];if(s in Oi)return Oi[s](e)},has(t,s){return s in t||s in Oi}}))}function J_(e,t=!0){return gt(e)?e.displayName||e.name:e.name||t&&e.__name}function Q_(e){return gt(e)&&"__vccOpts"in e}const ty=(e,t)=>Vg(e,t,Zr);function H1(e,t,s){const r=arguments.length;return r===2?Gt(t)&&!ft(t)?ml(t)?ae(e,null,[t]):ae(e,t):ae(e,null,t):(r>3?s=Array.prototype.slice.call(arguments,2):r===3&&ml(s)&&(s=[s]),ae(e,t,s))}const ey=Symbol.for("v-scx"),sy=()=>$n(ey),ry="3.3.4",iy="http://www.w3.org/2000/svg",er=typeof document<"u"?document:null,Uc=er&&er.createElement("template"),ny={insert:(e,t,s)=>{t.insertBefore(e,s||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,s,r)=>{const i=t?er.createElementNS(iy,e):er.createElement(e,s?{is:s}:void 0);return e==="select"&&r&&r.multiple!=null&&i.setAttribute("multiple",r.multiple),i},createText:e=>er.createTextNode(e),createComment:e=>er.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>er.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,s,r,i,n){const o=s?s.previousSibling:t.lastChild;if(i&&(i===n||i.nextSibling))for(;t.insertBefore(i.cloneNode(!0),s),!(i===n||!(i=i.nextSibling)););else{Uc.innerHTML=r?`<svg>${e}</svg>`:e;const a=Uc.content;if(r){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}t.insertBefore(a,s)}return[o?o.nextSibling:t.firstChild,s?s.previousSibling:t.lastChild]}};function oy(e,t,s){const r=e._vtc;r&&(t=(t?[t,...r]:[...r]).join(" ")),t==null?e.removeAttribute("class"):s?e.setAttribute("class",t):e.className=t}function ay(e,t,s){const r=e.style,i=Yt(s);if(s&&!i){if(t&&!Yt(t))for(const n in t)s[n]==null&&gl(r,n,"");for(const n in s)gl(r,n,s[n])}else{const n=r.display;i?t!==s&&(r.cssText=s):t&&e.removeAttribute("style"),"_vod"in e&&(r.display=n)}}const kc=/\s*!important$/;function gl(e,t,s){if(ft(s))s.forEach(r=>gl(e,t,r));else if(s==null&&(s=""),t.startsWith("--"))e.setProperty(t,s);else{const r=ly(e,t);kc.test(s)?e.setProperty(ni(r),s.replace(kc,""),"important"):e[r]=s}}const Gc=["Webkit","Moz","ms"],ua={};function ly(e,t){const s=ua[t];if(s)return s;let r=os(t);if(r!=="filter"&&r in e)return ua[t]=r;r=Ro(r);for(let i=0;i<Gc.length;i++){const n=Gc[i]+r;if(n in e)return ua[t]=n}return t}const Hc="http://www.w3.org/1999/xlink";function hy(e,t,s,r,i){if(r&&t.startsWith("xlink:"))s==null?e.removeAttributeNS(Hc,t.slice(6,t.length)):e.setAttributeNS(Hc,t,s);else{const n=ug(t);s==null||n&&!Xf(s)?e.removeAttribute(t):e.setAttribute(t,n?"":s)}}function cy(e,t,s,r,i,n,o){if(t==="innerHTML"||t==="textContent"){r&&o(r,i,n),e[t]=s??"";return}const a=e.tagName;if(t==="value"&&a!=="PROGRESS"&&!a.includes("-")){e._value=s;const h=a==="OPTION"?e.getAttribute("value"):e.value,c=s??"";h!==c&&(e.value=c),s==null&&e.removeAttribute(t);return}let l=!1;if(s===""||s==null){const h=typeof e[t];h==="boolean"?s=Xf(s):s==null&&h==="string"?(s="",l=!0):h==="number"&&(s=0,l=!0)}try{e[t]=s}catch{}l&&e.removeAttribute(t)}function uy(e,t,s,r){e.addEventListener(t,s,r)}function fy(e,t,s,r){e.removeEventListener(t,s,r)}function dy(e,t,s,r,i=null){const n=e._vei||(e._vei={}),o=n[t];if(r&&o)o.value=r;else{const[a,l]=py(t);if(r){const h=n[t]=_y(r,i);uy(e,a,h,l)}else o&&(fy(e,a,o,l),n[t]=void 0)}}const $c=/(?:Once|Passive|Capture)$/;function py(e){let t;if($c.test(e)){t={};let r;for(;r=e.match($c);)e=e.slice(0,e.length-r[0].length),t[r[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):ni(e.slice(2)),t]}let fa=0;const my=Promise.resolve(),gy=()=>fa||(my.then(()=>fa=0),fa=Date.now());function _y(e,t){const s=r=>{if(!r._vts)r._vts=Date.now();else if(r._vts<=s.attached)return;$e(yy(r,s.value),t,5,[r])};return s.value=e,s.attached=gy(),s}function yy(e,t){if(ft(t)){const s=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{s.call(e),e._stopped=!0},t.map(r=>i=>!i._stopped&&r&&r(i))}else return t}const Wc=/^on[a-z]/,vy=(e,t,s,r,i=!1,n,o,a,l)=>{t==="class"?oy(e,r,i):t==="style"?ay(e,s,r):Ao(t)?ch(t)||dy(e,t,s,r,o):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):xy(e,t,r,i))?cy(e,t,r,n,o,a,l):(t==="true-value"?e._trueValue=r:t==="false-value"&&(e._falseValue=r),hy(e,t,r,i))};function xy(e,t,s,r){return r?!!(t==="innerHTML"||t==="textContent"||t in e&&Wc.test(t)&&gt(s)):t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA"||Wc.test(t)&&Yt(s)?!1:t in e}const Ey=["ctrl","shift","alt","meta"],by={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>Ey.some(s=>e[`${s}Key`]&&!t.includes(s))},$1=(e,t)=>(s,...r)=>{for(let i=0;i<t.length;i++){const n=by[t[i]];if(n&&n(s,t))return}return e(s,...r)},W1={beforeMount(e,{value:t},{transition:s}){e._vod=e.style.display==="none"?"":e.style.display,s&&t?s.beforeEnter(e):di(e,t)},mounted(e,{value:t},{transition:s}){s&&t&&s.enter(e)},updated(e,{value:t,oldValue:s},{transition:r}){!t!=!s&&(r?t?(r.beforeEnter(e),di(e,!0),r.enter(e)):r.leave(e,()=>{di(e,!1)}):di(e,t))},beforeUnmount(e,{value:t}){di(e,t)}};function di(e,t){e.style.display=t?e._vod:"none"}const wy=re({patchProp:vy},ny);let Xc;function Ty(){return Xc||(Xc=B_(wy))}const X1=(...e)=>{const t=Ty().createApp(...e),{mount:s}=t;return t.mount=r=>{const i=Sy(r);if(!i)return;const n=t._component;!gt(n)&&!n.render&&!n.template&&(n.template=i.innerHTML),i.innerHTML="";const o=s(i,!1,i instanceof SVGElement);return i instanceof Element&&(i.removeAttribute("v-cloak"),i.setAttribute("data-v-app","")),o},t};function Sy(e){return Yt(e)?document.querySelector(e):e}function Ay(e){return jf()?(pg(e),!0):!1}function z1(e){let t=!1,s;const r=fg(!0);return(...i)=>(t||(s=r.run(()=>e(...i)),t=!0),s)}function Bh(e){return typeof e=="function"?e():hd(e)}const Iy=typeof window<"u"&&typeof document<"u",Cy=Object.prototype.toString,Ry=e=>Cy.call(e)==="[object Object]",Py=()=>{};function My(e,t){function s(...r){return new Promise((i,n)=>{Promise.resolve(e(()=>t.apply(this,r),{fn:t,thisArg:this,args:r})).then(i).catch(n)})}return s}const Ld=e=>e();function Oy(e=Ld){const t=Pi(!0);function s(){t.value=!1}function r(){t.value=!0}const i=(...n)=>{t.value&&e(...n)};return{isActive:bh(t),pause:s,resume:r,eventFilter:i}}function By(e,t,s={}){const{eventFilter:r=Ld,...i}=s;return Mi(e,My(r,t),i)}function Dy(e,t,s={}){const{eventFilter:r,...i}=s,{eventFilter:n,pause:o,resume:a,isActive:l}=Oy(r);return{stop:By(e,t,{...i,eventFilter:n}),pause:o,resume:a,isActive:l}}function V1(e,t=!0){j_()?vd(e):t?e():Ah(e)}function Fy(e){var t;const s=Bh(e);return(t=s==null?void 0:s.$el)!=null?t:s}const oo=Iy?window:void 0;function zc(...e){let t,s,r,i;if(typeof e[0]=="string"||Array.isArray(e[0])?([s,r,i]=e,t=oo):[t,s,r,i]=e,!t)return Py;Array.isArray(s)||(s=[s]),Array.isArray(r)||(r=[r]);const n=[],o=()=>{n.forEach(c=>c()),n.length=0},a=(c,u,f,p)=>(c.addEventListener(u,f,p),()=>c.removeEventListener(u,f,p)),l=Mi(()=>[Fy(t),Bh(i)],([c,u])=>{if(o(),!c)return;const f=Ry(u)?{...u}:u;n.push(...s.flatMap(p=>r.map(d=>a(c,p,d,f))))},{immediate:!0,flush:"post"}),h=()=>{l(),o()};return Ay(h),h}const fn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},dn="__vueuse_ssr_handlers__",Ly=Ny();function Ny(){return dn in fn||(fn[dn]=fn[dn]||{}),fn[dn]}function Uy(e,t){return Ly[e]||t}function ky(e){return e==null?"any":e instanceof Set?"set":e instanceof Map?"map":e instanceof Date?"date":typeof e=="boolean"?"boolean":typeof e=="string"?"string":typeof e=="object"?"object":Number.isNaN(e)?"any":"number"}const Gy={boolean:{read:e=>e==="true",write:e=>String(e)},object:{read:e=>JSON.parse(e),write:e=>JSON.stringify(e)},number:{read:e=>Number.parseFloat(e),write:e=>String(e)},any:{read:e=>e,write:e=>String(e)},string:{read:e=>e,write:e=>String(e)},map:{read:e=>new Map(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e.entries()))},set:{read:e=>new Set(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e))},date:{read:e=>new Date(e),write:e=>e.toISOString()}},Vc="vueuse-storage";function Hy(e,t,s,r={}){var i;const{flush:n="pre",deep:o=!0,listenToStorageChanges:a=!0,writeDefaults:l=!0,mergeDefaults:h=!1,shallow:c,window:u=oo,eventFilter:f,onError:p=b=>{console.error(b)}}=r,d=(c?$g:Pi)(t);if(!s)try{s=Uy("getDefaultStorage",()=>{var b;return(b=oo)==null?void 0:b.localStorage})()}catch(b){p(b)}if(!s)return d;const m=Bh(t),g=ky(m),y=(i=r.serializer)!=null?i:Gy[g],{pause:E,resume:_}=Dy(d,()=>v(d.value),{flush:n,deep:o,eventFilter:f});return u&&a&&(zc(u,"storage",w),zc(u,Vc,A)),w(),d;function v(b){try{if(b==null)s.removeItem(e);else{const R=y.write(b),F=s.getItem(e);F!==R&&(s.setItem(e,R),u&&u.dispatchEvent(new CustomEvent(Vc,{detail:{key:e,oldValue:F,newValue:R,storageArea:s}})))}}catch(R){p(R)}}function S(b){const R=b?b.newValue:s.getItem(e);if(R==null)return l&&m!==null&&s.setItem(e,y.write(m)),m;if(!b&&h){const F=y.read(R);return typeof h=="function"?h(F,m):g==="object"&&!Array.isArray(F)?{...m,...F}:F}else return typeof R!="string"?R:y.read(R)}function A(b){w(b.detail)}function w(b){if(!(b&&b.storageArea!==s)){if(b&&b.key==null){d.value=m;return}if(!(b&&b.key!==e)){E();try{(b==null?void 0:b.newValue)!==y.write(d.value)&&(d.value=S(b))}catch(R){p(R)}finally{b?Ah(_):_()}}}}}function j1(e,t,s={}){const{window:r=oo}=s;return Hy(e,t,r==null?void 0:r.sessionStorage,s)}var gr=(e=>(e[e.WEBGL_LEGACY=0]="WEBGL_LEGACY",e[e.WEBGL=1]="WEBGL",e[e.WEBGL2=2]="WEBGL2",e))(gr||{}),Nd=(e=>(e[e.UNKNOWN=0]="UNKNOWN",e[e.WEBGL=1]="WEBGL",e[e.CANVAS=2]="CANVAS",e))(Nd||{}),_l=(e=>(e[e.COLOR=16384]="COLOR",e[e.DEPTH=256]="DEPTH",e[e.STENCIL=1024]="STENCIL",e))(_l||{}),ut=(e=>(e[e.NORMAL=0]="NORMAL",e[e.ADD=1]="ADD",e[e.MULTIPLY=2]="MULTIPLY",e[e.SCREEN=3]="SCREEN",e[e.OVERLAY=4]="OVERLAY",e[e.DARKEN=5]="DARKEN",e[e.LIGHTEN=6]="LIGHTEN",e[e.COLOR_DODGE=7]="COLOR_DODGE",e[e.COLOR_BURN=8]="COLOR_BURN",e[e.HARD_LIGHT=9]="HARD_LIGHT",e[e.SOFT_LIGHT=10]="SOFT_LIGHT",e[e.DIFFERENCE=11]="DIFFERENCE",e[e.EXCLUSION=12]="EXCLUSION",e[e.HUE=13]="HUE",e[e.SATURATION=14]="SATURATION",e[e.COLOR=15]="COLOR",e[e.LUMINOSITY=16]="LUMINOSITY",e[e.NORMAL_NPM=17]="NORMAL_NPM",e[e.ADD_NPM=18]="ADD_NPM",e[e.SCREEN_NPM=19]="SCREEN_NPM",e[e.NONE=20]="NONE",e[e.SRC_OVER=0]="SRC_OVER",e[e.SRC_IN=21]="SRC_IN",e[e.SRC_OUT=22]="SRC_OUT",e[e.SRC_ATOP=23]="SRC_ATOP",e[e.DST_OVER=24]="DST_OVER",e[e.DST_IN=25]="DST_IN",e[e.DST_OUT=26]="DST_OUT",e[e.DST_ATOP=27]="DST_ATOP",e[e.ERASE=26]="ERASE",e[e.SUBTRACT=28]="SUBTRACT",e[e.XOR=29]="XOR",e))(ut||{}),rs=(e=>(e[e.POINTS=0]="POINTS",e[e.LINES=1]="LINES",e[e.LINE_LOOP=2]="LINE_LOOP",e[e.LINE_STRIP=3]="LINE_STRIP",e[e.TRIANGLES=4]="TRIANGLES",e[e.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",e[e.TRIANGLE_FAN=6]="TRIANGLE_FAN",e))(rs||{}),z=(e=>(e[e.RGBA=6408]="RGBA",e[e.RGB=6407]="RGB",e[e.RG=33319]="RG",e[e.RED=6403]="RED",e[e.RGBA_INTEGER=36249]="RGBA_INTEGER",e[e.RGB_INTEGER=36248]="RGB_INTEGER",e[e.RG_INTEGER=33320]="RG_INTEGER",e[e.RED_INTEGER=36244]="RED_INTEGER",e[e.ALPHA=6406]="ALPHA",e[e.LUMINANCE=6409]="LUMINANCE",e[e.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",e[e.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",e[e.DEPTH_STENCIL=34041]="DEPTH_STENCIL",e))(z||{}),Gr=(e=>(e[e.TEXTURE_2D=3553]="TEXTURE_2D",e[e.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",e[e.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",e[e.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",e[e.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",e[e.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",e[e.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",e))(Gr||{}),lt=(e=>(e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",e[e.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",e[e.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",e[e.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",e[e.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",e[e.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",e[e.BYTE=5120]="BYTE",e[e.SHORT=5122]="SHORT",e[e.INT=5124]="INT",e[e.FLOAT=5126]="FLOAT",e[e.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",e[e.HALF_FLOAT=36193]="HALF_FLOAT",e))(lt||{}),yl=(e=>(e[e.FLOAT=0]="FLOAT",e[e.INT=1]="INT",e[e.UINT=2]="UINT",e))(yl||{}),ys=(e=>(e[e.NEAREST=0]="NEAREST",e[e.LINEAR=1]="LINEAR",e))(ys||{}),ks=(e=>(e[e.CLAMP=33071]="CLAMP",e[e.REPEAT=10497]="REPEAT",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",e))(ks||{}),as=(e=>(e[e.OFF=0]="OFF",e[e.POW2=1]="POW2",e[e.ON=2]="ON",e[e.ON_MANUAL=3]="ON_MANUAL",e))(as||{}),Ve=(e=>(e[e.NPM=0]="NPM",e[e.UNPACK=1]="UNPACK",e[e.PMA=2]="PMA",e[e.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",e[e.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",e[e.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",e))(Ve||{}),Qe=(e=>(e[e.NO=0]="NO",e[e.YES=1]="YES",e[e.AUTO=2]="AUTO",e[e.BLEND=0]="BLEND",e[e.CLEAR=1]="CLEAR",e[e.BLIT=2]="BLIT",e))(Qe||{}),Uo=(e=>(e[e.AUTO=0]="AUTO",e[e.MANUAL=1]="MANUAL",e))(Uo||{}),Ae=(e=>(e.LOW="lowp",e.MEDIUM="mediump",e.HIGH="highp",e))(Ae||{}),qt=(e=>(e[e.NONE=0]="NONE",e[e.SCISSOR=1]="SCISSOR",e[e.STENCIL=2]="STENCIL",e[e.SPRITE=3]="SPRITE",e[e.COLOR=4]="COLOR",e))(qt||{}),Vt=(e=>(e[e.NONE=0]="NONE",e[e.LOW=2]="LOW",e[e.MEDIUM=4]="MEDIUM",e[e.HIGH=8]="HIGH",e))(Vt||{}),is=(e=>(e[e.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",e[e.ARRAY_BUFFER=34962]="ARRAY_BUFFER",e[e.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",e))(is||{});const $y={createCanvas:(e,t)=>{const s=document.createElement("canvas");return s.width=e,s.height=t,s},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(e,t)=>fetch(e,t),parseXML:e=>new DOMParser().parseFromString(e,"text/xml")},q={ADAPTER:$y,RESOLUTION:1,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};var da=/iPhone/i,jc=/iPod/i,Yc=/iPad/i,Kc=/\biOS-universal(?:.+)Mac\b/i,pa=/\bAndroid(?:.+)Mobile\b/i,qc=/Android/i,br=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,pn=/Silk/i,us=/Windows Phone/i,Zc=/\bWindows(?:.+)ARM\b/i,Jc=/BlackBerry/i,Qc=/BB10/i,tu=/Opera Mini/i,eu=/\b(CriOS|Chrome)(?:.+)Mobile/i,su=/Mobile(?:.+)Firefox\b/i,ru=function(e){return typeof e<"u"&&e.platform==="MacIntel"&&typeof e.maxTouchPoints=="number"&&e.maxTouchPoints>1&&typeof MSStream>"u"};function Wy(e){return function(t){return t.test(e)}}function iu(e){var t={userAgent:"",platform:"",maxTouchPoints:0};!e&&typeof navigator<"u"?t={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof e=="string"?t.userAgent=e:e&&e.userAgent&&(t={userAgent:e.userAgent,platform:e.platform,maxTouchPoints:e.maxTouchPoints||0});var s=t.userAgent,r=s.split("[FBAN");typeof r[1]<"u"&&(s=r[0]),r=s.split("Twitter"),typeof r[1]<"u"&&(s=r[0]);var i=Wy(s),n={apple:{phone:i(da)&&!i(us),ipod:i(jc),tablet:!i(da)&&(i(Yc)||ru(t))&&!i(us),universal:i(Kc),device:(i(da)||i(jc)||i(Yc)||i(Kc)||ru(t))&&!i(us)},amazon:{phone:i(br),tablet:!i(br)&&i(pn),device:i(br)||i(pn)},android:{phone:!i(us)&&i(br)||!i(us)&&i(pa),tablet:!i(us)&&!i(br)&&!i(pa)&&(i(pn)||i(qc)),device:!i(us)&&(i(br)||i(pn)||i(pa)||i(qc))||i(/\bokhttp\b/i)},windows:{phone:i(us),tablet:i(Zc),device:i(us)||i(Zc)},other:{blackberry:i(Jc),blackberry10:i(Qc),opera:i(tu),firefox:i(su),chrome:i(eu),device:i(Jc)||i(Qc)||i(tu)||i(su)||i(eu)},any:!1,phone:!1,tablet:!1};return n.any=n.apple.device||n.android.device||n.windows.device||n.other.device,n.phone=n.apple.phone||n.android.phone||n.windows.phone,n.tablet=n.apple.tablet||n.android.tablet||n.windows.tablet,n}const Xy=iu.default??iu,vs=Xy(globalThis.navigator);q.RETINA_PREFIX=/@([0-9\.]+)x/;q.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var ma=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Dh(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function zy(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var s=function r(){return this instanceof r?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};s.prototype=t.prototype}else s={};return Object.defineProperty(s,"__esModule",{value:!0}),Object.keys(e).forEach(function(r){var i=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(s,r,i.get?i:{enumerable:!0,get:function(){return e[r]}})}),s}var Ud={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,s="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(s=!1));function i(l,h,c){this.fn=l,this.context=h,this.once=c||!1}function n(l,h,c,u,f){if(typeof c!="function")throw new TypeError("The listener must be a function");var p=new i(c,u||l,f),d=s?s+h:h;return l._events[d]?l._events[d].fn?l._events[d]=[l._events[d],p]:l._events[d].push(p):(l._events[d]=p,l._eventsCount++),l}function o(l,h){--l._eventsCount===0?l._events=new r:delete l._events[h]}function a(){this._events=new r,this._eventsCount=0}a.prototype.eventNames=function(){var h=[],c,u;if(this._eventsCount===0)return h;for(u in c=this._events)t.call(c,u)&&h.push(s?u.slice(1):u);return Object.getOwnPropertySymbols?h.concat(Object.getOwnPropertySymbols(c)):h},a.prototype.listeners=function(h){var c=s?s+h:h,u=this._events[c];if(!u)return[];if(u.fn)return[u.fn];for(var f=0,p=u.length,d=new Array(p);f<p;f++)d[f]=u[f].fn;return d},a.prototype.listenerCount=function(h){var c=s?s+h:h,u=this._events[c];return u?u.fn?1:u.length:0},a.prototype.emit=function(h,c,u,f,p,d){var m=s?s+h:h;if(!this._events[m])return!1;var g=this._events[m],y=arguments.length,E,_;if(g.fn){switch(g.once&&this.removeListener(h,g.fn,void 0,!0),y){case 1:return g.fn.call(g.context),!0;case 2:return g.fn.call(g.context,c),!0;case 3:return g.fn.call(g.context,c,u),!0;case 4:return g.fn.call(g.context,c,u,f),!0;case 5:return g.fn.call(g.context,c,u,f,p),!0;case 6:return g.fn.call(g.context,c,u,f,p,d),!0}for(_=1,E=new Array(y-1);_<y;_++)E[_-1]=arguments[_];g.fn.apply(g.context,E)}else{var v=g.length,S;for(_=0;_<v;_++)switch(g[_].once&&this.removeListener(h,g[_].fn,void 0,!0),y){case 1:g[_].fn.call(g[_].context);break;case 2:g[_].fn.call(g[_].context,c);break;case 3:g[_].fn.call(g[_].context,c,u);break;case 4:g[_].fn.call(g[_].context,c,u,f);break;default:if(!E)for(S=1,E=new Array(y-1);S<y;S++)E[S-1]=arguments[S];g[_].fn.apply(g[_].context,E)}}return!0},a.prototype.on=function(h,c,u){return n(this,h,c,u,!1)},a.prototype.once=function(h,c,u){return n(this,h,c,u,!0)},a.prototype.removeListener=function(h,c,u,f){var p=s?s+h:h;if(!this._events[p])return this;if(!c)return o(this,p),this;var d=this._events[p];if(d.fn)d.fn===c&&(!f||d.once)&&(!u||d.context===u)&&o(this,p);else{for(var m=0,g=[],y=d.length;m<y;m++)(d[m].fn!==c||f&&!d[m].once||u&&d[m].context!==u)&&g.push(d[m]);g.length?this._events[p]=g.length===1?g[0]:g:o(this,p)}return this},a.prototype.removeAllListeners=function(h){var c;return h?(c=s?s+h:h,this._events[c]&&o(this,c)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=s,a.EventEmitter=a,e.exports=a})(Ud);var Vy=Ud.exports;const Ji=Dh(Vy);var Fh={exports:{}};Fh.exports=ko;Fh.exports.default=ko;function ko(e,t,s){s=s||2;var r=t&&t.length,i=r?t[0]*s:e.length,n=kd(e,0,i,s,!0),o=[];if(!n||n.next===n.prev)return o;var a,l,h,c,u,f,p;if(r&&(n=Zy(e,t,n,s)),e.length>80*s){a=h=e[0],l=c=e[1];for(var d=s;d<i;d+=s)u=e[d],f=e[d+1],u<a&&(a=u),f<l&&(l=f),u>h&&(h=u),f>c&&(c=f);p=Math.max(h-a,c-l),p=p!==0?32767/p:0}return Xi(n,o,s,a,l,p,0),o}function kd(e,t,s,r,i){var n,o;if(i===El(e,t,s,r)>0)for(n=t;n<s;n+=r)o=nu(n,e[n],e[n+1],o);else for(n=s-r;n>=t;n-=r)o=nu(n,e[n],e[n+1],o);return o&&Go(o,o.next)&&(Vi(o),o=o.next),o}function fr(e,t){if(!e)return e;t||(t=e);var s=e,r;do if(r=!1,!s.steiner&&(Go(s,s.next)||Wt(s.prev,s,s.next)===0)){if(Vi(s),s=t=s.prev,s===s.next)break;r=!0}else s=s.next;while(r||s!==t);return t}function Xi(e,t,s,r,i,n,o){if(e){!o&&n&&sv(e,r,i,n);for(var a=e,l,h;e.prev!==e.next;){if(l=e.prev,h=e.next,n?Yy(e,r,i,n):jy(e)){t.push(l.i/s|0),t.push(e.i/s|0),t.push(h.i/s|0),Vi(e),e=h.next,a=h.next;continue}if(e=h,e===a){o?o===1?(e=Ky(fr(e),t,s),Xi(e,t,s,r,i,n,2)):o===2&&qy(e,t,s,r,i,n):Xi(fr(e),t,s,r,i,n,1);break}}}}function jy(e){var t=e.prev,s=e,r=e.next;if(Wt(t,s,r)>=0)return!1;for(var i=t.x,n=s.x,o=r.x,a=t.y,l=s.y,h=r.y,c=i<n?i<o?i:o:n<o?n:o,u=a<l?a<h?a:h:l<h?l:h,f=i>n?i>o?i:o:n>o?n:o,p=a>l?a>h?a:h:l>h?l:h,d=r.next;d!==t;){if(d.x>=c&&d.x<=f&&d.y>=u&&d.y<=p&&Br(i,a,n,l,o,h,d.x,d.y)&&Wt(d.prev,d,d.next)>=0)return!1;d=d.next}return!0}function Yy(e,t,s,r){var i=e.prev,n=e,o=e.next;if(Wt(i,n,o)>=0)return!1;for(var a=i.x,l=n.x,h=o.x,c=i.y,u=n.y,f=o.y,p=a<l?a<h?a:h:l<h?l:h,d=c<u?c<f?c:f:u<f?u:f,m=a>l?a>h?a:h:l>h?l:h,g=c>u?c>f?c:f:u>f?u:f,y=vl(p,d,t,s,r),E=vl(m,g,t,s,r),_=e.prevZ,v=e.nextZ;_&&_.z>=y&&v&&v.z<=E;){if(_.x>=p&&_.x<=m&&_.y>=d&&_.y<=g&&_!==i&&_!==o&&Br(a,c,l,u,h,f,_.x,_.y)&&Wt(_.prev,_,_.next)>=0||(_=_.prevZ,v.x>=p&&v.x<=m&&v.y>=d&&v.y<=g&&v!==i&&v!==o&&Br(a,c,l,u,h,f,v.x,v.y)&&Wt(v.prev,v,v.next)>=0))return!1;v=v.nextZ}for(;_&&_.z>=y;){if(_.x>=p&&_.x<=m&&_.y>=d&&_.y<=g&&_!==i&&_!==o&&Br(a,c,l,u,h,f,_.x,_.y)&&Wt(_.prev,_,_.next)>=0)return!1;_=_.prevZ}for(;v&&v.z<=E;){if(v.x>=p&&v.x<=m&&v.y>=d&&v.y<=g&&v!==i&&v!==o&&Br(a,c,l,u,h,f,v.x,v.y)&&Wt(v.prev,v,v.next)>=0)return!1;v=v.nextZ}return!0}function Ky(e,t,s){var r=e;do{var i=r.prev,n=r.next.next;!Go(i,n)&&Gd(i,r,r.next,n)&&zi(i,n)&&zi(n,i)&&(t.push(i.i/s|0),t.push(r.i/s|0),t.push(n.i/s|0),Vi(r),Vi(r.next),r=e=n),r=r.next}while(r!==e);return fr(r)}function qy(e,t,s,r,i,n){var o=e;do{for(var a=o.next.next;a!==o.prev;){if(o.i!==a.i&&nv(o,a)){var l=Hd(o,a);o=fr(o,o.next),l=fr(l,l.next),Xi(o,t,s,r,i,n,0),Xi(l,t,s,r,i,n,0);return}a=a.next}o=o.next}while(o!==e)}function Zy(e,t,s,r){var i=[],n,o,a,l,h;for(n=0,o=t.length;n<o;n++)a=t[n]*r,l=n<o-1?t[n+1]*r:e.length,h=kd(e,a,l,r,!1),h===h.next&&(h.steiner=!0),i.push(iv(h));for(i.sort(Jy),n=0;n<i.length;n++)s=Qy(i[n],s);return s}function Jy(e,t){return e.x-t.x}function Qy(e,t){var s=tv(e,t);if(!s)return t;var r=Hd(s,e);return fr(r,r.next),fr(s,s.next)}function tv(e,t){var s=t,r=e.x,i=e.y,n=-1/0,o;do{if(i<=s.y&&i>=s.next.y&&s.next.y!==s.y){var a=s.x+(i-s.y)*(s.next.x-s.x)/(s.next.y-s.y);if(a<=r&&a>n&&(n=a,o=s.x<s.next.x?s:s.next,a===r))return o}s=s.next}while(s!==t);if(!o)return null;var l=o,h=o.x,c=o.y,u=1/0,f;s=o;do r>=s.x&&s.x>=h&&r!==s.x&&Br(i<c?r:n,i,h,c,i<c?n:r,i,s.x,s.y)&&(f=Math.abs(i-s.y)/(r-s.x),zi(s,e)&&(f<u||f===u&&(s.x>o.x||s.x===o.x&&ev(o,s)))&&(o=s,u=f)),s=s.next;while(s!==l);return o}function ev(e,t){return Wt(e.prev,e,t.prev)<0&&Wt(t.next,e,e.next)<0}function sv(e,t,s,r){var i=e;do i.z===0&&(i.z=vl(i.x,i.y,t,s,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,rv(i)}function rv(e){var t,s,r,i,n,o,a,l,h=1;do{for(s=e,e=null,n=null,o=0;s;){for(o++,r=s,a=0,t=0;t<h&&(a++,r=r.nextZ,!!r);t++);for(l=h;a>0||l>0&&r;)a!==0&&(l===0||!r||s.z<=r.z)?(i=s,s=s.nextZ,a--):(i=r,r=r.nextZ,l--),n?n.nextZ=i:e=i,i.prevZ=n,n=i;s=r}n.nextZ=null,h*=2}while(o>1);return e}function vl(e,t,s,r,i){return e=(e-s)*i|0,t=(t-r)*i|0,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e|t<<1}function iv(e){var t=e,s=e;do(t.x<s.x||t.x===s.x&&t.y<s.y)&&(s=t),t=t.next;while(t!==e);return s}function Br(e,t,s,r,i,n,o,a){return(i-o)*(t-a)>=(e-o)*(n-a)&&(e-o)*(r-a)>=(s-o)*(t-a)&&(s-o)*(n-a)>=(i-o)*(r-a)}function nv(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!ov(e,t)&&(zi(e,t)&&zi(t,e)&&av(e,t)&&(Wt(e.prev,e,t.prev)||Wt(e,t.prev,t))||Go(e,t)&&Wt(e.prev,e,e.next)>0&&Wt(t.prev,t,t.next)>0)}function Wt(e,t,s){return(t.y-e.y)*(s.x-t.x)-(t.x-e.x)*(s.y-t.y)}function Go(e,t){return e.x===t.x&&e.y===t.y}function Gd(e,t,s,r){var i=gn(Wt(e,t,s)),n=gn(Wt(e,t,r)),o=gn(Wt(s,r,e)),a=gn(Wt(s,r,t));return!!(i!==n&&o!==a||i===0&&mn(e,s,t)||n===0&&mn(e,r,t)||o===0&&mn(s,e,r)||a===0&&mn(s,t,r))}function mn(e,t,s){return t.x<=Math.max(e.x,s.x)&&t.x>=Math.min(e.x,s.x)&&t.y<=Math.max(e.y,s.y)&&t.y>=Math.min(e.y,s.y)}function gn(e){return e>0?1:e<0?-1:0}function ov(e,t){var s=e;do{if(s.i!==e.i&&s.next.i!==e.i&&s.i!==t.i&&s.next.i!==t.i&&Gd(s,s.next,e,t))return!0;s=s.next}while(s!==e);return!1}function zi(e,t){return Wt(e.prev,e,e.next)<0?Wt(e,t,e.next)>=0&&Wt(e,e.prev,t)>=0:Wt(e,t,e.prev)<0||Wt(e,e.next,t)<0}function av(e,t){var s=e,r=!1,i=(e.x+t.x)/2,n=(e.y+t.y)/2;do s.y>n!=s.next.y>n&&s.next.y!==s.y&&i<(s.next.x-s.x)*(n-s.y)/(s.next.y-s.y)+s.x&&(r=!r),s=s.next;while(s!==e);return r}function Hd(e,t){var s=new xl(e.i,e.x,e.y),r=new xl(t.i,t.x,t.y),i=e.next,n=t.prev;return e.next=t,t.prev=e,s.next=i,i.prev=s,r.next=s,s.prev=r,n.next=r,r.prev=n,r}function nu(e,t,s,r){var i=new xl(e,t,s);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function Vi(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function xl(e,t,s){this.i=e,this.x=t,this.y=s,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}ko.deviation=function(e,t,s,r){var i=t&&t.length,n=i?t[0]*s:e.length,o=Math.abs(El(e,0,n,s));if(i)for(var a=0,l=t.length;a<l;a++){var h=t[a]*s,c=a<l-1?t[a+1]*s:e.length;o-=Math.abs(El(e,h,c,s))}var u=0;for(a=0;a<r.length;a+=3){var f=r[a]*s,p=r[a+1]*s,d=r[a+2]*s;u+=Math.abs((e[f]-e[d])*(e[p+1]-e[f+1])-(e[f]-e[p])*(e[d+1]-e[f+1]))}return o===0&&u===0?0:Math.abs((u-o)/o)};function El(e,t,s,r){for(var i=0,n=t,o=s-r;n<s;n+=r)i+=(e[o]-e[n])*(e[n+1]+e[o+1]),o=n;return i}ko.flatten=function(e){for(var t=e[0][0].length,s={vertices:[],holes:[],dimensions:t},r=0,i=0;i<e.length;i++){for(var n=0;n<e[i].length;n++)for(var o=0;o<t;o++)s.vertices.push(e[i][n][o]);i>0&&(r+=e[i-1].length,s.holes.push(r))}return s};var lv=Fh.exports;const hv=Dh(lv);var ao={exports:{}};ao.exports;(function(e,t){(function(s){var r=t&&!t.nodeType&&t,i=e&&!e.nodeType&&e,n=typeof ma=="object"&&ma;(n.global===n||n.window===n||n.self===n)&&(s=n);var o,a=2147483647,l=36,h=1,c=26,u=38,f=700,p=72,d=128,m="-",g=/^xn--/,y=/[^\x20-\x7E]/,E=/[\x2E\u3002\uFF0E\uFF61]/g,_={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},v=l-h,S=Math.floor,A=String.fromCharCode,w;function b(L){throw new RangeError(_[L])}function R(L,N){for(var Y=L.length,it=[];Y--;)it[Y]=N(L[Y]);return it}function F(L,N){var Y=L.split("@"),it="";Y.length>1&&(it=Y[0]+"@",L=Y[1]),L=L.replace(E,".");var tt=L.split("."),dt=R(tt,N).join(".");return it+dt}function U(L){for(var N=[],Y=0,it=L.length,tt,dt;Y<it;)tt=L.charCodeAt(Y++),tt>=55296&&tt<=56319&&Y<it?(dt=L.charCodeAt(Y++),(dt&64512)==56320?N.push(((tt&1023)<<10)+(dt&1023)+65536):(N.push(tt),Y--)):N.push(tt);return N}function H(L){return R(L,function(N){var Y="";return N>65535&&(N-=65536,Y+=A(N>>>10&1023|55296),N=56320|N&1023),Y+=A(N),Y}).join("")}function B(L){return L-48<10?L-22:L-65<26?L-65:L-97<26?L-97:l}function C(L,N){return L+22+75*(L<26)-((N!=0)<<5)}function ht(L,N,Y){var it=0;for(L=Y?S(L/f):L>>1,L+=S(L/N);L>v*c>>1;it+=l)L=S(L/v);return S(it+(v+1)*L/(L+u))}function Q(L){var N=[],Y=L.length,it,tt=0,dt=d,_t=p,ct,vt,Lt,Pt,Mt,x,T,I,M;for(ct=L.lastIndexOf(m),ct<0&&(ct=0),vt=0;vt<ct;++vt)L.charCodeAt(vt)>=128&&b("not-basic"),N.push(L.charCodeAt(vt));for(Lt=ct>0?ct+1:0;Lt<Y;){for(Pt=tt,Mt=1,x=l;Lt>=Y&&b("invalid-input"),T=B(L.charCodeAt(Lt++)),(T>=l||T>S((a-tt)/Mt))&&b("overflow"),tt+=T*Mt,I=x<=_t?h:x>=_t+c?c:x-_t,!(T<I);x+=l)M=l-I,Mt>S(a/M)&&b("overflow"),Mt*=M;it=N.length+1,_t=ht(tt-Pt,it,Pt==0),S(tt/it)>a-dt&&b("overflow"),dt+=S(tt/it),tt%=it,N.splice(tt++,0,dt)}return H(N)}function G(L){var N,Y,it,tt,dt,_t,ct,vt,Lt,Pt,Mt,x=[],T,I,M,D;for(L=U(L),T=L.length,N=d,Y=0,dt=p,_t=0;_t<T;++_t)Mt=L[_t],Mt<128&&x.push(A(Mt));for(it=tt=x.length,tt&&x.push(m);it<T;){for(ct=a,_t=0;_t<T;++_t)Mt=L[_t],Mt>=N&&Mt<ct&&(ct=Mt);for(I=it+1,ct-N>S((a-Y)/I)&&b("overflow"),Y+=(ct-N)*I,N=ct,_t=0;_t<T;++_t)if(Mt=L[_t],Mt<N&&++Y>a&&b("overflow"),Mt==N){for(vt=Y,Lt=l;Pt=Lt<=dt?h:Lt>=dt+c?c:Lt-dt,!(vt<Pt);Lt+=l)D=vt-Pt,M=l-Pt,x.push(A(C(Pt+D%M,0))),vt=S(D/M);x.push(A(C(vt,0))),dt=ht(Y,I,it==tt),Y=0,++it}++Y,++N}return x.join("")}function rt(L){return F(L,function(N){return g.test(N)?Q(N.slice(4).toLowerCase()):N})}function Ct(L){return F(L,function(N){return y.test(N)?"xn--"+G(N):N})}if(o={version:"1.4.1",ucs2:{decode:U,encode:H},decode:Q,encode:G,toASCII:Ct,toUnicode:rt},r&&i)if(e.exports==r)i.exports=o;else for(w in o)o.hasOwnProperty(w)&&(r[w]=o[w]);else s.punycode=o})(ma)})(ao,ao.exports);var cv=ao.exports,uv=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var t={},s=Symbol("test"),r=Object(s);if(typeof s=="string"||Object.prototype.toString.call(s)!=="[object Symbol]"||Object.prototype.toString.call(r)!=="[object Symbol]")return!1;var i=42;t[s]=i;for(s in t)return!1;if(typeof Object.keys=="function"&&Object.keys(t).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(t).length!==0)return!1;var n=Object.getOwnPropertySymbols(t);if(n.length!==1||n[0]!==s||!Object.prototype.propertyIsEnumerable.call(t,s))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var o=Object.getOwnPropertyDescriptor(t,s);if(o.value!==i||o.enumerable!==!0)return!1}return!0},ou=typeof Symbol<"u"&&Symbol,fv=uv,dv=function(){return typeof ou!="function"||typeof Symbol!="function"||typeof ou("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:fv()},au={foo:{}},pv=Object,mv=function(){return{__proto__:au}.foo===au.foo&&!({__proto__:null}instanceof pv)},gv="Function.prototype.bind called on incompatible ",ga=Array.prototype.slice,_v=Object.prototype.toString,yv="[object Function]",vv=function(t){var s=this;if(typeof s!="function"||_v.call(s)!==yv)throw new TypeError(gv+s);for(var r=ga.call(arguments,1),i,n=function(){if(this instanceof i){var c=s.apply(this,r.concat(ga.call(arguments)));return Object(c)===c?c:this}else return s.apply(t,r.concat(ga.call(arguments)))},o=Math.max(0,s.length-r.length),a=[],l=0;l<o;l++)a.push("$"+l);if(i=Function("binder","return function ("+a.join(",")+"){ return binder.apply(this,arguments); }")(n),s.prototype){var h=function(){};h.prototype=s.prototype,i.prototype=new h,h.prototype=null}return i},xv=vv,Lh=Function.prototype.bind||xv,Ev=Lh,bv=Ev.call(Function.call,Object.prototype.hasOwnProperty),Et,Jr=SyntaxError,$d=Function,Hr=TypeError,_a=function(e){try{return $d('"use strict"; return ('+e+").constructor;")()}catch{}},ar=Object.getOwnPropertyDescriptor;if(ar)try{ar({},"")}catch{ar=null}var ya=function(){throw new Hr},wv=ar?function(){try{return arguments.callee,ya}catch{try{return ar(arguments,"callee").get}catch{return ya}}}():ya,wr=dv(),Tv=mv(),te=Object.getPrototypeOf||(Tv?function(e){return e.__proto__}:null),Ir={},Sv=typeof Uint8Array>"u"||!te?Et:te(Uint8Array),lr={"%AggregateError%":typeof AggregateError>"u"?Et:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?Et:ArrayBuffer,"%ArrayIteratorPrototype%":wr&&te?te([][Symbol.iterator]()):Et,"%AsyncFromSyncIteratorPrototype%":Et,"%AsyncFunction%":Ir,"%AsyncGenerator%":Ir,"%AsyncGeneratorFunction%":Ir,"%AsyncIteratorPrototype%":Ir,"%Atomics%":typeof Atomics>"u"?Et:Atomics,"%BigInt%":typeof BigInt>"u"?Et:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?Et:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?Et:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?Et:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array>"u"?Et:Float32Array,"%Float64Array%":typeof Float64Array>"u"?Et:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?Et:FinalizationRegistry,"%Function%":$d,"%GeneratorFunction%":Ir,"%Int8Array%":typeof Int8Array>"u"?Et:Int8Array,"%Int16Array%":typeof Int16Array>"u"?Et:Int16Array,"%Int32Array%":typeof Int32Array>"u"?Et:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":wr&&te?te(te([][Symbol.iterator]())):Et,"%JSON%":typeof JSON=="object"?JSON:Et,"%Map%":typeof Map>"u"?Et:Map,"%MapIteratorPrototype%":typeof Map>"u"||!wr||!te?Et:te(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?Et:Promise,"%Proxy%":typeof Proxy>"u"?Et:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect>"u"?Et:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?Et:Set,"%SetIteratorPrototype%":typeof Set>"u"||!wr||!te?Et:te(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?Et:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":wr&&te?te(""[Symbol.iterator]()):Et,"%Symbol%":wr?Symbol:Et,"%SyntaxError%":Jr,"%ThrowTypeError%":wv,"%TypedArray%":Sv,"%TypeError%":Hr,"%Uint8Array%":typeof Uint8Array>"u"?Et:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?Et:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?Et:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?Et:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap>"u"?Et:WeakMap,"%WeakRef%":typeof WeakRef>"u"?Et:WeakRef,"%WeakSet%":typeof WeakSet>"u"?Et:WeakSet};if(te)try{null.error}catch(e){var Av=te(te(e));lr["%Error.prototype%"]=Av}var Iv=function e(t){var s;if(t==="%AsyncFunction%")s=_a("async function () {}");else if(t==="%GeneratorFunction%")s=_a("function* () {}");else if(t==="%AsyncGeneratorFunction%")s=_a("async function* () {}");else if(t==="%AsyncGenerator%"){var r=e("%AsyncGeneratorFunction%");r&&(s=r.prototype)}else if(t==="%AsyncIteratorPrototype%"){var i=e("%AsyncGenerator%");i&&te&&(s=te(i.prototype))}return lr[t]=s,s},lu={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},Qi=Lh,lo=bv,Cv=Qi.call(Function.call,Array.prototype.concat),Rv=Qi.call(Function.apply,Array.prototype.splice),hu=Qi.call(Function.call,String.prototype.replace),ho=Qi.call(Function.call,String.prototype.slice),Pv=Qi.call(Function.call,RegExp.prototype.exec),Mv=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,Ov=/\\(\\)?/g,Bv=function(t){var s=ho(t,0,1),r=ho(t,-1);if(s==="%"&&r!=="%")throw new Jr("invalid intrinsic syntax, expected closing `%`");if(r==="%"&&s!=="%")throw new Jr("invalid intrinsic syntax, expected opening `%`");var i=[];return hu(t,Mv,function(n,o,a,l){i[i.length]=a?hu(l,Ov,"$1"):o||n}),i},Dv=function(t,s){var r=t,i;if(lo(lu,r)&&(i=lu[r],r="%"+i[0]+"%"),lo(lr,r)){var n=lr[r];if(n===Ir&&(n=Iv(r)),typeof n>"u"&&!s)throw new Hr("intrinsic "+t+" exists, but is not available. Please file an issue!");return{alias:i,name:r,value:n}}throw new Jr("intrinsic "+t+" does not exist!")},Nh=function(t,s){if(typeof t!="string"||t.length===0)throw new Hr("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof s!="boolean")throw new Hr('"allowMissing" argument must be a boolean');if(Pv(/^%?[^%]*%?$/,t)===null)throw new Jr("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var r=Bv(t),i=r.length>0?r[0]:"",n=Dv("%"+i+"%",s),o=n.name,a=n.value,l=!1,h=n.alias;h&&(i=h[0],Rv(r,Cv([0,1],h)));for(var c=1,u=!0;c<r.length;c+=1){var f=r[c],p=ho(f,0,1),d=ho(f,-1);if((p==='"'||p==="'"||p==="`"||d==='"'||d==="'"||d==="`")&&p!==d)throw new Jr("property names with quotes must have matching quotes");if((f==="constructor"||!u)&&(l=!0),i+="."+f,o="%"+i+"%",lo(lr,o))a=lr[o];else if(a!=null){if(!(f in a)){if(!s)throw new Hr("base intrinsic for "+t+" exists, but the property is not available.");return}if(ar&&c+1>=r.length){var m=ar(a,f);u=!!m,u&&"get"in m&&!("originalValue"in m.get)?a=m.get:a=a[f]}else u=lo(a,f),a=a[f];u&&!l&&(lr[o]=a)}}return a},Wd={exports:{}};(function(e){var t=Lh,s=Nh,r=s("%Function.prototype.apply%"),i=s("%Function.prototype.call%"),n=s("%Reflect.apply%",!0)||t.call(i,r),o=s("%Object.getOwnPropertyDescriptor%",!0),a=s("%Object.defineProperty%",!0),l=s("%Math.max%");if(a)try{a({},"a",{value:1})}catch{a=null}e.exports=function(u){var f=n(t,i,arguments);if(o&&a){var p=o(f,"length");p.configurable&&a(f,"length",{value:1+l(0,u.length-(arguments.length-1))})}return f};var h=function(){return n(t,r,arguments)};a?a(e.exports,"apply",{value:h}):e.exports.apply=h})(Wd);var Fv=Wd.exports,Xd=Nh,zd=Fv,Lv=zd(Xd("String.prototype.indexOf")),Nv=function(t,s){var r=Xd(t,!!s);return typeof r=="function"&&Lv(t,".prototype.")>-1?zd(r):r};const Uv={},kv=Object.freeze(Object.defineProperty({__proto__:null,default:Uv},Symbol.toStringTag,{value:"Module"})),Gv=zy(kv);var Uh=typeof Map=="function"&&Map.prototype,va=Object.getOwnPropertyDescriptor&&Uh?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,co=Uh&&va&&typeof va.get=="function"?va.get:null,cu=Uh&&Map.prototype.forEach,kh=typeof Set=="function"&&Set.prototype,xa=Object.getOwnPropertyDescriptor&&kh?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,uo=kh&&xa&&typeof xa.get=="function"?xa.get:null,uu=kh&&Set.prototype.forEach,Hv=typeof WeakMap=="function"&&WeakMap.prototype,Di=Hv?WeakMap.prototype.has:null,$v=typeof WeakSet=="function"&&WeakSet.prototype,Fi=$v?WeakSet.prototype.has:null,Wv=typeof WeakRef=="function"&&WeakRef.prototype,fu=Wv?WeakRef.prototype.deref:null,Xv=Boolean.prototype.valueOf,zv=Object.prototype.toString,Vv=Function.prototype.toString,jv=String.prototype.match,Gh=String.prototype.slice,Bs=String.prototype.replace,Yv=String.prototype.toUpperCase,du=String.prototype.toLowerCase,Vd=RegExp.prototype.test,pu=Array.prototype.concat,ts=Array.prototype.join,Kv=Array.prototype.slice,mu=Math.floor,bl=typeof BigInt=="function"?BigInt.prototype.valueOf:null,Ea=Object.getOwnPropertySymbols,wl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,Qr=typeof Symbol=="function"&&typeof Symbol.iterator=="object",de=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===Qr||"symbol")?Symbol.toStringTag:null,jd=Object.prototype.propertyIsEnumerable,gu=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(e){return e.__proto__}:null);function _u(e,t){if(e===1/0||e===-1/0||e!==e||e&&e>-1e3&&e<1e3||Vd.call(/e/,t))return t;var s=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof e=="number"){var r=e<0?-mu(-e):mu(e);if(r!==e){var i=String(r),n=Gh.call(t,i.length+1);return Bs.call(i,s,"$&_")+"."+Bs.call(Bs.call(n,/([0-9]{3})/g,"$&_"),/_$/,"")}}return Bs.call(t,s,"$&_")}var Tl=Gv,yu=Tl.custom,vu=Kd(yu)?yu:null,qv=function e(t,s,r,i){var n=s||{};if(Ms(n,"quoteStyle")&&n.quoteStyle!=="single"&&n.quoteStyle!=="double")throw new TypeError('option "quoteStyle" must be "single" or "double"');if(Ms(n,"maxStringLength")&&(typeof n.maxStringLength=="number"?n.maxStringLength<0&&n.maxStringLength!==1/0:n.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var o=Ms(n,"customInspect")?n.customInspect:!0;if(typeof o!="boolean"&&o!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(Ms(n,"indent")&&n.indent!==null&&n.indent!=="	"&&!(parseInt(n.indent,10)===n.indent&&n.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(Ms(n,"numericSeparator")&&typeof n.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var a=n.numericSeparator;if(typeof t>"u")return"undefined";if(t===null)return"null";if(typeof t=="boolean")return t?"true":"false";if(typeof t=="string")return Zd(t,n);if(typeof t=="number"){if(t===0)return 1/0/t>0?"0":"-0";var l=String(t);return a?_u(t,l):l}if(typeof t=="bigint"){var h=String(t)+"n";return a?_u(t,h):h}var c=typeof n.depth>"u"?5:n.depth;if(typeof r>"u"&&(r=0),r>=c&&c>0&&typeof t=="object")return Sl(t)?"[Array]":"[Object]";var u=px(n,r);if(typeof i>"u")i=[];else if(qd(i,t)>=0)return"[Circular]";function f(B,C,ht){if(C&&(i=Kv.call(i),i.push(C)),ht){var Q={depth:n.depth};return Ms(n,"quoteStyle")&&(Q.quoteStyle=n.quoteStyle),e(B,Q,r+1,i)}return e(B,n,r+1,i)}if(typeof t=="function"&&!xu(t)){var p=nx(t),d=_n(t,f);return"[Function"+(p?": "+p:" (anonymous)")+"]"+(d.length>0?" { "+ts.call(d,", ")+" }":"")}if(Kd(t)){var m=Qr?Bs.call(String(t),/^(Symbol\(.*\))_[^)]*$/,"$1"):wl.call(t);return typeof t=="object"&&!Qr?pi(m):m}if(ux(t)){for(var g="<"+du.call(String(t.nodeName)),y=t.attributes||[],E=0;E<y.length;E++)g+=" "+y[E].name+"="+Yd(Zv(y[E].value),"double",n);return g+=">",t.childNodes&&t.childNodes.length&&(g+="..."),g+="</"+du.call(String(t.nodeName))+">",g}if(Sl(t)){if(t.length===0)return"[]";var _=_n(t,f);return u&&!dx(_)?"["+Al(_,u)+"]":"[ "+ts.call(_,", ")+" ]"}if(Qv(t)){var v=_n(t,f);return!("cause"in Error.prototype)&&"cause"in t&&!jd.call(t,"cause")?"{ ["+String(t)+"] "+ts.call(pu.call("[cause]: "+f(t.cause),v),", ")+" }":v.length===0?"["+String(t)+"]":"{ ["+String(t)+"] "+ts.call(v,", ")+" }"}if(typeof t=="object"&&o){if(vu&&typeof t[vu]=="function"&&Tl)return Tl(t,{depth:c-r});if(o!=="symbol"&&typeof t.inspect=="function")return t.inspect()}if(ox(t)){var S=[];return cu&&cu.call(t,function(B,C){S.push(f(C,t,!0)+" => "+f(B,t))}),Eu("Map",co.call(t),S,u)}if(hx(t)){var A=[];return uu&&uu.call(t,function(B){A.push(f(B,t))}),Eu("Set",uo.call(t),A,u)}if(ax(t))return ba("WeakMap");if(cx(t))return ba("WeakSet");if(lx(t))return ba("WeakRef");if(ex(t))return pi(f(Number(t)));if(rx(t))return pi(f(bl.call(t)));if(sx(t))return pi(Xv.call(t));if(tx(t))return pi(f(String(t)));if(!Jv(t)&&!xu(t)){var w=_n(t,f),b=gu?gu(t)===Object.prototype:t instanceof Object||t.constructor===Object,R=t instanceof Object?"":"null prototype",F=!b&&de&&Object(t)===t&&de in t?Gh.call(zs(t),8,-1):R?"Object":"",U=b||typeof t.constructor!="function"?"":t.constructor.name?t.constructor.name+" ":"",H=U+(F||R?"["+ts.call(pu.call([],F||[],R||[]),": ")+"] ":"");return w.length===0?H+"{}":u?H+"{"+Al(w,u)+"}":H+"{ "+ts.call(w,", ")+" }"}return String(t)};function Yd(e,t,s){var r=(s.quoteStyle||t)==="double"?'"':"'";return r+e+r}function Zv(e){return Bs.call(String(e),/"/g,"&quot;")}function Sl(e){return zs(e)==="[object Array]"&&(!de||!(typeof e=="object"&&de in e))}function Jv(e){return zs(e)==="[object Date]"&&(!de||!(typeof e=="object"&&de in e))}function xu(e){return zs(e)==="[object RegExp]"&&(!de||!(typeof e=="object"&&de in e))}function Qv(e){return zs(e)==="[object Error]"&&(!de||!(typeof e=="object"&&de in e))}function tx(e){return zs(e)==="[object String]"&&(!de||!(typeof e=="object"&&de in e))}function ex(e){return zs(e)==="[object Number]"&&(!de||!(typeof e=="object"&&de in e))}function sx(e){return zs(e)==="[object Boolean]"&&(!de||!(typeof e=="object"&&de in e))}function Kd(e){if(Qr)return e&&typeof e=="object"&&e instanceof Symbol;if(typeof e=="symbol")return!0;if(!e||typeof e!="object"||!wl)return!1;try{return wl.call(e),!0}catch{}return!1}function rx(e){if(!e||typeof e!="object"||!bl)return!1;try{return bl.call(e),!0}catch{}return!1}var ix=Object.prototype.hasOwnProperty||function(e){return e in this};function Ms(e,t){return ix.call(e,t)}function zs(e){return zv.call(e)}function nx(e){if(e.name)return e.name;var t=jv.call(Vv.call(e),/^function\s*([\w$]+)/);return t?t[1]:null}function qd(e,t){if(e.indexOf)return e.indexOf(t);for(var s=0,r=e.length;s<r;s++)if(e[s]===t)return s;return-1}function ox(e){if(!co||!e||typeof e!="object")return!1;try{co.call(e);try{uo.call(e)}catch{return!0}return e instanceof Map}catch{}return!1}function ax(e){if(!Di||!e||typeof e!="object")return!1;try{Di.call(e,Di);try{Fi.call(e,Fi)}catch{return!0}return e instanceof WeakMap}catch{}return!1}function lx(e){if(!fu||!e||typeof e!="object")return!1;try{return fu.call(e),!0}catch{}return!1}function hx(e){if(!uo||!e||typeof e!="object")return!1;try{uo.call(e);try{co.call(e)}catch{return!0}return e instanceof Set}catch{}return!1}function cx(e){if(!Fi||!e||typeof e!="object")return!1;try{Fi.call(e,Fi);try{Di.call(e,Di)}catch{return!0}return e instanceof WeakSet}catch{}return!1}function ux(e){return!e||typeof e!="object"?!1:typeof HTMLElement<"u"&&e instanceof HTMLElement?!0:typeof e.nodeName=="string"&&typeof e.getAttribute=="function"}function Zd(e,t){if(e.length>t.maxStringLength){var s=e.length-t.maxStringLength,r="... "+s+" more character"+(s>1?"s":"");return Zd(Gh.call(e,0,t.maxStringLength),t)+r}var i=Bs.call(Bs.call(e,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,fx);return Yd(i,"single",t)}function fx(e){var t=e.charCodeAt(0),s={8:"b",9:"t",10:"n",12:"f",13:"r"}[t];return s?"\\"+s:"\\x"+(t<16?"0":"")+Yv.call(t.toString(16))}function pi(e){return"Object("+e+")"}function ba(e){return e+" { ? }"}function Eu(e,t,s,r){var i=r?Al(s,r):ts.call(s,", ");return e+" ("+t+") {"+i+"}"}function dx(e){for(var t=0;t<e.length;t++)if(qd(e[t],`
`)>=0)return!1;return!0}function px(e,t){var s;if(e.indent==="	")s="	";else if(typeof e.indent=="number"&&e.indent>0)s=ts.call(Array(e.indent+1)," ");else return null;return{base:s,prev:ts.call(Array(t+1),s)}}function Al(e,t){if(e.length===0)return"";var s=`
`+t.prev+t.base;return s+ts.call(e,","+s)+`
`+t.prev}function _n(e,t){var s=Sl(e),r=[];if(s){r.length=e.length;for(var i=0;i<e.length;i++)r[i]=Ms(e,i)?t(e[i],e):""}var n=typeof Ea=="function"?Ea(e):[],o;if(Qr){o={};for(var a=0;a<n.length;a++)o["$"+n[a]]=n[a]}for(var l in e)Ms(e,l)&&(s&&String(Number(l))===l&&l<e.length||Qr&&o["$"+l]instanceof Symbol||(Vd.call(/[^\w$]/,l)?r.push(t(l,e)+": "+t(e[l],e)):r.push(l+": "+t(e[l],e))));if(typeof Ea=="function")for(var h=0;h<n.length;h++)jd.call(e,n[h])&&r.push("["+t(n[h])+"]: "+t(e[n[h]],e));return r}var Hh=Nh,li=Nv,mx=qv,gx=Hh("%TypeError%"),yn=Hh("%WeakMap%",!0),vn=Hh("%Map%",!0),_x=li("WeakMap.prototype.get",!0),yx=li("WeakMap.prototype.set",!0),vx=li("WeakMap.prototype.has",!0),xx=li("Map.prototype.get",!0),Ex=li("Map.prototype.set",!0),bx=li("Map.prototype.has",!0),$h=function(e,t){for(var s=e,r;(r=s.next)!==null;s=r)if(r.key===t)return s.next=r.next,r.next=e.next,e.next=r,r},wx=function(e,t){var s=$h(e,t);return s&&s.value},Tx=function(e,t,s){var r=$h(e,t);r?r.value=s:e.next={key:t,next:e.next,value:s}},Sx=function(e,t){return!!$h(e,t)},Ax=function(){var t,s,r,i={assert:function(n){if(!i.has(n))throw new gx("Side channel does not contain "+mx(n))},get:function(n){if(yn&&n&&(typeof n=="object"||typeof n=="function")){if(t)return _x(t,n)}else if(vn){if(s)return xx(s,n)}else if(r)return wx(r,n)},has:function(n){if(yn&&n&&(typeof n=="object"||typeof n=="function")){if(t)return vx(t,n)}else if(vn){if(s)return bx(s,n)}else if(r)return Sx(r,n);return!1},set:function(n,o){yn&&n&&(typeof n=="object"||typeof n=="function")?(t||(t=new yn),yx(t,n,o)):vn?(s||(s=new vn),Ex(s,n,o)):(r||(r={key:{},next:null}),Tx(r,n,o))}};return i},Ix=String.prototype.replace,Cx=/%20/g,wa={RFC1738:"RFC1738",RFC3986:"RFC3986"},Wh={default:wa.RFC3986,formatters:{RFC1738:function(e){return Ix.call(e,Cx,"+")},RFC3986:function(e){return String(e)}},RFC1738:wa.RFC1738,RFC3986:wa.RFC3986},Rx=Wh,Ta=Object.prototype.hasOwnProperty,sr=Array.isArray,Ke=function(){for(var e=[],t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e}(),Px=function(t){for(;t.length>1;){var s=t.pop(),r=s.obj[s.prop];if(sr(r)){for(var i=[],n=0;n<r.length;++n)typeof r[n]<"u"&&i.push(r[n]);s.obj[s.prop]=i}}},Jd=function(t,s){for(var r=s&&s.plainObjects?Object.create(null):{},i=0;i<t.length;++i)typeof t[i]<"u"&&(r[i]=t[i]);return r},Mx=function e(t,s,r){if(!s)return t;if(typeof s!="object"){if(sr(t))t.push(s);else if(t&&typeof t=="object")(r&&(r.plainObjects||r.allowPrototypes)||!Ta.call(Object.prototype,s))&&(t[s]=!0);else return[t,s];return t}if(!t||typeof t!="object")return[t].concat(s);var i=t;return sr(t)&&!sr(s)&&(i=Jd(t,r)),sr(t)&&sr(s)?(s.forEach(function(n,o){if(Ta.call(t,o)){var a=t[o];a&&typeof a=="object"&&n&&typeof n=="object"?t[o]=e(a,n,r):t.push(n)}else t[o]=n}),t):Object.keys(s).reduce(function(n,o){var a=s[o];return Ta.call(n,o)?n[o]=e(n[o],a,r):n[o]=a,n},i)},Ox=function(t,s){return Object.keys(s).reduce(function(r,i){return r[i]=s[i],r},t)},Bx=function(e,t,s){var r=e.replace(/\+/g," ");if(s==="iso-8859-1")return r.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(r)}catch{return r}},Dx=function(t,s,r,i,n){if(t.length===0)return t;var o=t;if(typeof t=="symbol"?o=Symbol.prototype.toString.call(t):typeof t!="string"&&(o=String(t)),r==="iso-8859-1")return escape(o).replace(/%u[0-9a-f]{4}/gi,function(c){return"%26%23"+parseInt(c.slice(2),16)+"%3B"});for(var a="",l=0;l<o.length;++l){var h=o.charCodeAt(l);if(h===45||h===46||h===95||h===126||h>=48&&h<=57||h>=65&&h<=90||h>=97&&h<=122||n===Rx.RFC1738&&(h===40||h===41)){a+=o.charAt(l);continue}if(h<128){a=a+Ke[h];continue}if(h<2048){a=a+(Ke[192|h>>6]+Ke[128|h&63]);continue}if(h<55296||h>=57344){a=a+(Ke[224|h>>12]+Ke[128|h>>6&63]+Ke[128|h&63]);continue}l+=1,h=65536+((h&1023)<<10|o.charCodeAt(l)&1023),a+=Ke[240|h>>18]+Ke[128|h>>12&63]+Ke[128|h>>6&63]+Ke[128|h&63]}return a},Fx=function(t){for(var s=[{obj:{o:t},prop:"o"}],r=[],i=0;i<s.length;++i)for(var n=s[i],o=n.obj[n.prop],a=Object.keys(o),l=0;l<a.length;++l){var h=a[l],c=o[h];typeof c=="object"&&c!==null&&r.indexOf(c)===-1&&(s.push({obj:o,prop:h}),r.push(c))}return Px(s),t},Lx=function(t){return Object.prototype.toString.call(t)==="[object RegExp]"},Nx=function(t){return!t||typeof t!="object"?!1:!!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t))},Ux=function(t,s){return[].concat(t,s)},kx=function(t,s){if(sr(t)){for(var r=[],i=0;i<t.length;i+=1)r.push(s(t[i]));return r}return s(t)},Qd={arrayToObject:Jd,assign:Ox,combine:Ux,compact:Fx,decode:Bx,encode:Dx,isBuffer:Nx,isRegExp:Lx,maybeMap:kx,merge:Mx},tp=Ax,Xn=Qd,Li=Wh,Gx=Object.prototype.hasOwnProperty,bu={brackets:function(t){return t+"[]"},comma:"comma",indices:function(t,s){return t+"["+s+"]"},repeat:function(t){return t}},_s=Array.isArray,Hx=Array.prototype.push,ep=function(e,t){Hx.apply(e,_s(t)?t:[t])},$x=Date.prototype.toISOString,wu=Li.default,he={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:Xn.encode,encodeValuesOnly:!1,format:wu,formatter:Li.formatters[wu],indices:!1,serializeDate:function(t){return $x.call(t)},skipNulls:!1,strictNullHandling:!1},Wx=function(t){return typeof t=="string"||typeof t=="number"||typeof t=="boolean"||typeof t=="symbol"||typeof t=="bigint"},Sa={},Xx=function e(t,s,r,i,n,o,a,l,h,c,u,f,p,d,m,g){for(var y=t,E=g,_=0,v=!1;(E=E.get(Sa))!==void 0&&!v;){var S=E.get(t);if(_+=1,typeof S<"u"){if(S===_)throw new RangeError("Cyclic object value");v=!0}typeof E.get(Sa)>"u"&&(_=0)}if(typeof l=="function"?y=l(s,y):y instanceof Date?y=u(y):r==="comma"&&_s(y)&&(y=Xn.maybeMap(y,function(Q){return Q instanceof Date?u(Q):Q})),y===null){if(n)return a&&!d?a(s,he.encoder,m,"key",f):s;y=""}if(Wx(y)||Xn.isBuffer(y)){if(a){var A=d?s:a(s,he.encoder,m,"key",f);return[p(A)+"="+p(a(y,he.encoder,m,"value",f))]}return[p(s)+"="+p(String(y))]}var w=[];if(typeof y>"u")return w;var b;if(r==="comma"&&_s(y))d&&a&&(y=Xn.maybeMap(y,a)),b=[{value:y.length>0?y.join(",")||null:void 0}];else if(_s(l))b=l;else{var R=Object.keys(y);b=h?R.sort(h):R}for(var F=i&&_s(y)&&y.length===1?s+"[]":s,U=0;U<b.length;++U){var H=b[U],B=typeof H=="object"&&typeof H.value<"u"?H.value:y[H];if(!(o&&B===null)){var C=_s(y)?typeof r=="function"?r(F,H):F:F+(c?"."+H:"["+H+"]");g.set(t,_);var ht=tp();ht.set(Sa,g),ep(w,e(B,C,r,i,n,o,r==="comma"&&d&&_s(y)?null:a,l,h,c,u,f,p,d,m,ht))}}return w},zx=function(t){if(!t)return he;if(t.encoder!==null&&typeof t.encoder<"u"&&typeof t.encoder!="function")throw new TypeError("Encoder has to be a function.");var s=t.charset||he.charset;if(typeof t.charset<"u"&&t.charset!=="utf-8"&&t.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var r=Li.default;if(typeof t.format<"u"){if(!Gx.call(Li.formatters,t.format))throw new TypeError("Unknown format option provided.");r=t.format}var i=Li.formatters[r],n=he.filter;return(typeof t.filter=="function"||_s(t.filter))&&(n=t.filter),{addQueryPrefix:typeof t.addQueryPrefix=="boolean"?t.addQueryPrefix:he.addQueryPrefix,allowDots:typeof t.allowDots>"u"?he.allowDots:!!t.allowDots,charset:s,charsetSentinel:typeof t.charsetSentinel=="boolean"?t.charsetSentinel:he.charsetSentinel,delimiter:typeof t.delimiter>"u"?he.delimiter:t.delimiter,encode:typeof t.encode=="boolean"?t.encode:he.encode,encoder:typeof t.encoder=="function"?t.encoder:he.encoder,encodeValuesOnly:typeof t.encodeValuesOnly=="boolean"?t.encodeValuesOnly:he.encodeValuesOnly,filter:n,format:r,formatter:i,serializeDate:typeof t.serializeDate=="function"?t.serializeDate:he.serializeDate,skipNulls:typeof t.skipNulls=="boolean"?t.skipNulls:he.skipNulls,sort:typeof t.sort=="function"?t.sort:null,strictNullHandling:typeof t.strictNullHandling=="boolean"?t.strictNullHandling:he.strictNullHandling}},Vx=function(e,t){var s=e,r=zx(t),i,n;typeof r.filter=="function"?(n=r.filter,s=n("",s)):_s(r.filter)&&(n=r.filter,i=n);var o=[];if(typeof s!="object"||s===null)return"";var a;t&&t.arrayFormat in bu?a=t.arrayFormat:t&&"indices"in t?a=t.indices?"indices":"repeat":a="indices";var l=bu[a];if(t&&"commaRoundTrip"in t&&typeof t.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var h=l==="comma"&&t&&t.commaRoundTrip;i||(i=Object.keys(s)),r.sort&&i.sort(r.sort);for(var c=tp(),u=0;u<i.length;++u){var f=i[u];r.skipNulls&&s[f]===null||ep(o,Xx(s[f],f,l,h,r.strictNullHandling,r.skipNulls,r.encode?r.encoder:null,r.filter,r.sort,r.allowDots,r.serializeDate,r.format,r.formatter,r.encodeValuesOnly,r.charset,c))}var p=o.join(r.delimiter),d=r.addQueryPrefix===!0?"?":"";return r.charsetSentinel&&(r.charset==="iso-8859-1"?d+="utf8=%26%2310003%3B&":d+="utf8=%E2%9C%93&"),p.length>0?d+p:""},ti=Qd,Il=Object.prototype.hasOwnProperty,jx=Array.isArray,Qt={allowDots:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:ti.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},Yx=function(e){return e.replace(/&#(\d+);/g,function(t,s){return String.fromCharCode(parseInt(s,10))})},sp=function(e,t){return e&&typeof e=="string"&&t.comma&&e.indexOf(",")>-1?e.split(","):e},Kx="utf8=%26%2310003%3B",qx="utf8=%E2%9C%93",Zx=function(t,s){var r={__proto__:null},i=s.ignoreQueryPrefix?t.replace(/^\?/,""):t,n=s.parameterLimit===1/0?void 0:s.parameterLimit,o=i.split(s.delimiter,n),a=-1,l,h=s.charset;if(s.charsetSentinel)for(l=0;l<o.length;++l)o[l].indexOf("utf8=")===0&&(o[l]===qx?h="utf-8":o[l]===Kx&&(h="iso-8859-1"),a=l,l=o.length);for(l=0;l<o.length;++l)if(l!==a){var c=o[l],u=c.indexOf("]="),f=u===-1?c.indexOf("="):u+1,p,d;f===-1?(p=s.decoder(c,Qt.decoder,h,"key"),d=s.strictNullHandling?null:""):(p=s.decoder(c.slice(0,f),Qt.decoder,h,"key"),d=ti.maybeMap(sp(c.slice(f+1),s),function(m){return s.decoder(m,Qt.decoder,h,"value")})),d&&s.interpretNumericEntities&&h==="iso-8859-1"&&(d=Yx(d)),c.indexOf("[]=")>-1&&(d=jx(d)?[d]:d),Il.call(r,p)?r[p]=ti.combine(r[p],d):r[p]=d}return r},Jx=function(e,t,s,r){for(var i=r?t:sp(t,s),n=e.length-1;n>=0;--n){var o,a=e[n];if(a==="[]"&&s.parseArrays)o=[].concat(i);else{o=s.plainObjects?Object.create(null):{};var l=a.charAt(0)==="["&&a.charAt(a.length-1)==="]"?a.slice(1,-1):a,h=parseInt(l,10);!s.parseArrays&&l===""?o={0:i}:!isNaN(h)&&a!==l&&String(h)===l&&h>=0&&s.parseArrays&&h<=s.arrayLimit?(o=[],o[h]=i):l!=="__proto__"&&(o[l]=i)}i=o}return i},Qx=function(t,s,r,i){if(t){var n=r.allowDots?t.replace(/\.([^.[]+)/g,"[$1]"):t,o=/(\[[^[\]]*])/,a=/(\[[^[\]]*])/g,l=r.depth>0&&o.exec(n),h=l?n.slice(0,l.index):n,c=[];if(h){if(!r.plainObjects&&Il.call(Object.prototype,h)&&!r.allowPrototypes)return;c.push(h)}for(var u=0;r.depth>0&&(l=a.exec(n))!==null&&u<r.depth;){if(u+=1,!r.plainObjects&&Il.call(Object.prototype,l[1].slice(1,-1))&&!r.allowPrototypes)return;c.push(l[1])}return l&&c.push("["+n.slice(l.index)+"]"),Jx(c,s,r,i)}},t0=function(t){if(!t)return Qt;if(t.decoder!==null&&t.decoder!==void 0&&typeof t.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof t.charset<"u"&&t.charset!=="utf-8"&&t.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var s=typeof t.charset>"u"?Qt.charset:t.charset;return{allowDots:typeof t.allowDots>"u"?Qt.allowDots:!!t.allowDots,allowPrototypes:typeof t.allowPrototypes=="boolean"?t.allowPrototypes:Qt.allowPrototypes,allowSparse:typeof t.allowSparse=="boolean"?t.allowSparse:Qt.allowSparse,arrayLimit:typeof t.arrayLimit=="number"?t.arrayLimit:Qt.arrayLimit,charset:s,charsetSentinel:typeof t.charsetSentinel=="boolean"?t.charsetSentinel:Qt.charsetSentinel,comma:typeof t.comma=="boolean"?t.comma:Qt.comma,decoder:typeof t.decoder=="function"?t.decoder:Qt.decoder,delimiter:typeof t.delimiter=="string"||ti.isRegExp(t.delimiter)?t.delimiter:Qt.delimiter,depth:typeof t.depth=="number"||t.depth===!1?+t.depth:Qt.depth,ignoreQueryPrefix:t.ignoreQueryPrefix===!0,interpretNumericEntities:typeof t.interpretNumericEntities=="boolean"?t.interpretNumericEntities:Qt.interpretNumericEntities,parameterLimit:typeof t.parameterLimit=="number"?t.parameterLimit:Qt.parameterLimit,parseArrays:t.parseArrays!==!1,plainObjects:typeof t.plainObjects=="boolean"?t.plainObjects:Qt.plainObjects,strictNullHandling:typeof t.strictNullHandling=="boolean"?t.strictNullHandling:Qt.strictNullHandling}},e0=function(e,t){var s=t0(t);if(e===""||e===null||typeof e>"u")return s.plainObjects?Object.create(null):{};for(var r=typeof e=="string"?Zx(e,s):e,i=s.plainObjects?Object.create(null):{},n=Object.keys(r),o=0;o<n.length;++o){var a=n[o],l=Qx(a,r[a],s,typeof e=="string");i=ti.merge(i,l,s)}return s.allowSparse===!0?i:ti.compact(i)},s0=Vx,r0=e0,i0=Wh,n0={formats:i0,parse:r0,stringify:s0},o0=cv;function We(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var a0=/^([a-z0-9.+-]+:)/i,l0=/:[0-9]*$/,h0=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,c0=["<",">",'"',"`"," ","\r",`
`,"	"],u0=["{","}","|","\\","^","`"].concat(c0),Cl=["'"].concat(u0),Tu=["%","/","?",";","#"].concat(Cl),Su=["/","?","#"],f0=255,Au=/^[+a-z0-9A-Z_-]{0,63}$/,d0=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,p0={javascript:!0,"javascript:":!0},Rl={javascript:!0,"javascript:":!0},$r={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},Pl=n0;function Ho(e,t,s){if(e&&typeof e=="object"&&e instanceof We)return e;var r=new We;return r.parse(e,t,s),r}We.prototype.parse=function(e,t,s){if(typeof e!="string")throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var r=e.indexOf("?"),i=r!==-1&&r<e.indexOf("#")?"?":"#",n=e.split(i),o=/\\/g;n[0]=n[0].replace(o,"/"),e=n.join(i);var a=e;if(a=a.trim(),!s&&e.split("#").length===1){var l=h0.exec(a);if(l)return this.path=a,this.href=a,this.pathname=l[1],l[2]?(this.search=l[2],t?this.query=Pl.parse(this.search.substr(1)):this.query=this.search.substr(1)):t&&(this.search="",this.query={}),this}var h=a0.exec(a);if(h){h=h[0];var c=h.toLowerCase();this.protocol=c,a=a.substr(h.length)}if(s||h||a.match(/^\/\/[^@/]+@[^@/]+/)){var u=a.substr(0,2)==="//";u&&!(h&&Rl[h])&&(a=a.substr(2),this.slashes=!0)}if(!Rl[h]&&(u||h&&!$r[h])){for(var f=-1,p=0;p<Su.length;p++){var d=a.indexOf(Su[p]);d!==-1&&(f===-1||d<f)&&(f=d)}var m,g;f===-1?g=a.lastIndexOf("@"):g=a.lastIndexOf("@",f),g!==-1&&(m=a.slice(0,g),a=a.slice(g+1),this.auth=decodeURIComponent(m)),f=-1;for(var p=0;p<Tu.length;p++){var d=a.indexOf(Tu[p]);d!==-1&&(f===-1||d<f)&&(f=d)}f===-1&&(f=a.length),this.host=a.slice(0,f),a=a.slice(f),this.parseHost(),this.hostname=this.hostname||"";var y=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!y)for(var E=this.hostname.split(/\./),p=0,_=E.length;p<_;p++){var v=E[p];if(v&&!v.match(Au)){for(var S="",A=0,w=v.length;A<w;A++)v.charCodeAt(A)>127?S+="x":S+=v[A];if(!S.match(Au)){var b=E.slice(0,p),R=E.slice(p+1),F=v.match(d0);F&&(b.push(F[1]),R.unshift(F[2])),R.length&&(a="/"+R.join(".")+a),this.hostname=b.join(".");break}}}this.hostname.length>f0?this.hostname="":this.hostname=this.hostname.toLowerCase(),y||(this.hostname=o0.toASCII(this.hostname));var U=this.port?":"+this.port:"",H=this.hostname||"";this.host=H+U,this.href+=this.host,y&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),a[0]!=="/"&&(a="/"+a))}if(!p0[c])for(var p=0,_=Cl.length;p<_;p++){var B=Cl[p];if(a.indexOf(B)!==-1){var C=encodeURIComponent(B);C===B&&(C=escape(B)),a=a.split(B).join(C)}}var ht=a.indexOf("#");ht!==-1&&(this.hash=a.substr(ht),a=a.slice(0,ht));var Q=a.indexOf("?");if(Q!==-1?(this.search=a.substr(Q),this.query=a.substr(Q+1),t&&(this.query=Pl.parse(this.query)),a=a.slice(0,Q)):t&&(this.search="",this.query={}),a&&(this.pathname=a),$r[c]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var U=this.pathname||"",G=this.search||"";this.path=U+G}return this.href=this.format(),this};function m0(e){return typeof e=="string"&&(e=Ho(e)),e instanceof We?e.format():We.prototype.format.call(e)}We.prototype.format=function(){var e=this.auth||"";e&&(e=encodeURIComponent(e),e=e.replace(/%3A/i,":"),e+="@");var t=this.protocol||"",s=this.pathname||"",r=this.hash||"",i=!1,n="";this.host?i=e+this.host:this.hostname&&(i=e+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(i+=":"+this.port)),this.query&&typeof this.query=="object"&&Object.keys(this.query).length&&(n=Pl.stringify(this.query));var o=this.search||n&&"?"+n||"";return t&&t.substr(-1)!==":"&&(t+=":"),this.slashes||(!t||$r[t])&&i!==!1?(i="//"+(i||""),s&&s.charAt(0)!=="/"&&(s="/"+s)):i||(i=""),r&&r.charAt(0)!=="#"&&(r="#"+r),o&&o.charAt(0)!=="?"&&(o="?"+o),s=s.replace(/[?#]/g,function(a){return encodeURIComponent(a)}),o=o.replace("#","%23"),t+i+s+o+r};function g0(e,t){return Ho(e,!1,!0).resolve(t)}We.prototype.resolve=function(e){return this.resolveObject(Ho(e,!1,!0)).format()};We.prototype.resolveObject=function(e){if(typeof e=="string"){var t=new We;t.parse(e,!1,!0),e=t}for(var s=new We,r=Object.keys(this),i=0;i<r.length;i++){var n=r[i];s[n]=this[n]}if(s.hash=e.hash,e.href==="")return s.href=s.format(),s;if(e.slashes&&!e.protocol){for(var o=Object.keys(e),a=0;a<o.length;a++){var l=o[a];l!=="protocol"&&(s[l]=e[l])}return $r[s.protocol]&&s.hostname&&!s.pathname&&(s.pathname="/",s.path=s.pathname),s.href=s.format(),s}if(e.protocol&&e.protocol!==s.protocol){if(!$r[e.protocol]){for(var h=Object.keys(e),c=0;c<h.length;c++){var u=h[c];s[u]=e[u]}return s.href=s.format(),s}if(s.protocol=e.protocol,!e.host&&!Rl[e.protocol]){for(var _=(e.pathname||"").split("/");_.length&&!(e.host=_.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),_[0]!==""&&_.unshift(""),_.length<2&&_.unshift(""),s.pathname=_.join("/")}else s.pathname=e.pathname;if(s.search=e.search,s.query=e.query,s.host=e.host||"",s.auth=e.auth,s.hostname=e.hostname||e.host,s.port=e.port,s.pathname||s.search){var f=s.pathname||"",p=s.search||"";s.path=f+p}return s.slashes=s.slashes||e.slashes,s.href=s.format(),s}var d=s.pathname&&s.pathname.charAt(0)==="/",m=e.host||e.pathname&&e.pathname.charAt(0)==="/",g=m||d||s.host&&e.pathname,y=g,E=s.pathname&&s.pathname.split("/")||[],_=e.pathname&&e.pathname.split("/")||[],v=s.protocol&&!$r[s.protocol];if(v&&(s.hostname="",s.port=null,s.host&&(E[0]===""?E[0]=s.host:E.unshift(s.host)),s.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(_[0]===""?_[0]=e.host:_.unshift(e.host)),e.host=null),g=g&&(_[0]===""||E[0]==="")),m)s.host=e.host||e.host===""?e.host:s.host,s.hostname=e.hostname||e.hostname===""?e.hostname:s.hostname,s.search=e.search,s.query=e.query,E=_;else if(_.length)E||(E=[]),E.pop(),E=E.concat(_),s.search=e.search,s.query=e.query;else if(e.search!=null){if(v){s.host=E.shift(),s.hostname=s.host;var S=s.host&&s.host.indexOf("@")>0?s.host.split("@"):!1;S&&(s.auth=S.shift(),s.hostname=S.shift(),s.host=s.hostname)}return s.search=e.search,s.query=e.query,(s.pathname!==null||s.search!==null)&&(s.path=(s.pathname?s.pathname:"")+(s.search?s.search:"")),s.href=s.format(),s}if(!E.length)return s.pathname=null,s.search?s.path="/"+s.search:s.path=null,s.href=s.format(),s;for(var A=E.slice(-1)[0],w=(s.host||e.host||E.length>1)&&(A==="."||A==="..")||A==="",b=0,R=E.length;R>=0;R--)A=E[R],A==="."?E.splice(R,1):A===".."?(E.splice(R,1),b++):b&&(E.splice(R,1),b--);if(!g&&!y)for(;b--;b)E.unshift("..");g&&E[0]!==""&&(!E[0]||E[0].charAt(0)!=="/")&&E.unshift(""),w&&E.join("/").substr(-1)!=="/"&&E.push("");var F=E[0]===""||E[0]&&E[0].charAt(0)==="/";if(v){s.hostname=F?"":E.length?E.shift():"",s.host=s.hostname;var S=s.host&&s.host.indexOf("@")>0?s.host.split("@"):!1;S&&(s.auth=S.shift(),s.hostname=S.shift(),s.host=s.hostname)}return g=g||s.host&&E.length,g&&!F&&E.unshift(""),E.length>0?s.pathname=E.join("/"):(s.pathname=null,s.path=null),(s.pathname!==null||s.search!==null)&&(s.path=(s.pathname?s.pathname:"")+(s.search?s.search:"")),s.auth=e.auth||s.auth,s.slashes=s.slashes||e.slashes,s.href=s.format(),s};We.prototype.parseHost=function(){var e=this.host,t=l0.exec(e);t&&(t=t[0],t!==":"&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)};var _0=Ho,y0=g0,v0=m0;const x0={parse:_0,format:v0,resolve:y0};function Me(e){if(typeof e!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(e)}`)}function mi(e){return e.split("?")[0].split("#")[0]}function E0(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function b0(e,t,s){return e.replace(new RegExp(E0(t),"g"),s)}function w0(e,t){let s="",r=0,i=-1,n=0,o=-1;for(let a=0;a<=e.length;++a){if(a<e.length)o=e.charCodeAt(a);else{if(o===47)break;o=47}if(o===47){if(!(i===a-1||n===1))if(i!==a-1&&n===2){if(s.length<2||r!==2||s.charCodeAt(s.length-1)!==46||s.charCodeAt(s.length-2)!==46){if(s.length>2){const l=s.lastIndexOf("/");if(l!==s.length-1){l===-1?(s="",r=0):(s=s.slice(0,l),r=s.length-1-s.lastIndexOf("/")),i=a,n=0;continue}}else if(s.length===2||s.length===1){s="",r=0,i=a,n=0;continue}}t&&(s.length>0?s+="/..":s="..",r=2)}else s.length>0?s+=`/${e.slice(i+1,a)}`:s=e.slice(i+1,a),r=a-i-1;i=a,n=0}else o===46&&n!==-1?++n:n=-1}return s}const fe={toPosix(e){return b0(e,"\\","/")},isUrl(e){return/^https?:/.test(this.toPosix(e))},isDataUrl(e){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(e)},hasProtocol(e){return/^[^/:]+:\//.test(this.toPosix(e))},getProtocol(e){Me(e),e=this.toPosix(e);let t="";const s=/^file:\/\/\//.exec(e),r=/^[^/:]+:\/\//.exec(e),i=/^[^/:]+:\//.exec(e);if(s||r||i){const n=(s==null?void 0:s[0])||(r==null?void 0:r[0])||(i==null?void 0:i[0]);t=n,e=e.slice(n.length)}return t},toAbsolute(e,t,s){if(this.isDataUrl(e))return e;const r=mi(this.toPosix(t??q.ADAPTER.getBaseUrl())),i=mi(this.toPosix(s??this.rootname(r)));return Me(e),e=this.toPosix(e),e.startsWith("/")?fe.join(i,e.slice(1)):this.isAbsolute(e)?e:this.join(r,e)},normalize(e){if(e=this.toPosix(e),Me(e),e.length===0)return".";let t="";const s=e.startsWith("/");this.hasProtocol(e)&&(t=this.rootname(e),e=e.slice(t.length));const r=e.endsWith("/");return e=w0(e,!1),e.length>0&&r&&(e+="/"),s?`/${e}`:t+e},isAbsolute(e){return Me(e),e=this.toPosix(e),this.hasProtocol(e)?!0:e.startsWith("/")},join(...e){if(e.length===0)return".";let t;for(let s=0;s<e.length;++s){const r=e[s];if(Me(r),r.length>0)if(t===void 0)t=r;else{const i=e[s-1]??"";this.extname(i)?t+=`/../${r}`:t+=`/${r}`}}return t===void 0?".":this.normalize(t)},dirname(e){if(Me(e),e.length===0)return".";e=this.toPosix(e);let t=e.charCodeAt(0);const s=t===47;let r=-1,i=!0;const n=this.getProtocol(e),o=e;e=e.slice(n.length);for(let a=e.length-1;a>=1;--a)if(t=e.charCodeAt(a),t===47){if(!i){r=a;break}}else i=!1;return r===-1?s?"/":this.isUrl(o)?n+e:n:s&&r===1?"//":n+e.slice(0,r)},rootname(e){Me(e),e=this.toPosix(e);let t="";if(e.startsWith("/")?t="/":t=this.getProtocol(e),this.isUrl(e)){const s=e.indexOf("/",t.length);s!==-1?t=e.slice(0,s):t=e,t.endsWith("/")||(t+="/")}return t},basename(e,t){Me(e),t&&Me(t),e=mi(this.toPosix(e));let s=0,r=-1,i=!0,n;if(t!==void 0&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return"";let o=t.length-1,a=-1;for(n=e.length-1;n>=0;--n){const l=e.charCodeAt(n);if(l===47){if(!i){s=n+1;break}}else a===-1&&(i=!1,a=n+1),o>=0&&(l===t.charCodeAt(o)?--o===-1&&(r=n):(o=-1,r=a))}return s===r?r=a:r===-1&&(r=e.length),e.slice(s,r)}for(n=e.length-1;n>=0;--n)if(e.charCodeAt(n)===47){if(!i){s=n+1;break}}else r===-1&&(i=!1,r=n+1);return r===-1?"":e.slice(s,r)},extname(e){Me(e),e=mi(this.toPosix(e));let t=-1,s=0,r=-1,i=!0,n=0;for(let o=e.length-1;o>=0;--o){const a=e.charCodeAt(o);if(a===47){if(!i){s=o+1;break}continue}r===-1&&(i=!1,r=o+1),a===46?t===-1?t=o:n!==1&&(n=1):t!==-1&&(n=-1)}return t===-1||r===-1||n===0||n===1&&t===r-1&&t===s+1?"":e.slice(t,r)},parse(e){Me(e);const t={root:"",dir:"",base:"",ext:"",name:""};if(e.length===0)return t;e=mi(this.toPosix(e));let s=e.charCodeAt(0);const r=this.isAbsolute(e);let i;t.root=this.rootname(e),r||this.hasProtocol(e)?i=1:i=0;let n=-1,o=0,a=-1,l=!0,h=e.length-1,c=0;for(;h>=i;--h){if(s=e.charCodeAt(h),s===47){if(!l){o=h+1;break}continue}a===-1&&(l=!1,a=h+1),s===46?n===-1?n=h:c!==1&&(c=1):n!==-1&&(c=-1)}return n===-1||a===-1||c===0||c===1&&n===a-1&&n===o+1?a!==-1&&(o===0&&r?t.base=t.name=e.slice(1,a):t.base=t.name=e.slice(o,a)):(o===0&&r?(t.name=e.slice(1,n),t.base=e.slice(1,a)):(t.name=e.slice(o,n),t.base=e.slice(o,a)),t.ext=e.slice(n,a)),t.dir=this.dirname(e),t},sep:"/",delimiter:":"},Iu={};function bt(e,t,s=3){if(Iu[t])return;let r=new Error().stack;typeof r>"u"?console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${e}`):(r=r.split(`
`).splice(s).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${t}
Deprecated since v${e}`),console.warn(r),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${e}`),console.warn(r))),Iu[t]=!0}let Aa;function T0(){return typeof Aa>"u"&&(Aa=function(){var s;const t={stencil:!0,failIfMajorPerformanceCaveat:q.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!q.ADAPTER.getWebGLRenderingContext())return!1;const r=q.ADAPTER.createCanvas();let i=r.getContext("webgl",t)||r.getContext("experimental-webgl",t);const n=!!((s=i==null?void 0:i.getContextAttributes())!=null&&s.stencil);if(i){const o=i.getExtension("WEBGL_lose_context");o&&o.loseContext()}return i=null,n}catch{return!1}}()),Aa}var S0={grad:.9,turn:360,rad:360/(2*Math.PI)},fs=function(e){return typeof e=="string"?e.length>0:typeof e=="number"},ee=function(e,t,s){return t===void 0&&(t=0),s===void 0&&(s=Math.pow(10,t)),Math.round(s*e)/s+0},Ie=function(e,t,s){return t===void 0&&(t=0),s===void 0&&(s=1),e>s?s:e>t?e:t},rp=function(e){return(e=isFinite(e)?e%360:0)>0?e:e+360},Cu=function(e){return{r:Ie(e.r,0,255),g:Ie(e.g,0,255),b:Ie(e.b,0,255),a:Ie(e.a)}},Ia=function(e){return{r:ee(e.r),g:ee(e.g),b:ee(e.b),a:ee(e.a,3)}},A0=/^#([0-9a-f]{3,8})$/i,xn=function(e){var t=e.toString(16);return t.length<2?"0"+t:t},ip=function(e){var t=e.r,s=e.g,r=e.b,i=e.a,n=Math.max(t,s,r),o=n-Math.min(t,s,r),a=o?n===t?(s-r)/o:n===s?2+(r-t)/o:4+(t-s)/o:0;return{h:60*(a<0?a+6:a),s:n?o/n*100:0,v:n/255*100,a:i}},np=function(e){var t=e.h,s=e.s,r=e.v,i=e.a;t=t/360*6,s/=100,r/=100;var n=Math.floor(t),o=r*(1-s),a=r*(1-(t-n)*s),l=r*(1-(1-t+n)*s),h=n%6;return{r:255*[r,a,o,o,l,r][h],g:255*[l,r,r,a,o,o][h],b:255*[o,o,l,r,r,a][h],a:i}},Ru=function(e){return{h:rp(e.h),s:Ie(e.s,0,100),l:Ie(e.l,0,100),a:Ie(e.a)}},Pu=function(e){return{h:ee(e.h),s:ee(e.s),l:ee(e.l),a:ee(e.a,3)}},Mu=function(e){return np((s=(t=e).s,{h:t.h,s:(s*=((r=t.l)<50?r:100-r)/100)>0?2*s/(r+s)*100:0,v:r+s,a:t.a}));var t,s,r},Ni=function(e){return{h:(t=ip(e)).h,s:(i=(200-(s=t.s))*(r=t.v)/100)>0&&i<200?s*r/100/(i<=100?i:200-i)*100:0,l:i/2,a:t.a};var t,s,r,i},I0=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,C0=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,R0=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,P0=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Ml={string:[[function(e){var t=A0.exec(e);return t?(e=t[1]).length<=4?{r:parseInt(e[0]+e[0],16),g:parseInt(e[1]+e[1],16),b:parseInt(e[2]+e[2],16),a:e.length===4?ee(parseInt(e[3]+e[3],16)/255,2):1}:e.length===6||e.length===8?{r:parseInt(e.substr(0,2),16),g:parseInt(e.substr(2,2),16),b:parseInt(e.substr(4,2),16),a:e.length===8?ee(parseInt(e.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(e){var t=R0.exec(e)||P0.exec(e);return t?t[2]!==t[4]||t[4]!==t[6]?null:Cu({r:Number(t[1])/(t[2]?100/255:1),g:Number(t[3])/(t[4]?100/255:1),b:Number(t[5])/(t[6]?100/255:1),a:t[7]===void 0?1:Number(t[7])/(t[8]?100:1)}):null},"rgb"],[function(e){var t=I0.exec(e)||C0.exec(e);if(!t)return null;var s,r,i=Ru({h:(s=t[1],r=t[2],r===void 0&&(r="deg"),Number(s)*(S0[r]||1)),s:Number(t[3]),l:Number(t[4]),a:t[5]===void 0?1:Number(t[5])/(t[6]?100:1)});return Mu(i)},"hsl"]],object:[[function(e){var t=e.r,s=e.g,r=e.b,i=e.a,n=i===void 0?1:i;return fs(t)&&fs(s)&&fs(r)?Cu({r:Number(t),g:Number(s),b:Number(r),a:Number(n)}):null},"rgb"],[function(e){var t=e.h,s=e.s,r=e.l,i=e.a,n=i===void 0?1:i;if(!fs(t)||!fs(s)||!fs(r))return null;var o=Ru({h:Number(t),s:Number(s),l:Number(r),a:Number(n)});return Mu(o)},"hsl"],[function(e){var t=e.h,s=e.s,r=e.v,i=e.a,n=i===void 0?1:i;if(!fs(t)||!fs(s)||!fs(r))return null;var o=function(a){return{h:rp(a.h),s:Ie(a.s,0,100),v:Ie(a.v,0,100),a:Ie(a.a)}}({h:Number(t),s:Number(s),v:Number(r),a:Number(n)});return np(o)},"hsv"]]},Ou=function(e,t){for(var s=0;s<t.length;s++){var r=t[s][0](e);if(r)return[r,t[s][1]]}return[null,void 0]},M0=function(e){return typeof e=="string"?Ou(e.trim(),Ml.string):typeof e=="object"&&e!==null?Ou(e,Ml.object):[null,void 0]},Ca=function(e,t){var s=Ni(e);return{h:s.h,s:Ie(s.s+100*t,0,100),l:s.l,a:s.a}},Ra=function(e){return(299*e.r+587*e.g+114*e.b)/1e3/255},Bu=function(e,t){var s=Ni(e);return{h:s.h,s:s.s,l:Ie(s.l+100*t,0,100),a:s.a}},Ol=function(){function e(t){this.parsed=M0(t)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return e.prototype.isValid=function(){return this.parsed!==null},e.prototype.brightness=function(){return ee(Ra(this.rgba),2)},e.prototype.isDark=function(){return Ra(this.rgba)<.5},e.prototype.isLight=function(){return Ra(this.rgba)>=.5},e.prototype.toHex=function(){return t=Ia(this.rgba),s=t.r,r=t.g,i=t.b,o=(n=t.a)<1?xn(ee(255*n)):"","#"+xn(s)+xn(r)+xn(i)+o;var t,s,r,i,n,o},e.prototype.toRgb=function(){return Ia(this.rgba)},e.prototype.toRgbString=function(){return t=Ia(this.rgba),s=t.r,r=t.g,i=t.b,(n=t.a)<1?"rgba("+s+", "+r+", "+i+", "+n+")":"rgb("+s+", "+r+", "+i+")";var t,s,r,i,n},e.prototype.toHsl=function(){return Pu(Ni(this.rgba))},e.prototype.toHslString=function(){return t=Pu(Ni(this.rgba)),s=t.h,r=t.s,i=t.l,(n=t.a)<1?"hsla("+s+", "+r+"%, "+i+"%, "+n+")":"hsl("+s+", "+r+"%, "+i+"%)";var t,s,r,i,n},e.prototype.toHsv=function(){return t=ip(this.rgba),{h:ee(t.h),s:ee(t.s),v:ee(t.v),a:ee(t.a,3)};var t},e.prototype.invert=function(){return qe({r:255-(t=this.rgba).r,g:255-t.g,b:255-t.b,a:t.a});var t},e.prototype.saturate=function(t){return t===void 0&&(t=.1),qe(Ca(this.rgba,t))},e.prototype.desaturate=function(t){return t===void 0&&(t=.1),qe(Ca(this.rgba,-t))},e.prototype.grayscale=function(){return qe(Ca(this.rgba,-1))},e.prototype.lighten=function(t){return t===void 0&&(t=.1),qe(Bu(this.rgba,t))},e.prototype.darken=function(t){return t===void 0&&(t=.1),qe(Bu(this.rgba,-t))},e.prototype.rotate=function(t){return t===void 0&&(t=15),this.hue(this.hue()+t)},e.prototype.alpha=function(t){return typeof t=="number"?qe({r:(s=this.rgba).r,g:s.g,b:s.b,a:t}):ee(this.rgba.a,3);var s},e.prototype.hue=function(t){var s=Ni(this.rgba);return typeof t=="number"?qe({h:t,s:s.s,l:s.l,a:s.a}):ee(s.h)},e.prototype.isEqual=function(t){return this.toHex()===qe(t).toHex()},e}(),qe=function(e){return e instanceof Ol?e:new Ol(e)},Du=[],O0=function(e){e.forEach(function(t){Du.indexOf(t)<0&&(t(Ol,Ml),Du.push(t))})};function B0(e,t){var s={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},r={};for(var i in s)r[s[i]]=i;var n={};e.prototype.toName=function(o){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var a,l,h=r[this.toHex()];if(h)return h;if(o!=null&&o.closest){var c=this.toRgb(),u=1/0,f="black";if(!n.length)for(var p in s)n[p]=new e(s[p]).toRgb();for(var d in s){var m=(a=c,l=n[d],Math.pow(a.r-l.r,2)+Math.pow(a.g-l.g,2)+Math.pow(a.b-l.b,2));m<u&&(u=m,f=d)}return f}},t.string.push([function(o){var a=o.toLowerCase(),l=a==="transparent"?"#0000":s[a];return l?new e(l).toRgb():null},"name"])}O0([B0]);const Wr=class{constructor(e=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=e}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(e){return this.value=e,this}set value(e){if(e instanceof Wr)this._value=this.cloneSource(e._value),this._int=e._int,this._components.set(e._components);else{if(e===null)throw new Error("Cannot set PIXI.Color#value to null");(this._value===null||!this.isSourceEqual(this._value,e))&&(this.normalize(e),this._value=this.cloneSource(e))}}get value(){return this._value}cloneSource(e){return typeof e=="string"||typeof e=="number"||e instanceof Number||e===null?e:Array.isArray(e)||ArrayBuffer.isView(e)?e.slice(0):typeof e=="object"&&e!==null?{...e}:e}isSourceEqual(e,t){const s=typeof e;if(s!==typeof t)return!1;if(s==="number"||s==="string"||e instanceof Number)return e===t;if(Array.isArray(e)&&Array.isArray(t)||ArrayBuffer.isView(e)&&ArrayBuffer.isView(t))return e.length!==t.length?!1:e.every((i,n)=>i===t[n]);if(e!==null&&t!==null){const i=Object.keys(e),n=Object.keys(t);return i.length!==n.length?!1:i.every(o=>e[o]===t[o])}return e===t}toRgba(){const[e,t,s,r]=this._components;return{r:e,g:t,b:s,a:r}}toRgb(){const[e,t,s]=this._components;return{r:e,g:t,b:s}}toRgbaString(){const[e,t,s]=this.toUint8RgbArray();return`rgba(${e},${t},${s},${this.alpha})`}toUint8RgbArray(e){const[t,s,r]=this._components;return e=e??[],e[0]=Math.round(t*255),e[1]=Math.round(s*255),e[2]=Math.round(r*255),e}toRgbArray(e){e=e??[];const[t,s,r]=this._components;return e[0]=t,e[1]=s,e[2]=r,e}toNumber(){return this._int}toLittleEndianNumber(){const e=this._int;return(e>>16)+(e&65280)+((e&255)<<16)}multiply(e){const[t,s,r,i]=Wr.temp.setValue(e)._components;return this._components[0]*=t,this._components[1]*=s,this._components[2]*=r,this._components[3]*=i,this.refreshInt(),this._value=null,this}premultiply(e,t=!0){return t&&(this._components[0]*=e,this._components[1]*=e,this._components[2]*=e),this._components[3]=e,this.refreshInt(),this._value=null,this}toPremultiplied(e,t=!0){if(e===1)return(255<<24)+this._int;if(e===0)return t?0:this._int;let s=this._int>>16&255,r=this._int>>8&255,i=this._int&255;return t&&(s=s*e+.5|0,r=r*e+.5|0,i=i*e+.5|0),(e*255<<24)+(s<<16)+(r<<8)+i}toHex(){const e=this._int.toString(16);return`#${"000000".substring(0,6-e.length)+e}`}toHexa(){const t=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-t.length)+t}setAlpha(e){return this._components[3]=this._clamp(e),this}round(e){const[t,s,r]=this._components;return this._components[0]=Math.round(t*e)/e,this._components[1]=Math.round(s*e)/e,this._components[2]=Math.round(r*e)/e,this.refreshInt(),this._value=null,this}toArray(e){e=e??[];const[t,s,r,i]=this._components;return e[0]=t,e[1]=s,e[2]=r,e[3]=i,e}normalize(e){let t,s,r,i;if((typeof e=="number"||e instanceof Number)&&e>=0&&e<=16777215){const n=e;t=(n>>16&255)/255,s=(n>>8&255)/255,r=(n&255)/255,i=1}else if((Array.isArray(e)||e instanceof Float32Array)&&e.length>=3&&e.length<=4)e=this._clamp(e),[t,s,r,i=1]=e;else if((e instanceof Uint8Array||e instanceof Uint8ClampedArray)&&e.length>=3&&e.length<=4)e=this._clamp(e,0,255),[t,s,r,i=255]=e,t/=255,s/=255,r/=255,i/=255;else if(typeof e=="string"||typeof e=="object"){if(typeof e=="string"){const o=Wr.HEX_PATTERN.exec(e);o&&(e=`#${o[2]}`)}const n=qe(e);n.isValid()&&({r:t,g:s,b:r,a:i}=n.rgba,t/=255,s/=255,r/=255)}if(t!==void 0)this._components[0]=t,this._components[1]=s,this._components[2]=r,this._components[3]=i,this.refreshInt();else throw new Error(`Unable to convert color ${e}`)}refreshInt(){this._clamp(this._components);const[e,t,s]=this._components;this._int=(e*255<<16)+(t*255<<8)+(s*255|0)}_clamp(e,t=0,s=1){return typeof e=="number"?Math.min(Math.max(e,t),s):(e.forEach((r,i)=>{e[i]=Math.min(Math.max(r,t),s)}),e)}};let Ft=Wr;Ft.shared=new Wr;Ft.temp=new Wr;Ft.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;function D0(e){return bt("7.2.0","utils.hex2string is deprecated, use Color#toHex instead"),Ft.shared.setValue(e).toHex()}function F0(e){return bt("7.2.0","utils.rgb2hex is deprecated, use Color#toNumber instead"),Ft.shared.setValue(e).toNumber()}function L0(){const e=[],t=[];for(let r=0;r<32;r++)e[r]=r,t[r]=r;e[ut.NORMAL_NPM]=ut.NORMAL,e[ut.ADD_NPM]=ut.ADD,e[ut.SCREEN_NPM]=ut.SCREEN,t[ut.NORMAL]=ut.NORMAL_NPM,t[ut.ADD]=ut.ADD_NPM,t[ut.SCREEN]=ut.SCREEN_NPM;const s=[];return s.push(t),s.push(e),s}const op=L0();function ap(e,t){return op[t?1:0][e]}function N0(e,t=null){const s=e*6;if(t=t||new Uint16Array(s),t.length!==s)throw new Error(`Out buffer length is incorrect, got ${t.length} and expected ${s}`);for(let r=0,i=0;r<s;r+=6,i+=4)t[r+0]=i+0,t[r+1]=i+1,t[r+2]=i+2,t[r+3]=i+0,t[r+4]=i+2,t[r+5]=i+3;return t}function lp(e){if(e.BYTES_PER_ELEMENT===4)return e instanceof Float32Array?"Float32Array":e instanceof Uint32Array?"Uint32Array":"Int32Array";if(e.BYTES_PER_ELEMENT===2){if(e instanceof Uint16Array)return"Uint16Array"}else if(e.BYTES_PER_ELEMENT===1&&e instanceof Uint8Array)return"Uint8Array";return null}function fo(e){return e+=e===0?1:0,--e,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e+1}function Fu(e){return!(e&e-1)&&!!e}function Lu(e){let t=(e>65535?1:0)<<4;e>>>=t;let s=(e>255?1:0)<<3;return e>>>=s,t|=s,s=(e>15?1:0)<<2,e>>>=s,t|=s,s=(e>3?1:0)<<1,e>>>=s,t|=s,t|e>>1}function Xr(e,t,s){const r=e.length;let i;if(t>=r||s===0)return;s=t+s>r?r-t:s;const n=r-s;for(i=t;i<n;++i)e[i]=e[i+s];e.length=n}function Ds(e){return e===0?0:e<0?-1:1}let U0=0;function dr(){return++U0}const hp=class{constructor(e,t,s,r){this.left=e,this.top=t,this.right=s,this.bottom=r}get width(){return this.right-this.left}get height(){return this.bottom-this.top}isEmpty(){return this.left===this.right||this.top===this.bottom}};let Bl=hp;Bl.EMPTY=new hp(0,0,0,0);const Nu={},Ze=Object.create(null),Cs=Object.create(null);class k0{constructor(t,s,r){this._canvas=q.ADAPTER.createCanvas(),this._context=this._canvas.getContext("2d"),this.resolution=r||q.RESOLUTION,this.resize(t,s)}clear(){this._checkDestroyed(),this._context.setTransform(1,0,0,1,0,0),this._context.clearRect(0,0,this._canvas.width,this._canvas.height)}resize(t,s){this._checkDestroyed(),this._canvas.width=Math.round(t*this.resolution),this._canvas.height=Math.round(s*this.resolution)}destroy(){this._context=null,this._canvas=null}get width(){return this._checkDestroyed(),this._canvas.width}set width(t){this._checkDestroyed(),this._canvas.width=Math.round(t)}get height(){return this._checkDestroyed(),this._canvas.height}set height(t){this._checkDestroyed(),this._canvas.height=Math.round(t)}get canvas(){return this._checkDestroyed(),this._canvas}get context(){return this._checkDestroyed(),this._context}_checkDestroyed(){if(this._canvas===null)throw new TypeError("The CanvasRenderTarget has already been destroyed")}}function Uu(e,t,s){for(let r=0,i=4*s*t;r<t;++r,i+=4)if(e[i+3]!==0)return!1;return!0}function ku(e,t,s,r,i){const n=4*t;for(let o=r,a=r*n+4*s;o<=i;++o,a+=n)if(e[a+3]!==0)return!1;return!0}function G0(e){const{width:t,height:s}=e,r=e.getContext("2d",{willReadFrequently:!0});if(r===null)throw new TypeError("Failed to get canvas 2D context");const n=r.getImageData(0,0,t,s).data;let o=0,a=0,l=t-1,h=s-1;for(;a<s&&Uu(n,t,a);)++a;if(a===s)return Bl.EMPTY;for(;Uu(n,t,h);)--h;for(;ku(n,t,o,a,h);)++o;for(;ku(n,t,l,a,h);)--l;return++l,++h,new Bl(o,a,l,h)}function H0(e){const t=G0(e),{width:s,height:r}=t;let i=null;if(!t.isEmpty()){const n=e.getContext("2d");if(n===null)throw new TypeError("Failed to get canvas 2D context");i=n.getImageData(t.left,t.top,s,r)}return{width:s,height:r,data:i}}let En;function $0(e,t=globalThis.location){if(e.startsWith("data:"))return"";t=t||globalThis.location,En||(En=document.createElement("a")),En.href=e;const s=x0.parse(En.href),r=!s.port&&t.port===""||s.port===t.port;return s.hostname!==t.hostname||!r||s.protocol!==t.protocol?"anonymous":""}function Hs(e,t=1){var r;const s=(r=q.RETINA_PREFIX)==null?void 0:r.exec(e);return s?parseFloat(s[1]):t}var Z=(e=>(e.Renderer="renderer",e.Application="application",e.RendererSystem="renderer-webgl-system",e.RendererPlugin="renderer-webgl-plugin",e.CanvasRendererSystem="renderer-canvas-system",e.CanvasRendererPlugin="renderer-canvas-plugin",e.Asset="asset",e.LoadParser="load-parser",e.ResolveParser="resolve-parser",e.CacheParser="cache-parser",e.DetectionParser="detection-parser",e))(Z||{});const Dl=e=>{if(typeof e=="function"||typeof e=="object"&&e.extension){if(!e.extension)throw new Error("Extension class must have an extension object");e={...typeof e.extension!="object"?{type:e.extension}:e.extension,ref:e}}if(typeof e=="object")e={...e};else throw new Error("Invalid extension type");return typeof e.type=="string"&&(e.type=[e.type]),e},Gu=(e,t)=>Dl(e).priority??t,nt={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...e){return e.map(Dl).forEach(t=>{t.type.forEach(s=>{var r,i;return(i=(r=this._removeHandlers)[s])==null?void 0:i.call(r,t)})}),this},add(...e){return e.map(Dl).forEach(t=>{t.type.forEach(s=>{const r=this._addHandlers,i=this._queue;r[s]?r[s](t):(i[s]=i[s]||[],i[s].push(t))})}),this},handle(e,t,s){const r=this._addHandlers,i=this._removeHandlers;if(r[e]||i[e])throw new Error(`Extension type ${e} already has a handler`);r[e]=t,i[e]=s;const n=this._queue;return n[e]&&(n[e].forEach(o=>t(o)),delete n[e]),this},handleByMap(e,t){return this.handle(e,s=>{t[s.name]=s.ref},s=>{delete t[s.name]})},handleByList(e,t,s=-1){return this.handle(e,r=>{t.includes(r.ref)||(t.push(r.ref),t.sort((i,n)=>Gu(n,s)-Gu(i,s)))},r=>{const i=t.indexOf(r.ref);i!==-1&&t.splice(i,1)})}};class Fl{constructor(t){typeof t=="number"?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get uint16View(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}view(t){return this[`${t}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${t} isn't a valid view type`)}}}const W0=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function X0(e){let t="";for(let s=0;s<e;++s)s>0&&(t+=`
else `),s<e-1&&(t+=`if(test == ${s}.0){}`);return t}function z0(e,t){if(e===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const s=t.createShader(t.FRAGMENT_SHADER);for(;;){const r=W0.replace(/%forloop%/gi,X0(e));if(t.shaderSource(s,r),t.compileShader(s),!t.getShaderParameter(s,t.COMPILE_STATUS))e=e/2|0;else break}return e}const Pa=0,Ma=1,Oa=2,Ba=3,Da=4,Fa=5;class Ss{constructor(){this.data=0,this.blendMode=ut.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<Pa)}set blend(t){!!(this.data&1<<Pa)!==t&&(this.data^=1<<Pa)}get offsets(){return!!(this.data&1<<Ma)}set offsets(t){!!(this.data&1<<Ma)!==t&&(this.data^=1<<Ma)}get culling(){return!!(this.data&1<<Oa)}set culling(t){!!(this.data&1<<Oa)!==t&&(this.data^=1<<Oa)}get depthTest(){return!!(this.data&1<<Ba)}set depthTest(t){!!(this.data&1<<Ba)!==t&&(this.data^=1<<Ba)}get depthMask(){return!!(this.data&1<<Fa)}set depthMask(t){!!(this.data&1<<Fa)!==t&&(this.data^=1<<Fa)}get clockwiseFrontFace(){return!!(this.data&1<<Da)}set clockwiseFrontFace(t){!!(this.data&1<<Da)!==t&&(this.data^=1<<Da)}get blendMode(){return this._blendMode}set blendMode(t){this.blend=t!==ut.NONE,this._blendMode=t}get polygonOffset(){return this._polygonOffset}set polygonOffset(t){this.offsets=!!t,this._polygonOffset=t}toString(){return`[@pixi/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`}static for2d(){const t=new Ss;return t.depthTest=!1,t.blend=!0,t}}const Ll=[];function cp(e,t){if(!e)return null;let s="";if(typeof e=="string"){const r=/\.(\w{3,4})(?:$|\?|#)/i.exec(e);r&&(s=r[1].toLowerCase())}for(let r=Ll.length-1;r>=0;--r){const i=Ll[r];if(i.test&&i.test(e,s))return new i(e,t)}throw new Error("Unrecognized source type to auto-detect Resource")}class Xe{constructor(t){this.items=[],this._name=t,this._aliasCount=0}emit(t,s,r,i,n,o,a,l){if(arguments.length>8)throw new Error("max arguments reached");const{name:h,items:c}=this;this._aliasCount++;for(let u=0,f=c.length;u<f;u++)c[u][h](t,s,r,i,n,o,a,l);return c===this.items&&this._aliasCount--,this}ensureNonAliasedItems(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))}add(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this}remove(t){const s=this.items.indexOf(t);return s!==-1&&(this.ensureNonAliasedItems(),this.items.splice(s,1)),this}contains(t){return this.items.includes(t)}removeAll(){return this.ensureNonAliasedItems(),this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return this.items.length===0}get name(){return this._name}}Object.defineProperties(Xe.prototype,{dispatch:{value:Xe.prototype.emit},run:{value:Xe.prototype.emit}});class ji{constructor(t=0,s=0){this._width=t,this._height=s,this.destroyed=!1,this.internal=!1,this.onResize=new Xe("setRealSize"),this.onUpdate=new Xe("update"),this.onError=new Xe("onError")}bind(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),(this._width||this._height)&&this.onResize.emit(this._width,this._height)}unbind(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)}resize(t,s){(t!==this._width||s!==this._height)&&(this._width=t,this._height=s,this.onResize.emit(t,s))}get valid(){return!!this._width&&!!this._height}update(){this.destroyed||this.onUpdate.emit()}load(){return Promise.resolve(this)}get width(){return this._width}get height(){return this._height}style(t,s,r){return!1}dispose(){}destroy(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)}static test(t,s){return!1}}class tn extends ji{constructor(t,s){const{width:r,height:i}=s||{};if(!r||!i)throw new Error("BufferResource width or height invalid");super(r,i),this.data=t}upload(t,s,r){const i=t.gl;i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,s.alphaMode===Ve.UNPACK);const n=s.realWidth,o=s.realHeight;return r.width===n&&r.height===o?i.texSubImage2D(s.target,0,0,0,n,o,s.format,r.type,this.data):(r.width=n,r.height=o,i.texImage2D(s.target,0,r.internalFormat,n,o,0,s.format,r.type,this.data)),!0}dispose(){this.data=null}static test(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array}}const V0={scaleMode:ys.NEAREST,format:z.RGBA,alphaMode:Ve.NPM},Cr=class extends Ji{constructor(e=null,t=null){super(),t=Object.assign({},Cr.defaultOptions,t);const{alphaMode:s,mipmap:r,anisotropicLevel:i,scaleMode:n,width:o,height:a,wrapMode:l,format:h,type:c,target:u,resolution:f,resourceOptions:p}=t;e&&!(e instanceof ji)&&(e=cp(e,p),e.internal=!0),this.resolution=f||q.RESOLUTION,this.width=Math.round((o||0)*this.resolution)/this.resolution,this.height=Math.round((a||0)*this.resolution)/this.resolution,this._mipmap=r,this.anisotropicLevel=i,this._wrapMode=l,this._scaleMode=n,this.format=h,this.type=c,this.target=u,this.alphaMode=s,this.uid=dr(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=o>0&&a>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.parentTextureArray=null,this.setResource(e)}get realWidth(){return Math.round(this.width*this.resolution)}get realHeight(){return Math.round(this.height*this.resolution)}get mipmap(){return this._mipmap}set mipmap(e){this._mipmap!==e&&(this._mipmap=e,this.dirtyStyleId++)}get scaleMode(){return this._scaleMode}set scaleMode(e){this._scaleMode!==e&&(this._scaleMode=e,this.dirtyStyleId++)}get wrapMode(){return this._wrapMode}set wrapMode(e){this._wrapMode!==e&&(this._wrapMode=e,this.dirtyStyleId++)}setStyle(e,t){let s;return e!==void 0&&e!==this.scaleMode&&(this.scaleMode=e,s=!0),t!==void 0&&t!==this.mipmap&&(this.mipmap=t,s=!0),s&&this.dirtyStyleId++,this}setSize(e,t,s){return s=s||this.resolution,this.setRealSize(e*s,t*s,s)}setRealSize(e,t,s){return this.resolution=s||this.resolution,this.width=Math.round(e)/this.resolution,this.height=Math.round(t)/this.resolution,this._refreshPOT(),this.update(),this}_refreshPOT(){this.isPowerOfTwo=Fu(this.realWidth)&&Fu(this.realHeight)}setResolution(e){const t=this.resolution;return t===e?this:(this.resolution=e,this.valid&&(this.width=Math.round(this.width*t)/e,this.height=Math.round(this.height*t)/e,this.emit("update",this)),this._refreshPOT(),this)}setResource(e){if(this.resource===e)return this;if(this.resource)throw new Error("Resource can be set only once");return e.bind(this),this.resource=e,this}update(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))}onError(e){this.emit("error",this,e)}destroy(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete Cs[this.cacheId],delete Ze[this.cacheId],this.cacheId=null),this.dispose(),Cr.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0}dispose(){this.emit("dispose",this)}castToBaseTexture(){return this}static from(e,t,s=q.STRICT_TEXTURE_CACHE){const r=typeof e=="string";let i=null;if(r)i=e;else{if(!e._pixiId){const o=(t==null?void 0:t.pixiIdPrefix)||"pixiid";e._pixiId=`${o}_${dr()}`}i=e._pixiId}let n=Cs[i];if(r&&s&&!n)throw new Error(`The cacheId "${i}" does not exist in BaseTextureCache.`);return n||(n=new Cr(e,t),n.cacheId=i,Cr.addToCache(n,i)),n}static fromBuffer(e,t,s,r){e=e||new Float32Array(t*s*4);const i=new tn(e,{width:t,height:s}),n=e instanceof Float32Array?lt.FLOAT:lt.UNSIGNED_BYTE;return new Cr(i,Object.assign({},V0,{type:n},r))}static addToCache(e,t){t&&(e.textureCacheIds.includes(t)||e.textureCacheIds.push(t),Cs[t]&&Cs[t]!==e&&console.warn(`BaseTexture added to the cache with an id [${t}] that already had an entry`),Cs[t]=e)}static removeFromCache(e){if(typeof e=="string"){const t=Cs[e];if(t){const s=t.textureCacheIds.indexOf(e);return s>-1&&t.textureCacheIds.splice(s,1),delete Cs[e],t}}else if(e!=null&&e.textureCacheIds){for(let t=0;t<e.textureCacheIds.length;++t)delete Cs[e.textureCacheIds[t]];return e.textureCacheIds.length=0,e}return null}};let mt=Cr;mt.defaultOptions={mipmap:as.POW2,anisotropicLevel:0,scaleMode:ys.LINEAR,wrapMode:ks.CLAMP,alphaMode:Ve.UNPACK,target:Gr.TEXTURE_2D,format:z.RGBA,type:lt.UNSIGNED_BYTE};mt._globalBatch=0;class Nl{constructor(){this.texArray=null,this.blend=0,this.type=rs.TRIANGLES,this.start=0,this.size=0,this.data=null}}let j0=0,Zt=class up{constructor(t,s=!0,r=!1){this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=r,this.static=s,this.id=j0++,this.disposeRunner=new Xe("disposeBuffer")}update(t){t instanceof Array&&(t=new Float32Array(t)),this.data=t||this.data,this._updateID++}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.data=null}set index(t){this.type=t?is.ELEMENT_ARRAY_BUFFER:is.ARRAY_BUFFER}get index(){return this.type===is.ELEMENT_ARRAY_BUFFER}static from(t){return t instanceof Array&&(t=new Float32Array(t)),new up(t)}};class po{constructor(t,s=0,r=!1,i=lt.FLOAT,n,o,a,l=1){this.buffer=t,this.size=s,this.normalized=r,this.type=i,this.stride=n,this.start=o,this.instance=a,this.divisor=l}destroy(){this.buffer=null}static from(t,s,r,i,n){return new po(t,s,r,i,n)}}const Y0={Float32Array,Uint32Array,Int32Array,Uint8Array};function K0(e,t){let s=0,r=0;const i={};for(let l=0;l<e.length;l++)r+=t[l],s+=e[l].length;const n=new ArrayBuffer(s*4);let o=null,a=0;for(let l=0;l<e.length;l++){const h=t[l],c=e[l],u=lp(c);i[u]||(i[u]=new Y0[u](n)),o=i[u];for(let f=0;f<c.length;f++){const p=(f/h|0)*r+a,d=f%h;o[p+d]=c[f]}a+=h}return new Float32Array(n)}const Hu={5126:4,5123:2,5121:1};let q0=0;const Z0={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array};class $s{constructor(t=[],s={}){this.buffers=t,this.indexBuffer=null,this.attributes=s,this.glVertexArrayObjects={},this.id=q0++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new Xe("disposeGeometry"),this.refCount=0}addAttribute(t,s,r=0,i=!1,n,o,a,l=!1){if(!s)throw new Error("You must pass a buffer when creating an attribute");s instanceof Zt||(s instanceof Array&&(s=new Float32Array(s)),s=new Zt(s));const h=t.split("|");if(h.length>1){for(let u=0;u<h.length;u++)this.addAttribute(h[u],s,r,i,n);return this}let c=this.buffers.indexOf(s);return c===-1&&(this.buffers.push(s),c=this.buffers.length-1),this.attributes[t]=new po(c,r,i,n,o,a,l),this.instanced=this.instanced||l,this}getAttribute(t){return this.attributes[t]}getBuffer(t){return this.buffers[this.getAttribute(t).buffer]}addIndex(t){return t instanceof Zt||(t instanceof Array&&(t=new Uint16Array(t)),t=new Zt(t)),t.type=is.ELEMENT_ARRAY_BUFFER,this.indexBuffer=t,this.buffers.includes(t)||this.buffers.push(t),this}getIndex(){return this.indexBuffer}interleave(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;const t=[],s=[],r=new Zt;let i;for(i in this.attributes){const n=this.attributes[i],o=this.buffers[n.buffer];t.push(o.data),s.push(n.size*Hu[n.type]/4),n.buffer=0}for(r.data=K0(t,s),i=0;i<this.buffers.length;i++)this.buffers[i]!==this.indexBuffer&&this.buffers[i].destroy();return this.buffers=[r],this.indexBuffer&&this.buffers.push(this.indexBuffer),this}getSize(){for(const t in this.attributes){const s=this.attributes[t];return this.buffers[s.buffer].data.length/(s.stride/4||s.size)}return 0}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null}clone(){const t=new $s;for(let s=0;s<this.buffers.length;s++)t.buffers[s]=new Zt(this.buffers[s].data.slice(0));for(const s in this.attributes){const r=this.attributes[s];t.attributes[s]=new po(r.buffer,r.size,r.normalized,r.type,r.stride,r.start,r.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(this.indexBuffer)],t.indexBuffer.type=is.ELEMENT_ARRAY_BUFFER),t}static merge(t){const s=new $s,r=[],i=[],n=[];let o;for(let a=0;a<t.length;a++){o=t[a];for(let l=0;l<o.buffers.length;l++)i[l]=i[l]||0,i[l]+=o.buffers[l].data.length,n[l]=0}for(let a=0;a<o.buffers.length;a++)r[a]=new Z0[lp(o.buffers[a].data)](i[a]),s.buffers[a]=new Zt(r[a]);for(let a=0;a<t.length;a++){o=t[a];for(let l=0;l<o.buffers.length;l++)r[l].set(o.buffers[l].data,n[l]),n[l]+=o.buffers[l].data.length}if(s.attributes=o.attributes,o.indexBuffer){s.indexBuffer=s.buffers[o.buffers.indexOf(o.indexBuffer)],s.indexBuffer.type=is.ELEMENT_ARRAY_BUFFER;let a=0,l=0,h=0,c=0;for(let u=0;u<o.buffers.length;u++)if(o.buffers[u]!==o.indexBuffer){c=u;break}for(const u in o.attributes){const f=o.attributes[u];(f.buffer|0)===c&&(l+=f.size*Hu[f.type]/4)}for(let u=0;u<t.length;u++){const f=t[u].indexBuffer.data;for(let p=0;p<f.length;p++)s.indexBuffer.data[p+h]+=a;a+=t[u].buffers[c].data.length/l,h+=f.length}}return s}}class fp extends $s{constructor(t=!1){super(),this._buffer=new Zt(null,t,!1),this._indexBuffer=new Zt(null,t,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,lt.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,lt.FLOAT).addAttribute("aColor",this._buffer,4,!0,lt.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,lt.FLOAT).addIndex(this._indexBuffer)}}const mo=Math.PI*2,J0=180/Math.PI,Q0=Math.PI/180;var oe=(e=>(e[e.POLY=0]="POLY",e[e.RECT=1]="RECT",e[e.CIRC=2]="CIRC",e[e.ELIP=3]="ELIP",e[e.RREC=4]="RREC",e))(oe||{});class It{constructor(t=0,s=0){this.x=0,this.y=0,this.x=t,this.y=s}clone(){return new It(this.x,this.y)}copyFrom(t){return this.set(t.x,t.y),this}copyTo(t){return t.set(this.x,this.y),t}equals(t){return t.x===this.x&&t.y===this.y}set(t=0,s=t){return this.x=t,this.y=s,this}toString(){return`[@pixi/math:Point x=${this.x} y=${this.y}]`}}const bn=[new It,new It,new It,new It];class yt{constructor(t=0,s=0,r=0,i=0){this.x=Number(t),this.y=Number(s),this.width=Number(r),this.height=Number(i),this.type=oe.RECT}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new yt(0,0,0,0)}clone(){return new yt(this.x,this.y,this.width,this.height)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t}contains(t,s){return this.width<=0||this.height<=0?!1:t>=this.x&&t<this.x+this.width&&s>=this.y&&s<this.y+this.height}intersects(t,s){if(!s){const b=this.x<t.x?t.x:this.x;if((this.right>t.right?t.right:this.right)<=b)return!1;const F=this.y<t.y?t.y:this.y;return(this.bottom>t.bottom?t.bottom:this.bottom)>F}const r=this.left,i=this.right,n=this.top,o=this.bottom;if(i<=r||o<=n)return!1;const a=bn[0].set(t.left,t.top),l=bn[1].set(t.left,t.bottom),h=bn[2].set(t.right,t.top),c=bn[3].set(t.right,t.bottom);if(h.x<=a.x||l.y<=a.y)return!1;const u=Math.sign(s.a*s.d-s.b*s.c);if(u===0||(s.apply(a,a),s.apply(l,l),s.apply(h,h),s.apply(c,c),Math.max(a.x,l.x,h.x,c.x)<=r||Math.min(a.x,l.x,h.x,c.x)>=i||Math.max(a.y,l.y,h.y,c.y)<=n||Math.min(a.y,l.y,h.y,c.y)>=o))return!1;const f=u*(l.y-a.y),p=u*(a.x-l.x),d=f*r+p*n,m=f*i+p*n,g=f*r+p*o,y=f*i+p*o;if(Math.max(d,m,g,y)<=f*a.x+p*a.y||Math.min(d,m,g,y)>=f*c.x+p*c.y)return!1;const E=u*(a.y-h.y),_=u*(h.x-a.x),v=E*r+_*n,S=E*i+_*n,A=E*r+_*o,w=E*i+_*o;return!(Math.max(v,S,A,w)<=E*a.x+_*a.y||Math.min(v,S,A,w)>=E*c.x+_*c.y)}pad(t=0,s=t){return this.x-=t,this.y-=s,this.width+=t*2,this.height+=s*2,this}fit(t){const s=Math.max(this.x,t.x),r=Math.min(this.x+this.width,t.x+t.width),i=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height);return this.x=s,this.width=Math.max(r-s,0),this.y=i,this.height=Math.max(n-i,0),this}ceil(t=1,s=.001){const r=Math.ceil((this.x+this.width-s)*t)/t,i=Math.ceil((this.y+this.height-s)*t)/t;return this.x=Math.floor((this.x+s)*t)/t,this.y=Math.floor((this.y+s)*t)/t,this.width=r-this.x,this.height=i-this.y,this}enlarge(t){const s=Math.min(this.x,t.x),r=Math.max(this.x+this.width,t.x+t.width),i=Math.min(this.y,t.y),n=Math.max(this.y+this.height,t.y+t.height);return this.x=s,this.width=r-s,this.y=i,this.height=n-i,this}toString(){return`[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}class Xh{constructor(t=0,s=0,r=0){this.x=t,this.y=s,this.radius=r,this.type=oe.CIRC}clone(){return new Xh(this.x,this.y,this.radius)}contains(t,s){if(this.radius<=0)return!1;const r=this.radius*this.radius;let i=this.x-t,n=this.y-s;return i*=i,n*=n,i+n<=r}getBounds(){return new yt(this.x-this.radius,this.y-this.radius,this.radius*2,this.radius*2)}toString(){return`[@pixi/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}}class zh{constructor(t=0,s=0,r=0,i=0){this.x=t,this.y=s,this.width=r,this.height=i,this.type=oe.ELIP}clone(){return new zh(this.x,this.y,this.width,this.height)}contains(t,s){if(this.width<=0||this.height<=0)return!1;let r=(t-this.x)/this.width,i=(s-this.y)/this.height;return r*=r,i*=i,r+i<=1}getBounds(){return new yt(this.x-this.width,this.y-this.height,this.width,this.height)}toString(){return`[@pixi/math:Ellipse x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}class zr{constructor(...t){let s=Array.isArray(t[0])?t[0]:t;if(typeof s[0]!="number"){const r=[];for(let i=0,n=s.length;i<n;i++)r.push(s[i].x,s[i].y);s=r}this.points=s,this.type=oe.POLY,this.closeStroke=!0}clone(){const t=this.points.slice(),s=new zr(t);return s.closeStroke=this.closeStroke,s}contains(t,s){let r=!1;const i=this.points.length/2;for(let n=0,o=i-1;n<i;o=n++){const a=this.points[n*2],l=this.points[n*2+1],h=this.points[o*2],c=this.points[o*2+1];l>s!=c>s&&t<(h-a)*((s-l)/(c-l))+a&&(r=!r)}return r}toString(){return`[@pixi/math:PolygoncloseStroke=${this.closeStroke}points=${this.points.reduce((t,s)=>`${t}, ${s}`,"")}]`}}class Vh{constructor(t=0,s=0,r=0,i=0,n=20){this.x=t,this.y=s,this.width=r,this.height=i,this.radius=n,this.type=oe.RREC}clone(){return new Vh(this.x,this.y,this.width,this.height,this.radius)}contains(t,s){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&s>=this.y&&s<=this.y+this.height){const r=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(s>=this.y+r&&s<=this.y+this.height-r||t>=this.x+r&&t<=this.x+this.width-r)return!0;let i=t-(this.x+r),n=s-(this.y+r);const o=r*r;if(i*i+n*n<=o||(i=t-(this.x+this.width-r),i*i+n*n<=o)||(n=s-(this.y+this.height-r),i*i+n*n<=o)||(i=t-(this.x+r),i*i+n*n<=o))return!0}return!1}toString(){return`[@pixi/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}}class kt{constructor(t=1,s=0,r=0,i=1,n=0,o=0){this.array=null,this.a=t,this.b=s,this.c=r,this.d=i,this.tx=n,this.ty=o}fromArray(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]}set(t,s,r,i,n,o){return this.a=t,this.b=s,this.c=r,this.d=i,this.tx=n,this.ty=o,this}toArray(t,s){this.array||(this.array=new Float32Array(9));const r=s||this.array;return t?(r[0]=this.a,r[1]=this.b,r[2]=0,r[3]=this.c,r[4]=this.d,r[5]=0,r[6]=this.tx,r[7]=this.ty,r[8]=1):(r[0]=this.a,r[1]=this.c,r[2]=this.tx,r[3]=this.b,r[4]=this.d,r[5]=this.ty,r[6]=0,r[7]=0,r[8]=1),r}apply(t,s){s=s||new It;const r=t.x,i=t.y;return s.x=this.a*r+this.c*i+this.tx,s.y=this.b*r+this.d*i+this.ty,s}applyInverse(t,s){s=s||new It;const r=1/(this.a*this.d+this.c*-this.b),i=t.x,n=t.y;return s.x=this.d*r*i+-this.c*r*n+(this.ty*this.c-this.tx*this.d)*r,s.y=this.a*r*n+-this.b*r*i+(-this.ty*this.a+this.tx*this.b)*r,s}translate(t,s){return this.tx+=t,this.ty+=s,this}scale(t,s){return this.a*=t,this.d*=s,this.c*=t,this.b*=s,this.tx*=t,this.ty*=s,this}rotate(t){const s=Math.cos(t),r=Math.sin(t),i=this.a,n=this.c,o=this.tx;return this.a=i*s-this.b*r,this.b=i*r+this.b*s,this.c=n*s-this.d*r,this.d=n*r+this.d*s,this.tx=o*s-this.ty*r,this.ty=o*r+this.ty*s,this}append(t){const s=this.a,r=this.b,i=this.c,n=this.d;return this.a=t.a*s+t.b*i,this.b=t.a*r+t.b*n,this.c=t.c*s+t.d*i,this.d=t.c*r+t.d*n,this.tx=t.tx*s+t.ty*i+this.tx,this.ty=t.tx*r+t.ty*n+this.ty,this}setTransform(t,s,r,i,n,o,a,l,h){return this.a=Math.cos(a+h)*n,this.b=Math.sin(a+h)*n,this.c=-Math.sin(a-l)*o,this.d=Math.cos(a-l)*o,this.tx=t-(r*this.a+i*this.c),this.ty=s-(r*this.b+i*this.d),this}prepend(t){const s=this.tx;if(t.a!==1||t.b!==0||t.c!==0||t.d!==1){const r=this.a,i=this.c;this.a=r*t.a+this.b*t.c,this.b=r*t.b+this.b*t.d,this.c=i*t.a+this.d*t.c,this.d=i*t.b+this.d*t.d}return this.tx=s*t.a+this.ty*t.c+t.tx,this.ty=s*t.b+this.ty*t.d+t.ty,this}decompose(t){const s=this.a,r=this.b,i=this.c,n=this.d,o=t.pivot,a=-Math.atan2(-i,n),l=Math.atan2(r,s),h=Math.abs(a+l);return h<1e-5||Math.abs(mo-h)<1e-5?(t.rotation=l,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=a,t.skew.y=l),t.scale.x=Math.sqrt(s*s+r*r),t.scale.y=Math.sqrt(i*i+n*n),t.position.x=this.tx+(o.x*s+o.y*i),t.position.y=this.ty+(o.x*r+o.y*n),t}invert(){const t=this.a,s=this.b,r=this.c,i=this.d,n=this.tx,o=t*i-s*r;return this.a=i/o,this.b=-s/o,this.c=-r/o,this.d=t/o,this.tx=(r*this.ty-i*n)/o,this.ty=-(t*this.ty-s*n)/o,this}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const t=new kt;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyTo(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyFrom(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this}toString(){return`[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return new kt}static get TEMP_MATRIX(){return new kt}}const qs=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],Zs=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],Js=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],Qs=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Ul=[],dp=[],wn=Math.sign;function tE(){for(let e=0;e<16;e++){const t=[];Ul.push(t);for(let s=0;s<16;s++){const r=wn(qs[e]*qs[s]+Js[e]*Zs[s]),i=wn(Zs[e]*qs[s]+Qs[e]*Zs[s]),n=wn(qs[e]*Js[s]+Js[e]*Qs[s]),o=wn(Zs[e]*Js[s]+Qs[e]*Qs[s]);for(let a=0;a<16;a++)if(qs[a]===r&&Zs[a]===i&&Js[a]===n&&Qs[a]===o){t.push(a);break}}}for(let e=0;e<16;e++){const t=new kt;t.set(qs[e],Zs[e],Js[e],Qs[e],0,0),dp.push(t)}}tE();const Ht={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:e=>qs[e],uY:e=>Zs[e],vX:e=>Js[e],vY:e=>Qs[e],inv:e=>e&8?e&15:-e&7,add:(e,t)=>Ul[e][t],sub:(e,t)=>Ul[e][Ht.inv(t)],rotate180:e=>e^4,isVertical:e=>(e&3)===2,byDirection:(e,t)=>Math.abs(e)*2<=Math.abs(t)?t>=0?Ht.S:Ht.N:Math.abs(t)*2<=Math.abs(e)?e>0?Ht.E:Ht.W:t>0?e>0?Ht.SE:Ht.SW:e>0?Ht.NE:Ht.NW,matrixAppendRotationInv:(e,t,s=0,r=0)=>{const i=dp[Ht.inv(t)];i.tx=s,i.ty=r,e.append(i)}};class Fs{constructor(t,s,r=0,i=0){this._x=r,this._y=i,this.cb=t,this.scope=s}clone(t=this.cb,s=this.scope){return new Fs(t,s,this._x,this._y)}set(t=0,s=t){return(this._x!==t||this._y!==s)&&(this._x=t,this._y=s,this.cb.call(this.scope)),this}copyFrom(t){return(this._x!==t.x||this._y!==t.y)&&(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this}copyTo(t){return t.set(this._x,this._y),t}equals(t){return t.x===this._x&&t.y===this._y}toString(){return`[@pixi/math:ObservablePoint x=0 y=0 scope=${this.scope}]`}get x(){return this._x}set x(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))}get y(){return this._y}set y(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))}}const pp=class{constructor(){this.worldTransform=new kt,this.localTransform=new kt,this.position=new Fs(this.onChange,this,0,0),this.scale=new Fs(this.onChange,this,1,1),this.pivot=new Fs(this.onChange,this,0,0),this.skew=new Fs(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}onChange(){this._localID++}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++}toString(){return`[@pixi/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`}updateLocalTransform(){const e=this.localTransform;this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1)}updateTransform(e){const t=this.localTransform;if(this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==e._worldID){const s=e.worldTransform,r=this.worldTransform;r.a=t.a*s.a+t.b*s.c,r.b=t.a*s.b+t.b*s.d,r.c=t.c*s.a+t.d*s.c,r.d=t.c*s.b+t.d*s.d,r.tx=t.tx*s.a+t.ty*s.c+s.tx,r.ty=t.tx*s.b+t.ty*s.d+s.ty,this._parentID=e._worldID,this._worldID++}}setFromMatrix(e){e.decompose(this),this._localID++}get rotation(){return this._rotation}set rotation(e){this._rotation!==e&&(this._rotation=e,this.updateSkew())}};let jh=pp;jh.IDENTITY=new pp;var eE=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`,sE=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`;function $u(e,t,s){const r=e.createShader(t);return e.shaderSource(r,s),e.compileShader(r),r}function La(e){const t=new Array(e);for(let s=0;s<t.length;s++)t[s]=!1;return t}function mp(e,t){switch(e){case"float":return 0;case"vec2":return new Float32Array(2*t);case"vec3":return new Float32Array(3*t);case"vec4":return new Float32Array(4*t);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*t);case"ivec3":return new Int32Array(3*t);case"ivec4":return new Int32Array(4*t);case"uvec2":return new Uint32Array(2*t);case"uvec3":return new Uint32Array(3*t);case"uvec4":return new Uint32Array(4*t);case"bool":return!1;case"bvec2":return La(2*t);case"bvec3":return La(3*t);case"bvec4":return La(4*t);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const Vr=[{test:e=>e.type==="float"&&e.size===1&&!e.isArray,code:e=>`
            if(uv["${e}"] !== ud["${e}"].value)
            {
                ud["${e}"].value = uv["${e}"]
                gl.uniform1f(ud["${e}"].location, uv["${e}"])
            }
            `},{test:(e,t)=>(e.type==="sampler2D"||e.type==="samplerCube"||e.type==="sampler2DArray")&&e.size===1&&!e.isArray&&(t==null||t.castToBaseTexture!==void 0),code:e=>`t = syncData.textureCount++;

            renderer.texture.bind(uv["${e}"], t);

            if(ud["${e}"].value !== t)
            {
                ud["${e}"].value = t;
                gl.uniform1i(ud["${e}"].location, t);
; // eslint-disable-line max-len
            }`},{test:(e,t)=>e.type==="mat3"&&e.size===1&&!e.isArray&&t.a!==void 0,code:e=>`
            gl.uniformMatrix3fv(ud["${e}"].location, false, uv["${e}"].toArray(true));
            `,codeUbo:e=>`
                var ${e}_matrix = uv.${e}.toArray(true);

                data[offset] = ${e}_matrix[0];
                data[offset+1] = ${e}_matrix[1];
                data[offset+2] = ${e}_matrix[2];
        
                data[offset + 4] = ${e}_matrix[3];
                data[offset + 5] = ${e}_matrix[4];
                data[offset + 6] = ${e}_matrix[5];
        
                data[offset + 8] = ${e}_matrix[6];
                data[offset + 9] = ${e}_matrix[7];
                data[offset + 10] = ${e}_matrix[8];
            `},{test:(e,t)=>e.type==="vec2"&&e.size===1&&!e.isArray&&t.x!==void 0,code:e=>`
                cv = ud["${e}"].value;
                v = uv["${e}"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["${e}"].location, v.x, v.y);
                }`,codeUbo:e=>`
                v = uv.${e};

                data[offset] = v.x;
                data[offset+1] = v.y;
            `},{test:e=>e.type==="vec2"&&e.size===1&&!e.isArray,code:e=>`
                cv = ud["${e}"].value;
                v = uv["${e}"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["${e}"].location, v[0], v[1]);
                }
            `},{test:(e,t)=>e.type==="vec4"&&e.size===1&&!e.isArray&&t.width!==void 0,code:e=>`
                cv = ud["${e}"].value;
                v = uv["${e}"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["${e}"].location, v.x, v.y, v.width, v.height)
                }`,codeUbo:e=>`
                    v = uv.${e};

                    data[offset] = v.x;
                    data[offset+1] = v.y;
                    data[offset+2] = v.width;
                    data[offset+3] = v.height;
                `},{test:(e,t)=>e.type==="vec4"&&e.size===1&&!e.isArray&&t.red!==void 0,code:e=>`
                cv = ud["${e}"].value;
                v = uv["${e}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.alpha)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
                    cv[3] = v.alpha;
                    gl.uniform4f(ud["${e}"].location, v.red, v.green, v.blue, v.alpha)
                }`,codeUbo:e=>`
                    v = uv.${e};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                    data[offset+3] = v.alpha;
                `},{test:(e,t)=>e.type==="vec3"&&e.size===1&&!e.isArray&&t.red!==void 0,code:e=>`
                cv = ud["${e}"].value;
                v = uv["${e}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.a)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
    
                    gl.uniform3f(ud["${e}"].location, v.red, v.green, v.blue)
                }`,codeUbo:e=>`
                    v = uv.${e};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                `},{test:e=>e.type==="vec4"&&e.size===1&&!e.isArray,code:e=>`
                cv = ud["${e}"].value;
                v = uv["${e}"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["${e}"].location, v[0], v[1], v[2], v[3])
                }`}],rE={float:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1f(location, v);
    }`,vec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4f(location, v[0], v[1], v[2], v[3]);
    }`,int:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,ivec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,ivec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,ivec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,uint:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1ui(location, v);
    }`,uvec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2ui(location, v[0], v[1]);
    }`,uvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3ui(location, v[0], v[1], v[2]);
    }`,uvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
    }`,bool:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1i(location, v);
    }`,bvec2:`
    if (cv[0] != v[0] || cv[1] != v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,bvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,bvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,samplerCube:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,sampler2DArray:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`},iE={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function nE(e,t){var r;const s=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
    `];for(const i in e.uniforms){const n=t[i];if(!n){(r=e.uniforms[i])!=null&&r.group&&(e.uniforms[i].ubo?s.push(`
                        renderer.shader.syncUniformBufferGroup(uv.${i}, '${i}');
                    `):s.push(`
                        renderer.shader.syncUniformGroup(uv.${i}, syncData);
                    `));continue}const o=e.uniforms[i];let a=!1;for(let l=0;l<Vr.length;l++)if(Vr[l].test(n,o)){s.push(Vr[l].code(i,o)),a=!0;break}if(!a){const h=(n.size===1&&!n.isArray?rE:iE)[n.type].replace("location",`ud["${i}"].location`);s.push(`
            cu = ud["${i}"];
            cv = cu.value;
            v = uv["${i}"];
            ${h};`)}}return new Function("ud","uv","renderer","syncData",s.join(`
`))}const gp={};let Tr=gp;function oE(){if(Tr===gp||Tr!=null&&Tr.isContextLost()){const e=q.ADAPTER.createCanvas();let t;q.PREFER_ENV>=gr.WEBGL2&&(t=e.getContext("webgl2",{})),t||(t=e.getContext("webgl",{})||e.getContext("experimental-webgl",{}),t?t.getExtension("WEBGL_draw_buffers"):t=null),Tr=t}return Tr}let Tn;function aE(){if(!Tn){Tn=Ae.MEDIUM;const e=oE();e&&e.getShaderPrecisionFormat&&(Tn=e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision?Ae.HIGH:Ae.MEDIUM)}return Tn}function Wu(e,t){const s=e.getShaderSource(t).split(`
`).map((h,c)=>`${c}: ${h}`),r=e.getShaderInfoLog(t),i=r.split(`
`),n={},o=i.map(h=>parseFloat(h.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))).filter(h=>h&&!n[h]?(n[h]=!0,!0):!1),a=[""];o.forEach(h=>{s[h-1]=`%c${s[h-1]}%c`,a.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});const l=s.join(`
`);a[0]=l,console.error(r),console.groupCollapsed("click to view full shader code"),console.warn(...a),console.groupEnd()}function lE(e,t,s,r){e.getProgramParameter(t,e.LINK_STATUS)||(e.getShaderParameter(s,e.COMPILE_STATUS)||Wu(e,s),e.getShaderParameter(r,e.COMPILE_STATUS)||Wu(e,r),console.error("PixiJS Error: Could not initialize shader."),e.getProgramInfoLog(t)!==""&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",e.getProgramInfoLog(t)))}const hE={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function _p(e){return hE[e]}let Sn=null;const Xu={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function yp(e,t){if(!Sn){const s=Object.keys(Xu);Sn={};for(let r=0;r<s.length;++r){const i=s[r];Sn[e[i]]=Xu[i]}}return Sn[t]}function zu(e,t,s){if(e.substring(0,9)!=="precision"){let r=t;return t===Ae.HIGH&&s!==Ae.HIGH&&(r=Ae.MEDIUM),`precision ${r} float;
${e}`}else if(s!==Ae.HIGH&&e.substring(0,15)==="precision highp")return e.replace("precision highp","precision mediump");return e}let gi;function cE(){if(typeof gi=="boolean")return gi;try{gi=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{gi=!1}return gi}let uE=0;const An={},Rr=class{constructor(e,t,s="pixi-shader",r={}){this.extra={},this.id=uE++,this.vertexSrc=e||Rr.defaultVertexSrc,this.fragmentSrc=t||Rr.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.extra=r,this.vertexSrc.substring(0,8)!=="#version"&&(s=s.replace(/\s+/g,"-"),An[s]?(An[s]++,s+=`-${An[s]}`):An[s]=1,this.vertexSrc=`#define SHADER_NAME ${s}
${this.vertexSrc}`,this.fragmentSrc=`#define SHADER_NAME ${s}
${this.fragmentSrc}`,this.vertexSrc=zu(this.vertexSrc,Rr.defaultVertexPrecision,Ae.HIGH),this.fragmentSrc=zu(this.fragmentSrc,Rr.defaultFragmentPrecision,aE())),this.glPrograms={},this.syncUniforms=null}static get defaultVertexSrc(){return sE}static get defaultFragmentSrc(){return eE}static from(e,t,s){const r=e+t;let i=Nu[r];return i||(Nu[r]=i=new Rr(e,t,s)),i}};let ke=Rr;ke.defaultVertexPrecision=Ae.HIGH;ke.defaultFragmentPrecision=vs.apple.device?Ae.HIGH:Ae.MEDIUM;let fE=0;class ze{constructor(t,s,r){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=fE++,this.static=!!s,this.ubo=!!r,t instanceof Zt?(this.buffer=t,this.buffer.type=is.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=t,this.ubo&&(this.buffer=new Zt(new Float32Array(1)),this.buffer.type=is.UNIFORM_BUFFER,this.autoManage=!0))}update(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()}add(t,s,r){if(!this.ubo)this.uniforms[t]=new ze(s,r);else throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them")}static from(t,s,r){return new ze(t,s,r)}static uboFrom(t,s){return new ze(t,s??!0,!0)}}class ns{constructor(t,s){this.uniformBindCount=0,this.program=t,s?s instanceof ze?this.uniformGroup=s:this.uniformGroup=new ze(s):this.uniformGroup=new ze({}),this.disposeRunner=new Xe("disposeShader")}checkUniformExists(t,s){if(s.uniforms[t])return!0;for(const r in s.uniforms){const i=s.uniforms[r];if(i.group&&this.checkUniformExists(t,i))return!0}return!1}destroy(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()}get uniforms(){return this.uniformGroup.uniforms}static from(t,s,r){const i=ke.from(t,s);return new ns(i,r)}}class dE{constructor(t,s){if(this.vertexSrc=t,this.fragTemplate=s,this.programCache={},this.defaultGroupCache={},!s.includes("%count%"))throw new Error('Fragment template must contain "%count%".');if(!s.includes("%forloop%"))throw new Error('Fragment template must contain "%forloop%".')}generateShader(t){if(!this.programCache[t]){const r=new Int32Array(t);for(let n=0;n<t;n++)r[n]=n;this.defaultGroupCache[t]=ze.from({uSamplers:r},!0);let i=this.fragTemplate;i=i.replace(/%count%/gi,`${t}`),i=i.replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new ke(this.vertexSrc,i)}const s={tint:new Float32Array([1,1,1,1]),translationMatrix:new kt,default:this.defaultGroupCache[t]};return new ns(this.programCache[t],s)}generateSampleSrc(t){let s="";s+=`
`,s+=`
`;for(let r=0;r<t;r++)r>0&&(s+=`
else `),r<t-1&&(s+=`if(vTextureId < ${r}.5)`),s+=`
{`,s+=`
	color = texture2D(uSamplers[${r}], vTextureCoord);`,s+=`
}`;return s+=`
`,s+=`
`,s}}class kl{constructor(){this.elements=[],this.ids=[],this.count=0}clear(){for(let t=0;t<this.count;t++)this.elements[t]=null;this.count=0}}function pE(){return!vs.apple.device}function mE(e){let t=!0;const s=q.ADAPTER.getNavigator();if(vs.tablet||vs.phone){if(vs.apple.device){const r=s.userAgent.match(/OS (\d+)_(\d+)?/);r&&parseInt(r[1],10)<11&&(t=!1)}if(vs.android.device){const r=s.userAgent.match(/Android\s([0-9.]*)/);r&&parseInt(r[1],10)<7&&(t=!1)}}return t?e:4}class $o{constructor(t){this.renderer=t}flush(){}destroy(){this.renderer=null}start(){}stop(){this.flush()}render(t){}}var gE=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`,_E=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`;const Be=class extends $o{constructor(e){super(e),this.setShaderGenerator(),this.geometryClass=fp,this.vertexSize=6,this.state=Ss.for2d(),this.size=Be.defaultBatchSize*4,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.maxTextures=1,this.renderer.on("prerender",this.onPrerender,this),e.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}static get defaultMaxTextures(){return this._defaultMaxTextures=this._defaultMaxTextures??mE(32),this._defaultMaxTextures}static set defaultMaxTextures(e){this._defaultMaxTextures=e}static get canUploadSameBuffer(){return this._canUploadSameBuffer=this._canUploadSameBuffer??pE(),this._canUploadSameBuffer}static set canUploadSameBuffer(e){this._canUploadSameBuffer=e}get MAX_TEXTURES(){return bt("7.1.0","BatchRenderer#MAX_TEXTURES renamed to BatchRenderer#maxTextures"),this.maxTextures}static get defaultVertexSrc(){return _E}static get defaultFragmentTemplate(){return gE}setShaderGenerator({vertex:e=Be.defaultVertexSrc,fragment:t=Be.defaultFragmentTemplate}={}){this.shaderGenerator=new dE(e,t)}contextChange(){const e=this.renderer.gl;q.PREFER_ENV===gr.WEBGL_LEGACY?this.maxTextures=1:(this.maxTextures=Math.min(e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),Be.defaultMaxTextures),this.maxTextures=z0(this.maxTextures,e)),this._shader=this.shaderGenerator.generateShader(this.maxTextures);for(let t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]=new this.geometryClass;this.initFlushBuffers()}initFlushBuffers(){const{_drawCallPool:e,_textureArrayPool:t}=Be,s=this.size/4,r=Math.floor(s/this.maxTextures)+1;for(;e.length<s;)e.push(new Nl);for(;t.length<r;)t.push(new kl);for(let i=0;i<this.maxTextures;i++)this._tempBoundTextures[i]=null}onPrerender(){this._flushId=0}render(e){e._texture.valid&&(this._vertexCount+e.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=e.vertexData.length/2,this._indexCount+=e.indices.length,this._bufferedTextures[this._bufferSize]=e._texture.baseTexture,this._bufferedElements[this._bufferSize++]=e)}buildTexturesAndDrawCalls(){const{_bufferedTextures:e,maxTextures:t}=this,s=Be._textureArrayPool,r=this.renderer.batch,i=this._tempBoundTextures,n=this.renderer.textureGC.count;let o=++mt._globalBatch,a=0,l=s[0],h=0;r.copyBoundTextures(i,t);for(let c=0;c<this._bufferSize;++c){const u=e[c];e[c]=null,u._batchEnabled!==o&&(l.count>=t&&(r.boundArray(l,i,o,t),this.buildDrawCalls(l,h,c),h=c,l=s[++a],++o),u._batchEnabled=o,u.touched=n,l.elements[l.count++]=u)}l.count>0&&(r.boundArray(l,i,o,t),this.buildDrawCalls(l,h,this._bufferSize),++a,++o);for(let c=0;c<i.length;c++)i[c]=null;mt._globalBatch=o}buildDrawCalls(e,t,s){const{_bufferedElements:r,_attributeBuffer:i,_indexBuffer:n,vertexSize:o}=this,a=Be._drawCallPool;let l=this._dcIndex,h=this._aIndex,c=this._iIndex,u=a[l];u.start=this._iIndex,u.texArray=e;for(let f=t;f<s;++f){const p=r[f],d=p._texture.baseTexture,m=op[d.alphaMode?1:0][p.blendMode];r[f]=null,t<f&&u.blend!==m&&(u.size=c-u.start,t=f,u=a[++l],u.texArray=e,u.start=c),this.packInterleavedGeometry(p,i,n,h,c),h+=p.vertexData.length/2*o,c+=p.indices.length,u.blend=m}t<s&&(u.size=c-u.start,++l),this._dcIndex=l,this._aIndex=h,this._iIndex=c}bindAndClearTexArray(e){const t=this.renderer.texture;for(let s=0;s<e.count;s++)t.bind(e.elements[s],e.ids[s]),e.elements[s]=null;e.count=0}updateGeometry(){const{_packedGeometries:e,_attributeBuffer:t,_indexBuffer:s}=this;Be.canUploadSameBuffer?(e[this._flushId]._buffer.update(t.rawBinaryData),e[this._flushId]._indexBuffer.update(s),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,e[this._flushId]=new this.geometryClass),e[this._flushId]._buffer.update(t.rawBinaryData),e[this._flushId]._indexBuffer.update(s),this.renderer.geometry.bind(e[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)}drawBatches(){const e=this._dcIndex,{gl:t,state:s}=this.renderer,r=Be._drawCallPool;let i=null;for(let n=0;n<e;n++){const{texArray:o,type:a,size:l,start:h,blend:c}=r[n];i!==o&&(i=o,this.bindAndClearTexArray(o)),this.state.blendMode=c,s.set(this.state),t.drawElements(a,l,t.UNSIGNED_SHORT,h*2)}}flush(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)}start(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.maxTextures),this.renderer.shader.bind(this._shader),Be.canUploadSameBuffer&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])}stop(){this.flush()}destroy(){for(let e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]&&this._packedGeometries[e].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),super.destroy()}getAttributeBuffer(e){const t=fo(Math.ceil(e/8)),s=Lu(t),r=t*8;this._aBuffers.length<=s&&(this._iBuffers.length=s+1);let i=this._aBuffers[r];return i||(this._aBuffers[r]=i=new Fl(r*this.vertexSize*4)),i}getIndexBuffer(e){const t=fo(Math.ceil(e/12)),s=Lu(t),r=t*12;this._iBuffers.length<=s&&(this._iBuffers.length=s+1);let i=this._iBuffers[s];return i||(this._iBuffers[s]=i=new Uint16Array(r)),i}packInterleavedGeometry(e,t,s,r,i){const{uint32View:n,float32View:o}=t,a=r/this.vertexSize,l=e.uvs,h=e.indices,c=e.vertexData,u=e._texture.baseTexture._batchLocation,f=Math.min(e.worldAlpha,1),p=Ft.shared.setValue(e._tintRGB).toPremultiplied(f,e._texture.baseTexture.alphaMode>0);for(let d=0;d<c.length;d+=2)o[r++]=c[d],o[r++]=c[d+1],o[r++]=l[d],o[r++]=l[d+1],n[r++]=p,o[r++]=u;for(let d=0;d<h.length;d++)s[i++]=a+h[d]}};let we=Be;we.defaultBatchSize=4096;we.extension={name:"batch",type:Z.RendererPlugin};we._drawCallPool=[];we._textureArrayPool=[];nt.add(we);var yE=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`,vE=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const wi=class extends ns{constructor(e,t,s){const r=ke.from(e||wi.defaultVertexSrc,t||wi.defaultFragmentSrc);super(r,s),this.padding=0,this.resolution=wi.defaultResolution,this.multisample=wi.defaultMultisample,this.enabled=!0,this.autoFit=!0,this.state=new Ss}apply(e,t,s,r,i){e.applyFilter(this,t,s,r)}get blendMode(){return this.state.blendMode}set blendMode(e){this.state.blendMode=e}get resolution(){return this._resolution}set resolution(e){this._resolution=e}static get defaultVertexSrc(){return vE}static get defaultFragmentSrc(){return yE}};let le=wi;le.defaultResolution=1;le.defaultMultisample=Vt.NONE;class Wo{constructor(){this.clearBeforeRender=!0,this._backgroundColor=new Ft(0),this.alpha=1}init(t){this.clearBeforeRender=t.clearBeforeRender;const{backgroundColor:s,background:r,backgroundAlpha:i}=t,n=r??s;n!==void 0&&(this.color=n),this.alpha=i}get color(){return this._backgroundColor.value}set color(t){this._backgroundColor.setValue(t)}get alpha(){return this._backgroundColor.alpha}set alpha(t){this._backgroundColor.setAlpha(t)}get backgroundColor(){return this._backgroundColor}destroy(){}}Wo.defaultOptions={backgroundAlpha:1,backgroundColor:0,clearBeforeRender:!0};Wo.extension={type:[Z.RendererSystem,Z.CanvasRendererSystem],name:"background"};nt.add(Wo);class vp{constructor(t){this.renderer=t,this.emptyRenderer=new $o(t),this.currentRenderer=this.emptyRenderer}setObjectRenderer(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())}flush(){this.setObjectRenderer(this.emptyRenderer)}reset(){this.setObjectRenderer(this.emptyRenderer)}copyBoundTextures(t,s){const{boundTextures:r}=this.renderer.texture;for(let i=s-1;i>=0;--i)t[i]=r[i]||null,t[i]&&(t[i]._batchLocation=i)}boundArray(t,s,r,i){const{elements:n,ids:o,count:a}=t;let l=0;for(let h=0;h<a;h++){const c=n[h],u=c._batchLocation;if(u>=0&&u<i&&s[u]===c){o[h]=u;continue}for(;l<i;){const f=s[l];if(f&&f._batchEnabled===r&&f._batchLocation===l){l++;continue}o[h]=l,c._batchLocation=l,s[l]=c;break}}}destroy(){this.renderer=null}}vp.extension={type:Z.RendererSystem,name:"batch"};nt.add(vp);let Vu=0;class Xo{constructor(t){this.renderer=t,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=Vu++}init(t){if(t.context)this.initFromContext(t.context);else{const s=this.renderer.background.alpha<1,r=t.premultipliedAlpha;this.preserveDrawingBuffer=t.preserveDrawingBuffer,this.useContextAlpha=t.useContextAlpha,this.powerPreference=t.powerPreference,this.initFromOptions({alpha:s,premultipliedAlpha:r,antialias:t.antialias,stencil:!0,preserveDrawingBuffer:t.preserveDrawingBuffer,powerPreference:t.powerPreference})}}initFromContext(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=Vu++,this.renderer.runners.contextChange.emit(t);const s=this.renderer.view;s.addEventListener!==void 0&&(s.addEventListener("webglcontextlost",this.handleContextLost,!1),s.addEventListener("webglcontextrestored",this.handleContextRestored,!1))}initFromOptions(t){const s=this.createContext(this.renderer.view,t);this.initFromContext(s)}createContext(t,s){let r;if(q.PREFER_ENV>=gr.WEBGL2&&(r=t.getContext("webgl2",s)),r)this.webGLVersion=2;else if(this.webGLVersion=1,r=t.getContext("webgl",s)||t.getContext("experimental-webgl",s),!r)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=r,this.getExtensions(),this.gl}getExtensions(){const{gl:t}=this,s={loseContext:t.getExtension("WEBGL_lose_context"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),s3tc:t.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:t.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:t.getExtension("WEBGL_compressed_texture_etc"),etc1:t.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:t.getExtension("WEBGL_compressed_texture_atc"),astc:t.getExtension("WEBGL_compressed_texture_astc")};this.webGLVersion===1?Object.assign(this.extensions,s,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBGL_depth_texture"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension("OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):this.webGLVersion===2&&Object.assign(this.extensions,s,{colorBufferFloat:t.getExtension("EXT_color_buffer_float")})}handleContextLost(t){t.preventDefault(),setTimeout(()=>{this.gl.isContextLost()&&this.extensions.loseContext&&this.extensions.loseContext.restoreContext()},0)}handleContextRestored(){this.renderer.runners.contextChange.emit(this.gl)}destroy(){const t=this.renderer.view;this.renderer=null,t.removeEventListener!==void 0&&(t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener("webglcontextrestored",this.handleContextRestored)),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()}postrender(){this.renderer.objectRenderer.renderingToScreen&&this.gl.flush()}validateContext(t){const s=t.getContextAttributes(),r="WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext;r&&(this.webGLVersion=2),s&&!s.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");const i=r||!!t.getExtension("OES_element_index_uint");this.supports.uint32Indices=i,i||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")}}Xo.defaultOptions={context:null,antialias:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!1,powerPreference:"default"};Xo.extension={type:Z.RendererSystem,name:"context"};nt.add(Xo);class xE extends tn{upload(t,s,r){const i=t.gl;i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,s.alphaMode===Ve.UNPACK);const n=s.realWidth,o=s.realHeight;return r.width===n&&r.height===o?i.texSubImage2D(s.target,0,0,0,n,o,s.format,r.type,this.data):(r.width=n,r.height=o,i.texImage2D(s.target,0,r.internalFormat,n,o,0,s.format,r.type,this.data)),!0}}class Gl{constructor(t,s){this.width=Math.round(t||100),this.height=Math.round(s||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new Xe("disposeFramebuffer"),this.multisample=Vt.NONE}get colorTexture(){return this.colorTextures[0]}addColorTexture(t=0,s){return this.colorTextures[t]=s||new mt(null,{scaleMode:ys.NEAREST,resolution:1,mipmap:as.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this}addDepthTexture(t){return this.depthTexture=t||new mt(new xE(null,{width:this.width,height:this.height}),{scaleMode:ys.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:as.OFF,format:z.DEPTH_COMPONENT,type:lt.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this}enableDepth(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this}enableStencil(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this}resize(t,s){if(t=Math.round(t),s=Math.round(s),!(t===this.width&&s===this.height)){this.width=t,this.height=s,this.dirtyId++,this.dirtySize++;for(let r=0;r<this.colorTextures.length;r++){const i=this.colorTextures[r],n=i.resolution;i.setSize(t/n,s/n)}if(this.depthTexture){const r=this.depthTexture.resolution;this.depthTexture.setSize(t/r,s/r)}}}dispose(){this.disposeRunner.emit(this,!1)}destroyDepthTexture(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)}}class xp extends mt{constructor(t={}){if(typeof t=="number"){const s=arguments[0],r=arguments[1],i=arguments[2],n=arguments[3];t={width:s,height:r,scaleMode:i,resolution:n}}t.width=t.width||100,t.height=t.height||100,t.multisample??(t.multisample=Vt.NONE),super(null,t),this.mipmap=as.OFF,this.valid=!0,this._clear=new Ft([0,0,0,0]),this.framebuffer=new Gl(this.realWidth,this.realHeight).addColorTexture(0,this),this.framebuffer.multisample=t.multisample,this.maskStack=[],this.filterStack=[{}]}set clearColor(t){this._clear.setValue(t)}get clearColor(){return this._clear.value}get clear(){return this._clear}resize(t,s){this.framebuffer.resize(t*this.resolution,s*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)}dispose(){this.framebuffer.dispose(),super.dispose()}destroy(){super.destroy(),this.framebuffer.destroyDepthTexture(),this.framebuffer=null}}class Ws extends ji{constructor(t){const s=t,r=s.naturalWidth||s.videoWidth||s.width,i=s.naturalHeight||s.videoHeight||s.height;super(r,i),this.source=t,this.noSubImage=!1}static crossOrigin(t,s,r){r===void 0&&!s.startsWith("data:")?t.crossOrigin=$0(s):r!==!1&&(t.crossOrigin=typeof r=="string"?r:"anonymous")}upload(t,s,r,i){const n=t.gl,o=s.realWidth,a=s.realHeight;if(i=i||this.source,typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement){if(!i.complete||i.naturalWidth===0)return!1}else if(typeof HTMLVideoElement<"u"&&i instanceof HTMLVideoElement&&i.readyState<=1&&i.buffered.length===0)return!1;return n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,s.alphaMode===Ve.UNPACK),!this.noSubImage&&s.target===n.TEXTURE_2D&&r.width===o&&r.height===a?n.texSubImage2D(n.TEXTURE_2D,0,0,0,s.format,r.type,i):(r.width=o,r.height=a,n.texImage2D(s.target,0,r.internalFormat,s.format,r.type,i)),!0}update(){if(this.destroyed)return;const t=this.source,s=t.naturalWidth||t.videoWidth||t.width,r=t.naturalHeight||t.videoHeight||t.height;this.resize(s,r),super.update()}dispose(){this.source=null}}class Ep extends Ws{constructor(t,s){if(s=s||{},typeof t=="string"){const r=new Image;Ws.crossOrigin(r,t,s.crossorigin),r.src=t,t=r}super(t),!t.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=t.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(s.createBitmap??q.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,this.alphaMode=typeof s.alphaMode=="number"?s.alphaMode:null,this.bitmap=null,this._load=null,s.autoLoad!==!1&&this.load()}load(t){return this._load?this._load:(t!==void 0&&(this.createBitmap=t),this._load=new Promise((s,r)=>{const i=this.source;this.url=i.src;const n=()=>{this.destroyed||(i.onload=null,i.onerror=null,this.resize(i.width,i.height),this._load=null,this.createBitmap?s(this.process()):s(this))};i.complete&&i.src?n():(i.onload=n,i.onerror=o=>{r(o),this.onError.emit(o)})}),this._load)}process(){const t=this.source;if(this._process!==null)return this._process;if(this.bitmap!==null||!globalThis.createImageBitmap)return Promise.resolve(this);const s=globalThis.createImageBitmap,r=!t.crossOrigin||t.crossOrigin==="anonymous";return this._process=fetch(t.src,{mode:r?"cors":"no-cors"}).then(i=>i.blob()).then(i=>s(i,0,0,t.width,t.height,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===Ve.UNPACK?"premultiply":"none"})).then(i=>this.destroyed?Promise.reject():(this.bitmap=i,this.update(),this._process=null,Promise.resolve(this))),this._process}upload(t,s,r){if(typeof this.alphaMode=="number"&&(s.alphaMode=this.alphaMode),!this.createBitmap)return super.upload(t,s,r);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(super.upload(t,s,r,this.bitmap),!this.preserveBitmap){let i=!0;const n=s._glTextures;for(const o in n){const a=n[o];if(a!==r&&a.dirtyId!==s.dirtyId){i=!1;break}}i&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0}dispose(){this.source.onload=null,this.source.onerror=null,super.dispose(),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null}static test(t){return typeof HTMLImageElement<"u"&&(typeof t=="string"||t instanceof HTMLImageElement)}}class bp{constructor(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}set(t,s,r){const i=s.width,n=s.height;if(r){const o=t.width/2/i,a=t.height/2/n,l=t.x/i+o,h=t.y/n+a;r=Ht.add(r,Ht.NW),this.x0=l+o*Ht.uX(r),this.y0=h+a*Ht.uY(r),r=Ht.add(r,2),this.x1=l+o*Ht.uX(r),this.y1=h+a*Ht.uY(r),r=Ht.add(r,2),this.x2=l+o*Ht.uX(r),this.y2=h+a*Ht.uY(r),r=Ht.add(r,2),this.x3=l+o*Ht.uX(r),this.y3=h+a*Ht.uY(r)}else this.x0=t.x/i,this.y0=t.y/n,this.x1=(t.x+t.width)/i,this.y1=t.y/n,this.x2=(t.x+t.width)/i,this.y2=(t.y+t.height)/n,this.x3=t.x/i,this.y3=(t.y+t.height)/n;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}toString(){return`[@pixi/core:TextureUvs x0=${this.x0} y0=${this.y0} x1=${this.x1} y1=${this.y1} x2=${this.x2} y2=${this.y2} x3=${this.x3} y3=${this.y3}]`}}const ju=new bp;function In(e){e.destroy=function(){},e.on=function(){},e.once=function(){},e.emit=function(){}}class J extends Ji{constructor(t,s,r,i,n,o,a){if(super(),this.noFrame=!1,s||(this.noFrame=!0,s=new yt(0,0,1,1)),t instanceof J&&(t=t.baseTexture),this.baseTexture=t,this._frame=s,this.trim=i,this.valid=!1,this._uvs=ju,this.uvMatrix=null,this.orig=r||s,this._rotate=Number(n||0),n===!0)this._rotate=2;else if(this._rotate%2!==0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=o?new It(o.x,o.y):new It(0,0),this.defaultBorders=a,this._updateID=0,this.textureCacheIds=[],t.valid?this.noFrame?t.valid&&this.onBaseTextureUpdated(t):this.frame=s:t.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&t.on("update",this.onBaseTextureUpdated,this)}update(){this.baseTexture.resource&&this.baseTexture.resource.update()}onBaseTextureUpdated(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)}destroy(t){if(this.baseTexture){if(t){const{resource:s}=this.baseTexture;s!=null&&s.url&&Ze[s.url]&&J.removeFromCache(s.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,J.removeFromCache(this),this.textureCacheIds=null}clone(){var i;const t=this._frame.clone(),s=this._frame===this.orig?t:this.orig.clone(),r=new J(this.baseTexture,!this.noFrame&&t,s,(i=this.trim)==null?void 0:i.clone(),this.rotate,this.defaultAnchor,this.defaultBorders);return this.noFrame&&(r._frame=t),r}updateUvs(){this._uvs===ju&&(this._uvs=new bp),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++}static from(t,s={},r=q.STRICT_TEXTURE_CACHE){const i=typeof t=="string";let n=null;if(i)n=t;else if(t instanceof mt){if(!t.cacheId){const a=(s==null?void 0:s.pixiIdPrefix)||"pixiid";t.cacheId=`${a}-${dr()}`,mt.addToCache(t,t.cacheId)}n=t.cacheId}else{if(!t._pixiId){const a=(s==null?void 0:s.pixiIdPrefix)||"pixiid";t._pixiId=`${a}_${dr()}`}n=t._pixiId}let o=Ze[n];if(i&&r&&!o)throw new Error(`The cacheId "${n}" does not exist in TextureCache.`);return!o&&!(t instanceof mt)?(s.resolution||(s.resolution=Hs(t)),o=new J(new mt(t,s)),o.baseTexture.cacheId=n,mt.addToCache(o.baseTexture,n),J.addToCache(o,n)):!o&&t instanceof mt&&(o=new J(t),J.addToCache(o,n)),o}static fromURL(t,s){const r=Object.assign({autoLoad:!1},s==null?void 0:s.resourceOptions),i=J.from(t,Object.assign({resourceOptions:r},s),!1),n=i.baseTexture.resource;return i.baseTexture.valid?Promise.resolve(i):n.load().then(()=>Promise.resolve(i))}static fromBuffer(t,s,r,i){return new J(mt.fromBuffer(t,s,r,i))}static fromLoader(t,s,r,i){const n=new mt(t,Object.assign({scaleMode:mt.defaultOptions.scaleMode,resolution:Hs(s)},i)),{resource:o}=n;o instanceof Ep&&(o.url=s);const a=new J(n);return r||(r=s),mt.addToCache(a.baseTexture,r),J.addToCache(a,r),r!==s&&(mt.addToCache(a.baseTexture,s),J.addToCache(a,s)),a.baseTexture.valid?Promise.resolve(a):new Promise(l=>{a.baseTexture.once("loaded",()=>l(a))})}static addToCache(t,s){s&&(t.textureCacheIds.includes(s)||t.textureCacheIds.push(s),Ze[s]&&Ze[s]!==t&&console.warn(`Texture added to the cache with an id [${s}] that already had an entry`),Ze[s]=t)}static removeFromCache(t){if(typeof t=="string"){const s=Ze[t];if(s){const r=s.textureCacheIds.indexOf(t);return r>-1&&s.textureCacheIds.splice(r,1),delete Ze[t],s}}else if(t!=null&&t.textureCacheIds){for(let s=0;s<t.textureCacheIds.length;++s)Ze[t.textureCacheIds[s]]===t&&delete Ze[t.textureCacheIds[s]];return t.textureCacheIds.length=0,t}return null}get resolution(){return this.baseTexture.resolution}get frame(){return this._frame}set frame(t){this._frame=t,this.noFrame=!1;const{x:s,y:r,width:i,height:n}=t,o=s+i>this.baseTexture.width,a=r+n>this.baseTexture.height;if(o||a){const l=o&&a?"and":"or",h=`X: ${s} + ${i} = ${s+i} > ${this.baseTexture.width}`,c=`Y: ${r} + ${n} = ${r+n} > ${this.baseTexture.height}`;throw new Error(`Texture Error: frame does not fit inside the base Texture dimensions: ${h} ${l} ${c}`)}this.valid=i&&n&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=t),this.valid&&this.updateUvs()}get rotate(){return this._rotate}set rotate(t){this._rotate=t,this.valid&&this.updateUvs()}get width(){return this.orig.width}get height(){return this.orig.height}castToBaseTexture(){return this.baseTexture}static get EMPTY(){return J._EMPTY||(J._EMPTY=new J(new mt),In(J._EMPTY),In(J._EMPTY.baseTexture)),J._EMPTY}static get WHITE(){if(!J._WHITE){const t=q.ADAPTER.createCanvas(16,16),s=t.getContext("2d");t.width=16,t.height=16,s.fillStyle="white",s.fillRect(0,0,16,16),J._WHITE=new J(mt.from(t)),In(J._WHITE),In(J._WHITE.baseTexture)}return J._WHITE}}class _r extends J{constructor(t,s){super(t,s),this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}get framebuffer(){return this.baseTexture.framebuffer}get multisample(){return this.framebuffer.multisample}set multisample(t){this.framebuffer.multisample=t}resize(t,s,r=!0){const i=this.baseTexture.resolution,n=Math.round(t*i)/i,o=Math.round(s*i)/i;this.valid=n>0&&o>0,this._frame.width=this.orig.width=n,this._frame.height=this.orig.height=o,r&&this.baseTexture.resize(n,o),this.updateUvs()}setResolution(t){const{baseTexture:s}=this;s.resolution!==t&&(s.setResolution(t),this.resize(s.width,s.height,!1))}static create(t){return new _r(new xp(t))}}class wp{constructor(t){this.texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}createTexture(t,s,r=Vt.NONE){const i=new xp(Object.assign({width:t,height:s,resolution:1,multisample:r},this.textureOptions));return new _r(i)}getOptimalTexture(t,s,r=1,i=Vt.NONE){let n;t=Math.ceil(t*r-1e-6),s=Math.ceil(s*r-1e-6),!this.enableFullScreen||t!==this._pixelsWidth||s!==this._pixelsHeight?(t=fo(t),s=fo(s),n=((t&65535)<<16|s&65535)>>>0,i>1&&(n+=i*4294967296)):n=i>1?-i:-1,this.texturePool[n]||(this.texturePool[n]=[]);let o=this.texturePool[n].pop();return o||(o=this.createTexture(t,s,i)),o.filterPoolKey=n,o.setResolution(r),o}getFilterTexture(t,s,r){const i=this.getOptimalTexture(t.width,t.height,s||t.resolution,r||Vt.NONE);return i.filterFrame=t.filterFrame,i}returnTexture(t){const s=t.filterPoolKey;t.filterFrame=null,this.texturePool[s].push(t)}returnFilterTexture(t){this.returnTexture(t)}clear(t){if(t=t!==!1,t)for(const s in this.texturePool){const r=this.texturePool[s];if(r)for(let i=0;i<r.length;i++)r[i].destroy(!0)}this.texturePool={}}setScreenSize(t){if(!(t.width===this._pixelsWidth&&t.height===this._pixelsHeight)){this.enableFullScreen=t.width>0&&t.height>0;for(const s in this.texturePool){if(!(Number(s)<0))continue;const r=this.texturePool[s];if(r)for(let i=0;i<r.length;i++)r[i].destroy(!0);this.texturePool[s]=[]}this._pixelsWidth=t.width,this._pixelsHeight=t.height}}}wp.SCREEN_KEY=-1;class EE extends $s{constructor(){super(),this.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2])}}class Tp extends $s{constructor(){super(),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new Zt(this.vertices),this.uvBuffer=new Zt(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}map(t,s){let r=0,i=0;return this.uvs[0]=r,this.uvs[1]=i,this.uvs[2]=r+s.width/t.width,this.uvs[3]=i,this.uvs[4]=r+s.width/t.width,this.uvs[5]=i+s.height/t.height,this.uvs[6]=r,this.uvs[7]=i+s.height/t.height,r=s.x,i=s.y,this.vertices[0]=r,this.vertices[1]=i,this.vertices[2]=r+s.width,this.vertices[3]=i,this.vertices[4]=r+s.width,this.vertices[5]=i+s.height,this.vertices[6]=r,this.vertices[7]=i+s.height,this.invalidate(),this}invalidate(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this}}class bE{constructor(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=Vt.NONE,this.sourceFrame=new yt,this.destinationFrame=new yt,this.bindingSourceFrame=new yt,this.bindingDestinationFrame=new yt,this.filters=[],this.transform=null}clear(){this.target=null,this.filters=null,this.renderTexture=null}}const Cn=[new It,new It,new It,new It],Na=new kt;class Sp{constructor(t){this.renderer=t,this.defaultFilterStack=[{}],this.texturePool=new wp,this.statePool=[],this.quad=new EE,this.quadUv=new Tp,this.tempRect=new yt,this.activeState={},this.globalUniforms=new ze({outputFrame:new yt,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}init(){this.texturePool.setScreenSize(this.renderer.view)}push(t,s){const r=this.renderer,i=this.defaultFilterStack,n=this.statePool.pop()||new bE,o=this.renderer.renderTexture;let a=s[0].resolution,l=s[0].multisample,h=s[0].padding,c=s[0].autoFit,u=s[0].legacy??!0;for(let d=1;d<s.length;d++){const m=s[d];a=Math.min(a,m.resolution),l=Math.min(l,m.multisample),h=this.useMaxPadding?Math.max(h,m.padding):h+m.padding,c=c&&m.autoFit,u=u||(m.legacy??!0)}i.length===1&&(this.defaultFilterStack[0].renderTexture=o.current),i.push(n),n.resolution=a,n.multisample=l,n.legacy=u,n.target=t,n.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),n.sourceFrame.pad(h);const f=this.tempRect.copyFrom(o.sourceFrame);r.projection.transform&&this.transformAABB(Na.copyFrom(r.projection.transform).invert(),f),c?(n.sourceFrame.fit(f),(n.sourceFrame.width<=0||n.sourceFrame.height<=0)&&(n.sourceFrame.width=0,n.sourceFrame.height=0)):n.sourceFrame.intersects(f)||(n.sourceFrame.width=0,n.sourceFrame.height=0),this.roundFrame(n.sourceFrame,o.current?o.current.resolution:r.resolution,o.sourceFrame,o.destinationFrame,r.projection.transform),n.renderTexture=this.getOptimalFilterTexture(n.sourceFrame.width,n.sourceFrame.height,a,l),n.filters=s,n.destinationFrame.width=n.renderTexture.width,n.destinationFrame.height=n.renderTexture.height;const p=this.tempRect;p.x=0,p.y=0,p.width=n.sourceFrame.width,p.height=n.sourceFrame.height,n.renderTexture.filterFrame=n.sourceFrame,n.bindingSourceFrame.copyFrom(o.sourceFrame),n.bindingDestinationFrame.copyFrom(o.destinationFrame),n.transform=r.projection.transform,r.projection.transform=null,o.bind(n.renderTexture,n.sourceFrame,p),r.framebuffer.clear(0,0,0,0)}pop(){const t=this.defaultFilterStack,s=t.pop(),r=s.filters;this.activeState=s;const i=this.globalUniforms.uniforms;i.outputFrame=s.sourceFrame,i.resolution=s.resolution;const n=i.inputSize,o=i.inputPixel,a=i.inputClamp;if(n[0]=s.destinationFrame.width,n[1]=s.destinationFrame.height,n[2]=1/n[0],n[3]=1/n[1],o[0]=Math.round(n[0]*s.resolution),o[1]=Math.round(n[1]*s.resolution),o[2]=1/o[0],o[3]=1/o[1],a[0]=.5*o[2],a[1]=.5*o[3],a[2]=s.sourceFrame.width*n[2]-.5*o[2],a[3]=s.sourceFrame.height*n[3]-.5*o[3],s.legacy){const h=i.filterArea;h[0]=s.destinationFrame.width,h[1]=s.destinationFrame.height,h[2]=s.sourceFrame.x,h[3]=s.sourceFrame.y,i.filterClamp=i.inputClamp}this.globalUniforms.update();const l=t[t.length-1];if(this.renderer.framebuffer.blit(),r.length===1)r[0].apply(this,s.renderTexture,l.renderTexture,Qe.BLEND,s),this.returnFilterTexture(s.renderTexture);else{let h=s.renderTexture,c=this.getOptimalFilterTexture(h.width,h.height,s.resolution);c.filterFrame=h.filterFrame;let u=0;for(u=0;u<r.length-1;++u){u===1&&s.multisample>1&&(c=this.getOptimalFilterTexture(h.width,h.height,s.resolution),c.filterFrame=h.filterFrame),r[u].apply(this,h,c,Qe.CLEAR,s);const f=h;h=c,c=f}r[u].apply(this,h,l.renderTexture,Qe.BLEND,s),u>1&&s.multisample>1&&this.returnFilterTexture(s.renderTexture),this.returnFilterTexture(h),this.returnFilterTexture(c)}s.clear(),this.statePool.push(s)}bindAndClear(t,s=Qe.CLEAR){const{renderTexture:r,state:i}=this.renderer;if(t===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,t!=null&&t.filterFrame){const o=this.tempRect;o.x=0,o.y=0,o.width=t.filterFrame.width,o.height=t.filterFrame.height,r.bind(t,t.filterFrame,o)}else t!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?r.bind(t):this.renderer.renderTexture.bind(t,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);const n=i.stateId&1||this.forceClear;(s===Qe.CLEAR||s===Qe.BLIT&&n)&&this.renderer.framebuffer.clear(0,0,0,0)}applyFilter(t,s,r,i){const n=this.renderer;n.state.set(t.state),this.bindAndClear(r,i),t.uniforms.uSampler=s,t.uniforms.filterGlobals=this.globalUniforms,n.shader.bind(t),t.legacy=!!t.program.attributeData.aTextureCoord,t.legacy?(this.quadUv.map(s._frame,s.filterFrame),n.geometry.bind(this.quadUv),n.geometry.draw(rs.TRIANGLES)):(n.geometry.bind(this.quad),n.geometry.draw(rs.TRIANGLE_STRIP))}calculateSpriteMatrix(t,s){const{sourceFrame:r,destinationFrame:i}=this.activeState,{orig:n}=s._texture,o=t.set(i.width,0,0,i.height,r.x,r.y),a=s.worldTransform.copyTo(kt.TEMP_MATRIX);return a.invert(),o.prepend(a),o.scale(1/n.width,1/n.height),o.translate(s.anchor.x,s.anchor.y),o}destroy(){this.renderer=null,this.texturePool.clear(!1)}getOptimalFilterTexture(t,s,r=1,i=Vt.NONE){return this.texturePool.getOptimalTexture(t,s,r,i)}getFilterTexture(t,s,r){if(typeof t=="number"){const n=t;t=s,s=n}t=t||this.activeState.renderTexture;const i=this.texturePool.getOptimalTexture(t.width,t.height,s||t.resolution,r||Vt.NONE);return i.filterFrame=t.filterFrame,i}returnFilterTexture(t){this.texturePool.returnTexture(t)}emptyPool(){this.texturePool.clear(!0)}resize(){this.texturePool.setScreenSize(this.renderer.view)}transformAABB(t,s){const r=Cn[0],i=Cn[1],n=Cn[2],o=Cn[3];r.set(s.left,s.top),i.set(s.left,s.bottom),n.set(s.right,s.top),o.set(s.right,s.bottom),t.apply(r,r),t.apply(i,i),t.apply(n,n),t.apply(o,o);const a=Math.min(r.x,i.x,n.x,o.x),l=Math.min(r.y,i.y,n.y,o.y),h=Math.max(r.x,i.x,n.x,o.x),c=Math.max(r.y,i.y,n.y,o.y);s.x=a,s.y=l,s.width=h-a,s.height=c-l}roundFrame(t,s,r,i,n){if(!(t.width<=0||t.height<=0||r.width<=0||r.height<=0)){if(n){const{a:o,b:a,c:l,d:h}=n;if((Math.abs(a)>1e-4||Math.abs(l)>1e-4)&&(Math.abs(o)>1e-4||Math.abs(h)>1e-4))return}n=n?Na.copyFrom(n):Na.identity(),n.translate(-r.x,-r.y).scale(i.width/r.width,i.height/r.height).translate(i.x,i.y),this.transformAABB(n,t),t.ceil(s),this.transformAABB(n.invert(),t)}}}Sp.extension={type:Z.RendererSystem,name:"filter"};nt.add(Sp);class wE{constructor(t){this.framebuffer=t,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=Vt.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}}const TE=new yt;class Ap{constructor(t){this.renderer=t,this.managedFramebuffers=[],this.unknownFramebuffer=new Gl(10,10),this.msaaSamples=null}contextChange(){this.disposeAll(!0);const t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new yt,this.hasMRT=!0,this.writeDepthTexture=!0,this.renderer.context.webGLVersion===1){let s=this.renderer.context.extensions.drawBuffers,r=this.renderer.context.extensions.depthTexture;q.PREFER_ENV===gr.WEBGL_LEGACY&&(s=null,r=null),s?t.drawBuffers=i=>s.drawBuffersWEBGL(i):(this.hasMRT=!1,t.drawBuffers=()=>{}),r||(this.writeDepthTexture=!1)}else this.msaaSamples=t.getInternalformatParameter(t.RENDERBUFFER,t.RGBA8,t.SAMPLES)}bind(t,s,r=0){const{gl:i}=this;if(t){const n=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,i.bindFramebuffer(i.FRAMEBUFFER,n.framebuffer)),n.mipLevel!==r&&(t.dirtyId++,t.dirtyFormat++,n.mipLevel=r),n.dirtyId!==t.dirtyId&&(n.dirtyId=t.dirtyId,n.dirtyFormat!==t.dirtyFormat?(n.dirtyFormat=t.dirtyFormat,n.dirtySize=t.dirtySize,this.updateFramebuffer(t,r)):n.dirtySize!==t.dirtySize&&(n.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(let o=0;o<t.colorTextures.length;o++){const a=t.colorTextures[o];this.renderer.texture.unbind(a.parentTextureArray||a)}if(t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),s){const o=s.width>>r,a=s.height>>r,l=o/s.width;this.setViewport(s.x*l,s.y*l,o,a)}else{const o=t.width>>r,a=t.height>>r;this.setViewport(0,0,o,a)}}else this.current&&(this.current=null,i.bindFramebuffer(i.FRAMEBUFFER,null)),s?this.setViewport(s.x,s.y,s.width,s.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)}setViewport(t,s,r,i){const n=this.viewport;t=Math.round(t),s=Math.round(s),r=Math.round(r),i=Math.round(i),(n.width!==r||n.height!==i||n.x!==t||n.y!==s)&&(n.x=t,n.y=s,n.width=r,n.height=i,this.gl.viewport(t,s,r,i))}get size(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}}clear(t,s,r,i,n=_l.COLOR|_l.DEPTH){const{gl:o}=this;o.clearColor(t,s,r,i),o.clear(n)}initFramebuffer(t){const{gl:s}=this,r=new wE(s.createFramebuffer());return r.multisample=this.detectSamples(t.multisample),t.glFramebuffers[this.CONTEXT_UID]=r,this.managedFramebuffers.push(t),t.disposeRunner.add(this),r}resizeFramebuffer(t){const{gl:s}=this,r=t.glFramebuffers[this.CONTEXT_UID];r.stencil&&(s.bindRenderbuffer(s.RENDERBUFFER,r.stencil),r.msaaBuffer?s.renderbufferStorageMultisample(s.RENDERBUFFER,r.multisample,s.DEPTH24_STENCIL8,t.width,t.height):s.renderbufferStorage(s.RENDERBUFFER,s.DEPTH_STENCIL,t.width,t.height));const i=t.colorTextures;let n=i.length;s.drawBuffers||(n=Math.min(n,1));for(let o=0;o<n;o++){const a=i[o],l=a.parentTextureArray||a;this.renderer.texture.bind(l,0),o===0&&r.msaaBuffer&&(s.bindRenderbuffer(s.RENDERBUFFER,r.msaaBuffer),s.renderbufferStorageMultisample(s.RENDERBUFFER,r.multisample,l._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height))}t.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(t.depthTexture,0)}updateFramebuffer(t,s){const{gl:r}=this,i=t.glFramebuffers[this.CONTEXT_UID],n=t.colorTextures;let o=n.length;r.drawBuffers||(o=Math.min(o,1)),i.multisample>1&&this.canMultisampleFramebuffer(t)?i.msaaBuffer=i.msaaBuffer||r.createRenderbuffer():i.msaaBuffer&&(r.deleteRenderbuffer(i.msaaBuffer),i.msaaBuffer=null,i.blitFramebuffer&&(i.blitFramebuffer.dispose(),i.blitFramebuffer=null));const a=[];for(let l=0;l<o;l++){const h=n[l],c=h.parentTextureArray||h;this.renderer.texture.bind(c,0),l===0&&i.msaaBuffer?(r.bindRenderbuffer(r.RENDERBUFFER,i.msaaBuffer),r.renderbufferStorageMultisample(r.RENDERBUFFER,i.multisample,c._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.RENDERBUFFER,i.msaaBuffer)):(r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0+l,h.target,c._glTextures[this.CONTEXT_UID].texture,s),a.push(r.COLOR_ATTACHMENT0+l))}if(a.length>1&&r.drawBuffers(a),t.depthTexture&&this.writeDepthTexture){const h=t.depthTexture;this.renderer.texture.bind(h,0),r.framebufferTexture2D(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.TEXTURE_2D,h._glTextures[this.CONTEXT_UID].texture,s)}(t.stencil||t.depth)&&!(t.depthTexture&&this.writeDepthTexture)?(i.stencil=i.stencil||r.createRenderbuffer(),r.bindRenderbuffer(r.RENDERBUFFER,i.stencil),i.msaaBuffer?r.renderbufferStorageMultisample(r.RENDERBUFFER,i.multisample,r.DEPTH24_STENCIL8,t.width,t.height):r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_STENCIL,t.width,t.height),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_STENCIL_ATTACHMENT,r.RENDERBUFFER,i.stencil)):i.stencil&&(r.deleteRenderbuffer(i.stencil),i.stencil=null)}canMultisampleFramebuffer(t){return this.renderer.context.webGLVersion!==1&&t.colorTextures.length<=1&&!t.depthTexture}detectSamples(t){const{msaaSamples:s}=this;let r=Vt.NONE;if(t<=1||s===null)return r;for(let i=0;i<s.length;i++)if(s[i]<=t){r=s[i];break}return r===1&&(r=Vt.NONE),r}blit(t,s,r){const{current:i,renderer:n,gl:o,CONTEXT_UID:a}=this;if(n.context.webGLVersion!==2||!i)return;const l=i.glFramebuffers[a];if(!l)return;if(!t){if(!l.msaaBuffer)return;const c=i.colorTextures[0];if(!c)return;l.blitFramebuffer||(l.blitFramebuffer=new Gl(i.width,i.height),l.blitFramebuffer.addColorTexture(0,c)),t=l.blitFramebuffer,t.colorTextures[0]!==c&&(t.colorTextures[0]=c,t.dirtyId++,t.dirtyFormat++),(t.width!==i.width||t.height!==i.height)&&(t.width=i.width,t.height=i.height,t.dirtyId++,t.dirtySize++)}s||(s=TE,s.width=i.width,s.height=i.height),r||(r=s);const h=s.width===r.width&&s.height===r.height;this.bind(t),o.bindFramebuffer(o.READ_FRAMEBUFFER,l.framebuffer),o.blitFramebuffer(s.left,s.top,s.right,s.bottom,r.left,r.top,r.right,r.bottom,o.COLOR_BUFFER_BIT,h?o.NEAREST:o.LINEAR),o.bindFramebuffer(o.READ_FRAMEBUFFER,t.glFramebuffers[this.CONTEXT_UID].framebuffer)}disposeFramebuffer(t,s){const r=t.glFramebuffers[this.CONTEXT_UID],i=this.gl;if(!r)return;delete t.glFramebuffers[this.CONTEXT_UID];const n=this.managedFramebuffers.indexOf(t);n>=0&&this.managedFramebuffers.splice(n,1),t.disposeRunner.remove(this),s||(i.deleteFramebuffer(r.framebuffer),r.msaaBuffer&&i.deleteRenderbuffer(r.msaaBuffer),r.stencil&&i.deleteRenderbuffer(r.stencil)),r.blitFramebuffer&&this.disposeFramebuffer(r.blitFramebuffer,s)}disposeAll(t){const s=this.managedFramebuffers;this.managedFramebuffers=[];for(let r=0;r<s.length;r++)this.disposeFramebuffer(s[r],t)}forceStencil(){const t=this.current;if(!t)return;const s=t.glFramebuffers[this.CONTEXT_UID];if(!s||s.stencil)return;t.stencil=!0;const r=t.width,i=t.height,n=this.gl,o=n.createRenderbuffer();n.bindRenderbuffer(n.RENDERBUFFER,o),s.msaaBuffer?n.renderbufferStorageMultisample(n.RENDERBUFFER,s.multisample,n.DEPTH24_STENCIL8,r,i):n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,r,i),s.stencil=o,n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,o)}reset(){this.current=this.unknownFramebuffer,this.viewport=new yt}destroy(){this.renderer=null}}Ap.extension={type:Z.RendererSystem,name:"framebuffer"};nt.add(Ap);const Ua={5126:4,5123:2,5121:1};class Ip{constructor(t){this.renderer=t,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}contextChange(){this.disposeAll(!0);const t=this.gl=this.renderer.gl,s=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,s.webGLVersion!==2){let r=this.renderer.context.extensions.vertexArrayObject;q.PREFER_ENV===gr.WEBGL_LEGACY&&(r=null),r?(t.createVertexArray=()=>r.createVertexArrayOES(),t.bindVertexArray=i=>r.bindVertexArrayOES(i),t.deleteVertexArray=i=>r.deleteVertexArrayOES(i)):(this.hasVao=!1,t.createVertexArray=()=>null,t.bindVertexArray=()=>null,t.deleteVertexArray=()=>null)}if(s.webGLVersion!==2){const r=t.getExtension("ANGLE_instanced_arrays");r?(t.vertexAttribDivisor=(i,n)=>r.vertexAttribDivisorANGLE(i,n),t.drawElementsInstanced=(i,n,o,a,l)=>r.drawElementsInstancedANGLE(i,n,o,a,l),t.drawArraysInstanced=(i,n,o,a)=>r.drawArraysInstancedANGLE(i,n,o,a)):this.hasInstance=!1}this.canUseUInt32ElementIndex=s.webGLVersion===2||!!s.extensions.uint32ElementIndex}bind(t,s){s=s||this.renderer.shader.shader;const{gl:r}=this;let i=t.glVertexArrayObjects[this.CONTEXT_UID],n=!1;i||(this.managedGeometries[t.id]=t,t.disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=i={},n=!0);const o=i[s.program.id]||this.initGeometryVao(t,s,n);this._activeGeometry=t,this._activeVao!==o&&(this._activeVao=o,this.hasVao?r.bindVertexArray(o):this.activateVao(t,s.program)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){const t=this._activeGeometry,s=this.renderer.buffer;for(let r=0;r<t.buffers.length;r++){const i=t.buffers[r];s.update(i)}}checkCompatibility(t,s){const r=t.attributes,i=s.attributeData;for(const n in i)if(!r[n])throw new Error(`shader and geometry incompatible, geometry missing the "${n}" attribute`)}getSignature(t,s){const r=t.attributes,i=s.attributeData,n=["g",t.id];for(const o in r)i[o]&&n.push(o,i[o].location);return n.join("-")}initGeometryVao(t,s,r=!0){const i=this.gl,n=this.CONTEXT_UID,o=this.renderer.buffer,a=s.program;a.glPrograms[n]||this.renderer.shader.generateProgram(s),this.checkCompatibility(t,a);const l=this.getSignature(t,a),h=t.glVertexArrayObjects[this.CONTEXT_UID];let c=h[l];if(c)return h[a.id]=c,c;const u=t.buffers,f=t.attributes,p={},d={};for(const m in u)p[m]=0,d[m]=0;for(const m in f)!f[m].size&&a.attributeData[m]?f[m].size=a.attributeData[m].size:f[m].size||console.warn(`PIXI Geometry attribute '${m}' size cannot be determined (likely the bound shader does not have the attribute)`),p[f[m].buffer]+=f[m].size*Ua[f[m].type];for(const m in f){const g=f[m],y=g.size;g.stride===void 0&&(p[g.buffer]===y*Ua[g.type]?g.stride=0:g.stride=p[g.buffer]),g.start===void 0&&(g.start=d[g.buffer],d[g.buffer]+=y*Ua[g.type])}c=i.createVertexArray(),i.bindVertexArray(c);for(let m=0;m<u.length;m++){const g=u[m];o.bind(g),r&&g._glBuffers[n].refCount++}return this.activateVao(t,a),h[a.id]=c,h[l]=c,i.bindVertexArray(null),o.unbind(is.ARRAY_BUFFER),c}disposeGeometry(t,s){var a;if(!this.managedGeometries[t.id])return;delete this.managedGeometries[t.id];const r=t.glVertexArrayObjects[this.CONTEXT_UID],i=this.gl,n=t.buffers,o=(a=this.renderer)==null?void 0:a.buffer;if(t.disposeRunner.remove(this),!!r){if(o)for(let l=0;l<n.length;l++){const h=n[l]._glBuffers[this.CONTEXT_UID];h&&(h.refCount--,h.refCount===0&&!s&&o.dispose(n[l],s))}if(!s){for(const l in r)if(l[0]==="g"){const h=r[l];this._activeVao===h&&this.unbind(),i.deleteVertexArray(h)}}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}disposeAll(t){const s=Object.keys(this.managedGeometries);for(let r=0;r<s.length;r++)this.disposeGeometry(this.managedGeometries[s[r]],t)}activateVao(t,s){const r=this.gl,i=this.CONTEXT_UID,n=this.renderer.buffer,o=t.buffers,a=t.attributes;t.indexBuffer&&n.bind(t.indexBuffer);let l=null;for(const h in a){const c=a[h],u=o[c.buffer],f=u._glBuffers[i];if(s.attributeData[h]){l!==f&&(n.bind(u),l=f);const p=s.attributeData[h].location;if(r.enableVertexAttribArray(p),r.vertexAttribPointer(p,c.size,c.type||r.FLOAT,c.normalized,c.stride,c.start),c.instance)if(this.hasInstance)r.vertexAttribDivisor(p,c.divisor);else throw new Error("geometry error, GPU Instancing is not supported on this device")}}}draw(t,s,r,i){const{gl:n}=this,o=this._activeGeometry;if(o.indexBuffer){const a=o.indexBuffer.data.BYTES_PER_ELEMENT,l=a===2?n.UNSIGNED_SHORT:n.UNSIGNED_INT;a===2||a===4&&this.canUseUInt32ElementIndex?o.instanced?n.drawElementsInstanced(t,s||o.indexBuffer.data.length,l,(r||0)*a,i||1):n.drawElements(t,s||o.indexBuffer.data.length,l,(r||0)*a):console.warn("unsupported index buffer type: uint32")}else o.instanced?n.drawArraysInstanced(t,r,s||o.getSize(),i||1):n.drawArrays(t,r,s||o.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this.renderer=null}}Ip.extension={type:Z.RendererSystem,name:"geometry"};nt.add(Ip);const Yu=new kt;class Cp{constructor(t,s){this._texture=t,this.mapCoord=new kt,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof s>"u"?.5:s,this.isSimple=!1}get texture(){return this._texture}set texture(t){this._texture=t,this._textureID=-1}multiplyUvs(t,s){s===void 0&&(s=t);const r=this.mapCoord;for(let i=0;i<t.length;i+=2){const n=t[i],o=t[i+1];s[i]=n*r.a+o*r.c+r.tx,s[i+1]=n*r.b+o*r.d+r.ty}return s}update(t){const s=this._texture;if(!s||!s.valid||!t&&this._textureID===s._updateID)return!1;this._textureID=s._updateID,this._updateID++;const r=s._uvs;this.mapCoord.set(r.x1-r.x0,r.y1-r.y0,r.x3-r.x0,r.y3-r.y0,r.x0,r.y0);const i=s.orig,n=s.trim;n&&(Yu.set(i.width/n.width,0,0,i.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(Yu));const o=s.baseTexture,a=this.uClampFrame,l=this.clampMargin/o.resolution,h=this.clampOffset;return a[0]=(s._frame.x+l+h)/o.width,a[1]=(s._frame.y+l+h)/o.height,a[2]=(s._frame.x+s._frame.width-l+h)/o.width,a[3]=(s._frame.y+s._frame.height-l+h)/o.height,this.uClampOffset[0]=h/o.realWidth,this.uClampOffset[1]=h/o.realHeight,this.isSimple=s._frame.width===o.width&&s._frame.height===o.height&&s.rotate===0,!0}}var SE=`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`,AE=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`;class IE extends le{constructor(t,s,r){let i=null;typeof t!="string"&&s===void 0&&r===void 0&&(i=t,t=void 0,s=void 0,r=void 0),super(t||AE,s||SE,r),this.maskSprite=i,this.maskMatrix=new kt}get maskSprite(){return this._maskSprite}set maskSprite(t){this._maskSprite=t,this._maskSprite&&(this._maskSprite.renderable=!1)}apply(t,s,r,i){const n=this._maskSprite,o=n._texture;o.valid&&(o.uvMatrix||(o.uvMatrix=new Cp(o,0)),o.uvMatrix.update(),this.uniforms.npmAlpha=o.baseTexture.alphaMode?0:1,this.uniforms.mask=o,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,n).prepend(o.uvMatrix.mapCoord),this.uniforms.alpha=n.worldAlpha,this.uniforms.maskClamp=o.uvMatrix.uClampFrame,t.applyFilter(this,s,r,i))}}class CE{constructor(t=null){this.type=qt.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=le.defaultMultisample,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}get filter(){return this._filters?this._filters[0]:null}set filter(t){t?this._filters?this._filters[0]=t:this._filters=[t]:this._filters=null}reset(){this.pooled&&(this.maskObject=null,this.type=qt.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null}copyCountersOrReset(t){t?(this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)}}class Rp{constructor(t){this.renderer=t,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}setMaskStack(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)}push(t,s){let r=s;if(!r.isMaskData){const n=this.maskDataPool.pop()||new CE;n.pooled=!0,n.maskObject=s,r=n}const i=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null;if(r.copyCountersOrReset(i),r._colorMask=i?i._colorMask:15,r.autoDetect&&this.detect(r),r._target=t,r.type!==qt.SPRITE&&this.maskStack.push(r),r.enabled)switch(r.type){case qt.SCISSOR:this.renderer.scissor.push(r);break;case qt.STENCIL:this.renderer.stencil.push(r);break;case qt.SPRITE:r.copyCountersOrReset(null),this.pushSpriteMask(r);break;case qt.COLOR:this.pushColorMask(r);break}r.type===qt.SPRITE&&this.maskStack.push(r)}pop(t){const s=this.maskStack.pop();if(!(!s||s._target!==t)){if(s.enabled)switch(s.type){case qt.SCISSOR:this.renderer.scissor.pop(s);break;case qt.STENCIL:this.renderer.stencil.pop(s.maskObject);break;case qt.SPRITE:this.popSpriteMask(s);break;case qt.COLOR:this.popColorMask(s);break}if(s.reset(),s.pooled&&this.maskDataPool.push(s),this.maskStack.length!==0){const r=this.maskStack[this.maskStack.length-1];r.type===qt.SPRITE&&r._filters&&(r._filters[0].maskSprite=r.maskObject)}}}detect(t){const s=t.maskObject;s?s.isSprite?t.type=qt.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(t)?t.type=qt.SCISSOR:t.type=qt.STENCIL:t.type=qt.COLOR}pushSpriteMask(t){const{maskObject:s}=t,r=t._target;let i=t._filters;i||(i=this.alphaMaskPool[this.alphaMaskIndex],i||(i=this.alphaMaskPool[this.alphaMaskIndex]=[new IE]));const n=this.renderer,o=n.renderTexture;let a,l;if(o.current){const c=o.current;a=t.resolution||c.resolution,l=t.multisample??c.multisample}else a=t.resolution||n.resolution,l=t.multisample??n.multisample;i[0].resolution=a,i[0].multisample=l,i[0].maskSprite=s;const h=r.filterArea;r.filterArea=s.getBounds(!0),n.filter.push(r,i),r.filterArea=h,t._filters||this.alphaMaskIndex++}popSpriteMask(t){this.renderer.filter.pop(),t._filters?t._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)}pushColorMask(t){const s=t._colorMask,r=t._colorMask=s&t.colorMask;r!==s&&this.renderer.gl.colorMask((r&1)!==0,(r&2)!==0,(r&4)!==0,(r&8)!==0)}popColorMask(t){const s=t._colorMask,r=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;r!==s&&this.renderer.gl.colorMask((r&1)!==0,(r&2)!==0,(r&4)!==0,(r&8)!==0)}destroy(){this.renderer=null}}Rp.extension={type:Z.RendererSystem,name:"mask"};nt.add(Rp);class Pp{constructor(t){this.renderer=t,this.maskStack=[],this.glConst=0}getStackLength(){return this.maskStack.length}setMaskStack(t){const{gl:s}=this.renderer,r=this.getStackLength();this.maskStack=t;const i=this.getStackLength();i!==r&&(i===0?s.disable(this.glConst):(s.enable(this.glConst),this._useCurrent()))}_useCurrent(){}destroy(){this.renderer=null,this.maskStack=null}}const Ku=new kt,qu=[],zn=class extends Pp{constructor(e){super(e),this.glConst=q.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST}getStackLength(){const e=this.maskStack[this.maskStack.length-1];return e?e._scissorCounter:0}calcScissorRect(e){if(e._scissorRectLocal)return;const t=e._scissorRect,{maskObject:s}=e,{renderer:r}=this,i=r.renderTexture,n=s.getBounds(!0,qu.pop()??new yt);this.roundFrameToPixels(n,i.current?i.current.resolution:r.resolution,i.sourceFrame,i.destinationFrame,r.projection.transform),t&&n.fit(t),e._scissorRectLocal=n}static isMatrixRotated(e){if(!e)return!1;const{a:t,b:s,c:r,d:i}=e;return(Math.abs(s)>1e-4||Math.abs(r)>1e-4)&&(Math.abs(t)>1e-4||Math.abs(i)>1e-4)}testScissor(e){const{maskObject:t}=e;if(!t.isFastRect||!t.isFastRect()||zn.isMatrixRotated(t.worldTransform)||zn.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(e);const s=e._scissorRectLocal;return s.width>0&&s.height>0}roundFrameToPixels(e,t,s,r,i){zn.isMatrixRotated(i)||(i=i?Ku.copyFrom(i):Ku.identity(),i.translate(-s.x,-s.y).scale(r.width/s.width,r.height/s.height).translate(r.x,r.y),this.renderer.filter.transformAABB(i,e),e.fit(r),e.x=Math.round(e.x*t),e.y=Math.round(e.y*t),e.width=Math.round(e.width*t),e.height=Math.round(e.height*t))}push(e){e._scissorRectLocal||this.calcScissorRect(e);const{gl:t}=this.renderer;e._scissorRect||t.enable(t.SCISSOR_TEST),e._scissorCounter++,e._scissorRect=e._scissorRectLocal,this._useCurrent()}pop(e){const{gl:t}=this.renderer;e&&qu.push(e._scissorRectLocal),this.getStackLength()>0?this._useCurrent():t.disable(t.SCISSOR_TEST)}_useCurrent(){const e=this.maskStack[this.maskStack.length-1]._scissorRect;let t;this.renderer.renderTexture.current?t=e.y:t=this.renderer.height-e.height-e.y,this.renderer.gl.scissor(e.x,t,e.width,e.height)}};let Mp=zn;Mp.extension={type:Z.RendererSystem,name:"scissor"};nt.add(Mp);class Op extends Pp{constructor(t){super(t),this.glConst=q.ADAPTER.getWebGLRenderingContext().STENCIL_TEST}getStackLength(){const t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0}push(t){const s=t.maskObject,{gl:r}=this.renderer,i=t._stencilCounter;i===0&&(this.renderer.framebuffer.forceStencil(),r.clearStencil(0),r.clear(r.STENCIL_BUFFER_BIT),r.enable(r.STENCIL_TEST)),t._stencilCounter++;const n=t._colorMask;n!==0&&(t._colorMask=0,r.colorMask(!1,!1,!1,!1)),r.stencilFunc(r.EQUAL,i,4294967295),r.stencilOp(r.KEEP,r.KEEP,r.INCR),s.renderable=!0,s.render(this.renderer),this.renderer.batch.flush(),s.renderable=!1,n!==0&&(t._colorMask=n,r.colorMask((n&1)!==0,(n&2)!==0,(n&4)!==0,(n&8)!==0)),this._useCurrent()}pop(t){const s=this.renderer.gl;if(this.getStackLength()===0)s.disable(s.STENCIL_TEST);else{const r=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null,i=r?r._colorMask:15;i!==0&&(r._colorMask=0,s.colorMask(!1,!1,!1,!1)),s.stencilOp(s.KEEP,s.KEEP,s.DECR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,i!==0&&(r._colorMask=i,s.colorMask((i&1)!==0,(i&2)!==0,(i&4)!==0,(i&8)!==0)),this._useCurrent()}}_useCurrent(){const t=this.renderer.gl;t.stencilFunc(t.EQUAL,this.getStackLength(),4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)}}Op.extension={type:Z.RendererSystem,name:"stencil"};nt.add(Op);class Bp{constructor(t){this.renderer=t,this.plugins={},Object.defineProperties(this.plugins,{extract:{enumerable:!1,get(){return bt("7.0.0","renderer.plugins.extract has moved to renderer.extract"),t.extract}},prepare:{enumerable:!1,get(){return bt("7.0.0","renderer.plugins.prepare has moved to renderer.prepare"),t.prepare}},interaction:{enumerable:!1,get(){return bt("7.0.0","renderer.plugins.interaction has been deprecated, use renderer.events"),t.events}}})}init(){const t=this.rendererPlugins;for(const s in t)this.plugins[s]=new t[s](this.renderer)}destroy(){for(const t in this.plugins)this.plugins[t].destroy(),this.plugins[t]=null}}Bp.extension={type:[Z.RendererSystem,Z.CanvasRendererSystem],name:"_plugin"};nt.add(Bp);class Dp{constructor(t){this.renderer=t,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new kt,this.transform=null}update(t,s,r,i){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=s||this.sourceFrame||t,this.calculateProjection(this.destinationFrame,this.sourceFrame,r,i),this.transform&&this.projectionMatrix.append(this.transform);const n=this.renderer;n.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,n.globalUniforms.update(),n.shader.shader&&n.shader.syncUniformGroup(n.shader.shader.uniforms.globals)}calculateProjection(t,s,r,i){const n=this.projectionMatrix,o=i?-1:1;n.identity(),n.a=1/s.width*2,n.d=o*(1/s.height*2),n.tx=-1-s.x*n.a,n.ty=-o-s.y*n.d}setTransform(t){}destroy(){this.renderer=null}}Dp.extension={type:Z.RendererSystem,name:"projection"};nt.add(Dp);const RE=new jh;class Fp{constructor(t){this.renderer=t,this._tempMatrix=new kt}generateTexture(t,s){const{region:r,...i}=s||{},n=r||t.getLocalBounds(null,!0);n.width===0&&(n.width=1),n.height===0&&(n.height=1);const o=_r.create({width:n.width,height:n.height,...i});this._tempMatrix.tx=-n.x,this._tempMatrix.ty=-n.y;const a=t.transform;return t.transform=RE,this.renderer.render(t,{renderTexture:o,transform:this._tempMatrix,skipUpdateTransform:!!t.parent,blit:!0}),t.transform=a,o}destroy(){}}Fp.extension={type:[Z.RendererSystem,Z.CanvasRendererSystem],name:"textureGenerator"};nt.add(Fp);const Ys=new yt,_i=new yt;class Lp{constructor(t){this.renderer=t,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new yt,this.destinationFrame=new yt,this.viewportFrame=new yt}contextChange(){var s;const t=(s=this.renderer)==null?void 0:s.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(t&&t.alpha&&t.premultipliedAlpha)}bind(t=null,s,r){const i=this.renderer;this.current=t;let n,o,a;t?(n=t.baseTexture,a=n.resolution,s||(Ys.width=t.frame.width,Ys.height=t.frame.height,s=Ys),r||(_i.x=t.frame.x,_i.y=t.frame.y,_i.width=s.width,_i.height=s.height,r=_i),o=n.framebuffer):(a=i.resolution,s||(Ys.width=i._view.screen.width,Ys.height=i._view.screen.height,s=Ys),r||(r=Ys,r.width=s.width,r.height=s.height));const l=this.viewportFrame;l.x=r.x*a,l.y=r.y*a,l.width=r.width*a,l.height=r.height*a,t||(l.y=i.view.height-(l.y+l.height)),l.ceil(),this.renderer.framebuffer.bind(o,l),this.renderer.projection.update(r,s,a,!o),t?this.renderer.mask.setMaskStack(n.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(s),this.destinationFrame.copyFrom(r)}clear(t,s){const r=this.current?this.current.baseTexture.clear:this.renderer.background.backgroundColor,i=Ft.shared.setValue(t||r);(this.current&&this.current.baseTexture.alphaMode>0||!this.current&&this._rendererPremultipliedAlpha)&&i.premultiply(i.alpha);const n=this.destinationFrame,o=this.current?this.current.baseTexture:this.renderer._view.screen,a=n.width!==o.width||n.height!==o.height;if(a){let{x:l,y:h,width:c,height:u}=this.viewportFrame;l=Math.round(l),h=Math.round(h),c=Math.round(c),u=Math.round(u),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(l,h,c,u)}this.renderer.framebuffer.clear(i.red,i.green,i.blue,i.alpha,s),a&&this.renderer.scissor.pop()}resize(){this.bind(null)}reset(){this.bind(null)}destroy(){this.renderer=null}}Lp.extension={type:Z.RendererSystem,name:"renderTexture"};nt.add(Lp);class PE{constructor(t,s){this.program=t,this.uniformData=s,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null}}function ME(e,t){const s={},r=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES);for(let i=0;i<r;i++){const n=t.getActiveAttrib(e,i);if(n.name.startsWith("gl_"))continue;const o=yp(t,n.type),a={type:o,name:n.name,size:_p(o),location:t.getAttribLocation(e,n.name)};s[n.name]=a}return s}function OE(e,t){const s={},r=t.getProgramParameter(e,t.ACTIVE_UNIFORMS);for(let i=0;i<r;i++){const n=t.getActiveUniform(e,i),o=n.name.replace(/\[.*?\]$/,""),a=!!n.name.match(/\[.*?\]$/),l=yp(t,n.type);s[o]={name:o,index:i,type:l,size:n.size,isArray:a,value:mp(l,n.size)}}return s}function BE(e,t){var l;const s=$u(e,e.VERTEX_SHADER,t.vertexSrc),r=$u(e,e.FRAGMENT_SHADER,t.fragmentSrc),i=e.createProgram();e.attachShader(i,s),e.attachShader(i,r);const n=(l=t.extra)==null?void 0:l.transformFeedbackVaryings;if(n&&(typeof e.transformFeedbackVaryings!="function"?console.warn("TransformFeedback is not supported but TransformFeedbackVaryings are given."):e.transformFeedbackVaryings(i,n.names,n.bufferMode==="separate"?e.SEPARATE_ATTRIBS:e.INTERLEAVED_ATTRIBS)),e.linkProgram(i),e.getProgramParameter(i,e.LINK_STATUS)||lE(e,i,s,r),t.attributeData=ME(i,e),t.uniformData=OE(i,e),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(t.vertexSrc)){const h=Object.keys(t.attributeData);h.sort((c,u)=>c>u?1:-1);for(let c=0;c<h.length;c++)t.attributeData[h[c]].location=c,e.bindAttribLocation(i,c,h[c]);e.linkProgram(i)}e.deleteShader(s),e.deleteShader(r);const o={};for(const h in t.uniformData){const c=t.uniformData[h];o[h]={location:e.getUniformLocation(i,h),value:mp(c.type,c.size)}}return new PE(i,o)}function DE(e,t,s,r,i){s.buffer.update(i)}const FE={float:`
        data[offset] = v;
    `,vec2:`
        data[offset] = v[0];
        data[offset+1] = v[1];
    `,vec3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

    `,vec4:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];
        data[offset+3] = v[3];
    `,mat2:`
        data[offset] = v[0];
        data[offset+1] = v[1];

        data[offset+4] = v[2];
        data[offset+5] = v[3];
    `,mat3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];

        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];
    `,mat4:`
        for(var i = 0; i < 16; i++)
        {
            data[offset + i] = v[i];
        }
    `},Np={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:16*2,mat3:16*3,mat4:16*4};function LE(e){const t=e.map(n=>({data:n,offset:0,dataLen:0,dirty:0}));let s=0,r=0,i=0;for(let n=0;n<t.length;n++){const o=t[n];if(s=Np[o.data.type],o.data.size>1&&(s=Math.max(s,16)*o.data.size),o.dataLen=s,r%s!==0&&r<16){const a=r%s%16;r+=a,i+=a}r+s>16?(i=Math.ceil(i/16)*16,o.offset=i,i+=s,r=s):(o.offset=i,r+=s,i+=s)}return i=Math.ceil(i/16)*16,{uboElements:t,size:i}}function NE(e,t){const s=[];for(const r in e)t[r]&&s.push(t[r]);return s.sort((r,i)=>r.index-i.index),s}function UE(e,t){if(!e.autoManage)return{size:0,syncFunc:DE};const s=NE(e.uniforms,t),{uboElements:r,size:i}=LE(s),n=[`
    var v = null;
    var v2 = null;
    var cv = null;
    var t = 0;
    var gl = renderer.gl
    var index = 0;
    var data = buffer.data;
    `];for(let o=0;o<r.length;o++){const a=r[o],l=e.uniforms[a.data.name],h=a.data.name;let c=!1;for(let u=0;u<Vr.length;u++){const f=Vr[u];if(f.codeUbo&&f.test(a.data,l)){n.push(`offset = ${a.offset/4};`,Vr[u].codeUbo(a.data.name,l)),c=!0;break}}if(!c)if(a.data.size>1){const u=_p(a.data.type),f=Math.max(Np[a.data.type]/16,1),p=u/f,d=(4-p%4)%4;n.push(`
                cv = ud.${h}.value;
                v = uv.${h};
                offset = ${a.offset/4};

                t = 0;

                for(var i=0; i < ${a.data.size*f}; i++)
                {
                    for(var j = 0; j < ${p}; j++)
                    {
                        data[offset++] = v[t++];
                    }
                    offset += ${d};
                }

                `)}else{const u=FE[a.data.type];n.push(`
                cv = ud.${h}.value;
                v = uv.${h};
                offset = ${a.offset/4};
                ${u};
                `)}}return n.push(`
       renderer.buffer.update(buffer);
    `),{size:i,syncFunc:new Function("ud","uv","renderer","syncData","buffer",n.join(`
`))}}let kE=0;const Rn={textureCount:0,uboCount:0};class Up{constructor(t){this.destroyed=!1,this.renderer=t,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=kE++}systemCheck(){if(!cE())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")}contextChange(t){this.gl=t,this.reset()}bind(t,s){t.disposeRunner.add(this),t.uniforms.globals=this.renderer.globalUniforms;const r=t.program,i=r.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(t);return this.shader=t,this.program!==r&&(this.program=r,this.gl.useProgram(i.program)),s||(Rn.textureCount=0,Rn.uboCount=0,this.syncUniformGroup(t.uniformGroup,Rn)),i}setUniforms(t){const s=this.shader.program,r=s.glPrograms[this.renderer.CONTEXT_UID];s.syncUniforms(r.uniformData,t,this.renderer)}syncUniformGroup(t,s){const r=this.getGlProgram();(!t.static||t.dirtyId!==r.uniformDirtyGroups[t.id])&&(r.uniformDirtyGroups[t.id]=t.dirtyId,this.syncUniforms(t,r,s))}syncUniforms(t,s,r){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(s.uniformData,t.uniforms,this.renderer,r)}createSyncGroups(t){const s=this.getSignature(t,this.shader.program.uniformData,"u");return this.cache[s]||(this.cache[s]=nE(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[s],t.syncUniforms[this.shader.program.id]}syncUniformBufferGroup(t,s){const r=this.getGlProgram();if(!t.static||t.dirtyId!==0||!r.uniformGroups[t.id]){t.dirtyId=0;const i=r.uniformGroups[t.id]||this.createSyncBufferGroup(t,r,s);t.buffer.update(),i(r.uniformData,t.uniforms,this.renderer,Rn,t.buffer)}this.renderer.buffer.bindBufferBase(t.buffer,r.uniformBufferBindings[s])}createSyncBufferGroup(t,s,r){const{gl:i}=this.renderer;this.renderer.buffer.bind(t.buffer);const n=this.gl.getUniformBlockIndex(s.program,r);s.uniformBufferBindings[r]=this.shader.uniformBindCount,i.uniformBlockBinding(s.program,n,this.shader.uniformBindCount),this.shader.uniformBindCount++;const o=this.getSignature(t,this.shader.program.uniformData,"ubo");let a=this._uboCache[o];if(a||(a=this._uboCache[o]=UE(t,this.shader.program.uniformData)),t.autoManage){const l=new Float32Array(a.size/4);t.buffer.update(l)}return s.uniformGroups[t.id]=a.syncFunc,s.uniformGroups[t.id]}getSignature(t,s,r){const i=t.uniforms,n=[`${r}-`];for(const o in i)n.push(o),s[o]&&n.push(s[o].type);return n.join("-")}getGlProgram(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null}generateProgram(t){const s=this.gl,r=t.program,i=BE(s,r);return r.glPrograms[this.renderer.CONTEXT_UID]=i,i}reset(){this.program=null,this.shader=null}disposeShader(t){this.shader===t&&(this.shader=null)}destroy(){this.renderer=null,this.destroyed=!0}}Up.extension={type:Z.RendererSystem,name:"shader"};nt.add(Up);class zo{constructor(t){this.renderer=t}run(t){const{renderer:s}=this;s.runners.init.emit(s.options),t.hello&&console.log(`PixiJS 7.2.4 - ${s.rendererLogId} - https://pixijs.com`),s.resize(s.screen.width,s.screen.height)}destroy(){}}zo.defaultOptions={hello:!1};zo.extension={type:[Z.RendererSystem,Z.CanvasRendererSystem],name:"startup"};nt.add(zo);function GE(e,t=[]){return t[ut.NORMAL]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ut.ADD]=[e.ONE,e.ONE],t[ut.MULTIPLY]=[e.DST_COLOR,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ut.SCREEN]=[e.ONE,e.ONE_MINUS_SRC_COLOR,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ut.OVERLAY]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ut.DARKEN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ut.LIGHTEN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ut.COLOR_DODGE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ut.COLOR_BURN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ut.HARD_LIGHT]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ut.SOFT_LIGHT]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ut.DIFFERENCE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ut.EXCLUSION]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ut.HUE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ut.SATURATION]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ut.COLOR]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ut.LUMINOSITY]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ut.NONE]=[0,0],t[ut.NORMAL_NPM]=[e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ut.ADD_NPM]=[e.SRC_ALPHA,e.ONE,e.ONE,e.ONE],t[ut.SCREEN_NPM]=[e.SRC_ALPHA,e.ONE_MINUS_SRC_COLOR,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ut.SRC_IN]=[e.DST_ALPHA,e.ZERO],t[ut.SRC_OUT]=[e.ONE_MINUS_DST_ALPHA,e.ZERO],t[ut.SRC_ATOP]=[e.DST_ALPHA,e.ONE_MINUS_SRC_ALPHA],t[ut.DST_OVER]=[e.ONE_MINUS_DST_ALPHA,e.ONE],t[ut.DST_IN]=[e.ZERO,e.SRC_ALPHA],t[ut.DST_OUT]=[e.ZERO,e.ONE_MINUS_SRC_ALPHA],t[ut.DST_ATOP]=[e.ONE_MINUS_DST_ALPHA,e.SRC_ALPHA],t[ut.XOR]=[e.ONE_MINUS_DST_ALPHA,e.ONE_MINUS_SRC_ALPHA],t[ut.SUBTRACT]=[e.ONE,e.ONE,e.ONE,e.ONE,e.FUNC_REVERSE_SUBTRACT,e.FUNC_ADD],t}const HE=0,$E=1,WE=2,XE=3,zE=4,VE=5,Hl=class{constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=ut.NONE,this._blendEq=!1,this.map=[],this.map[HE]=this.setBlend,this.map[$E]=this.setOffset,this.map[WE]=this.setCullFace,this.map[XE]=this.setDepthTest,this.map[zE]=this.setFrontFace,this.map[VE]=this.setDepthMask,this.checks=[],this.defaultState=new Ss,this.defaultState.blend=!0}contextChange(e){this.gl=e,this.blendModes=GE(e),this.set(this.defaultState),this.reset()}set(e){if(e=e||this.defaultState,this.stateId!==e.data){let t=this.stateId^e.data,s=0;for(;t;)t&1&&this.map[s].call(this,!!(e.data&1<<s)),t=t>>1,s++;this.stateId=e.data}for(let t=0;t<this.checks.length;t++)this.checks[t](this,e)}forceState(e){e=e||this.defaultState;for(let t=0;t<this.map.length;t++)this.map[t].call(this,!!(e.data&1<<t));for(let t=0;t<this.checks.length;t++)this.checks[t](this,e);this.stateId=e.data}setBlend(e){this.updateCheck(Hl.checkBlendMode,e),this.gl[e?"enable":"disable"](this.gl.BLEND)}setOffset(e){this.updateCheck(Hl.checkPolygonOffset,e),this.gl[e?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(e){this.gl[e?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(e){this.gl.depthMask(e)}setCullFace(e){this.gl[e?"enable":"disable"](this.gl.CULL_FACE)}setFrontFace(e){this.gl.frontFace(this.gl[e?"CW":"CCW"])}setBlendMode(e){if(e===this.blendMode)return;this.blendMode=e;const t=this.blendModes[e],s=this.gl;t.length===2?s.blendFunc(t[0],t[1]):s.blendFuncSeparate(t[0],t[1],t[2],t[3]),t.length===6?(this._blendEq=!0,s.blendEquationSeparate(t[4],t[5])):this._blendEq&&(this._blendEq=!1,s.blendEquationSeparate(s.FUNC_ADD,s.FUNC_ADD))}setPolygonOffset(e,t){this.gl.polygonOffset(e,t)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)}updateCheck(e,t){const s=this.checks.indexOf(e);t&&s===-1?this.checks.push(e):!t&&s!==-1&&this.checks.splice(s,1)}static checkBlendMode(e,t){e.setBlendMode(t.blendMode)}static checkPolygonOffset(e,t){e.setPolygonOffset(1,t.polygonOffset)}destroy(){this.gl=null}};let kp=Hl;kp.extension={type:Z.RendererSystem,name:"state"};nt.add(kp);class jE extends Ji{constructor(){super(...arguments),this.runners={},this._systemsHash={}}setup(t){this.addRunners(...t.runners);const s=(t.priority??[]).filter(i=>t.systems[i]),r=[...s,...Object.keys(t.systems).filter(i=>!s.includes(i))];for(const i of r)this.addSystem(t.systems[i],i)}addRunners(...t){t.forEach(s=>{this.runners[s]=new Xe(s)})}addSystem(t,s){const r=new t(this);if(this[s])throw new Error(`Whoops! The name "${s}" is already in use`);this[s]=r,this._systemsHash[s]=r;for(const i in this.runners)this.runners[i].add(r);return this}emitWithCustomOptions(t,s){const r=Object.keys(this._systemsHash);t.items.forEach(i=>{const n=r.find(o=>this._systemsHash[o]===i);i[t.name](s[n])})}destroy(){Object.values(this.runners).forEach(t=>{t.destroy()}),this._systemsHash={}}}const Vn=class{constructor(e){this.renderer=e,this.count=0,this.checkCount=0,this.maxIdle=Vn.defaultMaxIdle,this.checkCountMax=Vn.defaultCheckCountMax,this.mode=Vn.defaultMode}postrender(){this.renderer.objectRenderer.renderingToScreen&&(this.count++,this.mode!==Uo.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){const e=this.renderer.texture,t=e.managedTextures;let s=!1;for(let r=0;r<t.length;r++){const i=t[r];!i.framebuffer&&this.count-i.touched>this.maxIdle&&(e.destroyTexture(i,!0),t[r]=null,s=!0)}if(s){let r=0;for(let i=0;i<t.length;i++)t[i]!==null&&(t[r++]=t[i]);t.length=r}}unload(e){const t=this.renderer.texture,s=e._texture;s&&!s.framebuffer&&t.destroyTexture(s);for(let r=e.children.length-1;r>=0;r--)this.unload(e.children[r])}destroy(){this.renderer=null}};let Se=Vn;Se.defaultMode=Uo.AUTO;Se.defaultMaxIdle=60*60;Se.defaultCheckCountMax=60*10;Se.extension={type:Z.RendererSystem,name:"textureGC"};nt.add(Se);class ka{constructor(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=lt.UNSIGNED_BYTE,this.internalFormat=z.RGBA,this.samplerType=0}}function YE(e){let t;return"WebGL2RenderingContext"in globalThis&&e instanceof globalThis.WebGL2RenderingContext?t={[lt.UNSIGNED_BYTE]:{[z.RGBA]:e.RGBA8,[z.RGB]:e.RGB8,[z.RG]:e.RG8,[z.RED]:e.R8,[z.RGBA_INTEGER]:e.RGBA8UI,[z.RGB_INTEGER]:e.RGB8UI,[z.RG_INTEGER]:e.RG8UI,[z.RED_INTEGER]:e.R8UI,[z.ALPHA]:e.ALPHA,[z.LUMINANCE]:e.LUMINANCE,[z.LUMINANCE_ALPHA]:e.LUMINANCE_ALPHA},[lt.BYTE]:{[z.RGBA]:e.RGBA8_SNORM,[z.RGB]:e.RGB8_SNORM,[z.RG]:e.RG8_SNORM,[z.RED]:e.R8_SNORM,[z.RGBA_INTEGER]:e.RGBA8I,[z.RGB_INTEGER]:e.RGB8I,[z.RG_INTEGER]:e.RG8I,[z.RED_INTEGER]:e.R8I},[lt.UNSIGNED_SHORT]:{[z.RGBA_INTEGER]:e.RGBA16UI,[z.RGB_INTEGER]:e.RGB16UI,[z.RG_INTEGER]:e.RG16UI,[z.RED_INTEGER]:e.R16UI,[z.DEPTH_COMPONENT]:e.DEPTH_COMPONENT16},[lt.SHORT]:{[z.RGBA_INTEGER]:e.RGBA16I,[z.RGB_INTEGER]:e.RGB16I,[z.RG_INTEGER]:e.RG16I,[z.RED_INTEGER]:e.R16I},[lt.UNSIGNED_INT]:{[z.RGBA_INTEGER]:e.RGBA32UI,[z.RGB_INTEGER]:e.RGB32UI,[z.RG_INTEGER]:e.RG32UI,[z.RED_INTEGER]:e.R32UI,[z.DEPTH_COMPONENT]:e.DEPTH_COMPONENT24},[lt.INT]:{[z.RGBA_INTEGER]:e.RGBA32I,[z.RGB_INTEGER]:e.RGB32I,[z.RG_INTEGER]:e.RG32I,[z.RED_INTEGER]:e.R32I},[lt.FLOAT]:{[z.RGBA]:e.RGBA32F,[z.RGB]:e.RGB32F,[z.RG]:e.RG32F,[z.RED]:e.R32F,[z.DEPTH_COMPONENT]:e.DEPTH_COMPONENT32F},[lt.HALF_FLOAT]:{[z.RGBA]:e.RGBA16F,[z.RGB]:e.RGB16F,[z.RG]:e.RG16F,[z.RED]:e.R16F},[lt.UNSIGNED_SHORT_5_6_5]:{[z.RGB]:e.RGB565},[lt.UNSIGNED_SHORT_4_4_4_4]:{[z.RGBA]:e.RGBA4},[lt.UNSIGNED_SHORT_5_5_5_1]:{[z.RGBA]:e.RGB5_A1},[lt.UNSIGNED_INT_2_10_10_10_REV]:{[z.RGBA]:e.RGB10_A2,[z.RGBA_INTEGER]:e.RGB10_A2UI},[lt.UNSIGNED_INT_10F_11F_11F_REV]:{[z.RGB]:e.R11F_G11F_B10F},[lt.UNSIGNED_INT_5_9_9_9_REV]:{[z.RGB]:e.RGB9_E5},[lt.UNSIGNED_INT_24_8]:{[z.DEPTH_STENCIL]:e.DEPTH24_STENCIL8},[lt.FLOAT_32_UNSIGNED_INT_24_8_REV]:{[z.DEPTH_STENCIL]:e.DEPTH32F_STENCIL8}}:t={[lt.UNSIGNED_BYTE]:{[z.RGBA]:e.RGBA,[z.RGB]:e.RGB,[z.ALPHA]:e.ALPHA,[z.LUMINANCE]:e.LUMINANCE,[z.LUMINANCE_ALPHA]:e.LUMINANCE_ALPHA},[lt.UNSIGNED_SHORT_5_6_5]:{[z.RGB]:e.RGB},[lt.UNSIGNED_SHORT_4_4_4_4]:{[z.RGBA]:e.RGBA},[lt.UNSIGNED_SHORT_5_5_5_1]:{[z.RGBA]:e.RGBA}},t}class Gp{constructor(t){this.renderer=t,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new mt,this.hasIntegerTextures=!1}contextChange(){const t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=YE(t);const s=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=s;for(let i=0;i<s;i++)this.boundTextures[i]=null;this.emptyTextures={};const r=new ka(t.createTexture());t.bindTexture(t.TEXTURE_2D,r.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=r,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new ka(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(let i=0;i<6;i++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+i,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(let i=0;i<this.boundTextures.length;i++)this.bind(null,i)}bind(t,s=0){const{gl:r}=this;if(t=t==null?void 0:t.castToBaseTexture(),t!=null&&t.valid&&!t.parentTextureArray){t.touched=this.renderer.textureGC.count;const i=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.boundTextures[s]!==t&&(this.currentLocation!==s&&(this.currentLocation=s,r.activeTexture(r.TEXTURE0+s)),r.bindTexture(t.target,i.texture)),i.dirtyId!==t.dirtyId?(this.currentLocation!==s&&(this.currentLocation=s,r.activeTexture(r.TEXTURE0+s)),this.updateTexture(t)):i.dirtyStyleId!==t.dirtyStyleId&&this.updateTextureStyle(t),this.boundTextures[s]=t}else this.currentLocation!==s&&(this.currentLocation=s,r.activeTexture(r.TEXTURE0+s)),r.bindTexture(r.TEXTURE_2D,this.emptyTextures[r.TEXTURE_2D].texture),this.boundTextures[s]=null}reset(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(let t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture}unbind(t){const{gl:s,boundTextures:r}=this;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(let i=0;i<r.length;i++)r[i]===this.unknownTexture&&this.bind(null,i)}for(let i=0;i<r.length;i++)r[i]===t&&(this.currentLocation!==i&&(s.activeTexture(s.TEXTURE0+i),this.currentLocation=i),s.bindTexture(t.target,this.emptyTextures[t.target].texture),r[i]=null)}ensureSamplerType(t){const{boundTextures:s,hasIntegerTextures:r,CONTEXT_UID:i}=this;if(r)for(let n=t-1;n>=0;--n){const o=s[n];o&&o._glTextures[i].samplerType!==yl.FLOAT&&this.renderer.texture.unbind(o)}}initTexture(t){const s=new ka(this.gl.createTexture());return s.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=s,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),s}initTextureType(t,s){var r;s.internalFormat=((r=this.internalFormats[t.type])==null?void 0:r[t.format])??t.format,this.webGLVersion===2&&t.type===lt.HALF_FLOAT?s.type=this.gl.HALF_FLOAT:s.type=t.type}updateTexture(t){var i;const s=t._glTextures[this.CONTEXT_UID];if(!s)return;const r=this.renderer;if(this.initTextureType(t,s),(i=t.resource)!=null&&i.upload(r,t,s))s.samplerType!==yl.FLOAT&&(this.hasIntegerTextures=!0);else{const n=t.realWidth,o=t.realHeight,a=r.gl;(s.width!==n||s.height!==o||s.dirtyId<0)&&(s.width=n,s.height=o,a.texImage2D(t.target,0,s.internalFormat,n,o,0,t.format,s.type,null))}t.dirtyStyleId!==s.dirtyStyleId&&this.updateTextureStyle(t),s.dirtyId=t.dirtyId}destroyTexture(t,s){const{gl:r}=this;if(t=t.castToBaseTexture(),t._glTextures[this.CONTEXT_UID]&&(this.unbind(t),r.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!s)){const i=this.managedTextures.indexOf(t);i!==-1&&Xr(this.managedTextures,i,1)}}updateTextureStyle(t){var r;const s=t._glTextures[this.CONTEXT_UID];s&&((t.mipmap===as.POW2||this.webGLVersion!==2)&&!t.isPowerOfTwo?s.mipmap=!1:s.mipmap=t.mipmap>=1,this.webGLVersion!==2&&!t.isPowerOfTwo?s.wrapMode=ks.CLAMP:s.wrapMode=t.wrapMode,(r=t.resource)!=null&&r.style(this.renderer,t,s)||this.setStyle(t,s),s.dirtyStyleId=t.dirtyStyleId)}setStyle(t,s){const r=this.gl;if(s.mipmap&&t.mipmap!==as.ON_MANUAL&&r.generateMipmap(t.target),r.texParameteri(t.target,r.TEXTURE_WRAP_S,s.wrapMode),r.texParameteri(t.target,r.TEXTURE_WRAP_T,s.wrapMode),s.mipmap){r.texParameteri(t.target,r.TEXTURE_MIN_FILTER,t.scaleMode===ys.LINEAR?r.LINEAR_MIPMAP_LINEAR:r.NEAREST_MIPMAP_NEAREST);const i=this.renderer.context.extensions.anisotropicFiltering;if(i&&t.anisotropicLevel>0&&t.scaleMode===ys.LINEAR){const n=Math.min(t.anisotropicLevel,r.getParameter(i.MAX_TEXTURE_MAX_ANISOTROPY_EXT));r.texParameterf(t.target,i.TEXTURE_MAX_ANISOTROPY_EXT,n)}}else r.texParameteri(t.target,r.TEXTURE_MIN_FILTER,t.scaleMode===ys.LINEAR?r.LINEAR:r.NEAREST);r.texParameteri(t.target,r.TEXTURE_MAG_FILTER,t.scaleMode===ys.LINEAR?r.LINEAR:r.NEAREST)}destroy(){this.renderer=null}}Gp.extension={type:Z.RendererSystem,name:"texture"};nt.add(Gp);class Hp{constructor(t){this.renderer=t}contextChange(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(t){const{gl:s,CONTEXT_UID:r}=this,i=t._glTransformFeedbacks[r]||this.createGLTransformFeedback(t);s.bindTransformFeedback(s.TRANSFORM_FEEDBACK,i)}unbind(){const{gl:t}=this;t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,null)}beginTransformFeedback(t,s){const{gl:r,renderer:i}=this;s&&i.shader.bind(s),r.beginTransformFeedback(t)}endTransformFeedback(){const{gl:t}=this;t.endTransformFeedback()}createGLTransformFeedback(t){const{gl:s,renderer:r,CONTEXT_UID:i}=this,n=s.createTransformFeedback();t._glTransformFeedbacks[i]=n,s.bindTransformFeedback(s.TRANSFORM_FEEDBACK,n);for(let o=0;o<t.buffers.length;o++){const a=t.buffers[o];a&&(r.buffer.update(a),a._glBuffers[i].refCount++,s.bindBufferBase(s.TRANSFORM_FEEDBACK_BUFFER,o,a._glBuffers[i].buffer||null))}return s.bindTransformFeedback(s.TRANSFORM_FEEDBACK,null),t.disposeRunner.add(this),n}disposeTransformFeedback(t,s){const r=t._glTransformFeedbacks[this.CONTEXT_UID],i=this.gl;t.disposeRunner.remove(this);const n=this.renderer.buffer;if(n)for(let o=0;o<t.buffers.length;o++){const a=t.buffers[o];if(!a)continue;const l=a._glBuffers[this.CONTEXT_UID];l&&(l.refCount--,l.refCount===0&&!s&&n.dispose(a,s))}r&&(s||i.deleteTransformFeedback(r),delete t._glTransformFeedbacks[this.CONTEXT_UID])}destroy(){this.renderer=null}}Hp.extension={type:Z.RendererSystem,name:"transformFeedback"};nt.add(Hp);class Vo{constructor(t){this.renderer=t}init(t){this.screen=new yt(0,0,t.width,t.height),this.element=t.view||q.ADAPTER.createCanvas(),this.resolution=t.resolution||q.RESOLUTION,this.autoDensity=!!t.autoDensity}resizeView(t,s){this.element.width=Math.round(t*this.resolution),this.element.height=Math.round(s*this.resolution);const r=this.element.width/this.resolution,i=this.element.height/this.resolution;this.screen.width=r,this.screen.height=i,this.autoDensity&&(this.element.style.width=`${r}px`,this.element.style.height=`${i}px`),this.renderer.emit("resize",r,i),this.renderer.runners.resize.emit(this.screen.width,this.screen.height)}destroy(t){var s;t&&((s=this.element.parentNode)==null||s.removeChild(this.element)),this.renderer=null,this.element=null,this.screen=null}}Vo.defaultOptions={width:800,height:600,resolution:q.RESOLUTION,autoDensity:!1};Vo.extension={type:[Z.RendererSystem,Z.CanvasRendererSystem],name:"_view"};nt.add(Vo);q.PREFER_ENV=gr.WEBGL2;q.STRICT_TEXTURE_CACHE=!1;q.RENDER_OPTIONS={...Xo.defaultOptions,...Wo.defaultOptions,...Vo.defaultOptions,...zo.defaultOptions};Object.defineProperties(q,{WRAP_MODE:{get(){return mt.defaultOptions.wrapMode},set(e){bt("7.1.0","settings.WRAP_MODE is deprecated, use BaseTexture.defaultOptions.wrapMode"),mt.defaultOptions.wrapMode=e}},SCALE_MODE:{get(){return mt.defaultOptions.scaleMode},set(e){bt("7.1.0","settings.SCALE_MODE is deprecated, use BaseTexture.defaultOptions.scaleMode"),mt.defaultOptions.scaleMode=e}},MIPMAP_TEXTURES:{get(){return mt.defaultOptions.mipmap},set(e){bt("7.1.0","settings.MIPMAP_TEXTURES is deprecated, use BaseTexture.defaultOptions.mipmap"),mt.defaultOptions.mipmap=e}},ANISOTROPIC_LEVEL:{get(){return mt.defaultOptions.anisotropicLevel},set(e){bt("7.1.0","settings.ANISOTROPIC_LEVEL is deprecated, use BaseTexture.defaultOptions.anisotropicLevel"),mt.defaultOptions.anisotropicLevel=e}},FILTER_RESOLUTION:{get(){return bt("7.1.0","settings.FILTER_RESOLUTION is deprecated, use Filter.defaultResolution"),le.defaultResolution},set(e){le.defaultResolution=e}},FILTER_MULTISAMPLE:{get(){return bt("7.1.0","settings.FILTER_MULTISAMPLE is deprecated, use Filter.defaultMultisample"),le.defaultMultisample},set(e){le.defaultMultisample=e}},SPRITE_MAX_TEXTURES:{get(){return we.defaultMaxTextures},set(e){bt("7.1.0","settings.SPRITE_MAX_TEXTURES is deprecated, use BatchRenderer.defaultMaxTextures"),we.defaultMaxTextures=e}},SPRITE_BATCH_SIZE:{get(){return we.defaultBatchSize},set(e){bt("7.1.0","settings.SPRITE_BATCH_SIZE is deprecated, use BatchRenderer.defaultBatchSize"),we.defaultBatchSize=e}},CAN_UPLOAD_SAME_BUFFER:{get(){return we.canUploadSameBuffer},set(e){bt("7.1.0","settings.CAN_UPLOAD_SAME_BUFFER is deprecated, use BatchRenderer.canUploadSameBuffer"),we.canUploadSameBuffer=e}},GC_MODE:{get(){return Se.defaultMode},set(e){bt("7.1.0","settings.GC_MODE is deprecated, use TextureGCSystem.defaultMode"),Se.defaultMode=e}},GC_MAX_IDLE:{get(){return Se.defaultMaxIdle},set(e){bt("7.1.0","settings.GC_MAX_IDLE is deprecated, use TextureGCSystem.defaultMaxIdle"),Se.defaultMaxIdle=e}},GC_MAX_CHECK_COUNT:{get(){return Se.defaultCheckCountMax},set(e){bt("7.1.0","settings.GC_MAX_CHECK_COUNT is deprecated, use TextureGCSystem.defaultCheckCountMax"),Se.defaultCheckCountMax=e}},PRECISION_VERTEX:{get(){return ke.defaultVertexPrecision},set(e){bt("7.1.0","settings.PRECISION_VERTEX is deprecated, use Program.defaultVertexPrecision"),ke.defaultVertexPrecision=e}},PRECISION_FRAGMENT:{get(){return ke.defaultFragmentPrecision},set(e){bt("7.1.0","settings.PRECISION_FRAGMENT is deprecated, use Program.defaultFragmentPrecision"),ke.defaultFragmentPrecision=e}}});var Xs=(e=>(e[e.INTERACTION=50]="INTERACTION",e[e.HIGH=25]="HIGH",e[e.NORMAL=0]="NORMAL",e[e.LOW=-25]="LOW",e[e.UTILITY=-50]="UTILITY",e))(Xs||{});class Ga{constructor(t,s=null,r=0,i=!1){this.next=null,this.previous=null,this._destroyed=!1,this.fn=t,this.context=s,this.priority=r,this.once=i}match(t,s=null){return this.fn===t&&this.context===s}emit(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));const s=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),s}connect(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this}destroy(t=!1){this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const s=this.next;return this.next=t?null:s,this.previous=null,s}}const xe=class{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new Ga(null,null,1/0),this.deltaMS=1/xe.targetFPMS,this.elapsedMS=1/xe.targetFPMS,this._tick=e=>{this._requestId=null,this.started&&(this.update(e),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(e,t,s=Xs.NORMAL){return this._addListener(new Ga(e,t,s))}addOnce(e,t,s=Xs.NORMAL){return this._addListener(new Ga(e,t,s,!0))}_addListener(e){let t=this._head.next,s=this._head;if(!t)e.connect(s);else{for(;t;){if(e.priority>t.priority){e.connect(s);break}s=t,t=t.next}e.previous||e.connect(s)}return this._startIfPossible(),this}remove(e,t){let s=this._head.next;for(;s;)s.match(e,t)?s=s.destroy():s=s.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let e=0,t=this._head;for(;t=t.next;)e++;return e}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let e=this._head.next;for(;e;)e=e.destroy(!0);this._head.destroy(),this._head=null}}update(e=performance.now()){let t;if(e>this.lastTime){if(t=this.elapsedMS=e-this.lastTime,t>this._maxElapsedMS&&(t=this._maxElapsedMS),t*=this.speed,this._minElapsedMS){const i=e-this._lastFrame|0;if(i<this._minElapsedMS)return;this._lastFrame=e-i%this._minElapsedMS}this.deltaMS=t,this.deltaTime=this.deltaMS*xe.targetFPMS;const s=this._head;let r=s.next;for(;r;)r=r.emit(this.deltaTime);s.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=e}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(e){const t=Math.min(this.maxFPS,e),s=Math.min(Math.max(0,t)/1e3,xe.targetFPMS);this._maxElapsedMS=1/s}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(e){if(e===0)this._minElapsedMS=0;else{const t=Math.max(this.minFPS,e);this._minElapsedMS=1/(t/1e3)}}static get shared(){if(!xe._shared){const e=xe._shared=new xe;e.autoStart=!0,e._protected=!0}return xe._shared}static get system(){if(!xe._system){const e=xe._system=new xe;e.autoStart=!0,e._protected=!0}return xe._system}};let jt=xe;jt.targetFPMS=.06;Object.defineProperties(q,{TARGET_FPMS:{get(){return jt.targetFPMS},set(e){bt("7.1.0","settings.TARGET_FPMS is deprecated, use Ticker.targetFPMS"),jt.targetFPMS=e}}});class $p{static init(t){t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set(s){this._ticker&&this._ticker.remove(this.render,this),this._ticker=s,s&&s.add(this.render,this,Xs.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?jt.shared:new jt,t.autoStart&&this.start()}static destroy(){if(this._ticker){const t=this._ticker;this.ticker=null,t.destroy()}}}$p.extension=Z.Application;nt.add($p);const Wp=[];nt.handleByList(Z.Renderer,Wp);function KE(e){for(const t of Wp)if(t.test(e))return new t(e);throw new Error("Unable to auto-detect a suitable renderer.")}var qE=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,ZE=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const JE=qE,Xp=ZE;class zp{constructor(t){this.renderer=t}contextChange(t){let s;if(this.renderer.context.webGLVersion===1){const r=t.getParameter(t.FRAMEBUFFER_BINDING);t.bindFramebuffer(t.FRAMEBUFFER,null),s=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.FRAMEBUFFER,r)}else{const r=t.getParameter(t.DRAW_FRAMEBUFFER_BINDING);t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),s=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,r)}s>=Vt.HIGH?this.multisample=Vt.HIGH:s>=Vt.MEDIUM?this.multisample=Vt.MEDIUM:s>=Vt.LOW?this.multisample=Vt.LOW:this.multisample=Vt.NONE}destroy(){}}zp.extension={type:Z.RendererSystem,name:"_multisample"};nt.add(zp);class QE{constructor(t){this.buffer=t||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}}class Vp{constructor(t){this.renderer=t,this.managedBuffers={},this.boundBufferBases={}}destroy(){this.renderer=null}contextChange(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(t){const{gl:s,CONTEXT_UID:r}=this,i=t._glBuffers[r]||this.createGLBuffer(t);s.bindBuffer(t.type,i.buffer)}unbind(t){const{gl:s}=this;s.bindBuffer(t,null)}bindBufferBase(t,s){const{gl:r,CONTEXT_UID:i}=this;if(this.boundBufferBases[s]!==t){const n=t._glBuffers[i]||this.createGLBuffer(t);this.boundBufferBases[s]=t,r.bindBufferBase(r.UNIFORM_BUFFER,s,n.buffer)}}bindBufferRange(t,s,r){const{gl:i,CONTEXT_UID:n}=this;r=r||0;const o=t._glBuffers[n]||this.createGLBuffer(t);i.bindBufferRange(i.UNIFORM_BUFFER,s||0,o.buffer,r*256,256)}update(t){const{gl:s,CONTEXT_UID:r}=this,i=t._glBuffers[r]||this.createGLBuffer(t);if(t._updateID!==i.updateID)if(i.updateID=t._updateID,s.bindBuffer(t.type,i.buffer),i.byteLength>=t.data.byteLength)s.bufferSubData(t.type,0,t.data);else{const n=t.static?s.STATIC_DRAW:s.DYNAMIC_DRAW;i.byteLength=t.data.byteLength,s.bufferData(t.type,t.data,n)}}dispose(t,s){if(!this.managedBuffers[t.id])return;delete this.managedBuffers[t.id];const r=t._glBuffers[this.CONTEXT_UID],i=this.gl;t.disposeRunner.remove(this),r&&(s||i.deleteBuffer(r.buffer),delete t._glBuffers[this.CONTEXT_UID])}disposeAll(t){const s=Object.keys(this.managedBuffers);for(let r=0;r<s.length;r++)this.dispose(this.managedBuffers[s[r]],t)}createGLBuffer(t){const{CONTEXT_UID:s,gl:r}=this;return t._glBuffers[s]=new QE(r.createBuffer()),this.managedBuffers[t.id]=t,t.disposeRunner.add(this),t._glBuffers[s]}}Vp.extension={type:Z.RendererSystem,name:"buffer"};nt.add(Vp);class jp{constructor(t){this.renderer=t}render(t,s){const r=this.renderer;let i,n,o,a;if(s&&(i=s.renderTexture,n=s.clear,o=s.transform,a=s.skipUpdateTransform),this.renderingToScreen=!i,r.runners.prerender.emit(),r.emit("prerender"),r.projection.transform=o,!r.context.isLost){if(i||(this.lastObjectRendered=t),!a){const l=t.enableTempParent();t.updateTransform(),t.disableTempParent(l)}r.renderTexture.bind(i),r.batch.currentRenderer.start(),(n??r.background.clearBeforeRender)&&r.renderTexture.clear(),t.render(r),r.batch.currentRenderer.flush(),i&&(s.blit&&r.framebuffer.blit(),i.baseTexture.update()),r.runners.postrender.emit(),r.projection.transform=null,r.emit("postrender")}}destroy(){this.renderer=null,this.lastObjectRendered=null}}jp.extension={type:Z.RendererSystem,name:"objectRenderer"};nt.add(jp);const $l=class extends jE{constructor(e){super(),this.type=Nd.WEBGL,e=Object.assign({},q.RENDER_OPTIONS,e),this.gl=null,this.CONTEXT_UID=0,this.globalUniforms=new ze({projectionMatrix:new kt},!0);const t={runners:["init","destroy","contextChange","resolutionChange","reset","update","postrender","prerender","resize"],systems:$l.__systems,priority:["_view","textureGenerator","background","_plugin","startup","context","state","texture","buffer","geometry","framebuffer","transformFeedback","mask","scissor","stencil","projection","textureGC","filter","renderTexture","batch","objectRenderer","_multisample"]};this.setup(t),"useContextAlpha"in e&&(bt("7.0.0","options.useContextAlpha is deprecated, use options.premultipliedAlpha and options.backgroundAlpha instead"),e.premultipliedAlpha=e.useContextAlpha&&e.useContextAlpha!=="notMultiplied",e.backgroundAlpha=e.useContextAlpha===!1?1:e.backgroundAlpha),this._plugin.rendererPlugins=$l.__plugins,this.options=e,this.startup.run(this.options)}static test(e){return e!=null&&e.forceCanvas?!1:T0()}render(e,t){this.objectRenderer.render(e,t)}resize(e,t){this._view.resizeView(e,t)}reset(){return this.runners.reset.emit(),this}clear(){this.renderTexture.bind(),this.renderTexture.clear()}destroy(e=!1){this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:e}),super.destroy()}get plugins(){return this._plugin.plugins}get multisample(){return this._multisample.multisample}get width(){return this._view.element.width}get height(){return this._view.element.height}get resolution(){return this._view.resolution}set resolution(e){this._view.resolution=e,this.runners.resolutionChange.emit(e)}get autoDensity(){return this._view.autoDensity}get view(){return this._view.element}get screen(){return this._view.screen}get lastObjectRendered(){return this.objectRenderer.lastObjectRendered}get renderingToScreen(){return this.objectRenderer.renderingToScreen}get rendererLogId(){return`WebGL ${this.context.webGLVersion}`}get clearBeforeRender(){return bt("7.0.0","renderer.clearBeforeRender has been deprecated, please use renderer.background.clearBeforeRender instead."),this.background.clearBeforeRender}get useContextAlpha(){return bt("7.0.0","renderer.useContextAlpha has been deprecated, please use renderer.context.premultipliedAlpha instead."),this.context.useContextAlpha}get preserveDrawingBuffer(){return bt("7.0.0","renderer.preserveDrawingBuffer has been deprecated, we cannot truly know this unless pixi created the context"),this.context.preserveDrawingBuffer}get backgroundColor(){return bt("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color}set backgroundColor(e){bt("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color=e}get backgroundAlpha(){return bt("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha}set backgroundAlpha(e){bt("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha=e}get powerPreference(){return bt("7.0.0","renderer.powerPreference has been deprecated, we can only know this if pixi creates the context"),this.context.powerPreference}generateTexture(e,t){return this.textureGenerator.generateTexture(e,t)}};let hi=$l;hi.extension={type:Z.Renderer,priority:1};hi.__plugins={};hi.__systems={};nt.handleByMap(Z.RendererPlugin,hi.__plugins);nt.handleByMap(Z.RendererSystem,hi.__systems);nt.add(hi);class Yp extends ji{constructor(t,s){const{width:r,height:i}=s||{};super(r,i),this.items=[],this.itemDirtyIds=[];for(let n=0;n<t;n++){const o=new mt;this.items.push(o),this.itemDirtyIds.push(-2)}this.length=t,this._load=null,this.baseTexture=null}initFromArray(t,s){for(let r=0;r<this.length;r++)t[r]&&(t[r].castToBaseTexture?this.addBaseTextureAt(t[r].castToBaseTexture(),r):t[r]instanceof ji?this.addResourceAt(t[r],r):this.addResourceAt(cp(t[r],s),r))}dispose(){for(let t=0,s=this.length;t<s;t++)this.items[t].destroy();this.items=null,this.itemDirtyIds=null,this._load=null}addResourceAt(t,s){if(!this.items[s])throw new Error(`Index ${s} is out of bounds`);return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[s].setResource(t),this}bind(t){if(this.baseTexture!==null)throw new Error("Only one base texture per TextureArray is allowed");super.bind(t);for(let s=0;s<this.length;s++)this.items[s].parentTextureArray=t,this.items[s].on("update",t.update,t)}unbind(t){super.unbind(t);for(let s=0;s<this.length;s++)this.items[s].parentTextureArray=null,this.items[s].off("update",t.update,t)}load(){if(this._load)return this._load;const s=this.items.map(r=>r.resource).filter(r=>r).map(r=>r.load());return this._load=Promise.all(s).then(()=>{const{realWidth:r,realHeight:i}=this.items[0];return this.resize(r,i),Promise.resolve(this)}),this._load}}class tb extends Yp{constructor(t,s){const{width:r,height:i}=s||{};let n,o;Array.isArray(t)?(n=t,o=t.length):o=t,super(o,{width:r,height:i}),n&&this.initFromArray(n,s)}addBaseTextureAt(t,s){if(t.resource)this.addResourceAt(t.resource,s);else throw new Error("ArrayResource does not support RenderTexture");return this}bind(t){super.bind(t),t.target=Gr.TEXTURE_2D_ARRAY}upload(t,s,r){const{length:i,itemDirtyIds:n,items:o}=this,{gl:a}=t;r.dirtyId<0&&a.texImage3D(a.TEXTURE_2D_ARRAY,0,r.internalFormat,this._width,this._height,i,0,s.format,r.type,null);for(let l=0;l<i;l++){const h=o[l];n[l]<h.dirtyId&&(n[l]=h.dirtyId,h.valid&&a.texSubImage3D(a.TEXTURE_2D_ARRAY,0,0,0,l,h.resource.width,h.resource.height,1,s.format,r.type,h.resource.source))}return!0}}class eb extends Ws{constructor(t){super(t)}static test(t){const{OffscreenCanvas:s}=globalThis;return s&&t instanceof s?!0:globalThis.HTMLCanvasElement&&t instanceof HTMLCanvasElement}}const Ti=class extends Yp{constructor(e,t){const{width:s,height:r,autoLoad:i,linkBaseTexture:n}=t||{};if(e&&e.length!==Ti.SIDES)throw new Error(`Invalid length. Got ${e.length}, expected 6`);super(6,{width:s,height:r});for(let o=0;o<Ti.SIDES;o++)this.items[o].target=Gr.TEXTURE_CUBE_MAP_POSITIVE_X+o;this.linkBaseTexture=n!==!1,e&&this.initFromArray(e,t),i!==!1&&this.load()}bind(e){super.bind(e),e.target=Gr.TEXTURE_CUBE_MAP}addBaseTextureAt(e,t,s){if(s===void 0&&(s=this.linkBaseTexture),!this.items[t])throw new Error(`Index ${t} is out of bounds`);if(!this.linkBaseTexture||e.parentTextureArray||Object.keys(e._glTextures).length>0)if(e.resource)this.addResourceAt(e.resource,t);else throw new Error("CubeResource does not support copying of renderTexture.");else e.target=Gr.TEXTURE_CUBE_MAP_POSITIVE_X+t,e.parentTextureArray=this.baseTexture,this.items[t]=e;return e.valid&&!this.valid&&this.resize(e.realWidth,e.realHeight),this.items[t]=e,this}upload(e,t,s){const r=this.itemDirtyIds;for(let i=0;i<Ti.SIDES;i++){const n=this.items[i];(r[i]<n.dirtyId||s.dirtyId<t.dirtyId)&&(n.valid&&n.resource?(n.resource.upload(e,n,s),r[i]=n.dirtyId):r[i]<-1&&(e.gl.texImage2D(n.target,0,s.internalFormat,t.realWidth,t.realHeight,0,t.format,s.type,null),r[i]=-1))}return!0}static test(e){return Array.isArray(e)&&e.length===Ti.SIDES}};let Kp=Ti;Kp.SIDES=6;class Dr extends Ws{constructor(t,s){s=s||{};let r,i;typeof t=="string"?(r=Dr.EMPTY,i=t):(r=t,i=null),super(r),this.url=i,this.crossOrigin=s.crossOrigin??!0,this.alphaMode=typeof s.alphaMode=="number"?s.alphaMode:null,this._load=null,s.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(async(t,s)=>{if(this.url===null){t(this);return}try{const r=await q.ADAPTER.fetch(this.url,{mode:this.crossOrigin?"cors":"no-cors"});if(this.destroyed)return;const i=await r.blob();if(this.destroyed)return;const n=await createImageBitmap(i,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===Ve.UNPACK?"premultiply":"none"});if(this.destroyed)return;this.source=n,this.update(),t(this)}catch(r){if(this.destroyed)return;s(r),this.onError.emit(r)}}),this._load)}upload(t,s,r){return this.source instanceof ImageBitmap?(typeof this.alphaMode=="number"&&(s.alphaMode=this.alphaMode),super.upload(t,s,r)):(this.load(),!1)}dispose(){this.source instanceof ImageBitmap&&this.source.close(),super.dispose(),this._load=null}static test(t){return!!globalThis.createImageBitmap&&typeof ImageBitmap<"u"&&(typeof t=="string"||t instanceof ImageBitmap)}static get EMPTY(){return Dr._EMPTY=Dr._EMPTY??q.ADAPTER.createCanvas(0,0),Dr._EMPTY}}const jn=class extends Ws{constructor(e,t){t=t||{},super(q.ADAPTER.createCanvas()),this._width=0,this._height=0,this.svg=e,this.scale=t.scale||1,this._overrideWidth=t.width,this._overrideHeight=t.height,this._resolve=null,this._crossorigin=t.crossorigin,this._load=null,t.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(e=>{if(this._resolve=()=>{this.resize(this.source.width,this.source.height),e(this)},jn.SVG_XML.test(this.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");this.svg=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(this.svg)))}`}this._loadSvg()}),this._load)}_loadSvg(){const e=new Image;Ws.crossOrigin(e,this.svg,this._crossorigin),e.src=this.svg,e.onerror=t=>{this._resolve&&(e.onerror=null,this.onError.emit(t))},e.onload=()=>{if(!this._resolve)return;const t=e.width,s=e.height;if(!t||!s)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");let r=t*this.scale,i=s*this.scale;(this._overrideWidth||this._overrideHeight)&&(r=this._overrideWidth||this._overrideHeight/s*t,i=this._overrideHeight||this._overrideWidth/t*s),r=Math.round(r),i=Math.round(i);const n=this.source;n.width=r,n.height=i,n._pixiId=`canvas_${dr()}`,n.getContext("2d").drawImage(e,0,0,t,s,0,0,r,i),this._resolve(),this._resolve=null}}static getSize(e){const t=jn.SVG_SIZE.exec(e),s={};return t&&(s[t[1]]=Math.round(parseFloat(t[3])),s[t[5]]=Math.round(parseFloat(t[7]))),s}dispose(){super.dispose(),this._resolve=null,this._crossorigin=null}static test(e,t){return t==="svg"||typeof e=="string"&&e.startsWith("data:image/svg+xml")||typeof e=="string"&&jn.SVG_XML.test(e)}};let Yi=jn;Yi.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m;Yi.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;const Wl=class extends Ws{constructor(e,t){if(t=t||{},!(e instanceof HTMLVideoElement)){const s=document.createElement("video");s.setAttribute("preload","auto"),s.setAttribute("webkit-playsinline",""),s.setAttribute("playsinline",""),typeof e=="string"&&(e=[e]);const r=e[0].src||e[0];Ws.crossOrigin(s,r,t.crossorigin);for(let i=0;i<e.length;++i){const n=document.createElement("source");let{src:o,mime:a}=e[i];o=o||e[i];const l=o.split("?").shift().toLowerCase(),h=l.slice(l.lastIndexOf(".")+1);a=a||Wl.MIME_TYPES[h]||`video/${h}`,n.src=o,n.type=a,s.appendChild(n)}e=s}super(e),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=t.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=t.autoPlay!==!1,this._load=null,this._resolve=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),t.autoLoad!==!1&&this.load()}update(e=0){if(!this.destroyed){const t=jt.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-t),(!this._updateFPS||this._msToNextUpdate<=0)&&(super.update(),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}}load(){if(this._load)return this._load;const e=this.source;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart.bind(this)),e.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlay),e.addEventListener("error",this._onError,!0)),this._load=new Promise(t=>{this.valid?t(this):(this._resolve=t,e.load())}),this._load}_onError(e){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(e)}_isSourcePlaying(){const e=this.source;return!e.paused&&!e.ended&&this._isSourceReady()}_isSourceReady(){return this.source.readyState>2}_onPlayStart(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(jt.shared.add(this.update,this),this._isConnectedToTicker=!0)}_onPlayStop(){this._isConnectedToTicker&&(jt.shared.remove(this.update,this),this._isConnectedToTicker=!1)}_onCanPlay(){const e=this.source;e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlay);const t=this.valid;this.resize(e.videoWidth,e.videoHeight),!t&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&e.play()}dispose(){this._isConnectedToTicker&&(jt.shared.remove(this.update,this),this._isConnectedToTicker=!1);const e=this.source;e&&(e.removeEventListener("error",this._onError,!0),e.pause(),e.src="",e.load()),super.dispose()}get autoUpdate(){return this._autoUpdate}set autoUpdate(e){e!==this._autoUpdate&&(this._autoUpdate=e,!this._autoUpdate&&this._isConnectedToTicker?(jt.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(jt.shared.add(this.update,this),this._isConnectedToTicker=!0))}get updateFPS(){return this._updateFPS}set updateFPS(e){e!==this._updateFPS&&(this._updateFPS=e)}static test(e,t){return globalThis.HTMLVideoElement&&e instanceof HTMLVideoElement||Wl.TYPES.includes(t)}};let Yh=Wl;Yh.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"];Yh.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};Ll.push(Dr,Ep,eb,Yh,Yi,tn,Kp,tb);class go{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}clear(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}getRectangle(t){return this.minX>this.maxX||this.minY>this.maxY?yt.EMPTY:(t=t||new yt(0,0,1,1),t.x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)}addPoint(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)}addPointMatrix(t,s){const{a:r,b:i,c:n,d:o,tx:a,ty:l}=t,h=r*s.x+n*s.y+a,c=i*s.x+o*s.y+l;this.minX=Math.min(this.minX,h),this.maxX=Math.max(this.maxX,h),this.minY=Math.min(this.minY,c),this.maxY=Math.max(this.maxY,c)}addQuad(t){let s=this.minX,r=this.minY,i=this.maxX,n=this.maxY,o=t[0],a=t[1];s=o<s?o:s,r=a<r?a:r,i=o>i?o:i,n=a>n?a:n,o=t[2],a=t[3],s=o<s?o:s,r=a<r?a:r,i=o>i?o:i,n=a>n?a:n,o=t[4],a=t[5],s=o<s?o:s,r=a<r?a:r,i=o>i?o:i,n=a>n?a:n,o=t[6],a=t[7],s=o<s?o:s,r=a<r?a:r,i=o>i?o:i,n=a>n?a:n,this.minX=s,this.minY=r,this.maxX=i,this.maxY=n}addFrame(t,s,r,i,n){this.addFrameMatrix(t.worldTransform,s,r,i,n)}addFrameMatrix(t,s,r,i,n){const o=t.a,a=t.b,l=t.c,h=t.d,c=t.tx,u=t.ty;let f=this.minX,p=this.minY,d=this.maxX,m=this.maxY,g=o*s+l*r+c,y=a*s+h*r+u;f=g<f?g:f,p=y<p?y:p,d=g>d?g:d,m=y>m?y:m,g=o*i+l*r+c,y=a*i+h*r+u,f=g<f?g:f,p=y<p?y:p,d=g>d?g:d,m=y>m?y:m,g=o*s+l*n+c,y=a*s+h*n+u,f=g<f?g:f,p=y<p?y:p,d=g>d?g:d,m=y>m?y:m,g=o*i+l*n+c,y=a*i+h*n+u,f=g<f?g:f,p=y<p?y:p,d=g>d?g:d,m=y>m?y:m,this.minX=f,this.minY=p,this.maxX=d,this.maxY=m}addVertexData(t,s,r){let i=this.minX,n=this.minY,o=this.maxX,a=this.maxY;for(let l=s;l<r;l+=2){const h=t[l],c=t[l+1];i=h<i?h:i,n=c<n?c:n,o=h>o?h:o,a=c>a?c:a}this.minX=i,this.minY=n,this.maxX=o,this.maxY=a}addVertices(t,s,r,i){this.addVerticesMatrix(t.worldTransform,s,r,i)}addVerticesMatrix(t,s,r,i,n=0,o=n){const a=t.a,l=t.b,h=t.c,c=t.d,u=t.tx,f=t.ty;let p=this.minX,d=this.minY,m=this.maxX,g=this.maxY;for(let y=r;y<i;y+=2){const E=s[y],_=s[y+1],v=a*E+h*_+u,S=c*_+l*E+f;p=Math.min(p,v-n),m=Math.max(m,v+n),d=Math.min(d,S-o),g=Math.max(g,S+o)}this.minX=p,this.minY=d,this.maxX=m,this.maxY=g}addBounds(t){const s=this.minX,r=this.minY,i=this.maxX,n=this.maxY;this.minX=t.minX<s?t.minX:s,this.minY=t.minY<r?t.minY:r,this.maxX=t.maxX>i?t.maxX:i,this.maxY=t.maxY>n?t.maxY:n}addBoundsMask(t,s){const r=t.minX>s.minX?t.minX:s.minX,i=t.minY>s.minY?t.minY:s.minY,n=t.maxX<s.maxX?t.maxX:s.maxX,o=t.maxY<s.maxY?t.maxY:s.maxY;if(r<=n&&i<=o){const a=this.minX,l=this.minY,h=this.maxX,c=this.maxY;this.minX=r<a?r:a,this.minY=i<l?i:l,this.maxX=n>h?n:h,this.maxY=o>c?o:c}}addBoundsMatrix(t,s){this.addFrameMatrix(s,t.minX,t.minY,t.maxX,t.maxY)}addBoundsArea(t,s){const r=t.minX>s.x?t.minX:s.x,i=t.minY>s.y?t.minY:s.y,n=t.maxX<s.x+s.width?t.maxX:s.x+s.width,o=t.maxY<s.y+s.height?t.maxY:s.y+s.height;if(r<=n&&i<=o){const a=this.minX,l=this.minY,h=this.maxX,c=this.maxY;this.minX=r<a?r:a,this.minY=i<l?i:l,this.maxX=n>h?n:h,this.maxY=o>c?o:c}}pad(t=0,s=t){this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=s,this.maxY+=s)}addFramePad(t,s,r,i,n,o){t-=n,s-=o,r+=n,i+=o,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>r?this.maxX:r,this.minY=this.minY<s?this.minY:s,this.maxY=this.maxY>i?this.maxY:i}}class Xt extends Ji{constructor(){super(),this.tempDisplayObjectParent=null,this.transform=new jh,this.alpha=1,this.visible=!0,this.renderable=!0,this.cullable=!1,this.cullArea=null,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new go,this._localBounds=null,this._boundsID=0,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._maskRefCount=0,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}static mixin(t){const s=Object.keys(t);for(let r=0;r<s.length;++r){const i=s[r];Object.defineProperty(Xt.prototype,i,Object.getOwnPropertyDescriptor(t,i))}}get destroyed(){return this._destroyed}_recursivePostUpdateTransform(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)}updateTransform(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha}getBounds(t,s){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),s||(this._boundsRect||(this._boundsRect=new yt),s=this._boundsRect),this._bounds.getRectangle(s)}getLocalBounds(t){t||(this._localBoundsRect||(this._localBoundsRect=new yt),t=this._localBoundsRect),this._localBounds||(this._localBounds=new go);const s=this.transform,r=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform;const i=this._bounds,n=this._boundsID;this._bounds=this._localBounds;const o=this.getBounds(!1,t);return this.parent=r,this.transform=s,this._bounds=i,this._bounds.updateID+=this._boundsID-n,o}toGlobal(t,s,r=!1){return r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,s)}toLocal(t,s,r,i){return s&&(t=s.toGlobal(t,r,i)),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,r)}setParent(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t}removeFromParent(){var t;(t=this.parent)==null||t.removeChild(this)}setTransform(t=0,s=0,r=1,i=1,n=0,o=0,a=0,l=0,h=0){return this.position.x=t,this.position.y=s,this.scale.x=r||1,this.scale.y=i||1,this.rotation=n,this.skew.x=o,this.skew.y=a,this.pivot.x=l,this.pivot.y=h,this}destroy(t){this.removeFromParent(),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.eventMode="auto",this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()}get _tempDisplayObjectParent(){return this.tempDisplayObjectParent===null&&(this.tempDisplayObjectParent=new sb),this.tempDisplayObjectParent}enableTempParent(){const t=this.parent;return this.parent=this._tempDisplayObjectParent,t}disableTempParent(t){this.parent=t}get x(){return this.position.x}set x(t){this.transform.position.x=t}get y(){return this.position.y}set y(t){this.transform.position.y=t}get worldTransform(){return this.transform.worldTransform}get localTransform(){return this.transform.localTransform}get position(){return this.transform.position}set position(t){this.transform.position.copyFrom(t)}get scale(){return this.transform.scale}set scale(t){this.transform.scale.copyFrom(t)}get pivot(){return this.transform.pivot}set pivot(t){this.transform.pivot.copyFrom(t)}get skew(){return this.transform.skew}set skew(t){this.transform.skew.copyFrom(t)}get rotation(){return this.transform.rotation}set rotation(t){this.transform.rotation=t}get angle(){return this.transform.rotation*J0}set angle(t){this.transform.rotation=t*Q0}get zIndex(){return this._zIndex}set zIndex(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)}get worldVisible(){let t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0}get mask(){return this._mask}set mask(t){if(this._mask!==t){if(this._mask){const s=this._mask.isMaskData?this._mask.maskObject:this._mask;s&&(s._maskRefCount--,s._maskRefCount===0&&(s.renderable=!0,s.isMask=!1))}if(this._mask=t,this._mask){const s=this._mask.isMaskData?this._mask.maskObject:this._mask;s&&(s._maskRefCount===0&&(s.renderable=!1,s.isMask=!0),s._maskRefCount++)}}}}class sb extends Xt{constructor(){super(...arguments),this.sortDirty=null}}Xt.prototype.displayObjectUpdateTransform=Xt.prototype.updateTransform;const rb=new kt;function ib(e,t){return e.zIndex===t.zIndex?e._lastSortedIndex-t._lastSortedIndex:e.zIndex-t.zIndex}const Xl=class extends Xt{constructor(){super(),this.children=[],this.sortableChildren=Xl.defaultSortableChildren,this.sortDirty=!1}onChildrenChange(e){}addChild(...e){if(e.length>1)for(let t=0;t<e.length;t++)this.addChild(e[t]);else{const t=e[0];t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.push(t),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this)}return e[0]}addChildAt(e,t){if(t<0||t>this.children.length)throw new Error(`${e}addChildAt: The index ${t} supplied is out of bounds ${this.children.length}`);return e.parent&&e.parent.removeChild(e),e.parent=this,this.sortDirty=!0,e.transform._parentID=-1,this.children.splice(t,0,e),this._boundsID++,this.onChildrenChange(t),e.emit("added",this),this.emit("childAdded",e,this,t),e}swapChildren(e,t){if(e===t)return;const s=this.getChildIndex(e),r=this.getChildIndex(t);this.children[s]=t,this.children[r]=e,this.onChildrenChange(s<r?s:r)}getChildIndex(e){const t=this.children.indexOf(e);if(t===-1)throw new Error("The supplied DisplayObject must be a child of the caller");return t}setChildIndex(e,t){if(t<0||t>=this.children.length)throw new Error(`The index ${t} supplied is out of bounds ${this.children.length}`);const s=this.getChildIndex(e);Xr(this.children,s,1),this.children.splice(t,0,e),this.onChildrenChange(t)}getChildAt(e){if(e<0||e>=this.children.length)throw new Error(`getChildAt: Index (${e}) does not exist.`);return this.children[e]}removeChild(...e){if(e.length>1)for(let t=0;t<e.length;t++)this.removeChild(e[t]);else{const t=e[0],s=this.children.indexOf(t);if(s===-1)return null;t.parent=null,t.transform._parentID=-1,Xr(this.children,s,1),this._boundsID++,this.onChildrenChange(s),t.emit("removed",this),this.emit("childRemoved",t,this,s)}return e[0]}removeChildAt(e){const t=this.getChildAt(e);return t.parent=null,t.transform._parentID=-1,Xr(this.children,e,1),this._boundsID++,this.onChildrenChange(e),t.emit("removed",this),this.emit("childRemoved",t,this,e),t}removeChildren(e=0,t=this.children.length){const s=e,r=t,i=r-s;let n;if(i>0&&i<=r){n=this.children.splice(s,i);for(let o=0;o<n.length;++o)n[o].parent=null,n[o].transform&&(n[o].transform._parentID=-1);this._boundsID++,this.onChildrenChange(e);for(let o=0;o<n.length;++o)n[o].emit("removed",this),this.emit("childRemoved",n[o],this,o);return n}else if(i===0&&this.children.length===0)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")}sortChildren(){let e=!1;for(let t=0,s=this.children.length;t<s;++t){const r=this.children[t];r._lastSortedIndex=t,!e&&r.zIndex!==0&&(e=!0)}e&&this.children.length>1&&this.children.sort(ib),this.sortDirty=!1}updateTransform(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(let e=0,t=this.children.length;e<t;++e){const s=this.children[e];s.visible&&s.updateTransform()}}calculateBounds(){this._bounds.clear(),this._calculateBounds();for(let e=0;e<this.children.length;e++){const t=this.children[e];if(!(!t.visible||!t.renderable))if(t.calculateBounds(),t._mask){const s=t._mask.isMaskData?t._mask.maskObject:t._mask;s?(s.calculateBounds(),this._bounds.addBoundsMask(t._bounds,s._bounds)):this._bounds.addBounds(t._bounds)}else t.filterArea?this._bounds.addBoundsArea(t._bounds,t.filterArea):this._bounds.addBounds(t._bounds)}this._bounds.updateID=this._boundsID}getLocalBounds(e,t=!1){const s=super.getLocalBounds(e);if(!t)for(let r=0,i=this.children.length;r<i;++r){const n=this.children[r];n.visible&&n.updateTransform()}return s}_calculateBounds(){}_renderWithCulling(e){const t=e.renderTexture.sourceFrame;if(!(t.width>0&&t.height>0))return;let s,r;this.cullArea?(s=this.cullArea,r=this.worldTransform):this._render!==Xl.prototype._render&&(s=this.getBounds(!0));const i=e.projection.transform;if(i&&(r?(r=rb.copyFrom(r),r.prepend(i)):r=i),s&&t.intersects(s,r))this._render(e);else if(this.cullArea)return;for(let n=0,o=this.children.length;n<o;++n){const a=this.children[n],l=a.cullable;a.cullable=l||!this.cullArea,a.render(e),a.cullable=l}}render(e){var t;if(!(!this.visible||this.worldAlpha<=0||!this.renderable))if(this._mask||(t=this.filters)!=null&&t.length)this.renderAdvanced(e);else if(this.cullable)this._renderWithCulling(e);else{this._render(e);for(let s=0,r=this.children.length;s<r;++s)this.children[s].render(e)}}renderAdvanced(e){var i,n,o;const t=this.filters,s=this._mask;if(t){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(let a=0;a<t.length;a++)t[a].enabled&&this._enabledFilters.push(t[a])}const r=t&&((i=this._enabledFilters)==null?void 0:i.length)||s&&(!s.isMaskData||s.enabled&&(s.autoDetect||s.type!==qt.NONE));if(r&&e.batch.flush(),t&&((n=this._enabledFilters)!=null&&n.length)&&e.filter.push(this,this._enabledFilters),s&&e.mask.push(this,this._mask),this.cullable)this._renderWithCulling(e);else{this._render(e);for(let a=0,l=this.children.length;a<l;++a)this.children[a].render(e)}r&&e.batch.flush(),s&&e.mask.pop(this),t&&((o=this._enabledFilters)!=null&&o.length)&&e.filter.pop()}_render(e){}destroy(e){super.destroy(),this.sortDirty=!1;const t=typeof e=="boolean"?e:e==null?void 0:e.children,s=this.removeChildren(0,this.children.length);if(t)for(let r=0;r<s.length;++r)s[r].destroy(e)}get width(){return this.scale.x*this.getLocalBounds().width}set width(e){const t=this.getLocalBounds().width;t!==0?this.scale.x=e/t:this.scale.x=1,this._width=e}get height(){return this.scale.y*this.getLocalBounds().height}set height(e){const t=this.getLocalBounds().height;t!==0?this.scale.y=e/t:this.scale.y=1,this._height=e}};let ye=Xl;ye.defaultSortableChildren=!1;ye.prototype.containerUpdateTransform=ye.prototype.updateTransform;Object.defineProperties(q,{SORTABLE_CHILDREN:{get(){return ye.defaultSortableChildren},set(e){bt("7.1.0","settings.SORTABLE_CHILDREN is deprecated, use Container.defaultSortableChildren"),ye.defaultSortableChildren=e}}});const yi=new It,nb=new Uint16Array([0,1,2,0,2,3]);class yr extends ye{constructor(t){super(),this._anchor=new Fs(this._onAnchorUpdate,this,t?t.defaultAnchor.x:0,t?t.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tintColor=new Ft(16777215),this._tintRGB=null,this.tint=16777215,this.blendMode=ut.NORMAL,this._cachedTint=16777215,this.uvs=null,this.texture=t||J.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=nb,this.pluginName="batch",this.isSprite=!0,this._roundPixels=q.ROUND_PIXELS}_onTextureUpdate(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=Ds(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=Ds(this.scale.y)*this._height/this._texture.orig.height)}_onAnchorUpdate(){this._transformID=-1,this._transformTrimmedID=-1}calculateVertices(){const t=this._texture;if(this._transformID===this.transform._worldID&&this._textureID===t._updateID)return;this._textureID!==t._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=t._updateID;const s=this.transform.worldTransform,r=s.a,i=s.b,n=s.c,o=s.d,a=s.tx,l=s.ty,h=this.vertexData,c=t.trim,u=t.orig,f=this._anchor;let p=0,d=0,m=0,g=0;if(c?(d=c.x-f._x*u.width,p=d+c.width,g=c.y-f._y*u.height,m=g+c.height):(d=-f._x*u.width,p=d+u.width,g=-f._y*u.height,m=g+u.height),h[0]=r*d+n*g+a,h[1]=o*g+i*d+l,h[2]=r*p+n*g+a,h[3]=o*g+i*p+l,h[4]=r*p+n*m+a,h[5]=o*m+i*p+l,h[6]=r*d+n*m+a,h[7]=o*m+i*d+l,this._roundPixels){const y=q.RESOLUTION;for(let E=0;E<h.length;++E)h[E]=Math.round(h[E]*y)/y}}calculateTrimmedVertices(){if(!this.vertexTrimmedData)this.vertexTrimmedData=new Float32Array(8);else if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return;this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;const t=this._texture,s=this.vertexTrimmedData,r=t.orig,i=this._anchor,n=this.transform.worldTransform,o=n.a,a=n.b,l=n.c,h=n.d,c=n.tx,u=n.ty,f=-i._x*r.width,p=f+r.width,d=-i._y*r.height,m=d+r.height;s[0]=o*f+l*d+c,s[1]=h*d+a*f+u,s[2]=o*p+l*d+c,s[3]=h*d+a*p+u,s[4]=o*p+l*m+c,s[5]=h*m+a*p+u,s[6]=o*f+l*m+c,s[7]=h*m+a*f+u}_render(t){this.calculateVertices(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)}_calculateBounds(){const t=this._texture.trim,s=this._texture.orig;!t||t.width===s.width&&t.height===s.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))}getLocalBounds(t){return this.children.length===0?(this._localBounds||(this._localBounds=new go),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),t||(this._localBoundsRect||(this._localBoundsRect=new yt),t=this._localBoundsRect),this._localBounds.getRectangle(t)):super.getLocalBounds.call(this,t)}containsPoint(t){this.worldTransform.applyInverse(t,yi);const s=this._texture.orig.width,r=this._texture.orig.height,i=-s*this.anchor.x;let n=0;return yi.x>=i&&yi.x<i+s&&(n=-r*this.anchor.y,yi.y>=n&&yi.y<n+r)}destroy(t){if(super.destroy(t),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,typeof t=="boolean"?t:t==null?void 0:t.texture){const r=typeof t=="boolean"?t:t==null?void 0:t.baseTexture;this._texture.destroy(!!r)}this._texture=null}static from(t,s){const r=t instanceof J?t:J.from(t,s);return new yr(r)}set roundPixels(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t}get roundPixels(){return this._roundPixels}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(t){const s=Ds(this.scale.x)||1;this.scale.x=s*t/this._texture.orig.width,this._width=t}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(t){const s=Ds(this.scale.y)||1;this.scale.y=s*t/this._texture.orig.height,this._height=t}get anchor(){return this._anchor}set anchor(t){this._anchor.copyFrom(t)}get tint(){return this._tintColor.value}set tint(t){this._tintColor.setValue(t),this._tintRGB=this._tintColor.toLittleEndianNumber()}get tintValue(){return this._tintColor.toNumber()}get texture(){return this._texture}set texture(t){this._texture!==t&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=t||J.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,t&&(t.baseTexture.valid?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))}}const qp=new kt;Xt.prototype._cacheAsBitmap=!1;Xt.prototype._cacheData=null;Xt.prototype._cacheAsBitmapResolution=null;Xt.prototype._cacheAsBitmapMultisample=null;class ob{constructor(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null}}Object.defineProperties(Xt.prototype,{cacheAsBitmapResolution:{get(){return this._cacheAsBitmapResolution},set(e){e!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=e,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get(){return this._cacheAsBitmapMultisample},set(e){e!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=e,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get(){return this._cacheAsBitmap},set(e){if(this._cacheAsBitmap===e)return;this._cacheAsBitmap=e;let t;e?(this._cacheData||(this._cacheData=new ob),t=this._cacheData,t.originalRender=this.render,t.originalRenderCanvas=this.renderCanvas,t.originalUpdateTransform=this.updateTransform,t.originalCalculateBounds=this.calculateBounds,t.originalGetLocalBounds=this.getLocalBounds,t.originalDestroy=this.destroy,t.originalContainsPoint=this.containsPoint,t.originalMask=this._mask,t.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(t=this._cacheData,t.sprite&&this._destroyCachedDisplayObject(),this.render=t.originalRender,this.renderCanvas=t.originalRenderCanvas,this.calculateBounds=t.originalCalculateBounds,this.getLocalBounds=t.originalGetLocalBounds,this.destroy=t.originalDestroy,this.updateTransform=t.originalUpdateTransform,this.containsPoint=t.originalContainsPoint,this._mask=t.originalMask,this.filterArea=t.originalFilterArea)}}});Xt.prototype._renderCached=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(t),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(t))};Xt.prototype._initCachedDisplayObject=function(t){var f,p;if((f=this._cacheData)!=null&&f.sprite)return;const s=this.alpha;this.alpha=1,t.batch.flush();const r=this.getLocalBounds(null,!0).clone();if((p=this.filters)!=null&&p.length){const d=this.filters[0].padding;r.pad(d)}r.ceil(q.RESOLUTION);const i=t.renderTexture.current,n=t.renderTexture.sourceFrame.clone(),o=t.renderTexture.destinationFrame.clone(),a=t.projection.transform,l=_r.create({width:r.width,height:r.height,resolution:this.cacheAsBitmapResolution||t.resolution,multisample:this.cacheAsBitmapMultisample??t.multisample}),h=`cacheAsBitmap_${dr()}`;this._cacheData.textureCacheId=h,mt.addToCache(l.baseTexture,h),J.addToCache(l,h);const c=this.transform.localTransform.copyTo(qp).invert().translate(-r.x,-r.y);this.render=this._cacheData.originalRender,t.render(this,{renderTexture:l,clear:!0,transform:c,skipUpdateTransform:!1}),t.framebuffer.blit(),t.projection.transform=a,t.renderTexture.bind(i,n,o),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=s;const u=new yr(l);u.transform.worldTransform=this.transform.worldTransform,u.anchor.x=-(r.x/r.width),u.anchor.y=-(r.y/r.height),u.alpha=s,u._bounds=this._bounds,this._cacheData.sprite=u,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=u.containsPoint.bind(u)};Xt.prototype._renderCachedCanvas=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(t),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(t))};Xt.prototype._initCachedDisplayObjectCanvas=function(t){var c;if((c=this._cacheData)!=null&&c.sprite)return;const s=this.getLocalBounds(null,!0),r=this.alpha;this.alpha=1;const i=t.canvasContext.activeContext,n=t._projTransform;s.ceil(q.RESOLUTION);const o=_r.create({width:s.width,height:s.height}),a=`cacheAsBitmap_${dr()}`;this._cacheData.textureCacheId=a,mt.addToCache(o.baseTexture,a),J.addToCache(o,a);const l=qp;this.transform.localTransform.copyTo(l),l.invert(),l.tx-=s.x,l.ty-=s.y,this.renderCanvas=this._cacheData.originalRenderCanvas,t.render(this,{renderTexture:o,clear:!0,transform:l,skipUpdateTransform:!1}),t.canvasContext.activeContext=i,t._projTransform=n,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=r;const h=new yr(o);h.transform.worldTransform=this.transform.worldTransform,h.anchor.x=-(s.x/s.width),h.anchor.y=-(s.y/s.height),h.alpha=r,h._bounds=this._bounds,this._cacheData.sprite=h,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=t._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=h.containsPoint.bind(h)};Xt.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID};Xt.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)};Xt.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,mt.removeFromCache(this._cacheData.textureCacheId),J.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null};Xt.prototype._cacheAsBitmapDestroy=function(t){this.cacheAsBitmap=!1,this.destroy(t)};Xt.prototype.name=null;ye.prototype.getChildByName=function(t,s){for(let r=0,i=this.children.length;r<i;r++)if(this.children[r].name===t)return this.children[r];if(s)for(let r=0,i=this.children.length;r<i;r++){const n=this.children[r];if(!n.getChildByName)continue;const o=n.getChildByName(t,!0);if(o)return o}return null};Xt.prototype.getGlobalPosition=function(t=new It,s=!1){return this.parent?this.parent.toGlobal(this.position,t,s):(t.x=this.position.x,t.y=this.position.y),t};var ab=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float uAlpha;

void main(void)
{
   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;
}
`;class lb extends le{constructor(t=1){super(JE,ab,{uAlpha:1}),this.alpha=t}get alpha(){return this.uniforms.uAlpha}set alpha(t){this.uniforms.uAlpha=t}}const hb={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},cb=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join(`
`);function ub(e){const t=hb[e],s=t.length;let r=cb,i="";const n="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;";let o;for(let a=0;a<e;a++){let l=n.replace("%index%",a.toString());o=a,a>=s&&(o=e-a-1),l=l.replace("%value%",t[o].toString()),i+=l,i+=`
`}return r=r.replace("%blur%",i),r=r.replace("%size%",e.toString()),r}const fb=`
    attribute vec2 aVertexPosition;

    uniform mat3 projectionMatrix;

    uniform float strength;

    varying vec2 vBlurTexCoords[%size%];

    uniform vec4 inputSize;
    uniform vec4 outputFrame;

    vec4 filterVertexPosition( void )
    {
        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
    }

    vec2 filterTextureCoord( void )
    {
        return aVertexPosition * (outputFrame.zw * inputSize.zw);
    }

    void main(void)
    {
        gl_Position = filterVertexPosition();

        vec2 textureCoord = filterTextureCoord();
        %blur%
    }`;function db(e,t){const s=Math.ceil(e/2);let r=fb,i="",n;t?n="vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":n="vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(let o=0;o<e;o++){let a=n.replace("%index%",o.toString());a=a.replace("%sampleIndex%",`${o-(s-1)}.0`),i+=a,i+=`
`}return r=r.replace("%blur%",i),r=r.replace("%size%",e.toString()),r}class zl extends le{constructor(t,s=8,r=4,i=le.defaultResolution,n=5){const o=db(n,t),a=ub(n);super(o,a),this.horizontal=t,this.resolution=i,this._quality=0,this.quality=r,this.blur=s}apply(t,s,r,i){if(r?this.horizontal?this.uniforms.strength=1/r.width*(r.width/s.width):this.uniforms.strength=1/r.height*(r.height/s.height):this.horizontal?this.uniforms.strength=1/t.renderer.width*(t.renderer.width/s.width):this.uniforms.strength=1/t.renderer.height*(t.renderer.height/s.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,this.passes===1)t.applyFilter(this,s,r,i);else{const n=t.getFilterTexture(),o=t.renderer;let a=s,l=n;this.state.blend=!1,t.applyFilter(this,a,l,Qe.CLEAR);for(let h=1;h<this.passes-1;h++){t.bindAndClear(a,Qe.BLIT),this.uniforms.uSampler=l;const c=l;l=a,a=c,o.shader.bind(this),o.geometry.draw(5)}this.state.blend=!0,t.applyFilter(this,l,r,i),t.returnFilterTexture(n)}}get blur(){return this.strength}set blur(t){this.padding=1+Math.abs(t)*2,this.strength=t}get quality(){return this._quality}set quality(t){this._quality=t,this.passes=t}}class pb extends le{constructor(t=8,s=4,r=le.defaultResolution,i=5){super(),this._repeatEdgePixels=!1,this.blurXFilter=new zl(!0,t,s,r,i),this.blurYFilter=new zl(!1,t,s,r,i),this.resolution=r,this.quality=s,this.blur=t,this.repeatEdgePixels=!1}apply(t,s,r,i){const n=Math.abs(this.blurXFilter.strength),o=Math.abs(this.blurYFilter.strength);if(n&&o){const a=t.getFilterTexture();this.blurXFilter.apply(t,s,a,Qe.CLEAR),this.blurYFilter.apply(t,a,r,i),t.returnFilterTexture(a)}else o?this.blurYFilter.apply(t,s,r,i):this.blurXFilter.apply(t,s,r,i)}updatePadding(){this._repeatEdgePixels?this.padding=0:this.padding=Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))*2}get blur(){return this.blurXFilter.blur}set blur(t){this.blurXFilter.blur=this.blurYFilter.blur=t,this.updatePadding()}get quality(){return this.blurXFilter.quality}set quality(t){this.blurXFilter.quality=this.blurYFilter.quality=t}get blurX(){return this.blurXFilter.blur}set blurX(t){this.blurXFilter.blur=t,this.updatePadding()}get blurY(){return this.blurYFilter.blur}set blurY(t){this.blurYFilter.blur=t,this.updatePadding()}get blendMode(){return this.blurYFilter.blendMode}set blendMode(t){this.blurYFilter.blendMode=t}get repeatEdgePixels(){return this._repeatEdgePixels}set repeatEdgePixels(t){this._repeatEdgePixels=t,this.updatePadding()}}var mb=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float m[20];
uniform float uAlpha;

void main(void)
{
    vec4 c = texture2D(uSampler, vTextureCoord);

    if (uAlpha == 0.0) {
        gl_FragColor = c;
        return;
    }

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (c.a > 0.0) {
      c.rgb /= c.a;
    }

    vec4 result;

    result.r = (m[0] * c.r);
        result.r += (m[1] * c.g);
        result.r += (m[2] * c.b);
        result.r += (m[3] * c.a);
        result.r += m[4];

    result.g = (m[5] * c.r);
        result.g += (m[6] * c.g);
        result.g += (m[7] * c.b);
        result.g += (m[8] * c.a);
        result.g += m[9];

    result.b = (m[10] * c.r);
       result.b += (m[11] * c.g);
       result.b += (m[12] * c.b);
       result.b += (m[13] * c.a);
       result.b += m[14];

    result.a = (m[15] * c.r);
       result.a += (m[16] * c.g);
       result.a += (m[17] * c.b);
       result.a += (m[18] * c.a);
       result.a += m[19];

    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);

    // Premultiply alpha again.
    rgb *= result.a;

    gl_FragColor = vec4(rgb, result.a);
}
`;class Vl extends le{constructor(){const t={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};super(Xp,mb,t),this.alpha=1}_loadMatrix(t,s=!1){let r=t;s&&(this._multiply(r,this.uniforms.m,t),r=this._colorMatrix(r)),this.uniforms.m=r}_multiply(t,s,r){return t[0]=s[0]*r[0]+s[1]*r[5]+s[2]*r[10]+s[3]*r[15],t[1]=s[0]*r[1]+s[1]*r[6]+s[2]*r[11]+s[3]*r[16],t[2]=s[0]*r[2]+s[1]*r[7]+s[2]*r[12]+s[3]*r[17],t[3]=s[0]*r[3]+s[1]*r[8]+s[2]*r[13]+s[3]*r[18],t[4]=s[0]*r[4]+s[1]*r[9]+s[2]*r[14]+s[3]*r[19]+s[4],t[5]=s[5]*r[0]+s[6]*r[5]+s[7]*r[10]+s[8]*r[15],t[6]=s[5]*r[1]+s[6]*r[6]+s[7]*r[11]+s[8]*r[16],t[7]=s[5]*r[2]+s[6]*r[7]+s[7]*r[12]+s[8]*r[17],t[8]=s[5]*r[3]+s[6]*r[8]+s[7]*r[13]+s[8]*r[18],t[9]=s[5]*r[4]+s[6]*r[9]+s[7]*r[14]+s[8]*r[19]+s[9],t[10]=s[10]*r[0]+s[11]*r[5]+s[12]*r[10]+s[13]*r[15],t[11]=s[10]*r[1]+s[11]*r[6]+s[12]*r[11]+s[13]*r[16],t[12]=s[10]*r[2]+s[11]*r[7]+s[12]*r[12]+s[13]*r[17],t[13]=s[10]*r[3]+s[11]*r[8]+s[12]*r[13]+s[13]*r[18],t[14]=s[10]*r[4]+s[11]*r[9]+s[12]*r[14]+s[13]*r[19]+s[14],t[15]=s[15]*r[0]+s[16]*r[5]+s[17]*r[10]+s[18]*r[15],t[16]=s[15]*r[1]+s[16]*r[6]+s[17]*r[11]+s[18]*r[16],t[17]=s[15]*r[2]+s[16]*r[7]+s[17]*r[12]+s[18]*r[17],t[18]=s[15]*r[3]+s[16]*r[8]+s[17]*r[13]+s[18]*r[18],t[19]=s[15]*r[4]+s[16]*r[9]+s[17]*r[14]+s[18]*r[19]+s[19],t}_colorMatrix(t){const s=new Float32Array(t);return s[4]/=255,s[9]/=255,s[14]/=255,s[19]/=255,s}brightness(t,s){const r=[t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0];this._loadMatrix(r,s)}tint(t,s){const[r,i,n]=Ft.shared.setValue(t).toArray(),o=[r,0,0,0,0,0,i,0,0,0,0,0,n,0,0,0,0,0,1,0];this._loadMatrix(o,s)}greyscale(t,s){const r=[t,t,t,0,0,t,t,t,0,0,t,t,t,0,0,0,0,0,1,0];this._loadMatrix(r,s)}blackAndWhite(t){const s=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0];this._loadMatrix(s,t)}hue(t,s){t=(t||0)/180*Math.PI;const r=Math.cos(t),i=Math.sin(t),n=Math.sqrt,o=1/3,a=n(o),l=r+(1-r)*o,h=o*(1-r)-a*i,c=o*(1-r)+a*i,u=o*(1-r)+a*i,f=r+o*(1-r),p=o*(1-r)-a*i,d=o*(1-r)-a*i,m=o*(1-r)+a*i,g=r+o*(1-r),y=[l,h,c,0,0,u,f,p,0,0,d,m,g,0,0,0,0,0,1,0];this._loadMatrix(y,s)}contrast(t,s){const r=(t||0)+1,i=-.5*(r-1),n=[r,0,0,0,i,0,r,0,0,i,0,0,r,0,i,0,0,0,1,0];this._loadMatrix(n,s)}saturate(t=0,s){const r=t*2/3+1,i=(r-1)*-.5,n=[r,i,i,0,0,i,r,i,0,0,i,i,r,0,0,0,0,0,1,0];this._loadMatrix(n,s)}desaturate(){this.saturate(-1)}negative(t){const s=[-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0];this._loadMatrix(s,t)}sepia(t){const s=[.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0];this._loadMatrix(s,t)}technicolor(t){const s=[1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0];this._loadMatrix(s,t)}polaroid(t){const s=[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0];this._loadMatrix(s,t)}toBGR(t){const s=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0];this._loadMatrix(s,t)}kodachrome(t){const s=[1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0];this._loadMatrix(s,t)}browni(t){const s=[.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0];this._loadMatrix(s,t)}vintage(t){const s=[.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0];this._loadMatrix(s,t)}colorTone(t,s,r,i,n){t=t||.2,s=s||.15,r=r||16770432,i=i||3375104;const o=Ft.shared,[a,l,h]=o.setValue(r).toArray(),[c,u,f]=o.setValue(i).toArray(),p=[.3,.59,.11,0,0,a,l,h,t,0,c,u,f,s,0,a-c,l-u,h-f,0,0];this._loadMatrix(p,n)}night(t,s){t=t||.1;const r=[t*-2,-t,0,0,0,-t,0,t,0,0,0,t,t*2,0,0,0,0,0,1,0];this._loadMatrix(r,s)}predator(t,s){const r=[11.224130630493164*t,-4.794486999511719*t,-2.8746118545532227*t,0*t,.40342438220977783*t,-3.6330697536468506*t,9.193157196044922*t,-2.951810836791992*t,0*t,-1.316135048866272*t,-3.2184197902679443*t,-4.2375030517578125*t,7.476448059082031*t,0*t,.8044459223747253*t,0,0,0,1,0];this._loadMatrix(r,s)}lsd(t){const s=[2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0];this._loadMatrix(s,t)}reset(){const t=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];this._loadMatrix(t,!1)}get matrix(){return this.uniforms.m}set matrix(t){this.uniforms.m=t}get alpha(){return this.uniforms.uAlpha}set alpha(t){this.uniforms.uAlpha=t}}Vl.prototype.grayscale=Vl.prototype.greyscale;var gb=`varying vec2 vFilterCoord;
varying vec2 vTextureCoord;

uniform vec2 scale;
uniform mat2 rotation;
uniform sampler2D uSampler;
uniform sampler2D mapSampler;

uniform highp vec4 inputSize;
uniform vec4 inputClamp;

void main(void)
{
  vec4 map =  texture2D(mapSampler, vFilterCoord);

  map -= 0.5;
  map.xy = scale * inputSize.zw * (rotation * map.xy);

  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));
}
`,_b=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;
uniform mat3 filterMatrix;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
	vFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;
}
`;class yb extends le{constructor(t,s){const r=new kt;t.renderable=!1,super(_b,gb,{mapSampler:t._texture,filterMatrix:r,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])}),this.maskSprite=t,this.maskMatrix=r,s==null&&(s=20),this.scale=new It(s,s)}apply(t,s,r,i){this.uniforms.filterMatrix=t.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;const n=this.maskSprite.worldTransform,o=Math.sqrt(n.a*n.a+n.b*n.b),a=Math.sqrt(n.c*n.c+n.d*n.d);o!==0&&a!==0&&(this.uniforms.rotation[0]=n.a/o,this.uniforms.rotation[1]=n.b/o,this.uniforms.rotation[2]=n.c/a,this.uniforms.rotation[3]=n.d/a),t.applyFilter(this,s,r,i)}get map(){return this.uniforms.mapSampler}set map(t){this.uniforms.mapSampler=t}}var vb=`varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;
uniform sampler2D uSampler;
uniform highp vec4 inputSize;


/**
 Basic FXAA implementation based on the code on geeks3d.com with the
 modification that the texture2DLod stuff was removed since it's
 unsupported by WebGL.

 --

 From:
 https://github.com/mitsuhiko/webgl-meincraft

 Copyright (c) 2011 by Armin Ronacher.

 Some rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions are
 met:

 * Redistributions of source code must retain the above copyright
 notice, this list of conditions and the following disclaimer.

 * Redistributions in binary form must reproduce the above
 copyright notice, this list of conditions and the following
 disclaimer in the documentation and/or other materials provided
 with the distribution.

 * The names of the contributors may not be used to endorse or
 promote products derived from this software without specific
 prior written permission.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#ifndef FXAA_REDUCE_MIN
#define FXAA_REDUCE_MIN   (1.0/ 128.0)
#endif
#ifndef FXAA_REDUCE_MUL
#define FXAA_REDUCE_MUL   (1.0 / 8.0)
#endif
#ifndef FXAA_SPAN_MAX
#define FXAA_SPAN_MAX     8.0
#endif

//optimized version for mobile, where dependent
//texture reads can be a bottleneck
vec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,
          vec2 v_rgbNW, vec2 v_rgbNE,
          vec2 v_rgbSW, vec2 v_rgbSE,
          vec2 v_rgbM) {
    vec4 color;
    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;
    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;
    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;
    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;
    vec4 texColor = texture2D(tex, v_rgbM);
    vec3 rgbM  = texColor.xyz;
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW, luma);
    float lumaNE = dot(rgbNE, luma);
    float lumaSW = dot(rgbSW, luma);
    float lumaSE = dot(rgbSE, luma);
    float lumaM  = dot(rgbM,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    mediump vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
                  dir * rcpDirMin)) * inverseVP;

    vec3 rgbA = 0.5 * (
                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +
                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);
    vec3 rgbB = rgbA * 0.5 + 0.25 * (
                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +
                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);

    float lumaB = dot(rgbB, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = vec4(rgbA, texColor.a);
    else
        color = vec4(rgbB, texColor.a);
    return color;
}

void main() {

      vec4 color;

      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);

      gl_FragColor = color;
}
`,xb=`
attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

void texcoords(vec2 fragCoord, vec2 inverseVP,
               out vec2 v_rgbNW, out vec2 v_rgbNE,
               out vec2 v_rgbSW, out vec2 v_rgbSE,
               out vec2 v_rgbM) {
    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;
    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;
    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;
    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;
    v_rgbM = vec2(fragCoord * inverseVP);
}

void main(void) {

   gl_Position = filterVertexPosition();

   vFragCoord = aVertexPosition * outputFrame.zw;

   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);
}
`;class Eb extends le{constructor(){super(xb,vb)}}var bb=`precision highp float;

varying vec2 vTextureCoord;
varying vec4 vColor;

uniform float uNoise;
uniform float uSeed;
uniform sampler2D uSampler;

float rand(vec2 co)
{
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main()
{
    vec4 color = texture2D(uSampler, vTextureCoord);
    float randomValue = rand(gl_FragCoord.xy * uSeed);
    float diff = (randomValue - 0.5) * uNoise;

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (color.a > 0.0) {
        color.rgb /= color.a;
    }

    color.r += diff;
    color.g += diff;
    color.b += diff;

    // Premultiply alpha again.
    color.rgb *= color.a;

    gl_FragColor = color;
}
`;class wb extends le{constructor(t=.5,s=Math.random()){super(Xp,bb,{uNoise:0,uSeed:0}),this.noise=t,this.seed=s}get noise(){return this.uniforms.uNoise}set noise(t){this.uniforms.uNoise=t}get seed(){return this.uniforms.uSeed}set seed(t){this.uniforms.uSeed=t}}const Zu={AlphaFilter:lb,BlurFilter:pb,BlurFilterPass:zl,ColorMatrixFilter:Vl,DisplacementFilter:yb,FXAAFilter:Eb,NoiseFilter:wb};Object.entries(Zu).forEach(([e,t])=>{Object.defineProperty(Zu,e,{get(){return bt("7.1.0",`filters.${e} has moved to ${e}`),t}})});class Tb{constructor(){this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}init(t){this.removeTickerListener(),this.events=t,this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}get pauseUpdate(){return this._pauseUpdate}set pauseUpdate(t){this._pauseUpdate=t}addTickerListener(){this.tickerAdded||!this.domElement||(jt.system.add(this.tickerUpdate,this,Xs.INTERACTION),this.tickerAdded=!0)}removeTickerListener(){this.tickerAdded&&(jt.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)}pointerMoved(){this._didMove=!0}update(){if(!this.domElement||this._pauseUpdate)return;if(this._didMove){this._didMove=!1;return}const t=this.events.rootPointerEvent;this.events.supportsTouchEvents&&t.pointerType==="touch"||globalThis.document.dispatchEvent(new PointerEvent("pointermove",{clientX:t.clientX,clientY:t.clientY}))}tickerUpdate(t){this._deltaTime+=t,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.update())}}const Os=new Tb;class en{constructor(t){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=en.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new It,this.page=new It,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=t}get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get data(){return this}composedPath(){return this.manager&&(!this.path||this.path[this.path.length-1]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}initEvent(t,s,r){throw new Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}initUIEvent(t,s,r,i,n){throw new Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}preventDefault(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){this.propagationStopped=!0}}class _o extends en{constructor(){super(...arguments),this.client=new It,this.movement=new It,this.offset=new It,this.global=new It,this.screen=new It}get clientX(){return this.client.x}get clientY(){return this.client.y}get x(){return this.clientX}get y(){return this.clientY}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getLocalPosition(t,s,r){return t.worldTransform.applyInverse(r||this.global,s)}getModifierState(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t)}initMouseEvent(t,s,r,i,n,o,a,l,h,c,u,f,p,d,m){throw new Error("Method not implemented.")}}class De extends _o{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]}getPredictedEvents(){throw new Error("getPredictedEvents is not supported!")}}class ei extends _o{constructor(){super(...arguments),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2}}ei.DOM_DELTA_PIXEL=0;ei.DOM_DELTA_LINE=1;ei.DOM_DELTA_PAGE=2;const Sb=2048,Ab=new It,Ha=new It;class Ib{constructor(t){this.dispatch=new Ji,this.moveOnAll=!1,this.enableGlobalMoveEvents=!0,this.mappingState={trackingData:{}},this.eventPool=new Map,this._allInteractiveElements=[],this._hitElements=[],this._isPointerMoveEvent=!1,this.rootTarget=t,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel)}addEventMapping(t,s){this.mappingTable[t]||(this.mappingTable[t]=[]),this.mappingTable[t].push({fn:s,priority:0}),this.mappingTable[t].sort((r,i)=>r.priority-i.priority)}dispatchEvent(t,s){t.propagationStopped=!1,t.propagationImmediatelyStopped=!1,this.propagate(t,s),this.dispatch.emit(s||t.type,t)}mapEvent(t){if(!this.rootTarget)return;const s=this.mappingTable[t.type];if(s)for(let r=0,i=s.length;r<i;r++)s[r].fn(t);else console.warn(`[EventBoundary]: Event mapping not defined for ${t.type}`)}hitTest(t,s){Os.pauseUpdate=!0;const i=this._isPointerMoveEvent&&this.enableGlobalMoveEvents?"hitTestMoveRecursive":"hitTestRecursive",n=this[i](this.rootTarget,this.rootTarget.eventMode,Ab.set(t,s),this.hitTestFn,this.hitPruneFn);return n&&n[0]}propagate(t,s){if(!t.target)return;const r=t.composedPath();t.eventPhase=t.CAPTURING_PHASE;for(let i=0,n=r.length-1;i<n;i++)if(t.currentTarget=r[i],this.notifyTarget(t,s),t.propagationStopped||t.propagationImmediatelyStopped)return;if(t.eventPhase=t.AT_TARGET,t.currentTarget=t.target,this.notifyTarget(t,s),!(t.propagationStopped||t.propagationImmediatelyStopped)){t.eventPhase=t.BUBBLING_PHASE;for(let i=r.length-2;i>=0;i--)if(t.currentTarget=r[i],this.notifyTarget(t,s),t.propagationStopped||t.propagationImmediatelyStopped)return}}all(t,s,r=this._allInteractiveElements){if(r.length===0)return;t.eventPhase=t.BUBBLING_PHASE;const i=Array.isArray(s)?s:[s];for(let n=r.length-1;n>=0;n--)i.forEach(o=>{t.currentTarget=r[n],this.notifyTarget(t,o)})}propagationPath(t){const s=[t];for(let r=0;r<Sb&&t!==this.rootTarget;r++){if(!t.parent)throw new Error("Cannot find propagation path to disconnected target");s.push(t.parent),t=t.parent}return s.reverse(),s}hitTestMoveRecursive(t,s,r,i,n,o=!1){let a=!1;if(this._interactivePrune(t))return null;if((t.eventMode==="dynamic"||s==="dynamic")&&(Os.pauseUpdate=!1),t.interactiveChildren&&t.children){const c=t.children;for(let u=c.length-1;u>=0;u--){const f=c[u],p=this.hitTestMoveRecursive(f,this._isInteractive(s)?s:f.eventMode,r,i,n,o||n(t,r));if(p){if(p.length>0&&!p[p.length-1].parent)continue;const d=t.isInteractive();(p.length>0||d)&&(d&&this._allInteractiveElements.push(t),p.push(t)),this._hitElements.length===0&&(this._hitElements=p),a=!0}}}const l=this._isInteractive(s),h=t.isInteractive();return h&&h&&this._allInteractiveElements.push(t),o||this._hitElements.length>0?null:a?this._hitElements:l&&!n(t,r)&&i(t,r)?h?[t]:[]:null}hitTestRecursive(t,s,r,i,n){if(this._interactivePrune(t)||n(t,r))return null;if((t.eventMode==="dynamic"||s==="dynamic")&&(Os.pauseUpdate=!1),t.interactiveChildren&&t.children){const l=t.children;for(let h=l.length-1;h>=0;h--){const c=l[h],u=this.hitTestRecursive(c,this._isInteractive(s)?s:c.eventMode,r,i,n);if(u){if(u.length>0&&!u[u.length-1].parent)continue;const f=t.isInteractive();return(u.length>0||f)&&u.push(t),u}}}const o=this._isInteractive(s),a=t.isInteractive();return o&&i(t,r)?a?[t]:[]:null}_isInteractive(t){return t==="static"||t==="dynamic"}_interactivePrune(t){return!!(!t||t.isMask||!t.visible||!t.renderable||t.eventMode==="none"||t.eventMode==="passive"&&!t.interactiveChildren||t.isMask)}hitPruneFn(t,s){var r;if(t.hitArea&&(t.worldTransform.applyInverse(s,Ha),!t.hitArea.contains(Ha.x,Ha.y)))return!0;if(t._mask){const i=t._mask.isMaskData?t._mask.maskObject:t._mask;if(i&&!((r=i.containsPoint)!=null&&r.call(i,s)))return!0}return!1}hitTestFn(t,s){return t.eventMode==="passive"?!1:t.hitArea?!0:t.containsPoint?t.containsPoint(s):!1}notifyTarget(t,s){var n,o;s=s??t.type;const r=`on${s}`;(o=(n=t.currentTarget)[r])==null||o.call(n,t);const i=t.eventPhase===t.CAPTURING_PHASE||t.eventPhase===t.AT_TARGET?`${s}capture`:s;this.notifyListeners(t,i),t.eventPhase===t.AT_TARGET&&this.notifyListeners(t,s)}mapPointerDown(t){if(!(t instanceof De)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const s=this.createPointerEvent(t);if(this.dispatchEvent(s,"pointerdown"),s.pointerType==="touch")this.dispatchEvent(s,"touchstart");else if(s.pointerType==="mouse"||s.pointerType==="pen"){const i=s.button===2;this.dispatchEvent(s,i?"rightdown":"mousedown")}const r=this.trackingData(t.pointerId);r.pressTargetsByButton[t.button]=s.composedPath(),this.freeEvent(s)}mapPointerMove(t){var l,h;if(!(t instanceof De)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}this._allInteractiveElements.length=0,this._hitElements.length=0,this._isPointerMoveEvent=!0;const s=this.createPointerEvent(t);this._isPointerMoveEvent=!1;const r=s.pointerType==="mouse"||s.pointerType==="pen",i=this.trackingData(t.pointerId),n=this.findMountedTarget(i.overTargets);if(((l=i.overTargets)==null?void 0:l.length)>0&&n!==s.target){const c=t.type==="mousemove"?"mouseout":"pointerout",u=this.createPointerEvent(t,c,n);if(this.dispatchEvent(u,"pointerout"),r&&this.dispatchEvent(u,"mouseout"),!s.composedPath().includes(n)){const f=this.createPointerEvent(t,"pointerleave",n);for(f.eventPhase=f.AT_TARGET;f.target&&!s.composedPath().includes(f.target);)f.currentTarget=f.target,this.notifyTarget(f),r&&this.notifyTarget(f,"mouseleave"),f.target=f.target.parent;this.freeEvent(f)}this.freeEvent(u)}if(n!==s.target){const c=t.type==="mousemove"?"mouseover":"pointerover",u=this.clonePointerEvent(s,c);this.dispatchEvent(u,"pointerover"),r&&this.dispatchEvent(u,"mouseover");let f=n==null?void 0:n.parent;for(;f&&f!==this.rootTarget.parent&&f!==s.target;)f=f.parent;if(!f||f===this.rootTarget.parent){const d=this.clonePointerEvent(s,"pointerenter");for(d.eventPhase=d.AT_TARGET;d.target&&d.target!==n&&d.target!==this.rootTarget.parent;)d.currentTarget=d.target,this.notifyTarget(d),r&&this.notifyTarget(d,"mouseenter"),d.target=d.target.parent;this.freeEvent(d)}this.freeEvent(u)}const o=[],a=this.enableGlobalMoveEvents??!0;this.moveOnAll?o.push("pointermove"):this.dispatchEvent(s,"pointermove"),a&&o.push("globalpointermove"),s.pointerType==="touch"&&(this.moveOnAll?o.splice(1,0,"touchmove"):this.dispatchEvent(s,"touchmove"),a&&o.push("globaltouchmove")),r&&(this.moveOnAll?o.splice(1,0,"mousemove"):this.dispatchEvent(s,"mousemove"),a&&o.push("globalmousemove"),this.cursor=(h=s.target)==null?void 0:h.cursor),o.length>0&&this.all(s,o),this._allInteractiveElements.length=0,this._hitElements.length=0,i.overTargets=s.composedPath(),this.freeEvent(s)}mapPointerOver(t){var o;if(!(t instanceof De)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const s=this.trackingData(t.pointerId),r=this.createPointerEvent(t),i=r.pointerType==="mouse"||r.pointerType==="pen";this.dispatchEvent(r,"pointerover"),i&&this.dispatchEvent(r,"mouseover"),r.pointerType==="mouse"&&(this.cursor=(o=r.target)==null?void 0:o.cursor);const n=this.clonePointerEvent(r,"pointerenter");for(n.eventPhase=n.AT_TARGET;n.target&&n.target!==this.rootTarget.parent;)n.currentTarget=n.target,this.notifyTarget(n),i&&this.notifyTarget(n,"mouseenter"),n.target=n.target.parent;s.overTargets=r.composedPath(),this.freeEvent(r),this.freeEvent(n)}mapPointerOut(t){if(!(t instanceof De)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const s=this.trackingData(t.pointerId);if(s.overTargets){const r=t.pointerType==="mouse"||t.pointerType==="pen",i=this.findMountedTarget(s.overTargets),n=this.createPointerEvent(t,"pointerout",i);this.dispatchEvent(n),r&&this.dispatchEvent(n,"mouseout");const o=this.createPointerEvent(t,"pointerleave",i);for(o.eventPhase=o.AT_TARGET;o.target&&o.target!==this.rootTarget.parent;)o.currentTarget=o.target,this.notifyTarget(o),r&&this.notifyTarget(o,"mouseleave"),o.target=o.target.parent;s.overTargets=null,this.freeEvent(n),this.freeEvent(o)}this.cursor=null}mapPointerUp(t){if(!(t instanceof De)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const s=performance.now(),r=this.createPointerEvent(t);if(this.dispatchEvent(r,"pointerup"),r.pointerType==="touch")this.dispatchEvent(r,"touchend");else if(r.pointerType==="mouse"||r.pointerType==="pen"){const a=r.button===2;this.dispatchEvent(r,a?"rightup":"mouseup")}const i=this.trackingData(t.pointerId),n=this.findMountedTarget(i.pressTargetsByButton[t.button]);let o=n;if(n&&!r.composedPath().includes(n)){let a=n;for(;a&&!r.composedPath().includes(a);){if(r.currentTarget=a,this.notifyTarget(r,"pointerupoutside"),r.pointerType==="touch")this.notifyTarget(r,"touchendoutside");else if(r.pointerType==="mouse"||r.pointerType==="pen"){const l=r.button===2;this.notifyTarget(r,l?"rightupoutside":"mouseupoutside")}a=a.parent}delete i.pressTargetsByButton[t.button],o=a}if(o){const a=this.clonePointerEvent(r,"click");a.target=o,a.path=null,i.clicksByButton[t.button]||(i.clicksByButton[t.button]={clickCount:0,target:a.target,timeStamp:s});const l=i.clicksByButton[t.button];if(l.target===a.target&&s-l.timeStamp<200?++l.clickCount:l.clickCount=1,l.target=a.target,l.timeStamp=s,a.detail=l.clickCount,a.pointerType==="mouse"){const h=a.button===2;this.dispatchEvent(a,h?"rightclick":"click")}else a.pointerType==="touch"&&this.dispatchEvent(a,"tap");this.dispatchEvent(a,"pointertap"),this.freeEvent(a)}this.freeEvent(r)}mapPointerUpOutside(t){if(!(t instanceof De)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const s=this.trackingData(t.pointerId),r=this.findMountedTarget(s.pressTargetsByButton[t.button]),i=this.createPointerEvent(t);if(r){let n=r;for(;n;)i.currentTarget=n,this.notifyTarget(i,"pointerupoutside"),i.pointerType==="touch"?this.notifyTarget(i,"touchendoutside"):(i.pointerType==="mouse"||i.pointerType==="pen")&&this.notifyTarget(i,i.button===2?"rightupoutside":"mouseupoutside"),n=n.parent;delete s.pressTargetsByButton[t.button]}this.freeEvent(i)}mapWheel(t){if(!(t instanceof ei)){console.warn("EventBoundary cannot map a non-wheel event as a wheel event");return}const s=this.createWheelEvent(t);this.dispatchEvent(s),this.freeEvent(s)}findMountedTarget(t){if(!t)return null;let s=t[0];for(let r=1;r<t.length&&t[r].parent===s;r++)s=t[r];return s}createPointerEvent(t,s,r){const i=this.allocateEvent(De);return this.copyPointerData(t,i),this.copyMouseData(t,i),this.copyData(t,i),i.nativeEvent=t.nativeEvent,i.originalEvent=t,i.target=r??this.hitTest(i.global.x,i.global.y)??this._hitElements[0],typeof s=="string"&&(i.type=s),i}createWheelEvent(t){const s=this.allocateEvent(ei);return this.copyWheelData(t,s),this.copyMouseData(t,s),this.copyData(t,s),s.nativeEvent=t.nativeEvent,s.originalEvent=t,s.target=this.hitTest(s.global.x,s.global.y),s}clonePointerEvent(t,s){const r=this.allocateEvent(De);return r.nativeEvent=t.nativeEvent,r.originalEvent=t.originalEvent,this.copyPointerData(t,r),this.copyMouseData(t,r),this.copyData(t,r),r.target=t.target,r.path=t.composedPath().slice(),r.type=s??r.type,r}copyWheelData(t,s){s.deltaMode=t.deltaMode,s.deltaX=t.deltaX,s.deltaY=t.deltaY,s.deltaZ=t.deltaZ}copyPointerData(t,s){t instanceof De&&s instanceof De&&(s.pointerId=t.pointerId,s.width=t.width,s.height=t.height,s.isPrimary=t.isPrimary,s.pointerType=t.pointerType,s.pressure=t.pressure,s.tangentialPressure=t.tangentialPressure,s.tiltX=t.tiltX,s.tiltY=t.tiltY,s.twist=t.twist)}copyMouseData(t,s){t instanceof _o&&s instanceof _o&&(s.altKey=t.altKey,s.button=t.button,s.buttons=t.buttons,s.client.copyFrom(t.client),s.ctrlKey=t.ctrlKey,s.metaKey=t.metaKey,s.movement.copyFrom(t.movement),s.screen.copyFrom(t.screen),s.shiftKey=t.shiftKey,s.global.copyFrom(t.global))}copyData(t,s){s.isTrusted=t.isTrusted,s.srcElement=t.srcElement,s.timeStamp=performance.now(),s.type=t.type,s.detail=t.detail,s.view=t.view,s.which=t.which,s.layer.copyFrom(t.layer),s.page.copyFrom(t.page)}trackingData(t){return this.mappingState.trackingData[t]||(this.mappingState.trackingData[t]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[t]}allocateEvent(t){this.eventPool.has(t)||this.eventPool.set(t,[]);const s=this.eventPool.get(t).pop()||new t(this);return s.eventPhase=s.NONE,s.currentTarget=null,s.path=null,s.target=null,s}freeEvent(t){if(t.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");const s=t.constructor;this.eventPool.has(s)||this.eventPool.set(s,[]),this.eventPool.get(s).push(t)}notifyListeners(t,s){const r=t.currentTarget._events[s];if(r&&t.currentTarget.isInteractive())if("fn"in r)r.once&&t.currentTarget.removeListener(s,r.fn,void 0,!0),r.fn.call(r.context,t);else for(let i=0,n=r.length;i<n&&!t.propagationImmediatelyStopped;i++)r[i].once&&t.currentTarget.removeListener(s,r[i].fn,void 0,!0),r[i].fn.call(r[i].context,t)}}const Cb=1,Rb={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},jl=class{constructor(e){this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=e,this.rootBoundary=new Ib(null),Os.init(this),this.autoPreventDefault=!0,this.eventsAdded=!1,this.rootPointerEvent=new De(null),this.rootWheelEvent=new ei(null),this.cursorStyles={default:"inherit",pointer:"pointer"},this.features=new Proxy({...jl.defaultEventFeatures},{set:(t,s,r)=>(s==="globalMove"&&(this.rootBoundary.enableGlobalMoveEvents=r),t[s]=r,!0)}),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.onPointerOverOut=this.onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this)}static get defaultEventMode(){return this._defaultEventMode}init(e){const{view:t,resolution:s}=this.renderer;this.setTargetElement(t),this.resolution=s,jl._defaultEventMode=e.eventMode??"auto",Object.assign(this.features,e.eventFeatures??{}),this.rootBoundary.enableGlobalMoveEvents=this.features.globalMove}resolutionChange(e){this.resolution=e}destroy(){this.setTargetElement(null),this.renderer=null}setCursor(e){e=e||"default";let t=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(t=!1),this.currentCursor===e)return;this.currentCursor=e;const s=this.cursorStyles[e];if(s)switch(typeof s){case"string":t&&(this.domElement.style.cursor=s);break;case"function":s(e);break;case"object":t&&Object.assign(this.domElement.style,s);break}else t&&typeof e=="string"&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,e)&&(this.domElement.style.cursor=e)}get pointer(){return this.rootPointerEvent}onPointerDown(e){if(!this.features.click||(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&e.pointerType==="touch"))return;const t=this.normalizeToPointerData(e);this.autoPreventDefault&&t[0].isNormalized&&(e.cancelable||!("cancelable"in e))&&e.preventDefault();for(let s=0,r=t.length;s<r;s++){const i=t[s],n=this.bootstrapEvent(this.rootPointerEvent,i);this.rootBoundary.mapEvent(n)}this.setCursor(this.rootBoundary.cursor)}onPointerMove(e){if(!this.features.move||(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&e.pointerType==="touch"))return;Os.pointerMoved();const t=this.normalizeToPointerData(e);for(let s=0,r=t.length;s<r;s++){const i=this.bootstrapEvent(this.rootPointerEvent,t[s]);this.rootBoundary.mapEvent(i)}this.setCursor(this.rootBoundary.cursor)}onPointerUp(e){if(!this.features.click||(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&e.pointerType==="touch"))return;let t=e.target;e.composedPath&&e.composedPath().length>0&&(t=e.composedPath()[0]);const s=t!==this.domElement?"outside":"",r=this.normalizeToPointerData(e);for(let i=0,n=r.length;i<n;i++){const o=this.bootstrapEvent(this.rootPointerEvent,r[i]);o.type+=s,this.rootBoundary.mapEvent(o)}this.setCursor(this.rootBoundary.cursor)}onPointerOverOut(e){if(!this.features.click||(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&e.pointerType==="touch"))return;const t=this.normalizeToPointerData(e);for(let s=0,r=t.length;s<r;s++){const i=this.bootstrapEvent(this.rootPointerEvent,t[s]);this.rootBoundary.mapEvent(i)}this.setCursor(this.rootBoundary.cursor)}onWheel(e){if(!this.features.wheel)return;const t=this.normalizeWheelEvent(e);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(t)}setTargetElement(e){this.removeEvents(),this.domElement=e,Os.domElement=e,this.addEvents()}addEvents(){if(this.eventsAdded||!this.domElement)return;Os.addTickerListener();const e=this.domElement.style;e&&(globalThis.navigator.msPointerEnabled?(e.msContentZooming="none",e.msTouchAction="none"):this.supportsPointerEvents&&(e.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,!0),this.domElement.addEventListener("pointerdown",this.onPointerDown,!0),this.domElement.addEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.addEventListener("pointerover",this.onPointerOverOut,!0),globalThis.addEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,!0),this.domElement.addEventListener("mousedown",this.onPointerDown,!0),this.domElement.addEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.addEventListener("mouseover",this.onPointerOverOut,!0),globalThis.addEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this.onPointerDown,!0),this.domElement.addEventListener("touchend",this.onPointerUp,!0),this.domElement.addEventListener("touchmove",this.onPointerMove,!0)),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this.eventsAdded=!0}removeEvents(){if(!this.eventsAdded||!this.domElement)return;Os.removeTickerListener();const e=this.domElement.style;globalThis.navigator.msPointerEnabled?(e.msContentZooming="",e.msTouchAction=""):this.supportsPointerEvents&&(e.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,!0),this.domElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.domElement.removeEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.removeEventListener("pointerover",this.onPointerOverOut,!0),globalThis.removeEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,!0),this.domElement.removeEventListener("mousedown",this.onPointerDown,!0),this.domElement.removeEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.removeEventListener("mouseover",this.onPointerOverOut,!0),globalThis.removeEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this.onPointerDown,!0),this.domElement.removeEventListener("touchend",this.onPointerUp,!0),this.domElement.removeEventListener("touchmove",this.onPointerMove,!0)),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}mapPositionToPoint(e,t,s){let r;this.domElement.parentElement?r=this.domElement.getBoundingClientRect():r={x:0,y:0,width:this.domElement.width,height:this.domElement.height,left:0,top:0};const i=1/this.resolution;e.x=(t-r.left)*(this.domElement.width/r.width)*i,e.y=(s-r.top)*(this.domElement.height/r.height)*i}normalizeToPointerData(e){const t=[];if(this.supportsTouchEvents&&e instanceof TouchEvent)for(let s=0,r=e.changedTouches.length;s<r;s++){const i=e.changedTouches[s];typeof i.button>"u"&&(i.button=0),typeof i.buttons>"u"&&(i.buttons=1),typeof i.isPrimary>"u"&&(i.isPrimary=e.touches.length===1&&e.type==="touchstart"),typeof i.width>"u"&&(i.width=i.radiusX||1),typeof i.height>"u"&&(i.height=i.radiusY||1),typeof i.tiltX>"u"&&(i.tiltX=0),typeof i.tiltY>"u"&&(i.tiltY=0),typeof i.pointerType>"u"&&(i.pointerType="touch"),typeof i.pointerId>"u"&&(i.pointerId=i.identifier||0),typeof i.pressure>"u"&&(i.pressure=i.force||.5),typeof i.twist>"u"&&(i.twist=0),typeof i.tangentialPressure>"u"&&(i.tangentialPressure=0),typeof i.layerX>"u"&&(i.layerX=i.offsetX=i.clientX),typeof i.layerY>"u"&&(i.layerY=i.offsetY=i.clientY),i.isNormalized=!0,i.type=e.type,t.push(i)}else if(!globalThis.MouseEvent||e instanceof MouseEvent&&(!this.supportsPointerEvents||!(e instanceof globalThis.PointerEvent))){const s=e;typeof s.isPrimary>"u"&&(s.isPrimary=!0),typeof s.width>"u"&&(s.width=1),typeof s.height>"u"&&(s.height=1),typeof s.tiltX>"u"&&(s.tiltX=0),typeof s.tiltY>"u"&&(s.tiltY=0),typeof s.pointerType>"u"&&(s.pointerType="mouse"),typeof s.pointerId>"u"&&(s.pointerId=Cb),typeof s.pressure>"u"&&(s.pressure=.5),typeof s.twist>"u"&&(s.twist=0),typeof s.tangentialPressure>"u"&&(s.tangentialPressure=0),s.isNormalized=!0,t.push(s)}else t.push(e);return t}normalizeWheelEvent(e){const t=this.rootWheelEvent;return this.transferMouseData(t,e),t.deltaX=e.deltaX,t.deltaY=e.deltaY,t.deltaZ=e.deltaZ,t.deltaMode=e.deltaMode,this.mapPositionToPoint(t.screen,e.clientX,e.clientY),t.global.copyFrom(t.screen),t.offset.copyFrom(t.screen),t.nativeEvent=e,t.type=e.type,t}bootstrapEvent(e,t){return e.originalEvent=null,e.nativeEvent=t,e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist,this.transferMouseData(e,t),this.mapPositionToPoint(e.screen,t.clientX,t.clientY),e.global.copyFrom(e.screen),e.offset.copyFrom(e.screen),e.isTrusted=t.isTrusted,e.type==="pointerleave"&&(e.type="pointerout"),e.type.startsWith("mouse")&&(e.type=e.type.replace("mouse","pointer")),e.type.startsWith("touch")&&(e.type=Rb[e.type]||e.type),e}transferMouseData(e,t){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=performance.now(),e.type=t.type,e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.client.x=t.clientX,e.client.y=t.clientY,e.ctrlKey=t.ctrlKey,e.metaKey=t.metaKey,e.movement.x=t.movementX,e.movement.y=t.movementY,e.page.x=t.pageX,e.page.y=t.pageY,e.relatedTarget=null,e.shiftKey=t.shiftKey}};let Ki=jl;Ki.extension={name:"events",type:[Z.RendererSystem,Z.CanvasRendererSystem]};Ki.defaultEventFeatures={move:!0,globalMove:!0,click:!0,wheel:!0};nt.add(Ki);function Ju(e){return e==="dynamic"||e==="static"}const Pb={onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onglobalmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onglobalpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,onglobaltouchmove:null,ontouchstart:null,onwheel:null,_internalInteractive:void 0,get interactive(){return this._internalInteractive??Ju(Ki.defaultEventMode)},set interactive(e){bt("7.2.0","Setting interactive is deprecated, use eventMode = 'none'/'passive'/'auto'/'static'/'dynamic' instead."),this._internalInteractive=e,this.eventMode=e?"static":"auto"},_internalEventMode:void 0,get eventMode(){return this._internalEventMode??Ki.defaultEventMode},set eventMode(e){this._internalInteractive=Ju(e),this._internalEventMode=e},isInteractive(){return this.eventMode==="static"||this.eventMode==="dynamic"},interactiveChildren:!0,hitArea:null,addEventListener(e,t,s){const r=typeof s=="boolean"&&s||typeof s=="object"&&s.capture,i=typeof t=="function"?void 0:t;e=r?`${e}capture`:e,t=typeof t=="function"?t:t.handleEvent,this.on(e,t,i)},removeEventListener(e,t,s){const r=typeof s=="boolean"&&s||typeof s=="object"&&s.capture,i=typeof t=="function"?void 0:t;e=r?`${e}capture`:e,t=typeof t=="function"?t:t.handleEvent,this.off(e,t,i)},dispatchEvent(e){if(!(e instanceof en))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");return e.defaultPrevented=!1,e.path=null,e.target=this,e.manager.dispatchEvent(e),!e.defaultPrevented}};Xt.mixin(Pb);const Mb={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1};Xt.mixin(Mb);const Ob=9,Pn=100,Bb=0,Db=0,Qu=2,tf=1,Fb=-1e3,Lb=-1e3,Nb=2;class Zp{constructor(t){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(vs.tablet||vs.phone)&&this.createTouchHook();const s=document.createElement("div");s.style.width=`${Pn}px`,s.style.height=`${Pn}px`,s.style.position="absolute",s.style.top=`${Bb}px`,s.style.left=`${Db}px`,s.style.zIndex=Qu.toString(),this.div=s,this.renderer=t,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}get isActive(){return this._isActive}get isMobileAccessibility(){return this._isMobileAccessibility}createTouchHook(){const t=document.createElement("button");t.style.width=`${tf}px`,t.style.height=`${tf}px`,t.style.position="absolute",t.style.top=`${Fb}px`,t.style.left=`${Lb}px`,t.style.zIndex=Nb.toString(),t.style.backgroundColor="#FF0000",t.title="select to enable accessibility for this content",t.addEventListener("focus",()=>{this._isMobileAccessibility=!0,this.activate(),this.destroyTouchHook()}),document.body.appendChild(t),this._hookDiv=t}destroyTouchHook(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)}activate(){var t;this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),(t=this.renderer.view.parentNode)==null||t.appendChild(this.div))}deactivate(){var t;!this._isActive||this._isMobileAccessibility||(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),(t=this.div.parentNode)==null||t.removeChild(this.div))}updateAccessibleObjects(t){if(!t.visible||!t.accessibleChildren)return;t.accessible&&t.isInteractive()&&(t._accessibleActive||this.addChild(t),t.renderId=this.renderId);const s=t.children;if(s)for(let r=0;r<s.length;r++)this.updateAccessibleObjects(s[r])}update(){const t=performance.now();if(vs.android.device&&t<this.androidUpdateCount||(this.androidUpdateCount=t+this.androidUpdateFrequency,!this.renderer.renderingToScreen))return;this.renderer.lastObjectRendered&&this.updateAccessibleObjects(this.renderer.lastObjectRendered);const{x:s,y:r,width:i,height:n}=this.renderer.view.getBoundingClientRect(),{width:o,height:a,resolution:l}=this.renderer,h=i/o*l,c=n/a*l;let u=this.div;u.style.left=`${s}px`,u.style.top=`${r}px`,u.style.width=`${o}px`,u.style.height=`${a}px`;for(let f=0;f<this.children.length;f++){const p=this.children[f];if(p.renderId!==this.renderId)p._accessibleActive=!1,Xr(this.children,f,1),this.div.removeChild(p._accessibleDiv),this.pool.push(p._accessibleDiv),p._accessibleDiv=null,f--;else{u=p._accessibleDiv;let d=p.hitArea;const m=p.worldTransform;p.hitArea?(u.style.left=`${(m.tx+d.x*m.a)*h}px`,u.style.top=`${(m.ty+d.y*m.d)*c}px`,u.style.width=`${d.width*m.a*h}px`,u.style.height=`${d.height*m.d*c}px`):(d=p.getBounds(),this.capHitArea(d),u.style.left=`${d.x*h}px`,u.style.top=`${d.y*c}px`,u.style.width=`${d.width*h}px`,u.style.height=`${d.height*c}px`,u.title!==p.accessibleTitle&&p.accessibleTitle!==null&&(u.title=p.accessibleTitle),u.getAttribute("aria-label")!==p.accessibleHint&&p.accessibleHint!==null&&u.setAttribute("aria-label",p.accessibleHint)),(p.accessibleTitle!==u.title||p.tabIndex!==u.tabIndex)&&(u.title=p.accessibleTitle,u.tabIndex=p.tabIndex,this.debug&&this.updateDebugHTML(u))}}this.renderId++}updateDebugHTML(t){t.innerHTML=`type: ${t.type}</br> title : ${t.title}</br> tabIndex: ${t.tabIndex}`}capHitArea(t){t.x<0&&(t.width+=t.x,t.x=0),t.y<0&&(t.height+=t.y,t.y=0);const{width:s,height:r}=this.renderer;t.x+t.width>s&&(t.width=s-t.x),t.y+t.height>r&&(t.height=r-t.y)}addChild(t){let s=this.pool.pop();s||(s=document.createElement("button"),s.style.width=`${Pn}px`,s.style.height=`${Pn}px`,s.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",s.style.position="absolute",s.style.zIndex=Qu.toString(),s.style.borderStyle="none",navigator.userAgent.toLowerCase().includes("chrome")?s.setAttribute("aria-live","off"):s.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?s.setAttribute("aria-relevant","additions"):s.setAttribute("aria-relevant","text"),s.addEventListener("click",this._onClick.bind(this)),s.addEventListener("focus",this._onFocus.bind(this)),s.addEventListener("focusout",this._onFocusOut.bind(this))),s.style.pointerEvents=t.accessiblePointerEvents,s.type=t.accessibleType,t.accessibleTitle&&t.accessibleTitle!==null?s.title=t.accessibleTitle:(!t.accessibleHint||t.accessibleHint===null)&&(s.title=`displayObject ${t.tabIndex}`),t.accessibleHint&&t.accessibleHint!==null&&s.setAttribute("aria-label",t.accessibleHint),this.debug&&this.updateDebugHTML(s),t._accessibleActive=!0,t._accessibleDiv=s,s.displayObject=t,this.children.push(t),this.div.appendChild(t._accessibleDiv),t._accessibleDiv.tabIndex=t.tabIndex}_dispatchEvent(t,s){const{displayObject:r}=t.target,i=this.renderer.events.rootBoundary,n=Object.assign(new en(i),{target:r});i.rootTarget=this.renderer.lastObjectRendered,s.forEach(o=>i.dispatchEvent(n,o))}_onClick(t){this._dispatchEvent(t,["click","pointertap","tap"])}_onFocus(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","assertive"),this._dispatchEvent(t,["mouseover"])}_onFocusOut(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","polite"),this._dispatchEvent(t,["mouseout"])}_onKeyDown(t){t.keyCode===Ob&&this.activate()}_onMouseMove(t){t.movementX===0&&t.movementY===0||this.deactivate()}destroy(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null}}Zp.extension={name:"accessibility",type:[Z.RendererPlugin,Z.CanvasRendererPlugin]};nt.add(Zp);const Yl=class{constructor(e){this.stage=new ye,e=Object.assign({forceCanvas:!1},e),this.renderer=KE(e),Yl._plugins.forEach(t=>{t.init.call(this,e)})}render(){this.renderer.render(this.stage)}get view(){return this.renderer.view}get screen(){return this.renderer.screen}destroy(e,t){const s=Yl._plugins.slice(0);s.reverse(),s.forEach(r=>{r.destroy.call(this)}),this.stage.destroy(t),this.stage=null,this.renderer.destroy(e),this.renderer=null}};let Kh=Yl;Kh._plugins=[];nt.handleByList(Z.Application,Kh._plugins);class Jp{static init(t){Object.defineProperty(this,"resizeTo",{set(s){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=s,s&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this.cancelResize(),this._resizeId=requestAnimationFrame(()=>this.resize()))},this.cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(!this._resizeTo)return;this.cancelResize();let s,r;if(this._resizeTo===globalThis.window)s=globalThis.innerWidth,r=globalThis.innerHeight;else{const{clientWidth:i,clientHeight:n}=this._resizeTo;s=i,r=n}this.renderer.resize(s,r),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=t.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}}Jp.extension=Z.Application;nt.add(Jp);const ef={loader:Z.LoadParser,resolver:Z.ResolveParser,cache:Z.CacheParser,detection:Z.DetectionParser};nt.handle(Z.Asset,e=>{const t=e.ref;Object.entries(ef).filter(([s])=>!!t[s]).forEach(([s,r])=>nt.add(Object.assign(t[s],{extension:t[s].extension??r})))},e=>{const t=e.ref;Object.keys(ef).filter(s=>!!t[s]).forEach(s=>nt.remove(t[s]))});class Ub{constructor(t,s=!1){this._loader=t,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=s}add(t){t.forEach(s=>{this._assetList.push(s)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const t=[],s=Math.min(this._assetList.length,this._maxConcurrent);for(let r=0;r<s;r++)t.push(this._assetList.pop());await this._loader.load(t),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(t){this._isActive!==t&&(this._isActive=t,t&&!this._isLoading&&this._next())}}function sn(e,t){if(Array.isArray(t)){for(const s of t)if(e.startsWith(`data:${s}`))return!0;return!1}return e.startsWith(`data:${t}`)}function vr(e,t){const s=e.split("?")[0],r=fe.extname(s).toLowerCase();return Array.isArray(t)?t.includes(r):r===t}const xs=(e,t)=>(Array.isArray(e)||(e=[e]),t?e.map(s=>typeof s=="string"?t(s):s):e),Kl=(e,t)=>{const s=t.split("?")[1];return s&&(e+=`?${s}`),e};function Qp(e,t,s,r,i){const n=t[s];for(let o=0;o<n.length;o++){const a=n[o];s<t.length-1?Qp(e.replace(r[s],a),t,s+1,r,i):i.push(e.replace(r[s],a))}}function kb(e){const t=/\{(.*?)\}/g,s=e.match(t),r=[];if(s){const i=[];s.forEach(n=>{const o=n.substring(1,n.length-1).split(",");i.push(o)}),Qp(e,i,0,s,r)}else r.push(e);return r}const yo=e=>!Array.isArray(e);class Gb{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(t){return this._cache.has(t)}get(t){const s=this._cache.get(t);return s||console.warn(`[Assets] Asset id ${t} was not found in the Cache`),s}set(t,s){const r=xs(t);let i;for(let a=0;a<this.parsers.length;a++){const l=this.parsers[a];if(l.test(s)){i=l.getCacheableAssets(r,s);break}}i||(i={},r.forEach(a=>{i[a]=s}));const n=Object.keys(i),o={cacheKeys:n,keys:r};if(r.forEach(a=>{this._cacheMap.set(a,o)}),n.forEach(a=>{this._cache.has(a)&&this._cache.get(a)!==s&&console.warn("[Cache] already has key:",a),this._cache.set(a,i[a])}),s instanceof J){const a=s;r.forEach(l=>{a.baseTexture!==J.EMPTY.baseTexture&&mt.addToCache(a.baseTexture,l),J.addToCache(a,l)})}}remove(t){if(this._cacheMap.get(t),!this._cacheMap.has(t)){console.warn(`[Assets] Asset id ${t} was not found in the Cache`);return}const s=this._cacheMap.get(t);s.cacheKeys.forEach(i=>{this._cache.delete(i)}),s.keys.forEach(i=>{this._cacheMap.delete(i)})}get parsers(){return this._parsers}}const vi=new Gb;class Hb{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(t,s,r)=>(this._parsersValidated=!1,t[s]=r,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(t,s){const r={promise:null,parser:null};return r.promise=(async()=>{var o,a;let i=null,n=null;if(s.loadParser&&(n=this._parserHash[s.loadParser],n||console.warn(`[Assets] specified load parser "${s.loadParser}" not found while loading ${t}`)),!n){for(let l=0;l<this.parsers.length;l++){const h=this.parsers[l];if(h.load&&((o=h.test)!=null&&o.call(h,t,s,this))){n=h;break}}if(!n)return console.warn(`[Assets] ${t} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}i=await n.load(t,s,this),r.parser=n;for(let l=0;l<this.parsers.length;l++){const h=this.parsers[l];h.parse&&h.parse&&await((a=h.testParse)==null?void 0:a.call(h,i,s,this))&&(i=await h.parse(i,s,this)||i,r.parser=h)}return i})(),r}async load(t,s){this._parsersValidated||this._validateParsers();let r=0;const i={},n=yo(t),o=xs(t,h=>({src:h})),a=o.length,l=o.map(async h=>{const c=fe.toAbsolute(h.src);if(!i[h.src])try{this.promiseCache[c]||(this.promiseCache[c]=this._getLoadPromiseAndParser(c,h)),i[h.src]=await this.promiseCache[c].promise,s&&s(++r/a)}catch(u){throw delete this.promiseCache[c],delete i[h.src],new Error(`[Loader.load] Failed to load ${c}.
${u}`)}});return await Promise.all(l),n?i[o[0].src]:i}async unload(t){const r=xs(t,i=>({src:i})).map(async i=>{var a,l;const n=fe.toAbsolute(i.src),o=this.promiseCache[n];if(o){const h=await o.promise;(l=(a=o.parser)==null?void 0:a.unload)==null||l.call(a,h,i,this),delete this.promiseCache[n]}});await Promise.all(r)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(t=>t.name).reduce((t,s)=>(t[s.name]&&console.warn(`[Assets] loadParser name conflict "${s.name}"`),{...t,[s.name]:s}),{})}}var hs=(e=>(e[e.Low=0]="Low",e[e.Normal=1]="Normal",e[e.High=2]="High",e))(hs||{});const $b=".json",Wb="application/json",Xb={extension:{type:Z.LoadParser,priority:hs.Low},name:"loadJson",test(e){return sn(e,Wb)||vr(e,$b)},async load(e){return await(await q.ADAPTER.fetch(e)).json()}};nt.add(Xb);const zb=".txt",Vb="text/plain",jb={name:"loadTxt",extension:{type:Z.LoadParser,priority:hs.Low},test(e){return sn(e,Vb)||vr(e,zb)},async load(e){return await(await q.ADAPTER.fetch(e)).text()}};nt.add(jb);const Yb=["normal","bold","100","200","300","400","500","600","700","800","900"],Kb=[".ttf",".otf",".woff",".woff2"],qb=["font/ttf","font/otf","font/woff","font/woff2"],Zb=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function Jb(e){const t=fe.extname(e),i=fe.basename(e,t).replace(/(-|_)/g," ").toLowerCase().split(" ").map(a=>a.charAt(0).toUpperCase()+a.slice(1));let n=i.length>0;for(const a of i)if(!a.match(Zb)){n=!1;break}let o=i.join(" ");return n||(o=`"${o.replace(/[\\"]/g,"\\$&")}"`),o}const Qb={extension:{type:Z.LoadParser,priority:hs.Low},name:"loadWebFont",test(e){return sn(e,qb)||vr(e,Kb)},async load(e,t){var r,i,n;const s=q.ADAPTER.getFontFaceSet();if(s){const o=[],a=((r=t.data)==null?void 0:r.family)??Jb(e),l=((n=(i=t.data)==null?void 0:i.weights)==null?void 0:n.filter(c=>Yb.includes(c)))??["normal"],h=t.data??{};for(let c=0;c<l.length;c++){const u=l[c],f=new FontFace(a,`url(${encodeURI(e)})`,{...h,weight:u});await f.load(),s.add(f),o.push(f)}return o.length===1?o[0]:o}return console.warn("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(e){(Array.isArray(e)?e:[e]).forEach(t=>q.ADAPTER.getFontFaceSet().delete(t))}};nt.add(Qb);let sf=0,$a;const tw="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=",ew={id:"checkImageBitmap",code:`
    async function checkImageBitmap()
    {
        try
        {
            if (typeof createImageBitmap !== 'function') return false;

            const response = await fetch('${tw}');
            const imageBlob =  await response.blob();
            const imageBitmap = await createImageBitmap(imageBlob);

            return imageBitmap.width === 1 && imageBitmap.height === 1;
        }
        catch (e)
        {
            return false;
        }
    }
    checkImageBitmap().then((result) => { self.postMessage(result); });
    `},sw={id:"loadImageBitmap",code:`
    async function loadImageBitmap(url)
    {
        const response = await fetch(url);

        if (!response.ok)
        {
            throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \`
                + \`\${response.status} \${response.statusText}\`);
        }

        const imageBlob =  await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);

        return imageBitmap;
    }
    self.onmessage = async (event) =>
    {
        try
        {
            const imageBitmap = await loadImageBitmap(event.data.data[0]);

            self.postMessage({
                data: imageBitmap,
                uuid: event.data.uuid,
                id: event.data.id,
            }, [imageBitmap]);
        }
        catch(e)
        {
            self.postMessage({
                error: e,
                uuid: event.data.uuid,
                id: event.data.id,
            });
        }
    };`};let Wa;class rw{constructor(){this._initialized=!1,this._createdWorkers=0,this.workerPool=[],this.queue=[],this.resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(t=>{const s=URL.createObjectURL(new Blob([ew.code],{type:"application/javascript"})),r=new Worker(s);r.addEventListener("message",i=>{r.terminate(),URL.revokeObjectURL(s),t(i.data)})}),this._isImageBitmapSupported)}loadImageBitmap(t){return this._run("loadImageBitmap",[t])}async _initWorkers(){this._initialized||(this._initialized=!0)}getWorker(){$a===void 0&&($a=navigator.hardwareConcurrency||4);let t=this.workerPool.pop();return!t&&this._createdWorkers<$a&&(Wa||(Wa=URL.createObjectURL(new Blob([sw.code],{type:"application/javascript"}))),this._createdWorkers++,t=new Worker(Wa),t.addEventListener("message",s=>{this.complete(s.data),this.returnWorker(s.target),this.next()})),t}returnWorker(t){this.workerPool.push(t)}complete(t){t.error!==void 0?this.resolveHash[t.uuid].reject(t.error):this.resolveHash[t.uuid].resolve(t.data),this.resolveHash[t.uuid]=null}async _run(t,s){await this._initWorkers();const r=new Promise((i,n)=>{this.queue.push({id:t,arguments:s,resolve:i,reject:n})});return this.next(),r}next(){if(!this.queue.length)return;const t=this.getWorker();if(!t)return;const s=this.queue.pop(),r=s.id;this.resolveHash[sf]={resolve:s.resolve,reject:s.reject},t.postMessage({data:s.arguments,uuid:sf++,id:r})}}const rf=new rw;function jo(e,t,s){const r=new J(e);return r.baseTexture.on("dispose",()=>{delete t.promiseCache[s]}),r}const iw=[".jpeg",".jpg",".png",".webp",".avif"],nw=["image/jpeg","image/png","image/webp","image/avif"];async function ow(e){const t=await q.ADAPTER.fetch(e);if(!t.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${e}: ${t.status} ${t.statusText}`);const s=await t.blob();return await createImageBitmap(s)}const Yo={name:"loadTextures",extension:{type:Z.LoadParser,priority:hs.High},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(e){return sn(e,nw)||vr(e,iw)},async load(e,t,s){let r=null;globalThis.createImageBitmap&&this.config.preferCreateImageBitmap?this.config.preferWorkers&&await rf.isImageBitmapSupported()?r=await rf.loadImageBitmap(e):r=await ow(e):r=await new Promise(n=>{r=new Image,r.crossOrigin=this.config.crossOrigin,r.src=e,r.complete?n(r):r.onload=()=>{n(r)}});const i=new mt(r,{resolution:Hs(e),...t.data});return i.resource.src=e,jo(i,s,e)},unload(e){e.destroy(!0)}};nt.add(Yo);const aw=".svg",lw="image/svg+xml",hw={extension:{type:Z.LoadParser,priority:hs.High},name:"loadSVG",test(e){return sn(e,lw)||vr(e,aw)},async testParse(e){return Yi.test(e)},async parse(e,t,s){var o;const r=new Yi(e,(o=t==null?void 0:t.data)==null?void 0:o.resourceOptions);await r.load();const i=new mt(r,{resolution:Hs(e),...t==null?void 0:t.data});return i.resource.src=e,jo(i,s,e)},async load(e,t){return(await q.ADAPTER.fetch(e)).text()},unload:Yo.unload};nt.add(hw);class cw{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(t,s)=>`${t}${this._bundleIdConnector}${s}`,extractAssetIdFromBundle:(t,s)=>s.replace(`${t}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(t){if(this._bundleIdConnector=t.connector??this._bundleIdConnector,this._createBundleAssetId=t.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=t.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...t){t.forEach(s=>{this._preferredOrder.push(s),s.priority||(s.priority=Object.keys(s.params))}),this._resolverHash={}}set basePath(t){this._basePath=t}get basePath(){return this._basePath}set rootPath(t){this._rootPath=t}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(t){if(typeof t=="string")this._defaultSearchParams=t;else{const s=t;this._defaultSearchParams=Object.keys(s).map(r=>`${encodeURIComponent(r)}=${encodeURIComponent(s[r])}`).join("&")}}addManifest(t){this._manifest&&console.warn("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=t,t.bundles.forEach(s=>{this.addBundle(s.name,s.assets)})}addBundle(t,s){const r=[];Array.isArray(s)?s.forEach(i=>{if(typeof i.name=="string"){const n=this._createBundleAssetId(t,i.name);r.push(n),this.add([i.name,n],i.srcs,i.data)}else{const n=i.name.map(o=>this._createBundleAssetId(t,o));n.forEach(o=>{r.push(o)}),this.add([...i.name,...n],i.srcs)}}):Object.keys(s).forEach(i=>{r.push(this._createBundleAssetId(t,i)),this.add([i,this._createBundleAssetId(t,i)],s[i])}),this._bundles[t]=r}add(t,s,r){const i=xs(t);i.forEach(o=>{this.hasKey(o)&&console.warn(`[Resolver] already has key: ${o} overwriting`)}),Array.isArray(s)||(typeof s=="string"?s=kb(s):s=[s]);const n=s.map(o=>{let a=o;if(typeof o=="string"){let l=!1;for(let h=0;h<this._parsers.length;h++){const c=this._parsers[h];if(c.test(o)){a=c.parse(o),l=!0;break}}l||(a={src:o})}return a.format||(a.format=a.src.split(".").pop()),a.alias||(a.alias=i),(this._basePath||this._rootPath)&&(a.src=fe.toAbsolute(a.src,this._basePath,this._rootPath)),a.src=this._appendDefaultSearchParams(a.src),a.data=a.data??r,a});i.forEach(o=>{this._assetMap[o]=n})}resolveBundle(t){const s=yo(t);t=xs(t);const r={};return t.forEach(i=>{const n=this._bundles[i];if(n){const o=this.resolve(n),a={};for(const l in o){const h=o[l];a[this._extractAssetIdFromBundle(i,l)]=h}r[i]=a}}),s?r[t[0]]:r}resolveUrl(t){const s=this.resolve(t);if(typeof t!="string"){const r={};for(const i in s)r[i]=s[i].src;return r}return s.src}resolve(t){const s=yo(t);t=xs(t);const r={};return t.forEach(i=>{if(!this._resolverHash[i])if(this._assetMap[i]){let n=this._assetMap[i];const o=this._getPreferredOrder(n),a=n[0];o==null||o.priority.forEach(l=>{o.params[l].forEach(h=>{const c=n.filter(u=>u[l]?u[l]===h:!1);c.length&&(n=c)})}),this._resolverHash[i]=n[0]??a}else{let n=i;(this._basePath||this._rootPath)&&(n=fe.toAbsolute(n,this._basePath,this._rootPath)),n=this._appendDefaultSearchParams(n),this._resolverHash[i]={src:n}}r[i]=this._resolverHash[i]}),s?r[t[0]]:r}hasKey(t){return!!this._assetMap[t]}hasBundle(t){return!!this._bundles[t]}_getPreferredOrder(t){for(let s=0;s<t.length;s++){const r=t[0],i=this._preferredOrder.find(n=>n.params.format.includes(r.format));if(i)return i}return this._preferredOrder[0]}_appendDefaultSearchParams(t){if(!this._defaultSearchParams)return t;const s=/\?/.test(t)?"&":"?";return`${t}${s}${this._defaultSearchParams}`}}class uw{constructor(){this._detections=[],this._initialized=!1,this.resolver=new cw,this.loader=new Hb,this.cache=vi,this._backgroundLoader=new Ub(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(t={}){var n,o,a;if(this._initialized){console.warn("[Assets]AssetManager already initialized, did you load before calling this Asset.init()?");return}if(this._initialized=!0,t.defaultSearchParams&&this.resolver.setDefaultSearchParams(t.defaultSearchParams),t.basePath&&(this.resolver.basePath=t.basePath),t.bundleIdentifier&&this.resolver.setBundleIdentifier(t.bundleIdentifier),t.manifest){let l=t.manifest;typeof l=="string"&&(l=await this.load(l)),this.resolver.addManifest(l)}const s=((n=t.texturePreference)==null?void 0:n.resolution)??1,r=typeof s=="number"?[s]:s;let i=[];if((o=t.texturePreference)!=null&&o.format){const l=(a=t.texturePreference)==null?void 0:a.format;i=typeof l=="string"?[l]:l;for(const h of this._detections)await h.test()||(i=await h.remove(i))}else for(const l of this._detections)await l.test()&&(i=await l.add(i));this.resolver.prefer({params:{format:i,resolution:r}}),t.preferences&&this.setPreferences(t.preferences)}add(t,s,r){this.resolver.add(t,s,r)}async load(t,s){this._initialized||await this.init();const r=yo(t),i=xs(t).map(a=>typeof a!="string"?(this.resolver.add(a.src,a),a.src):(this.resolver.hasKey(a)||this.resolver.add(a,a),a)),n=this.resolver.resolve(i),o=await this._mapLoadToResolve(n,s);return r?o[i[0]]:o}addBundle(t,s){this.resolver.addBundle(t,s)}async loadBundle(t,s){this._initialized||await this.init();let r=!1;typeof t=="string"&&(r=!0,t=[t]);const i=this.resolver.resolveBundle(t),n={},o=Object.keys(i);let a=0,l=0;const h=()=>{s==null||s(++a/l)},c=o.map(u=>{const f=i[u];return l+=Object.keys(f).length,this._mapLoadToResolve(f,h).then(p=>{n[u]=p})});return await Promise.all(c),r?n[t[0]]:n}async backgroundLoad(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const s=this.resolver.resolve(t);this._backgroundLoader.add(Object.values(s))}async backgroundLoadBundle(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const s=this.resolver.resolveBundle(t);Object.values(s).forEach(r=>{this._backgroundLoader.add(Object.values(r))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(t){if(typeof t=="string")return vi.get(t);const s={};for(let r=0;r<t.length;r++)s[r]=vi.get(t[r]);return s}async _mapLoadToResolve(t,s){const r=Object.values(t),i=Object.keys(t);this._backgroundLoader.active=!1;const n=await this.loader.load(r,s);this._backgroundLoader.active=!0;const o={};return r.forEach((a,l)=>{const h=n[a.src],c=[a.src];a.alias&&c.push(...a.alias),o[i[l]]=h,vi.set(c,h)}),o}async unload(t){this._initialized||await this.init();const s=xs(t).map(i=>typeof i!="string"?i.src:i),r=this.resolver.resolve(s);await this._unloadFromResolved(r)}async unloadBundle(t){this._initialized||await this.init(),t=xs(t);const s=this.resolver.resolveBundle(t),r=Object.keys(s).map(i=>this._unloadFromResolved(s[i]));await Promise.all(r)}async _unloadFromResolved(t){const s=Object.values(t);s.forEach(r=>{vi.remove(r.src)}),await this.loader.unload(s)}get detections(){return this._detections}get preferWorkers(){return Yo.config.preferWorkers}set preferWorkers(t){bt("7.2.0","Assets.prefersWorkers is deprecated, use Assets.setPreferences({ preferWorkers: true }) instead."),this.setPreferences({preferWorkers:t})}setPreferences(t){this.loader.parsers.forEach(s=>{s.config&&Object.keys(s.config).filter(r=>r in t).forEach(r=>{s.config[r]=t[r]})})}}const Si=new uw;nt.handleByList(Z.LoadParser,Si.loader.parsers).handleByList(Z.ResolveParser,Si.resolver.parsers).handleByList(Z.CacheParser,Si.cache.parsers).handleByList(Z.DetectionParser,Si.detections);const fw={extension:Z.CacheParser,test:e=>Array.isArray(e)&&e.every(t=>t instanceof J),getCacheableAssets:(e,t)=>{const s={};return e.forEach(r=>{t.forEach((i,n)=>{s[r+(n===0?"":n+1)]=i})}),s}};nt.add(fw);const dw={extension:{type:Z.DetectionParser,priority:1},test:async()=>{if(!globalThis.createImageBitmap)return!1;const e="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A=",t=await q.ADAPTER.fetch(e).then(s=>s.blob());return createImageBitmap(t).then(()=>!0,()=>!1)},add:async e=>[...e,"avif"],remove:async e=>e.filter(t=>t!=="avif")};nt.add(dw);const pw={extension:{type:Z.DetectionParser,priority:0},test:async()=>{if(!globalThis.createImageBitmap)return!1;const e="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA=",t=await q.ADAPTER.fetch(e).then(s=>s.blob());return createImageBitmap(t).then(()=>!0,()=>!1)},add:async e=>[...e,"webp"],remove:async e=>e.filter(t=>t!=="webp")};nt.add(pw);const nf=["png","jpg","jpeg"],mw={extension:{type:Z.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async e=>[...e,...nf],remove:async e=>e.filter(t=>!nf.includes(t))};nt.add(mw);const gw={extension:Z.ResolveParser,test:Yo.test,parse:e=>{var t;return{resolution:parseFloat(((t=q.RETINA_PREFIX.exec(e))==null?void 0:t[1])??"1"),format:e.split(".").pop(),src:e}}};nt.add(gw);var be=(e=>(e[e.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",e[e.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",e[e.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",e[e.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",e[e.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",e[e.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",e[e.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",e[e.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",e[e.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",e[e.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",e[e.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",e[e.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",e[e.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",e[e.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",e[e.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",e[e.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",e[e.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",e[e.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",e[e.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",e))(be||{});const vo={33776:.5,33777:.5,33778:1,33779:1,35916:.5,35917:.5,35918:1,35919:1,37488:.5,37489:.5,37490:1,37491:1,37492:.5,37496:1,37493:.5,37497:1,37494:.5,37495:.5,35840:.5,35842:.5,35841:.25,35843:.25,36196:.5,35986:.5,35986:1,34798:1,37808:1};let ds,Pr;function of(){Pr={s3tc:ds.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:ds.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:ds.getExtension("WEBGL_compressed_texture_etc"),etc1:ds.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:ds.getExtension("WEBGL_compressed_texture_pvrtc")||ds.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:ds.getExtension("WEBGL_compressed_texture_atc"),astc:ds.getExtension("WEBGL_compressed_texture_astc")}}const _w={extension:{type:Z.DetectionParser,priority:2},test:async()=>{const t=q.ADAPTER.createCanvas().getContext("webgl");return t?(ds=t,!0):(console.warn("WebGL not available for compressed textures."),!1)},add:async e=>{Pr||of();const t=[];for(const s in Pr)Pr[s]&&t.push(s);return[...t,...e]},remove:async e=>(Pr||of(),e.filter(t=>!(t in Pr)))};nt.add(_w);class yw extends tn{constructor(t,s={width:1,height:1,autoLoad:!0}){let r,i;typeof t=="string"?(r=t,i=new Uint8Array):(r=null,i=t),super(i,s),this.origin=r,this.buffer=i?new Fl(i):null,this._load=null,this.loaded=!1,this.origin!==null&&s.autoLoad!==!1&&this.load(),this.origin===null&&this.buffer&&(this._load=Promise.resolve(this),this.loaded=!0,this.onBlobLoaded(this.buffer.rawBinaryData))}onBlobLoaded(t){}load(){return this._load?this._load:(this._load=fetch(this.origin).then(t=>t.blob()).then(t=>t.arrayBuffer()).then(t=>(this.data=new Uint32Array(t),this.buffer=new Fl(t),this.loaded=!0,this.onBlobLoaded(t),this.update(),this)),this._load)}}class hr extends yw{constructor(t,s){super(t,s),this.format=s.format,this.levels=s.levels||1,this._width=s.width,this._height=s.height,this._extension=hr._formatToExtension(this.format),(s.levelBuffers||this.buffer)&&(this._levelBuffers=s.levelBuffers||hr._createLevelBuffers(t instanceof Uint8Array?t:this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height))}upload(t,s,r){const i=t.gl;if(!t.context.extensions[this._extension])throw new Error(`${this._extension} textures are not supported on the current machine`);if(!this._levelBuffers)return!1;for(let o=0,a=this.levels;o<a;o++){const{levelID:l,levelWidth:h,levelHeight:c,levelBuffer:u}=this._levelBuffers[o];i.compressedTexImage2D(i.TEXTURE_2D,l,this.format,h,c,0,u)}return!0}onBlobLoaded(){this._levelBuffers=hr._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)}static _formatToExtension(t){if(t>=33776&&t<=33779)return"s3tc";if(t>=37488&&t<=37497)return"etc";if(t>=35840&&t<=35843)return"pvrtc";if(t>=36196)return"etc1";if(t>=35986&&t<=34798)return"atc";throw new Error("Invalid (compressed) texture format given!")}static _createLevelBuffers(t,s,r,i,n,o,a){const l=new Array(r);let h=t.byteOffset,c=o,u=a,f=c+i-1&~(i-1),p=u+n-1&~(n-1),d=f*p*vo[s];for(let m=0;m<r;m++)l[m]={levelID:m,levelWidth:r>1?c:f,levelHeight:r>1?u:p,levelBuffer:new Uint8Array(t.buffer,h,d)},h+=d,c=c>>1||1,u=u>>1||1,f=c+i-1&~(i-1),p=u+n-1&~(n-1),d=f*p*vo[s];return l}}const Xa=4,Mn=124,vw=32,af=20,xw=542327876,On={SIZE:1,FLAGS:2,HEIGHT:3,WIDTH:4,MIPMAP_COUNT:7,PIXEL_FORMAT:19},Ew={SIZE:0,FLAGS:1,FOURCC:2,RGB_BITCOUNT:3,R_BIT_MASK:4,G_BIT_MASK:5,B_BIT_MASK:6,A_BIT_MASK:7},Bn={DXGI_FORMAT:0,RESOURCE_DIMENSION:1,MISC_FLAG:2,ARRAY_SIZE:3,MISC_FLAGS2:4},bw=1,ww=2,Tw=4,Sw=64,Aw=512,Iw=131072,Cw=827611204,Rw=861165636,Pw=894720068,Mw=808540228,Ow=4,Bw={[Cw]:be.COMPRESSED_RGBA_S3TC_DXT1_EXT,[Rw]:be.COMPRESSED_RGBA_S3TC_DXT3_EXT,[Pw]:be.COMPRESSED_RGBA_S3TC_DXT5_EXT},Dw={70:be.COMPRESSED_RGBA_S3TC_DXT1_EXT,71:be.COMPRESSED_RGBA_S3TC_DXT1_EXT,73:be.COMPRESSED_RGBA_S3TC_DXT3_EXT,74:be.COMPRESSED_RGBA_S3TC_DXT3_EXT,76:be.COMPRESSED_RGBA_S3TC_DXT5_EXT,77:be.COMPRESSED_RGBA_S3TC_DXT5_EXT,72:be.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,75:be.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,78:be.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT};function Fw(e){const t=new Uint32Array(e);if(t[0]!==xw)throw new Error("Invalid DDS file magic word");const r=new Uint32Array(e,0,Mn/Uint32Array.BYTES_PER_ELEMENT),i=r[On.HEIGHT],n=r[On.WIDTH],o=r[On.MIPMAP_COUNT],a=new Uint32Array(e,On.PIXEL_FORMAT*Uint32Array.BYTES_PER_ELEMENT,vw/Uint32Array.BYTES_PER_ELEMENT),l=a[bw];if(l&Tw){const h=a[Ew.FOURCC];if(h!==Mw){const _=Bw[h],v=Xa+Mn,S=new Uint8Array(e,v);return[new hr(S,{format:_,width:n,height:i,levels:o})]}const c=Xa+Mn,u=new Uint32Array(t.buffer,c,af/Uint32Array.BYTES_PER_ELEMENT),f=u[Bn.DXGI_FORMAT],p=u[Bn.RESOURCE_DIMENSION],d=u[Bn.MISC_FLAG],m=u[Bn.ARRAY_SIZE],g=Dw[f];if(g===void 0)throw new Error(`DDSParser cannot parse texture data with DXGI format ${f}`);if(d===Ow)throw new Error("DDSParser does not support cubemap textures");if(p===6)throw new Error("DDSParser does not supported 3D texture data");const y=new Array,E=Xa+Mn+af;if(m===1)y.push(new Uint8Array(e,E));else{const _=vo[g];let v=0,S=n,A=i;for(let b=0;b<o;b++){const R=Math.max(1,S+3&-4),F=Math.max(1,A+3&-4),U=R*F*_;v+=U,S=S>>>1,A=A>>>1}let w=E;for(let b=0;b<m;b++)y.push(new Uint8Array(e,w,v)),w+=v}return y.map(_=>new hr(_,{format:g,width:n,height:i,levels:o}))}throw l&Sw?new Error("DDSParser does not support uncompressed texture data."):l&Aw?new Error("DDSParser does not supported YUV uncompressed texture data."):l&Iw?new Error("DDSParser does not support single-channel (lumninance) texture data!"):l&ww?new Error("DDSParser does not support single-channel (alpha) texture data!"):new Error("DDSParser failed to load a texture file due to an unknown reason!")}const lf=[171,75,84,88,32,49,49,187,13,10,26,10],Lw=67305985,Oe={FILE_IDENTIFIER:0,ENDIANNESS:12,GL_TYPE:16,GL_TYPE_SIZE:20,GL_FORMAT:24,GL_INTERNAL_FORMAT:28,GL_BASE_INTERNAL_FORMAT:32,PIXEL_WIDTH:36,PIXEL_HEIGHT:40,PIXEL_DEPTH:44,NUMBER_OF_ARRAY_ELEMENTS:48,NUMBER_OF_FACES:52,NUMBER_OF_MIPMAP_LEVELS:56,BYTES_OF_KEY_VALUE_DATA:60},ql=64,hf={[lt.UNSIGNED_BYTE]:1,[lt.UNSIGNED_SHORT]:2,[lt.INT]:4,[lt.UNSIGNED_INT]:4,[lt.FLOAT]:4,[lt.HALF_FLOAT]:8},Nw={[z.RGBA]:4,[z.RGB]:3,[z.RG]:2,[z.RED]:1,[z.LUMINANCE]:1,[z.LUMINANCE_ALPHA]:2,[z.ALPHA]:1},Uw={[lt.UNSIGNED_SHORT_4_4_4_4]:2,[lt.UNSIGNED_SHORT_5_5_5_1]:2,[lt.UNSIGNED_SHORT_5_6_5]:2};function kw(e,t,s=!1){const r=new DataView(t);if(!Gw(e,r))return null;const i=r.getUint32(Oe.ENDIANNESS,!0)===Lw,n=r.getUint32(Oe.GL_TYPE,i),o=r.getUint32(Oe.GL_FORMAT,i),a=r.getUint32(Oe.GL_INTERNAL_FORMAT,i),l=r.getUint32(Oe.PIXEL_WIDTH,i),h=r.getUint32(Oe.PIXEL_HEIGHT,i)||1,c=r.getUint32(Oe.PIXEL_DEPTH,i)||1,u=r.getUint32(Oe.NUMBER_OF_ARRAY_ELEMENTS,i)||1,f=r.getUint32(Oe.NUMBER_OF_FACES,i),p=r.getUint32(Oe.NUMBER_OF_MIPMAP_LEVELS,i),d=r.getUint32(Oe.BYTES_OF_KEY_VALUE_DATA,i);if(h===0||c!==1)throw new Error("Only 2D textures are supported");if(f!==1)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(u!==1)throw new Error("WebGL does not support array textures");const m=4,g=4,y=l+3&-4,E=h+3&-4,_=new Array(u);let v=l*h;n===0&&(v=y*E);let S;if(n!==0?hf[n]?S=hf[n]*Nw[o]:S=Uw[n]:S=vo[a],S===void 0)throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");const A=s?$w(r,d,i):null;let b=v*S,R=l,F=h,U=y,H=E,B=ql+d;for(let C=0;C<p;C++){const ht=r.getUint32(B,i);let Q=B+4;for(let G=0;G<u;G++){let rt=_[G];rt||(rt=_[G]=new Array(p)),rt[C]={levelID:C,levelWidth:p>1||n!==0?R:U,levelHeight:p>1||n!==0?F:H,levelBuffer:new Uint8Array(t,Q,b)},Q+=b}B+=ht+4,B=B%4!==0?B+4-B%4:B,R=R>>1||1,F=F>>1||1,U=R+m-1&~(m-1),H=F+g-1&~(g-1),b=U*H*S}return n!==0?{uncompressed:_.map(C=>{let ht=C[0].levelBuffer,Q=!1;return n===lt.FLOAT?ht=new Float32Array(C[0].levelBuffer.buffer,C[0].levelBuffer.byteOffset,C[0].levelBuffer.byteLength/4):n===lt.UNSIGNED_INT?(Q=!0,ht=new Uint32Array(C[0].levelBuffer.buffer,C[0].levelBuffer.byteOffset,C[0].levelBuffer.byteLength/4)):n===lt.INT&&(Q=!0,ht=new Int32Array(C[0].levelBuffer.buffer,C[0].levelBuffer.byteOffset,C[0].levelBuffer.byteLength/4)),{resource:new tn(ht,{width:C[0].levelWidth,height:C[0].levelHeight}),type:n,format:Q?Hw(o):o}}),kvData:A}:{compressed:_.map(C=>new hr(null,{format:a,width:l,height:h,levels:p,levelBuffers:C})),kvData:A}}function Gw(e,t){for(let s=0;s<lf.length;s++)if(t.getUint8(s)!==lf[s])return console.error(`${e} is not a valid *.ktx file!`),!1;return!0}function Hw(e){switch(e){case z.RGBA:return z.RGBA_INTEGER;case z.RGB:return z.RGB_INTEGER;case z.RG:return z.RG_INTEGER;case z.RED:return z.RED_INTEGER;default:return e}}function $w(e,t,s){const r=new Map;let i=0;for(;i<t;){const n=e.getUint32(ql+i,s),o=ql+i+4,a=3-(n+3)%4;if(n===0||n>t-i){console.error("KTXLoader: keyAndValueByteSize out of bounds");break}let l=0;for(;l<n&&e.getUint8(o+l)!==0;l++);if(l===-1){console.error("KTXLoader: Failed to find null byte terminating kvData key");break}const h=new TextDecoder().decode(new Uint8Array(e.buffer,o,l)),c=new DataView(e.buffer,o+l+1,n-l-1);r.set(h,c),i+=4+n+a}return r}const Ww={extension:{type:Z.LoadParser,priority:hs.High},name:"loadDDS",test(e){return vr(e,".dds")},async load(e,t,s){const i=await(await q.ADAPTER.fetch(e)).arrayBuffer(),o=Fw(i).map(a=>{const l=new mt(a,{mipmap:as.OFF,alphaMode:Ve.NO_PREMULTIPLIED_ALPHA,resolution:Hs(e),...t.data});return jo(l,s,e)});return o.length===1?o[0]:o},unload(e){Array.isArray(e)?e.forEach(t=>t.destroy(!0)):e.destroy(!0)}};nt.add(Ww);const Xw={extension:{type:Z.LoadParser,priority:hs.High},name:"loadKTX",test(e){return vr(e,".ktx")},async load(e,t,s){const i=await(await q.ADAPTER.fetch(e)).arrayBuffer(),{compressed:n,uncompressed:o,kvData:a}=kw(e,i),l=n??o,h={mipmap:as.OFF,alphaMode:Ve.NO_PREMULTIPLIED_ALPHA,resolution:Hs(e),...t.data},c=l.map(u=>{l===o&&Object.assign(h,{type:u.type,format:u.format});const f=new mt(u,h);return f.ktxKeyValueData=a,jo(f,s,e)});return c.length===1?c[0]:c},unload(e){Array.isArray(e)?e.forEach(t=>t.destroy(!0)):e.destroy(!0)}};nt.add(Xw);const zw={extension:Z.ResolveParser,test:e=>{const s=e.split("?")[0].split(".").pop();return["basis","ktx","dds"].includes(s)},parse:e=>{var r,i;if(e.split("?")[0].split(".").pop()==="ktx"){const n=[".s3tc.ktx",".s3tc_sRGB.ktx",".etc.ktx",".etc1.ktx",".pvrt.ktx",".atc.ktx",".astc.ktx"];if(n.some(o=>e.endsWith(o)))return{resolution:parseFloat(((r=q.RETINA_PREFIX.exec(e))==null?void 0:r[1])??"1"),format:n.find(o=>e.endsWith(o)),src:e}}return{resolution:parseFloat(((i=q.RETINA_PREFIX.exec(e))==null?void 0:i[1])??"1"),format:e.split(".").pop(),src:e}}};nt.add(zw);const Vw=new yt,jw=4,Ai=class{constructor(e){this.renderer=e}async image(e,t,s){const r=new Image;return r.src=await this.base64(e,t,s),r}async base64(e,t,s){const r=this.canvas(e);if(r.toBlob!==void 0)return new Promise((i,n)=>{r.toBlob(o=>{if(!o){n(new Error("ICanvas.toBlob failed!"));return}const a=new FileReader;a.onload=()=>i(a.result),a.onerror=n,a.readAsDataURL(o)},t,s)});if(r.toDataURL!==void 0)return r.toDataURL(t,s);if(r.convertToBlob!==void 0){const i=await r.convertToBlob({type:t,quality:s});return new Promise((n,o)=>{const a=new FileReader;a.onload=()=>n(a.result),a.onerror=o,a.readAsDataURL(i)})}throw new Error("Extract.base64() requires ICanvas.toDataURL, ICanvas.toBlob, or ICanvas.convertToBlob to be implemented")}canvas(e,t){const{pixels:s,width:r,height:i,flipY:n}=this._rawPixels(e,t);n&&Ai._flipY(s,r,i),Ai._unpremultiplyAlpha(s);const o=new k0(r,i,1),a=new ImageData(new Uint8ClampedArray(s.buffer),r,i);return o.context.putImageData(a,0,0),o.canvas}pixels(e,t){const{pixels:s,width:r,height:i,flipY:n}=this._rawPixels(e,t);return n&&Ai._flipY(s,r,i),Ai._unpremultiplyAlpha(s),s}_rawPixels(e,t){const s=this.renderer;if(!s)throw new Error("The Extract has already been destroyed");let r,i=!1,n,o=!1;if(e&&(e instanceof _r?n=e:(n=s.generateTexture(e,{resolution:s.resolution,multisample:s.multisample}),o=!0)),n){if(r=n.baseTexture.resolution,t=t??n.frame,i=!1,!o){s.renderTexture.bind(n);const u=n.framebuffer.glFramebuffers[s.CONTEXT_UID];u.blitFramebuffer&&s.framebuffer.bind(u.blitFramebuffer)}}else r=s.resolution,t||(t=Vw,t.width=s.width/r,t.height=s.height/r),i=!0,s.renderTexture.bind();const a=Math.round(t.width*r),l=Math.round(t.height*r),h=new Uint8Array(jw*a*l),c=s.gl;return c.readPixels(Math.round(t.x*r),Math.round(t.y*r),a,l,c.RGBA,c.UNSIGNED_BYTE,h),o&&(n==null||n.destroy(!0)),{pixels:h,width:a,height:l,flipY:i}}destroy(){this.renderer=null}static _flipY(e,t,s){const r=t<<2,i=s>>1,n=new Uint8Array(r);for(let o=0;o<i;o++){const a=o*r,l=(s-o-1)*r;n.set(e.subarray(a,a+r)),e.copyWithin(a,l,l+r),e.set(n,l)}}static _unpremultiplyAlpha(e){e instanceof Uint8ClampedArray&&(e=new Uint8Array(e.buffer));const t=e.length;for(let s=0;s<t;s+=4){const r=e[s+3];if(r!==0){const i=255.001/r;e[s]=e[s]*i+.5,e[s+1]=e[s+1]*i+.5,e[s+2]=e[s+2]*i+.5}}}};let tm=Ai;tm.extension={name:"extract",type:Z.RendererSystem};nt.add(tm);const xo={build(e){const t=e.points;let s,r,i,n,o,a;if(e.type===oe.CIRC){const d=e.shape;s=d.x,r=d.y,o=a=d.radius,i=n=0}else if(e.type===oe.ELIP){const d=e.shape;s=d.x,r=d.y,o=d.width,a=d.height,i=n=0}else{const d=e.shape,m=d.width/2,g=d.height/2;s=d.x+m,r=d.y+g,o=a=Math.max(0,Math.min(d.radius,Math.min(m,g))),i=m-o,n=g-a}if(!(o>=0&&a>=0&&i>=0&&n>=0)){t.length=0;return}const l=Math.ceil(2.3*Math.sqrt(o+a)),h=l*8+(i?4:0)+(n?4:0);if(t.length=h,h===0)return;if(l===0){t.length=8,t[0]=t[6]=s+i,t[1]=t[3]=r+n,t[2]=t[4]=s-i,t[5]=t[7]=r-n;return}let c=0,u=l*4+(i?2:0)+2,f=u,p=h;{const d=i+o,m=n,g=s+d,y=s-d,E=r+m;if(t[c++]=g,t[c++]=E,t[--u]=E,t[--u]=y,n){const _=r-m;t[f++]=y,t[f++]=_,t[--p]=_,t[--p]=g}}for(let d=1;d<l;d++){const m=Math.PI/2*(d/l),g=i+Math.cos(m)*o,y=n+Math.sin(m)*a,E=s+g,_=s-g,v=r+y,S=r-y;t[c++]=E,t[c++]=v,t[--u]=v,t[--u]=_,t[f++]=_,t[f++]=S,t[--p]=S,t[--p]=E}{const d=i,m=n+a,g=s+d,y=s-d,E=r+m,_=r-m;t[c++]=g,t[c++]=E,t[--p]=_,t[--p]=g,i&&(t[c++]=y,t[c++]=E,t[--p]=_,t[--p]=y)}},triangulate(e,t){const s=e.points,r=t.points,i=t.indices;if(s.length===0)return;let n=r.length/2;const o=n;let a,l;if(e.type!==oe.RREC){const c=e.shape;a=c.x,l=c.y}else{const c=e.shape;a=c.x+c.width/2,l=c.y+c.height/2}const h=e.matrix;r.push(e.matrix?h.a*a+h.c*l+h.tx:a,e.matrix?h.b*a+h.d*l+h.ty:l),n++,r.push(s[0],s[1]);for(let c=2;c<s.length;c+=2)r.push(s[c],s[c+1]),i.push(n++,o,n);i.push(o+1,o,n)}};function cf(e,t=!1){const s=e.length;if(s<6)return;let r=0;for(let i=0,n=e[s-2],o=e[s-1];i<s;i+=2){const a=e[i],l=e[i+1];r+=(a-n)*(l+o),n=a,o=l}if(!t&&r>0||t&&r<=0){const i=s/2;for(let n=i+i%2;n<s;n+=2){const o=s-n-2,a=s-n-1,l=n,h=n+1;[e[o],e[l]]=[e[l],e[o]],[e[a],e[h]]=[e[h],e[a]]}}}const em={build(e){e.points=e.shape.points.slice()},triangulate(e,t){let s=e.points;const r=e.holes,i=t.points,n=t.indices;if(s.length>=6){cf(s,!1);const o=[];for(let h=0;h<r.length;h++){const c=r[h];cf(c.points,!0),o.push(s.length/2),s=s.concat(c.points)}const a=hv(s,o,2);if(!a)return;const l=i.length/2;for(let h=0;h<a.length;h+=3)n.push(a[h]+l),n.push(a[h+1]+l),n.push(a[h+2]+l);for(let h=0;h<s.length;h++)i.push(s[h])}}},Yw={build(e){const t=e.shape,s=t.x,r=t.y,i=t.width,n=t.height,o=e.points;o.length=0,i>=0&&n>=0&&o.push(s,r,s+i,r,s+i,r+n,s,r+n)},triangulate(e,t){const s=e.points,r=t.points;if(s.length===0)return;const i=r.length/2;r.push(s[0],s[1],s[2],s[3],s[6],s[7],s[4],s[5]),t.indices.push(i,i+1,i+2,i+1,i+2,i+3)}},Kw={build(e){xo.build(e)},triangulate(e,t){xo.triangulate(e,t)}};var Le=(e=>(e.MITER="miter",e.BEVEL="bevel",e.ROUND="round",e))(Le||{}),ir=(e=>(e.BUTT="butt",e.ROUND="round",e.SQUARE="square",e))(ir||{});const si={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount(e,t=20){if(!this.adaptive||!e||isNaN(e))return t;let s=Math.ceil(e/this.maxLength);return s<this.minSegments?s=this.minSegments:s>this.maxSegments&&(s=this.maxSegments),s}};class uf{static curveTo(t,s,r,i,n,o){const a=o[o.length-2],h=o[o.length-1]-s,c=a-t,u=i-s,f=r-t,p=Math.abs(h*f-c*u);if(p<1e-8||n===0)return(o[o.length-2]!==t||o[o.length-1]!==s)&&o.push(t,s),null;const d=h*h+c*c,m=u*u+f*f,g=h*u+c*f,y=n*Math.sqrt(d)/p,E=n*Math.sqrt(m)/p,_=y*g/d,v=E*g/m,S=y*f+E*c,A=y*u+E*h,w=c*(E+_),b=h*(E+_),R=f*(y+v),F=u*(y+v),U=Math.atan2(b-A,w-S),H=Math.atan2(F-A,R-S);return{cx:S+t,cy:A+s,radius:n,startAngle:U,endAngle:H,anticlockwise:c*u>f*h}}static arc(t,s,r,i,n,o,a,l,h){const c=a-o,u=si._segmentsCount(Math.abs(c)*n,Math.ceil(Math.abs(c)/mo)*40),f=c/(u*2),p=f*2,d=Math.cos(f),m=Math.sin(f),g=u-1,y=g%1/g;for(let E=0;E<=g;++E){const _=E+y*E,v=f+o+p*_,S=Math.cos(v),A=-Math.sin(v);h.push((d*S+m*A)*n+r,(d*-A+m*S)*n+i)}}}class qw{constructor(){this.reset()}begin(t,s,r){this.reset(),this.style=t,this.start=s,this.attribStart=r}end(t,s){this.attribSize=s-this.attribStart,this.size=t-this.start}reset(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0}}class qh{static curveLength(t,s,r,i,n,o,a,l){let c=0,u=0,f=0,p=0,d=0,m=0,g=0,y=0,E=0,_=0,v=0,S=t,A=s;for(let w=1;w<=10;++w)u=w/10,f=u*u,p=f*u,d=1-u,m=d*d,g=m*d,y=g*t+3*m*u*r+3*d*f*n+p*a,E=g*s+3*m*u*i+3*d*f*o+p*l,_=S-y,v=A-E,S=y,A=E,c+=Math.sqrt(_*_+v*v);return c}static curveTo(t,s,r,i,n,o,a){const l=a[a.length-2],h=a[a.length-1];a.length-=2;const c=si._segmentsCount(qh.curveLength(l,h,t,s,r,i,n,o));let u=0,f=0,p=0,d=0,m=0;a.push(l,h);for(let g=1,y=0;g<=c;++g)y=g/c,u=1-y,f=u*u,p=f*u,d=y*y,m=d*y,a.push(p*l+3*f*y*t+3*u*d*r+m*n,p*h+3*f*y*s+3*u*d*i+m*o)}}function ff(e,t,s,r,i,n,o,a){const l=e-s*i,h=t-r*i,c=e+s*n,u=t+r*n;let f,p;o?(f=r,p=-s):(f=-r,p=s);const d=l+f,m=h+p,g=c+f,y=u+p;return a.push(d,m,g,y),2}function Ks(e,t,s,r,i,n,o,a){const l=s-e,h=r-t;let c=Math.atan2(l,h),u=Math.atan2(i-e,n-t);a&&c<u?c+=Math.PI*2:!a&&c>u&&(u+=Math.PI*2);let f=c;const p=u-c,d=Math.abs(p),m=Math.sqrt(l*l+h*h),g=(15*d*Math.sqrt(m)/Math.PI>>0)+1,y=p/g;if(f+=y,a){o.push(e,t,s,r);for(let E=1,_=f;E<g;E++,_+=y)o.push(e,t,e+Math.sin(_)*m,t+Math.cos(_)*m);o.push(e,t,i,n)}else{o.push(s,r,e,t);for(let E=1,_=f;E<g;E++,_+=y)o.push(e+Math.sin(_)*m,t+Math.cos(_)*m,e,t);o.push(i,n,e,t)}return g*2}function Zw(e,t){const s=e.shape;let r=e.points||s.points.slice();const i=t.closePointEps;if(r.length===0)return;const n=e.lineStyle,o=new It(r[0],r[1]),a=new It(r[r.length-2],r[r.length-1]),l=s.type!==oe.POLY||s.closeStroke,h=Math.abs(o.x-a.x)<i&&Math.abs(o.y-a.y)<i;if(l){r=r.slice(),h&&(r.pop(),r.pop(),a.set(r[r.length-2],r[r.length-1]));const G=(o.x+a.x)*.5,rt=(a.y+o.y)*.5;r.unshift(G,rt),r.push(G,rt)}const c=t.points,u=r.length/2;let f=r.length;const p=c.length/2,d=n.width/2,m=d*d,g=n.miterLimit*n.miterLimit;let y=r[0],E=r[1],_=r[2],v=r[3],S=0,A=0,w=-(E-v),b=y-_,R=0,F=0,U=Math.sqrt(w*w+b*b);w/=U,b/=U,w*=d,b*=d;const H=n.alignment,B=(1-H)*2,C=H*2;l||(n.cap===ir.ROUND?f+=Ks(y-w*(B-C)*.5,E-b*(B-C)*.5,y-w*B,E-b*B,y+w*C,E+b*C,c,!0)+2:n.cap===ir.SQUARE&&(f+=ff(y,E,w,b,B,C,!0,c))),c.push(y-w*B,E-b*B,y+w*C,E+b*C);for(let G=1;G<u-1;++G){y=r[(G-1)*2],E=r[(G-1)*2+1],_=r[G*2],v=r[G*2+1],S=r[(G+1)*2],A=r[(G+1)*2+1],w=-(E-v),b=y-_,U=Math.sqrt(w*w+b*b),w/=U,b/=U,w*=d,b*=d,R=-(v-A),F=_-S,U=Math.sqrt(R*R+F*F),R/=U,F/=U,R*=d,F*=d;const rt=_-y,Ct=E-v,L=_-S,N=A-v,Y=rt*L+Ct*N,it=Ct*L-N*rt,tt=it<0;if(Math.abs(it)<.001*Math.abs(Y)){c.push(_-w*B,v-b*B,_+w*C,v+b*C),Y>=0&&(n.join===Le.ROUND?f+=Ks(_,v,_-w*B,v-b*B,_-R*B,v-F*B,c,!1)+4:f+=2,c.push(_-R*C,v-F*C,_+R*B,v+F*B));continue}const dt=(-w+y)*(-b+v)-(-w+_)*(-b+E),_t=(-R+S)*(-F+v)-(-R+_)*(-F+A),ct=(rt*_t-L*dt)/it,vt=(N*dt-Ct*_t)/it,Lt=(ct-_)*(ct-_)+(vt-v)*(vt-v),Pt=_+(ct-_)*B,Mt=v+(vt-v)*B,x=_-(ct-_)*C,T=v-(vt-v)*C,I=Math.min(rt*rt+Ct*Ct,L*L+N*N),M=tt?B:C,D=I+M*M*m,$=Lt<=D;let K=n.join;if(K===Le.MITER&&Lt/m>g&&(K=Le.BEVEL),$)switch(K){case Le.MITER:{c.push(Pt,Mt,x,T);break}case Le.BEVEL:{tt?c.push(Pt,Mt,_+w*C,v+b*C,Pt,Mt,_+R*C,v+F*C):c.push(_-w*B,v-b*B,x,T,_-R*B,v-F*B,x,T),f+=2;break}case Le.ROUND:{tt?(c.push(Pt,Mt,_+w*C,v+b*C),f+=Ks(_,v,_+w*C,v+b*C,_+R*C,v+F*C,c,!0)+4,c.push(Pt,Mt,_+R*C,v+F*C)):(c.push(_-w*B,v-b*B,x,T),f+=Ks(_,v,_-w*B,v-b*B,_-R*B,v-F*B,c,!1)+4,c.push(_-R*B,v-F*B,x,T));break}}else{switch(c.push(_-w*B,v-b*B,_+w*C,v+b*C),K){case Le.MITER:{tt?c.push(x,T,x,T):c.push(Pt,Mt,Pt,Mt),f+=2;break}case Le.ROUND:{tt?f+=Ks(_,v,_+w*C,v+b*C,_+R*C,v+F*C,c,!0)+2:f+=Ks(_,v,_-w*B,v-b*B,_-R*B,v-F*B,c,!1)+2;break}}c.push(_-R*B,v-F*B,_+R*C,v+F*C),f+=2}}y=r[(u-2)*2],E=r[(u-2)*2+1],_=r[(u-1)*2],v=r[(u-1)*2+1],w=-(E-v),b=y-_,U=Math.sqrt(w*w+b*b),w/=U,b/=U,w*=d,b*=d,c.push(_-w*B,v-b*B,_+w*C,v+b*C),l||(n.cap===ir.ROUND?f+=Ks(_-w*(B-C)*.5,v-b*(B-C)*.5,_-w*B,v-b*B,_+w*C,v+b*C,c,!1)+2:n.cap===ir.SQUARE&&(f+=ff(_,v,w,b,B,C,!1,c)));const ht=t.indices,Q=si.epsilon*si.epsilon;for(let G=p;G<f+p-2;++G)y=c[G*2],E=c[G*2+1],_=c[(G+1)*2],v=c[(G+1)*2+1],S=c[(G+2)*2],A=c[(G+2)*2+1],!(Math.abs(y*(v-A)+_*(A-E)+S*(E-v))<Q)&&ht.push(G,G+1,G+2)}function Jw(e,t){let s=0;const r=e.shape,i=e.points||r.points,n=r.type!==oe.POLY||r.closeStroke;if(i.length===0)return;const o=t.points,a=t.indices,l=i.length/2,h=o.length/2;let c=h;for(o.push(i[0],i[1]),s=1;s<l;s++)o.push(i[s*2],i[s*2+1]),a.push(c,c+1),c++;n&&a.push(c,h)}function df(e,t){e.lineStyle.native?Jw(e,t):Zw(e,t)}class Zh{static curveLength(t,s,r,i,n,o){const a=t-2*r+n,l=s-2*i+o,h=2*r-2*t,c=2*i-2*s,u=4*(a*a+l*l),f=4*(a*h+l*c),p=h*h+c*c,d=2*Math.sqrt(u+f+p),m=Math.sqrt(u),g=2*u*m,y=2*Math.sqrt(p),E=f/m;return(g*d+m*f*(d-y)+(4*p*u-f*f)*Math.log((2*m+E+d)/(E+y)))/(4*g)}static curveTo(t,s,r,i,n){const o=n[n.length-2],a=n[n.length-1],l=si._segmentsCount(Zh.curveLength(o,a,t,s,r,i));let h=0,c=0;for(let u=1;u<=l;++u){const f=u/l;h=o+(t-o)*f,c=a+(s-a)*f,n.push(h+(t+(r-t)*f-h)*f,c+(s+(i-s)*f-c)*f)}}}const za={[oe.POLY]:em,[oe.CIRC]:xo,[oe.ELIP]:xo,[oe.RECT]:Yw,[oe.RREC]:Kw},pf=[],Dn=[];class Eo{constructor(t,s=null,r=null,i=null){this.points=[],this.holes=[],this.shape=t,this.lineStyle=r,this.fillStyle=s,this.matrix=i,this.type=t.type}clone(){return new Eo(this.shape,this.fillStyle,this.lineStyle,this.matrix)}destroy(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null}}const Sr=new It,sm=class extends fp{constructor(){super(),this.closePointEps=1e-4,this.boundsPadding=0,this.uvsFloat32=null,this.indicesUint16=null,this.batchable=!1,this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.drawCalls=[],this.batchDirty=-1,this.batches=[],this.dirty=0,this.cacheDirty=-1,this.clearDirty=0,this.shapeIndex=0,this._bounds=new go,this.boundsDirty=-1}get bounds(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds}invalidate(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(let e=0;e<this.drawCalls.length;e++)this.drawCalls[e].texArray.clear(),Dn.push(this.drawCalls[e]);this.drawCalls.length=0;for(let e=0;e<this.batches.length;e++){const t=this.batches[e];t.reset(),pf.push(t)}this.batches.length=0}clear(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this}drawShape(e,t=null,s=null,r=null){const i=new Eo(e,t,s,r);return this.graphicsData.push(i),this.dirty++,this}drawHole(e,t=null){if(!this.graphicsData.length)return null;const s=new Eo(e,null,null,t),r=this.graphicsData[this.graphicsData.length-1];return s.lineStyle=r.lineStyle,r.holes.push(s),this.dirty++,this}destroy(){super.destroy();for(let e=0;e<this.graphicsData.length;++e)this.graphicsData[e].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null}containsPoint(e){const t=this.graphicsData;for(let s=0;s<t.length;++s){const r=t[s];if(r.fillStyle.visible&&r.shape&&(r.matrix?r.matrix.applyInverse(e,Sr):Sr.copyFrom(e),r.shape.contains(Sr.x,Sr.y))){let i=!1;if(r.holes){for(let n=0;n<r.holes.length;n++)if(r.holes[n].shape.contains(Sr.x,Sr.y)){i=!0;break}}if(!i)return!0}}return!1}updateBatches(){if(!this.graphicsData.length){this.batchable=!0;return}if(!this.validateBatching())return;this.cacheDirty=this.dirty;const e=this.uvs,t=this.graphicsData;let s=null,r=null;this.batches.length>0&&(s=this.batches[this.batches.length-1],r=s.style);for(let a=this.shapeIndex;a<t.length;a++){this.shapeIndex++;const l=t[a],h=l.fillStyle,c=l.lineStyle;za[l.type].build(l),l.matrix&&this.transformPoints(l.points,l.matrix),(h.visible||c.visible)&&this.processHoles(l.holes);for(let f=0;f<2;f++){const p=f===0?h:c;if(!p.visible)continue;const d=p.texture.baseTexture,m=this.indices.length,g=this.points.length/2;d.wrapMode=ks.REPEAT,f===0?this.processFill(l):this.processLine(l);const y=this.points.length/2-g;y!==0&&(s&&!this._compareStyles(r,p)&&(s.end(m,g),s=null),s||(s=pf.pop()||new qw,s.begin(p,m,g),this.batches.push(s),r=p),this.addUvs(this.points,e,p.texture,g,y,p.matrix))}}const i=this.indices.length,n=this.points.length/2;if(s&&s.end(i,n),this.batches.length===0){this.batchable=!0;return}const o=n>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&o===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=o?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}_compareStyles(e,t){return!(!e||!t||e.texture.baseTexture!==t.texture.baseTexture||e.color+e.alpha!==t.color+t.alpha||!!e.native!=!!t.native)}validateBatching(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(let e=0,t=this.graphicsData.length;e<t;e++){const s=this.graphicsData[e],r=s.fillStyle,i=s.lineStyle;if(r&&!r.texture.baseTexture.valid||i&&!i.texture.baseTexture.valid)return!1}return!0}packBatches(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);const e=this.batches;for(let t=0,s=e.length;t<s;t++){const r=e[t];for(let i=0;i<r.size;i++){const n=r.start+i;this.indicesUint16[n]=this.indicesUint16[n]-r.attribStart}}}isBatchable(){if(this.points.length>65535*2)return!1;const e=this.batches;for(let t=0;t<e.length;t++)if(e[t].style.native)return!1;return this.points.length<sm.BATCHABLE_SIZE*2}buildDrawCalls(){let e=++mt._globalBatch;for(let c=0;c<this.drawCalls.length;c++)this.drawCalls[c].texArray.clear(),Dn.push(this.drawCalls[c]);this.drawCalls.length=0;const t=this.colors,s=this.textureIds;let r=Dn.pop();r||(r=new Nl,r.texArray=new kl),r.texArray.count=0,r.start=0,r.size=0,r.type=rs.TRIANGLES;let i=0,n=null,o=0,a=!1,l=rs.TRIANGLES,h=0;this.drawCalls.push(r);for(let c=0;c<this.batches.length;c++){const u=this.batches[c],f=8,p=u.style,d=p.texture.baseTexture;a!==!!p.native&&(a=!!p.native,l=a?rs.LINES:rs.TRIANGLES,n=null,i=f,e++),n!==d&&(n=d,d._batchEnabled!==e&&(i===f&&(e++,i=0,r.size>0&&(r=Dn.pop(),r||(r=new Nl,r.texArray=new kl),this.drawCalls.push(r)),r.start=h,r.size=0,r.texArray.count=0,r.type=l),d.touched=1,d._batchEnabled=e,d._batchLocation=i,d.wrapMode=ks.REPEAT,r.texArray.elements[r.texArray.count++]=d,i++)),r.size+=u.size,h+=u.size,o=d._batchLocation,this.addColors(t,p.color,p.alpha,u.attribSize,u.attribStart),this.addTextureIds(s,o,u.attribSize,u.attribStart)}mt._globalBatch=e,this.packAttributes()}packAttributes(){const e=this.points,t=this.uvs,s=this.colors,r=this.textureIds,i=new ArrayBuffer(e.length*3*4),n=new Float32Array(i),o=new Uint32Array(i);let a=0;for(let l=0;l<e.length/2;l++)n[a++]=e[l*2],n[a++]=e[l*2+1],n[a++]=t[l*2],n[a++]=t[l*2+1],o[a++]=s[l],n[a++]=r[l];this._buffer.update(i),this._indexBuffer.update(this.indicesUint16)}processFill(e){e.holes.length?em.triangulate(e,this):za[e.type].triangulate(e,this)}processLine(e){df(e,this);for(let t=0;t<e.holes.length;t++)df(e.holes[t],this)}processHoles(e){for(let t=0;t<e.length;t++){const s=e[t];za[s.type].build(s),s.matrix&&this.transformPoints(s.points,s.matrix)}}calculateBounds(){const e=this._bounds;e.clear(),e.addVertexData(this.points,0,this.points.length),e.pad(this.boundsPadding,this.boundsPadding)}transformPoints(e,t){for(let s=0;s<e.length/2;s++){const r=e[s*2],i=e[s*2+1];e[s*2]=t.a*r+t.c*i+t.tx,e[s*2+1]=t.b*r+t.d*i+t.ty}}addColors(e,t,s,r,i=0){const n=Ft.shared.setValue(t).toLittleEndianNumber(),o=Ft.shared.setValue(n).toPremultiplied(s);e.length=Math.max(e.length,i+r);for(let a=0;a<r;a++)e[i+a]=o}addTextureIds(e,t,s,r=0){e.length=Math.max(e.length,r+s);for(let i=0;i<s;i++)e[r+i]=t}addUvs(e,t,s,r,i,n=null){let o=0;const a=t.length,l=s.frame;for(;o<i;){let c=e[(r+o)*2],u=e[(r+o)*2+1];if(n){const f=n.a*c+n.c*u+n.tx;u=n.b*c+n.d*u+n.ty,c=f}o++,t.push(c/l.width,u/l.height)}const h=s.baseTexture;(l.width<h.width||l.height<h.height)&&this.adjustUvs(t,s,a,i)}adjustUvs(e,t,s,r){const i=t.baseTexture,n=1e-6,o=s+r*2,a=t.frame,l=a.width/i.width,h=a.height/i.height;let c=a.x/a.width,u=a.y/a.height,f=Math.floor(e[s]+n),p=Math.floor(e[s+1]+n);for(let d=s+2;d<o;d+=2)f=Math.min(f,Math.floor(e[d]+n)),p=Math.min(p,Math.floor(e[d+1]+n));c-=f,u-=p;for(let d=s;d<o;d+=2)e[d]=(e[d]+c)*l,e[d+1]=(e[d+1]+u)*h}};let rm=sm;rm.BATCHABLE_SIZE=100;class Ko{constructor(){this.color=16777215,this.alpha=1,this.texture=J.WHITE,this.matrix=null,this.visible=!1,this.reset()}clone(){const t=new Ko;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t}reset(){this.color=16777215,this.alpha=1,this.texture=J.WHITE,this.matrix=null,this.visible=!1}destroy(){this.texture=null,this.matrix=null}}class Jh extends Ko{constructor(){super(...arguments),this.width=0,this.alignment=.5,this.native=!1,this.cap=ir.BUTT,this.join=Le.MITER,this.miterLimit=10}clone(){const t=new Jh;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t.width=this.width,t.alignment=this.alignment,t.native=this.native,t.cap=this.cap,t.join=this.join,t.miterLimit=this.miterLimit,t}reset(){super.reset(),this.color=0,this.alignment=.5,this.width=0,this.native=!1}}const Va={},Yn=class extends ye{constructor(e=null){super(),this.shader=null,this.pluginName="batch",this.currentPath=null,this.batches=[],this.batchTint=-1,this.batchDirty=-1,this.vertexData=null,this._fillStyle=new Ko,this._lineStyle=new Jh,this._matrix=null,this._holeMode=!1,this.state=Ss.for2d(),this._geometry=e||new rm,this._geometry.refCount++,this._transformID=-1,this._tintColor=new Ft(16777215),this.blendMode=ut.NORMAL}get geometry(){return this._geometry}clone(){return this.finishPoly(),new Yn(this._geometry)}set blendMode(e){this.state.blendMode=e}get blendMode(){return this.state.blendMode}get tint(){return this._tintColor.value}set tint(e){this._tintColor.setValue(e)}get fill(){return this._fillStyle}get line(){return this._lineStyle}lineStyle(e=null,t=0,s,r=.5,i=!1){return typeof e=="number"&&(e={width:e,color:t,alpha:s,alignment:r,native:i}),this.lineTextureStyle(e)}lineTextureStyle(e){const t={width:0,texture:J.WHITE,color:e!=null&&e.texture?16777215:0,matrix:null,alignment:.5,native:!1,cap:ir.BUTT,join:Le.MITER,miterLimit:10};e=Object.assign(t,e),this.normalizeColor(e),this.currentPath&&this.startPoly();const s=e.width>0&&e.alpha>0;return s?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._lineStyle,{visible:s},e)):this._lineStyle.reset(),this}startPoly(){if(this.currentPath){const e=this.currentPath.points,t=this.currentPath.points.length;t>2&&(this.drawShape(this.currentPath),this.currentPath=new zr,this.currentPath.closeStroke=!1,this.currentPath.points.push(e[t-2],e[t-1]))}else this.currentPath=new zr,this.currentPath.closeStroke=!1}finishPoly(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)}moveTo(e,t){return this.startPoly(),this.currentPath.points[0]=e,this.currentPath.points[1]=t,this}lineTo(e,t){this.currentPath||this.moveTo(0,0);const s=this.currentPath.points,r=s[s.length-2],i=s[s.length-1];return(r!==e||i!==t)&&s.push(e,t),this}_initCurve(e=0,t=0){this.currentPath?this.currentPath.points.length===0&&(this.currentPath.points=[e,t]):this.moveTo(e,t)}quadraticCurveTo(e,t,s,r){this._initCurve();const i=this.currentPath.points;return i.length===0&&this.moveTo(0,0),Zh.curveTo(e,t,s,r,i),this}bezierCurveTo(e,t,s,r,i,n){return this._initCurve(),qh.curveTo(e,t,s,r,i,n,this.currentPath.points),this}arcTo(e,t,s,r,i){this._initCurve(e,t);const n=this.currentPath.points,o=uf.curveTo(e,t,s,r,i,n);if(o){const{cx:a,cy:l,radius:h,startAngle:c,endAngle:u,anticlockwise:f}=o;this.arc(a,l,h,c,u,f)}return this}arc(e,t,s,r,i,n=!1){if(r===i)return this;if(!n&&i<=r?i+=mo:n&&r<=i&&(r+=mo),i-r===0)return this;const a=e+Math.cos(r)*s,l=t+Math.sin(r)*s,h=this._geometry.closePointEps;let c=this.currentPath?this.currentPath.points:null;if(c){const u=Math.abs(c[c.length-2]-a),f=Math.abs(c[c.length-1]-l);u<h&&f<h||c.push(a,l)}else this.moveTo(a,l),c=this.currentPath.points;return uf.arc(a,l,e,t,s,r,i,n,c),this}beginFill(e=0,t){return this.beginTextureFill({texture:J.WHITE,color:e,alpha:t})}normalizeColor(e){const t=Ft.shared.setValue(e.color??0);e.color=t.toNumber(),e.alpha??(e.alpha=t.alpha)}beginTextureFill(e){const t={texture:J.WHITE,color:16777215,matrix:null};e=Object.assign(t,e),this.normalizeColor(e),this.currentPath&&this.startPoly();const s=e.alpha>0;return s?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._fillStyle,{visible:s},e)):this._fillStyle.reset(),this}endFill(){return this.finishPoly(),this._fillStyle.reset(),this}drawRect(e,t,s,r){return this.drawShape(new yt(e,t,s,r))}drawRoundedRect(e,t,s,r,i){return this.drawShape(new Vh(e,t,s,r,i))}drawCircle(e,t,s){return this.drawShape(new Xh(e,t,s))}drawEllipse(e,t,s,r){return this.drawShape(new zh(e,t,s,r))}drawPolygon(...e){let t,s=!0;const r=e[0];r.points?(s=r.closeStroke,t=r.points):Array.isArray(e[0])?t=e[0]:t=e;const i=new zr(t);return i.closeStroke=s,this.drawShape(i),this}drawShape(e){return this._holeMode?this._geometry.drawHole(e,this._matrix):this._geometry.drawShape(e,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this}clear(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this}isFastRect(){const e=this._geometry.graphicsData;return e.length===1&&e[0].shape.type===oe.RECT&&!e[0].matrix&&!e[0].holes.length&&!(e[0].lineStyle.visible&&e[0].lineStyle.width)}_render(e){this.finishPoly();const t=this._geometry;t.updateBatches(),t.batchable?(this.batchDirty!==t.batchDirty&&this._populateBatches(),this._renderBatched(e)):(e.batch.flush(),this._renderDirect(e))}_populateBatches(){const e=this._geometry,t=this.blendMode,s=e.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=e.batchDirty,this.batches.length=s,this.vertexData=new Float32Array(e.points);for(let r=0;r<s;r++){const i=e.batches[r],n=i.style.color,o=new Float32Array(this.vertexData.buffer,i.attribStart*4*2,i.attribSize*2),a=new Float32Array(e.uvsFloat32.buffer,i.attribStart*4*2,i.attribSize*2),l=new Uint16Array(e.indicesUint16.buffer,i.start*2,i.size),h={vertexData:o,blendMode:t,indices:l,uvs:a,_batchRGB:Ft.shared.setValue(n).toRgbArray(),_tintRGB:n,_texture:i.style.texture,alpha:i.style.alpha,worldAlpha:1};this.batches[r]=h}}_renderBatched(e){if(this.batches.length){e.batch.setObjectRenderer(e.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(let t=0,s=this.batches.length;t<s;t++){const r=this.batches[t];r.worldAlpha=this.worldAlpha*r.alpha,e.plugins[this.pluginName].render(r)}}}_renderDirect(e){const t=this._resolveDirectShader(e),s=this._geometry,r=this.worldAlpha,i=t.uniforms,n=s.drawCalls;i.translationMatrix=this.transform.worldTransform,Ft.shared.setValue(this._tintColor).premultiply(r).toArray(i.tint),e.shader.bind(t),e.geometry.bind(s,t),e.state.set(this.state);for(let o=0,a=n.length;o<a;o++)this._renderDrawCallDirect(e,s.drawCalls[o])}_renderDrawCallDirect(e,t){const{texArray:s,type:r,size:i,start:n}=t,o=s.count;for(let a=0;a<o;a++)e.texture.bind(s.elements[a],a);e.geometry.draw(r,i,n)}_resolveDirectShader(e){let t=this.shader;const s=this.pluginName;if(!t){if(!Va[s]){const{maxTextures:r}=e.plugins[s],i=new Int32Array(r);for(let a=0;a<r;a++)i[a]=a;const n={tint:new Float32Array([1,1,1,1]),translationMatrix:new kt,default:ze.from({uSamplers:i},!0)},o=e.plugins[s]._shader.program;Va[s]=new ns(o,n)}t=Va[s]}return t}_calculateBounds(){this.finishPoly();const e=this._geometry;if(!e.graphicsData.length)return;const{minX:t,minY:s,maxX:r,maxY:i}=e.bounds;this._bounds.addFrame(this.transform,t,s,r,i)}containsPoint(e){return this.worldTransform.applyInverse(e,Yn._TEMP_POINT),this._geometry.containsPoint(Yn._TEMP_POINT)}calculateTints(){if(this.batchTint!==this.tint){this.batchTint=this._tintColor.toNumber();for(let e=0;e<this.batches.length;e++){const t=this.batches[e];t._tintRGB=Ft.shared.setValue(this._tintColor).multiply(t._batchRGB).toLittleEndianNumber()}}}calculateVertices(){const e=this.transform._worldID;if(this._transformID===e)return;this._transformID=e;const t=this.transform.worldTransform,s=t.a,r=t.b,i=t.c,n=t.d,o=t.tx,a=t.ty,l=this._geometry.points,h=this.vertexData;let c=0;for(let u=0;u<l.length;u+=2){const f=l[u],p=l[u+1];h[c++]=s*f+i*p+o,h[c++]=n*p+r*f+a}}closePath(){const e=this.currentPath;return e&&(e.closeStroke=!0,this.finishPoly()),this}setMatrix(e){return this._matrix=e,this}beginHole(){return this.finishPoly(),this._holeMode=!0,this}endHole(){return this.finishPoly(),this._holeMode=!1,this}destroy(e){this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,super.destroy(e)}};let qo=Yn;qo.curves=si;qo._TEMP_POINT=new It;class Qw{constructor(t,s){this.uvBuffer=t,this.uvMatrix=s,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}update(t){if(!t&&this._bufferUpdateId===this.uvBuffer._updateID&&this._textureUpdateId===this.uvMatrix._updateID)return;this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;const s=this.uvBuffer.data;(!this.data||this.data.length!==s.length)&&(this.data=new Float32Array(s.length)),this.uvMatrix.multiplyUvs(s,this.data),this._updateID++}}const ja=new It,mf=new zr,im=class extends ye{constructor(e,t,s,r=rs.TRIANGLES){super(),this.geometry=e,this.shader=t,this.state=s||Ss.for2d(),this.drawMode=r,this.start=0,this.size=0,this.uvs=null,this.indices=null,this.vertexData=new Float32Array(1),this.vertexDirty=-1,this._transformID=-1,this._roundPixels=q.ROUND_PIXELS,this.batchUvs=null}get geometry(){return this._geometry}set geometry(e){this._geometry!==e&&(this._geometry&&(this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose()),this._geometry=e,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)}get uvBuffer(){return this.geometry.buffers[1]}get verticesBuffer(){return this.geometry.buffers[0]}set material(e){this.shader=e}get material(){return this.shader}set blendMode(e){this.state.blendMode=e}get blendMode(){return this.state.blendMode}set roundPixels(e){this._roundPixels!==e&&(this._transformID=-1),this._roundPixels=e}get roundPixels(){return this._roundPixels}get tint(){return"tint"in this.shader?this.shader.tint:null}set tint(e){this.shader.tint=e}get tintValue(){return this.shader.tintValue}get texture(){return"texture"in this.shader?this.shader.texture:null}set texture(e){this.shader.texture=e}_render(e){const t=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===rs.TRIANGLES&&t.length<im.BATCHABLE_SIZE*2?this._renderToBatch(e):this._renderDefault(e)}_renderDefault(e){const t=this.shader;t.alpha=this.worldAlpha,t.update&&t.update(),e.batch.flush(),t.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),e.shader.bind(t),e.state.set(this.state),e.geometry.bind(this.geometry,t),e.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)}_renderToBatch(e){const t=this.geometry,s=this.shader;s.uvMatrix&&(s.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=t.indexBuffer.data,this._tintRGB=s._tintRGB,this._texture=s.texture;const r=this.material.pluginName;e.batch.setObjectRenderer(e.plugins[r]),e.plugins[r].render(this)}calculateVertices(){const t=this.geometry.buffers[0],s=t.data,r=t._updateID;if(r===this.vertexDirty&&this._transformID===this.transform._worldID)return;this._transformID=this.transform._worldID,this.vertexData.length!==s.length&&(this.vertexData=new Float32Array(s.length));const i=this.transform.worldTransform,n=i.a,o=i.b,a=i.c,l=i.d,h=i.tx,c=i.ty,u=this.vertexData;for(let f=0;f<u.length/2;f++){const p=s[f*2],d=s[f*2+1];u[f*2]=n*p+a*d+h,u[f*2+1]=o*p+l*d+c}if(this._roundPixels){const f=q.RESOLUTION;for(let p=0;p<u.length;++p)u[p]=Math.round(u[p]*f)/f}this.vertexDirty=r}calculateUvs(){const e=this.geometry.buffers[1],t=this.shader;t.uvMatrix.isSimple?this.uvs=e.data:(this.batchUvs||(this.batchUvs=new Qw(e,t.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)}_calculateBounds(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)}containsPoint(e){if(!this.getBounds().contains(e.x,e.y))return!1;this.worldTransform.applyInverse(e,ja);const t=this.geometry.getBuffer("aVertexPosition").data,s=mf.points,r=this.geometry.getIndex().data,i=r.length,n=this.drawMode===4?3:1;for(let o=0;o+2<i;o+=n){const a=r[o]*2,l=r[o+1]*2,h=r[o+2]*2;if(s[0]=t[a],s[1]=t[a+1],s[2]=t[l],s[3]=t[l+1],s[4]=t[h],s[5]=t[h+1],mf.contains(ja.x,ja.y))return!0}return!1}destroy(e){super.destroy(e),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null}};let Zl=im;Zl.BATCHABLE_SIZE=100;class tT extends $s{constructor(t,s,r){super();const i=new Zt(t),n=new Zt(s,!0),o=new Zt(r,!0,!0);this.addAttribute("aVertexPosition",i,2,!1,lt.FLOAT).addAttribute("aTextureCoord",n,2,!1,lt.FLOAT).addIndex(o),this._updateId=-1}get vertexDirtyId(){return this.buffers[0]._updateID}}var eT=`varying vec2 vTextureCoord;
uniform vec4 uColor;

uniform sampler2D uSampler;

void main(void)
{
    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;
}
`,sT=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTextureMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;
}
`;class gf extends ns{constructor(t,s){const r={uSampler:t,alpha:1,uTextureMatrix:kt.IDENTITY,uColor:new Float32Array([1,1,1,1])};s=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},s),s.uniforms&&Object.assign(r,s.uniforms),super(s.program||ke.from(sT,eT),r),this._colorDirty=!1,this.uvMatrix=new Cp(t),this.batchable=s.program===void 0,this.pluginName=s.pluginName,this._tintColor=new Ft(s.tint),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0,this.alpha=s.alpha}get texture(){return this.uniforms.uSampler}set texture(t){this.uniforms.uSampler!==t&&(!this.uniforms.uSampler.baseTexture.alphaMode!=!t.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=t,this.uvMatrix.texture=t)}set alpha(t){t!==this._alpha&&(this._alpha=t,this._colorDirty=!0)}get alpha(){return this._alpha}set tint(t){t!==this.tint&&(this._tintColor.setValue(t),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0)}get tint(){return this._tintColor.value}get tintValue(){return this._tintColor.toNumber()}update(){if(this._colorDirty){this._colorDirty=!1;const s=this.texture.baseTexture.alphaMode;Ft.shared.setValue(this._tintColor).premultiply(this._alpha,s).toArray(this.uniforms.uColor)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)}}class _f{constructor(t,s,r){this.geometry=new $s,this.indexBuffer=null,this.size=r,this.dynamicProperties=[],this.staticProperties=[];for(let i=0;i<t.length;++i){let n=t[i];n={attributeName:n.attributeName,size:n.size,uploadFunction:n.uploadFunction,type:n.type||lt.FLOAT,offset:n.offset},s[i]?this.dynamicProperties.push(n):this.staticProperties.push(n)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}initBuffers(){const t=this.geometry;let s=0;this.indexBuffer=new Zt(N0(this.size),!0,!0),t.addIndex(this.indexBuffer),this.dynamicStride=0;for(let o=0;o<this.dynamicProperties.length;++o){const a=this.dynamicProperties[o];a.offset=s,s+=a.size,this.dynamicStride+=a.size}const r=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(r),this.dynamicDataUint32=new Uint32Array(r),this.dynamicBuffer=new Zt(this.dynamicData,!1,!1);let i=0;this.staticStride=0;for(let o=0;o<this.staticProperties.length;++o){const a=this.staticProperties[o];a.offset=i,i+=a.size,this.staticStride+=a.size}const n=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(n),this.staticDataUint32=new Uint32Array(n),this.staticBuffer=new Zt(this.staticData,!0,!1);for(let o=0;o<this.dynamicProperties.length;++o){const a=this.dynamicProperties[o];t.addAttribute(a.attributeName,this.dynamicBuffer,0,a.type===lt.UNSIGNED_BYTE,a.type,this.dynamicStride*4,a.offset*4)}for(let o=0;o<this.staticProperties.length;++o){const a=this.staticProperties[o];t.addAttribute(a.attributeName,this.staticBuffer,0,a.type===lt.UNSIGNED_BYTE,a.type,this.staticStride*4,a.offset*4)}}uploadDynamic(t,s,r){for(let i=0;i<this.dynamicProperties.length;i++){const n=this.dynamicProperties[i];n.uploadFunction(t,s,r,n.type===lt.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,n.offset)}this.dynamicBuffer._updateID++}uploadStatic(t,s,r){for(let i=0;i<this.staticProperties.length;i++){const n=this.staticProperties[i];n.uploadFunction(t,s,r,n.type===lt.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,n.offset)}this.staticBuffer._updateID++}destroy(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()}}var rT=`varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uSampler;

void main(void){
    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;
    gl_FragColor = color;
}`,iT=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;

attribute vec2 aPositionCoord;
attribute float aRotation;

uniform mat3 translationMatrix;
uniform vec4 uColor;

varying vec2 vTextureCoord;
varying vec4 vColor;

void main(void){
    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);
    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);

    vec2 v = vec2(x, y);
    v = v + aPositionCoord;

    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vColor = aColor * uColor;
}
`;class nm extends $o{constructor(t){super(t),this.shader=null,this.properties=null,this.tempMatrix=new kt,this.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:this.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:this.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:this.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:this.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:lt.UNSIGNED_BYTE,uploadFunction:this.uploadTint,offset:0}],this.shader=ns.from(iT,rT,{}),this.state=Ss.for2d()}render(t){const s=t.children,r=t._maxSize,i=t._batchSize,n=this.renderer;let o=s.length;if(o===0)return;o>r&&!t.autoResize&&(o=r);let a=t._buffers;a||(a=t._buffers=this.generateBuffers(t));const l=s[0]._texture.baseTexture,h=l.alphaMode>0;this.state.blendMode=ap(t.blendMode,h),n.state.set(this.state);const c=n.gl,u=t.worldTransform.copyTo(this.tempMatrix);u.prepend(n.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=u.toArray(!0),this.shader.uniforms.uColor=Ft.shared.setValue(t.tintRgb).premultiply(t.worldAlpha,h).toArray(this.shader.uniforms.uColor),this.shader.uniforms.uSampler=l,this.renderer.shader.bind(this.shader);let f=!1;for(let p=0,d=0;p<o;p+=i,d+=1){let m=o-p;m>i&&(m=i),d>=a.length&&a.push(this._generateOneMoreBuffer(t));const g=a[d];g.uploadDynamic(s,p,m);const y=t._bufferUpdateIDs[d]||0;f=f||g._updateID<y,f&&(g._updateID=t._updateID,g.uploadStatic(s,p,m)),n.geometry.bind(g.geometry),c.drawElements(c.TRIANGLES,m*6,c.UNSIGNED_SHORT,0)}}generateBuffers(t){const s=[],r=t._maxSize,i=t._batchSize,n=t._properties;for(let o=0;o<r;o+=i)s.push(new _f(this.properties,n,i));return s}_generateOneMoreBuffer(t){const s=t._batchSize,r=t._properties;return new _f(this.properties,r,s)}uploadVertices(t,s,r,i,n,o){let a=0,l=0,h=0,c=0;for(let u=0;u<r;++u){const f=t[s+u],p=f._texture,d=f.scale.x,m=f.scale.y,g=p.trim,y=p.orig;g?(l=g.x-f.anchor.x*y.width,a=l+g.width,c=g.y-f.anchor.y*y.height,h=c+g.height):(a=y.width*(1-f.anchor.x),l=y.width*-f.anchor.x,h=y.height*(1-f.anchor.y),c=y.height*-f.anchor.y),i[o]=l*d,i[o+1]=c*m,i[o+n]=a*d,i[o+n+1]=c*m,i[o+n*2]=a*d,i[o+n*2+1]=h*m,i[o+n*3]=l*d,i[o+n*3+1]=h*m,o+=n*4}}uploadPosition(t,s,r,i,n,o){for(let a=0;a<r;a++){const l=t[s+a].position;i[o]=l.x,i[o+1]=l.y,i[o+n]=l.x,i[o+n+1]=l.y,i[o+n*2]=l.x,i[o+n*2+1]=l.y,i[o+n*3]=l.x,i[o+n*3+1]=l.y,o+=n*4}}uploadRotation(t,s,r,i,n,o){for(let a=0;a<r;a++){const l=t[s+a].rotation;i[o]=l,i[o+n]=l,i[o+n*2]=l,i[o+n*3]=l,o+=n*4}}uploadUvs(t,s,r,i,n,o){for(let a=0;a<r;++a){const l=t[s+a]._texture._uvs;l?(i[o]=l.x0,i[o+1]=l.y0,i[o+n]=l.x1,i[o+n+1]=l.y1,i[o+n*2]=l.x2,i[o+n*2+1]=l.y2,i[o+n*3]=l.x3,i[o+n*3+1]=l.y3,o+=n*4):(i[o]=0,i[o+1]=0,i[o+n]=0,i[o+n+1]=0,i[o+n*2]=0,i[o+n*2+1]=0,i[o+n*3]=0,i[o+n*3+1]=0,o+=n*4)}}uploadTint(t,s,r,i,n,o){for(let a=0;a<r;++a){const l=t[s+a],h=Ft.shared.setValue(l._tintRGB).toPremultiplied(l.alpha,l.texture.baseTexture.alphaMode>0);i[o]=h,i[o+n]=h,i[o+n*2]=h,i[o+n*3]=h,o+=n*4}}destroy(){super.destroy(),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null}}nm.extension={name:"particle",type:Z.RendererPlugin};nt.add(nm);var Zo=(e=>(e[e.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",e[e.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL",e))(Zo||{});const Fn={willReadFrequently:!0},st=class{static get experimentalLetterSpacingSupported(){let e=st._experimentalLetterSpacingSupported;if(e!==void 0){const t=q.ADAPTER.getCanvasRenderingContext2D().prototype;e=st._experimentalLetterSpacingSupported="letterSpacing"in t||"textLetterSpacing"in t}return e}constructor(e,t,s,r,i,n,o,a,l){this.text=e,this.style=t,this.width=s,this.height=r,this.lines=i,this.lineWidths=n,this.lineHeight=o,this.maxLineWidth=a,this.fontProperties=l}static measureText(e,t,s,r=st._canvas){s=s??t.wordWrap;const i=t.toFontString(),n=st.measureFont(i);n.fontSize===0&&(n.fontSize=t.fontSize,n.ascent=t.fontSize);const o=r.getContext("2d",Fn);o.font=i;const l=(s?st.wordWrap(e,t,r):e).split(/(?:\r\n|\r|\n)/),h=new Array(l.length);let c=0;for(let d=0;d<l.length;d++){const m=st._measureText(l[d],t.letterSpacing,o);h[d]=m,c=Math.max(c,m)}let u=c+t.strokeThickness;t.dropShadow&&(u+=t.dropShadowDistance);const f=t.lineHeight||n.fontSize+t.strokeThickness;let p=Math.max(f,n.fontSize+t.strokeThickness*2)+(l.length-1)*(f+t.leading);return t.dropShadow&&(p+=t.dropShadowDistance),new st(e,t,u,p,l,h,f+t.leading,c,n)}static _measureText(e,t,s){let r=!1;st.experimentalLetterSpacingSupported&&(st.experimentalLetterSpacing?(s.letterSpacing=`${t}px`,s.textLetterSpacing=`${t}px`,r=!0):(s.letterSpacing="0px",s.textLetterSpacing="0px"));let i=s.measureText(e).width;return i>0&&(r?i-=t:i+=(st.graphemeSegmenter(e).length-1)*t),i}static wordWrap(e,t,s=st._canvas){const r=s.getContext("2d",Fn);let i=0,n="",o="";const a=Object.create(null),{letterSpacing:l,whiteSpace:h}=t,c=st.collapseSpaces(h),u=st.collapseNewlines(h);let f=!c;const p=t.wordWrapWidth+l,d=st.tokenize(e);for(let m=0;m<d.length;m++){let g=d[m];if(st.isNewline(g)){if(!u){o+=st.addLine(n),f=!c,n="",i=0;continue}g=" "}if(c){const E=st.isBreakingSpace(g),_=st.isBreakingSpace(n[n.length-1]);if(E&&_)continue}const y=st.getFromCache(g,l,a,r);if(y>p)if(n!==""&&(o+=st.addLine(n),n="",i=0),st.canBreakWords(g,t.breakWords)){const E=st.wordWrapSplit(g);for(let _=0;_<E.length;_++){let v=E[_],S=v,A=1;for(;E[_+A];){const b=E[_+A];if(!st.canBreakChars(S,b,g,_,t.breakWords))v+=b;else break;S=b,A++}_+=A-1;const w=st.getFromCache(v,l,a,r);w+i>p&&(o+=st.addLine(n),f=!1,n="",i=0),n+=v,i+=w}}else{n.length>0&&(o+=st.addLine(n),n="",i=0);const E=m===d.length-1;o+=st.addLine(g,!E),f=!1,n="",i=0}else y+i>p&&(f=!1,o+=st.addLine(n),n="",i=0),(n.length>0||!st.isBreakingSpace(g)||f)&&(n+=g,i+=y)}return o+=st.addLine(n,!1),o}static addLine(e,t=!0){return e=st.trimRight(e),e=t?`${e}
`:e,e}static getFromCache(e,t,s,r){let i=s[e];return typeof i!="number"&&(i=st._measureText(e,t,r)+t,s[e]=i),i}static collapseSpaces(e){return e==="normal"||e==="pre-line"}static collapseNewlines(e){return e==="normal"}static trimRight(e){if(typeof e!="string")return"";for(let t=e.length-1;t>=0;t--){const s=e[t];if(!st.isBreakingSpace(s))break;e=e.slice(0,-1)}return e}static isNewline(e){return typeof e!="string"?!1:st._newlines.includes(e.charCodeAt(0))}static isBreakingSpace(e,t){return typeof e!="string"?!1:st._breakingSpaces.includes(e.charCodeAt(0))}static tokenize(e){const t=[];let s="";if(typeof e!="string")return t;for(let r=0;r<e.length;r++){const i=e[r],n=e[r+1];if(st.isBreakingSpace(i,n)||st.isNewline(i)){s!==""&&(t.push(s),s=""),t.push(i);continue}s+=i}return s!==""&&t.push(s),t}static canBreakWords(e,t){return t}static canBreakChars(e,t,s,r,i){return!0}static wordWrapSplit(e){return st.graphemeSegmenter(e)}static measureFont(e){if(st._fonts[e])return st._fonts[e];const t={ascent:0,descent:0,fontSize:0},s=st._canvas,r=st._context;r.font=e;const i=st.METRICS_STRING+st.BASELINE_SYMBOL,n=Math.ceil(r.measureText(i).width);let o=Math.ceil(r.measureText(st.BASELINE_SYMBOL).width);const a=Math.ceil(st.HEIGHT_MULTIPLIER*o);if(o=o*st.BASELINE_MULTIPLIER|0,n===0||a===0)return st._fonts[e]=t,t;s.width=n,s.height=a,r.fillStyle="#f00",r.fillRect(0,0,n,a),r.font=e,r.textBaseline="alphabetic",r.fillStyle="#000",r.fillText(i,0,o);const l=r.getImageData(0,0,n,a).data,h=l.length,c=n*4;let u=0,f=0,p=!1;for(u=0;u<o;++u){for(let d=0;d<c;d+=4)if(l[f+d]!==255){p=!0;break}if(!p)f+=c;else break}for(t.ascent=o-u,f=h-c,p=!1,u=a;u>o;--u){for(let d=0;d<c;d+=4)if(l[f+d]!==255){p=!0;break}if(!p)f-=c;else break}return t.descent=u-o,t.fontSize=t.ascent+t.descent,st._fonts[e]=t,t}static clearMetrics(e=""){e?delete st._fonts[e]:st._fonts={}}static get _canvas(){if(!st.__canvas){let e;try{const t=new OffscreenCanvas(0,0),s=t.getContext("2d",Fn);if(s!=null&&s.measureText)return st.__canvas=t,t;e=q.ADAPTER.createCanvas()}catch{e=q.ADAPTER.createCanvas()}e.width=e.height=10,st.__canvas=e}return st.__canvas}static get _context(){return st.__context||(st.__context=st._canvas.getContext("2d",Fn)),st.__context}};let ne=st;ne.METRICS_STRING="|ÉqÅ";ne.BASELINE_SYMBOL="M";ne.BASELINE_MULTIPLIER=1.4;ne.HEIGHT_MULTIPLIER=2;ne.graphemeSegmenter=(()=>{if(typeof(Intl==null?void 0:Intl.Segmenter)=="function"){const e=new Intl.Segmenter;return t=>[...e.segment(t)].map(s=>s.segment)}return e=>[...e]})();ne.experimentalLetterSpacing=!1;ne._fonts={};ne._newlines=[10,13];ne._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];const nT=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],Ii=class{constructor(e){this.styleID=0,this.reset(),Ka(this,e,e)}clone(){const e={};return Ka(e,this,Ii.defaultStyle),new Ii(e)}reset(){Ka(this,Ii.defaultStyle,Ii.defaultStyle)}get align(){return this._align}set align(e){this._align!==e&&(this._align=e,this.styleID++)}get breakWords(){return this._breakWords}set breakWords(e){this._breakWords!==e&&(this._breakWords=e,this.styleID++)}get dropShadow(){return this._dropShadow}set dropShadow(e){this._dropShadow!==e&&(this._dropShadow=e,this.styleID++)}get dropShadowAlpha(){return this._dropShadowAlpha}set dropShadowAlpha(e){this._dropShadowAlpha!==e&&(this._dropShadowAlpha=e,this.styleID++)}get dropShadowAngle(){return this._dropShadowAngle}set dropShadowAngle(e){this._dropShadowAngle!==e&&(this._dropShadowAngle=e,this.styleID++)}get dropShadowBlur(){return this._dropShadowBlur}set dropShadowBlur(e){this._dropShadowBlur!==e&&(this._dropShadowBlur=e,this.styleID++)}get dropShadowColor(){return this._dropShadowColor}set dropShadowColor(e){const t=Ya(e);this._dropShadowColor!==t&&(this._dropShadowColor=t,this.styleID++)}get dropShadowDistance(){return this._dropShadowDistance}set dropShadowDistance(e){this._dropShadowDistance!==e&&(this._dropShadowDistance=e,this.styleID++)}get fill(){return this._fill}set fill(e){const t=Ya(e);this._fill!==t&&(this._fill=t,this.styleID++)}get fillGradientType(){return this._fillGradientType}set fillGradientType(e){this._fillGradientType!==e&&(this._fillGradientType=e,this.styleID++)}get fillGradientStops(){return this._fillGradientStops}set fillGradientStops(e){oT(this._fillGradientStops,e)||(this._fillGradientStops=e,this.styleID++)}get fontFamily(){return this._fontFamily}set fontFamily(e){this.fontFamily!==e&&(this._fontFamily=e,this.styleID++)}get fontSize(){return this._fontSize}set fontSize(e){this._fontSize!==e&&(this._fontSize=e,this.styleID++)}get fontStyle(){return this._fontStyle}set fontStyle(e){this._fontStyle!==e&&(this._fontStyle=e,this.styleID++)}get fontVariant(){return this._fontVariant}set fontVariant(e){this._fontVariant!==e&&(this._fontVariant=e,this.styleID++)}get fontWeight(){return this._fontWeight}set fontWeight(e){this._fontWeight!==e&&(this._fontWeight=e,this.styleID++)}get letterSpacing(){return this._letterSpacing}set letterSpacing(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.styleID++)}get lineHeight(){return this._lineHeight}set lineHeight(e){this._lineHeight!==e&&(this._lineHeight=e,this.styleID++)}get leading(){return this._leading}set leading(e){this._leading!==e&&(this._leading=e,this.styleID++)}get lineJoin(){return this._lineJoin}set lineJoin(e){this._lineJoin!==e&&(this._lineJoin=e,this.styleID++)}get miterLimit(){return this._miterLimit}set miterLimit(e){this._miterLimit!==e&&(this._miterLimit=e,this.styleID++)}get padding(){return this._padding}set padding(e){this._padding!==e&&(this._padding=e,this.styleID++)}get stroke(){return this._stroke}set stroke(e){const t=Ya(e);this._stroke!==t&&(this._stroke=t,this.styleID++)}get strokeThickness(){return this._strokeThickness}set strokeThickness(e){this._strokeThickness!==e&&(this._strokeThickness=e,this.styleID++)}get textBaseline(){return this._textBaseline}set textBaseline(e){this._textBaseline!==e&&(this._textBaseline=e,this.styleID++)}get trim(){return this._trim}set trim(e){this._trim!==e&&(this._trim=e,this.styleID++)}get whiteSpace(){return this._whiteSpace}set whiteSpace(e){this._whiteSpace!==e&&(this._whiteSpace=e,this.styleID++)}get wordWrap(){return this._wordWrap}set wordWrap(e){this._wordWrap!==e&&(this._wordWrap=e,this.styleID++)}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(e){this._wordWrapWidth!==e&&(this._wordWrapWidth=e,this.styleID++)}toFontString(){const e=typeof this.fontSize=="number"?`${this.fontSize}px`:this.fontSize;let t=this.fontFamily;Array.isArray(this.fontFamily)||(t=this.fontFamily.split(","));for(let s=t.length-1;s>=0;s--){let r=t[s].trim();!/([\"\'])[^\'\"]+\1/.test(r)&&!nT.includes(r)&&(r=`"${r}"`),t[s]=r}return`${this.fontStyle} ${this.fontVariant} ${this.fontWeight} ${e} ${t.join(",")}`}};let ws=Ii;ws.defaultStyle={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:Zo.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};function Ya(e){const t=Ft.shared;return Array.isArray(e)?e.map(s=>t.setValue(s).toHex()):t.setValue(e).toHex()}function oT(e,t){if(!Array.isArray(e)||!Array.isArray(t)||e.length!==t.length)return!1;for(let s=0;s<e.length;++s)if(e[s]!==t[s])return!1;return!0}function Ka(e,t,s){for(const r in s)Array.isArray(t[r])?e[r]=t[r].slice():e[r]=t[r]}const aT={texture:!0,children:!1,baseTexture:!0},Jl=class extends yr{constructor(e,t,s){let r=!1;s||(s=q.ADAPTER.createCanvas(),r=!0),s.width=3,s.height=3;const i=J.from(s);i.orig=new yt,i.trim=new yt,super(i),this._ownCanvas=r,this.canvas=s,this.context=s.getContext("2d",{willReadFrequently:!0}),this._resolution=Jl.defaultResolution??q.RESOLUTION,this._autoResolution=Jl.defaultAutoResolution,this._text=null,this._style=null,this._styleListener=null,this._font="",this.text=e,this.style=t,this.localStyleID=-1}static get experimentalLetterSpacing(){return ne.experimentalLetterSpacing}static set experimentalLetterSpacing(e){bt("7.1.0","Text.experimentalLetterSpacing is deprecated, use TextMetrics.experimentalLetterSpacing"),ne.experimentalLetterSpacing=e}updateText(e){const t=this._style;if(this.localStyleID!==t.styleID&&(this.dirty=!0,this.localStyleID=t.styleID),!this.dirty&&e)return;this._font=this._style.toFontString();const s=this.context,r=ne.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),i=r.width,n=r.height,o=r.lines,a=r.lineHeight,l=r.lineWidths,h=r.maxLineWidth,c=r.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,i)+t.padding*2)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,n)+t.padding*2)*this._resolution),s.scale(this._resolution,this._resolution),s.clearRect(0,0,this.canvas.width,this.canvas.height),s.font=this._font,s.lineWidth=t.strokeThickness,s.textBaseline=t.textBaseline,s.lineJoin=t.lineJoin,s.miterLimit=t.miterLimit;let u,f;const p=t.dropShadow?2:1;for(let d=0;d<p;++d){const m=t.dropShadow&&d===0,g=m?Math.ceil(Math.max(1,n)+t.padding*2):0,y=g*this._resolution;if(m){s.fillStyle="black",s.strokeStyle="black";const _=t.dropShadowColor,v=t.dropShadowBlur*this._resolution,S=t.dropShadowDistance*this._resolution;s.shadowColor=Ft.shared.setValue(_).setAlpha(t.dropShadowAlpha).toRgbaString(),s.shadowBlur=v,s.shadowOffsetX=Math.cos(t.dropShadowAngle)*S,s.shadowOffsetY=Math.sin(t.dropShadowAngle)*S+y}else s.fillStyle=this._generateFillStyle(t,o,r),s.strokeStyle=t.stroke,s.shadowColor="black",s.shadowBlur=0,s.shadowOffsetX=0,s.shadowOffsetY=0;let E=(a-c.fontSize)/2;a-c.fontSize<0&&(E=0);for(let _=0;_<o.length;_++)u=t.strokeThickness/2,f=t.strokeThickness/2+_*a+c.ascent+E,t.align==="right"?u+=h-l[_]:t.align==="center"&&(u+=(h-l[_])/2),t.stroke&&t.strokeThickness&&this.drawLetterSpacing(o[_],u+t.padding,f+t.padding-g,!0),t.fill&&this.drawLetterSpacing(o[_],u+t.padding,f+t.padding-g)}this.updateTexture()}drawLetterSpacing(e,t,s,r=!1){const n=this._style.letterSpacing;let o=!1;if(ne.experimentalLetterSpacingSupported&&(ne.experimentalLetterSpacing?(this.context.letterSpacing=`${n}px`,this.context.textLetterSpacing=`${n}px`,o=!0):(this.context.letterSpacing="0px",this.context.textLetterSpacing="0px")),n===0||o){r?this.context.strokeText(e,t,s):this.context.fillText(e,t,s);return}let a=t;const l=ne.graphemeSegmenter(e);let h=this.context.measureText(e).width,c=0;for(let u=0;u<l.length;++u){const f=l[u];r?this.context.strokeText(f,a,s):this.context.fillText(f,a,s);let p="";for(let d=u+1;d<l.length;++d)p+=l[d];c=this.context.measureText(p).width,a+=h-c+n,h=c}}updateTexture(){const e=this.canvas;if(this._style.trim){const n=H0(e);n.data&&(e.width=n.width,e.height=n.height,this.context.putImageData(n.data,0,0))}const t=this._texture,s=this._style,r=s.trim?0:s.padding,i=t.baseTexture;t.trim.width=t._frame.width=e.width/this._resolution,t.trim.height=t._frame.height=e.height/this._resolution,t.trim.x=-r,t.trim.y=-r,t.orig.width=t._frame.width-r*2,t.orig.height=t._frame.height-r*2,this._onTextureUpdate(),i.setRealSize(e.width,e.height,this._resolution),t.updateUvs(),this.dirty=!1}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._render(e)}updateTransform(){this.updateText(!0),super.updateTransform()}getBounds(e,t){return this.updateText(!0),this._textureID===-1&&(e=!1),super.getBounds(e,t)}getLocalBounds(e){return this.updateText(!0),super.getLocalBounds.call(this,e)}_calculateBounds(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_generateFillStyle(e,t,s){const r=e.fill;if(Array.isArray(r)){if(r.length===1)return r[0]}else return r;let i;const n=e.dropShadow?e.dropShadowDistance:0,o=e.padding||0,a=this.canvas.width/this._resolution-n-o*2,l=this.canvas.height/this._resolution-n-o*2,h=r.slice(),c=e.fillGradientStops.slice();if(!c.length){const u=h.length+1;for(let f=1;f<u;++f)c.push(f/u)}if(h.unshift(r[0]),c.unshift(0),h.push(r[r.length-1]),c.push(1),e.fillGradientType===Zo.LINEAR_VERTICAL){i=this.context.createLinearGradient(a/2,o,a/2,l+o);const u=s.fontProperties.fontSize+e.strokeThickness;for(let f=0;f<t.length;f++){const p=s.lineHeight*(f-1)+u,d=s.lineHeight*f;let m=d;f>0&&p>d&&(m=(d+p)/2);const g=d+u,y=s.lineHeight*(f+1);let E=g;f+1<t.length&&y<g&&(E=(g+y)/2);const _=(E-m)/l;for(let v=0;v<h.length;v++){let S=0;typeof c[v]=="number"?S=c[v]:S=v/h.length;let A=Math.min(1,Math.max(0,m/l+S*_));A=Number(A.toFixed(5)),i.addColorStop(A,h[v])}}}else{i=this.context.createLinearGradient(o,l/2,a+o,l/2);const u=h.length+1;let f=1;for(let p=0;p<h.length;p++){let d;typeof c[p]=="number"?d=c[p]:d=f/u,i.addColorStop(d,h[p]),f++}}return i}destroy(e){typeof e=="boolean"&&(e={children:e}),e=Object.assign({},aT,e),super.destroy(e),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width}set width(e){this.updateText(!0);const t=Ds(this.scale.x)||1;this.scale.x=t*e/this._texture.orig.width,this._width=e}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height}set height(e){this.updateText(!0);const t=Ds(this.scale.y)||1;this.scale.y=t*e/this._texture.orig.height,this._height=e}get style(){return this._style}set style(e){e=e||{},e instanceof ws?this._style=e:this._style=new ws(e),this.localStyleID=-1,this.dirty=!0}get text(){return this._text}set text(e){e=String(e??""),this._text!==e&&(this._text=e,this.dirty=!0)}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}};let Qh=Jl;Qh.defaultAutoResolution=!0;class lT{constructor(t){this.maxItemsPerFrame=t,this.itemsLeft=0}beginFrame(){this.itemsLeft=this.maxItemsPerFrame}allowedToUpload(){return this.itemsLeft-- >0}}function hT(e,t){var r;let s=!1;if((r=e==null?void 0:e._textures)!=null&&r.length){for(let i=0;i<e._textures.length;i++)if(e._textures[i]instanceof J){const n=e._textures[i].baseTexture;t.includes(n)||(t.push(n),s=!0)}}return s}function cT(e,t){if(e.baseTexture instanceof mt){const s=e.baseTexture;return t.includes(s)||t.push(s),!0}return!1}function uT(e,t){if(e._texture&&e._texture instanceof J){const s=e._texture.baseTexture;return t.includes(s)||t.push(s),!0}return!1}function fT(e,t){return t instanceof Qh?(t.updateText(!0),!0):!1}function dT(e,t){if(t instanceof ws){const s=t.toFontString();return ne.measureFont(s),!0}return!1}function pT(e,t){if(e instanceof Qh){t.includes(e.style)||t.push(e.style),t.includes(e)||t.push(e);const s=e._texture.baseTexture;return t.includes(s)||t.push(s),!0}return!1}function mT(e,t){return e instanceof ws?(t.includes(e)||t.push(e),!0):!1}const om=class{constructor(e){this.limiter=new lT(om.uploadsPerFrame),this.renderer=e,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=()=>{this.queue&&this.prepareItems()},this.registerFindHook(pT),this.registerFindHook(mT),this.registerFindHook(hT),this.registerFindHook(cT),this.registerFindHook(uT),this.registerUploadHook(fT),this.registerUploadHook(dT)}upload(e){return new Promise(t=>{e&&this.add(e),this.queue.length?(this.completes.push(t),this.ticking||(this.ticking=!0,jt.system.addOnce(this.tick,this,Xs.UTILITY))):t()})}tick(){setTimeout(this.delayedTick,0)}prepareItems(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){const e=this.queue[0];let t=!1;if(e&&!e._destroyed){for(let s=0,r=this.uploadHooks.length;s<r;s++)if(this.uploadHooks[s](this.uploadHookHelper,e)){this.queue.shift(),t=!0;break}}t||this.queue.shift()}if(this.queue.length)jt.system.addOnce(this.tick,this,Xs.UTILITY);else{this.ticking=!1;const e=this.completes.slice(0);this.completes.length=0;for(let t=0,s=e.length;t<s;t++)e[t]()}}registerFindHook(e){return e&&this.addHooks.push(e),this}registerUploadHook(e){return e&&this.uploadHooks.push(e),this}add(e){for(let t=0,s=this.addHooks.length;t<s&&!this.addHooks[t](e,this.queue);t++);if(e instanceof ye)for(let t=e.children.length-1;t>=0;t--)this.add(e.children[t]);return this}destroy(){this.ticking&&jt.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null}};let bo=om;bo.uploadsPerFrame=4;Object.defineProperties(q,{UPLOADS_PER_FRAME:{get(){return bo.uploadsPerFrame},set(e){bt("7.1.0","settings.UPLOADS_PER_FRAME is deprecated, use prepare.BasePrepare.uploadsPerFrame"),bo.uploadsPerFrame=e}}});function am(e,t){return t instanceof mt?(t._glTextures[e.CONTEXT_UID]||e.texture.bind(t),!0):!1}function gT(e,t){if(!(t instanceof qo))return!1;const{geometry:s}=t;t.finishPoly(),s.updateBatches();const{batches:r}=s;for(let i=0;i<r.length;i++){const{texture:n}=r[i].style;n&&am(e,n.baseTexture)}return s.batchable||e.geometry.bind(s,t._resolveDirectShader(e)),!0}function _T(e,t){return e instanceof qo?(t.push(e),!0):!1}class lm extends bo{constructor(t){super(t),this.uploadHookHelper=this.renderer,this.registerFindHook(_T),this.registerUploadHook(am),this.registerUploadHook(gT)}}lm.extension={name:"prepare",type:Z.RendererSystem};nt.add(lm);class wo extends yr{constructor(t,s=!0){super(t[0]instanceof J?t[0]:t[0].texture),this._textures=null,this._durations=null,this._autoUpdate=s,this._isConnectedToTicker=!1,this.animationSpeed=1,this.loop=!0,this.updateAnchor=!1,this.onComplete=null,this.onFrameChange=null,this.onLoop=null,this._currentTime=0,this._playing=!1,this._previousFrame=null,this.textures=t}stop(){this._playing&&(this._playing=!1,this._autoUpdate&&this._isConnectedToTicker&&(jt.shared.remove(this.update,this),this._isConnectedToTicker=!1))}play(){this._playing||(this._playing=!0,this._autoUpdate&&!this._isConnectedToTicker&&(jt.shared.add(this.update,this,Xs.HIGH),this._isConnectedToTicker=!0))}gotoAndStop(t){this.stop(),this.currentFrame=t}gotoAndPlay(t){this.currentFrame=t,this.play()}update(t){if(!this._playing)return;const s=this.animationSpeed*t,r=this.currentFrame;if(this._durations!==null){let i=this._currentTime%1*this._durations[this.currentFrame];for(i+=s/60*1e3;i<0;)this._currentTime--,i+=this._durations[this.currentFrame];const n=Math.sign(this.animationSpeed*t);for(this._currentTime=Math.floor(this._currentTime);i>=this._durations[this.currentFrame];)i-=this._durations[this.currentFrame]*n,this._currentTime+=n;this._currentTime+=i/this._durations[this.currentFrame]}else this._currentTime+=s;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):r!==this.currentFrame&&(this.loop&&this.onLoop&&(this.animationSpeed>0&&this.currentFrame<r||this.animationSpeed<0&&this.currentFrame>r)&&this.onLoop(),this.updateTexture())}updateTexture(){const t=this.currentFrame;this._previousFrame!==t&&(this._previousFrame=t,this._texture=this._textures[t],this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this.uvs=this._texture._uvs.uvsFloat32,this.updateAnchor&&this._anchor.copyFrom(this._texture.defaultAnchor),this.onFrameChange&&this.onFrameChange(this.currentFrame))}destroy(t){this.stop(),super.destroy(t),this.onComplete=null,this.onFrameChange=null,this.onLoop=null}static fromFrames(t){const s=[];for(let r=0;r<t.length;++r)s.push(J.from(t[r]));return new wo(s)}static fromImages(t){const s=[];for(let r=0;r<t.length;++r)s.push(J.from(t[r]));return new wo(s)}get totalFrames(){return this._textures.length}get textures(){return this._textures}set textures(t){if(t[0]instanceof J)this._textures=t,this._durations=null;else{this._textures=[],this._durations=[];for(let s=0;s<t.length;s++)this._textures.push(t[s].texture),this._durations.push(t[s].time)}this._previousFrame=null,this.gotoAndStop(0),this.updateTexture()}get currentFrame(){let t=Math.floor(this._currentTime)%this._textures.length;return t<0&&(t+=this._textures.length),t}set currentFrame(t){if(t<0||t>this.totalFrames-1)throw new Error(`[AnimatedSprite]: Invalid frame index value ${t}, expected to be between 0 and totalFrames ${this.totalFrames}.`);const s=this.currentFrame;this._currentTime=t,s!==this.currentFrame&&this.updateTexture()}get playing(){return this._playing}get autoUpdate(){return this._autoUpdate}set autoUpdate(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(jt.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._playing&&(jt.shared.add(this.update,this),this._isConnectedToTicker=!0))}}var yT=`#version 300 es
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

in vec2 vTextureCoord;

out vec4 fragmentColor;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0

    fragmentColor = texSample * uColor;
}
`,vT=`#version 300 es
#define SHADER_NAME Tiling-Sprite-300

precision lowp float;

in vec2 aVertexPosition;
in vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

out vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,xT=`#version 100
#ifdef GL_EXT_shader_texture_lod
    #extension GL_EXT_shader_texture_lod : enable
#endif
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    #ifdef GL_EXT_shader_texture_lod
        vec4 texSample = unclamped == coord
            ? texture2D(uSampler, coord) 
            : texture2DLodEXT(uSampler, coord, 0);
    #else
        vec4 texSample = texture2D(uSampler, coord);
    #endif

    gl_FragColor = texSample * uColor;
}
`,yf=`#version 100
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,ET=`#version 100
#define SHADER_NAME Tiling-Sprite-Simple-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;

void main(void)
{
    vec4 texSample = texture2D(uSampler, vTextureCoord);
    gl_FragColor = texSample * uColor;
}
`;const Ln=new kt;class hm extends $o{constructor(t){super(t),t.runners.contextChange.add(this),this.quad=new Tp,this.state=Ss.for2d()}contextChange(){const t=this.renderer,s={globals:t.globalUniforms};this.simpleShader=ns.from(yf,ET,s),this.shader=t.context.webGLVersion>1?ns.from(vT,yT,s):ns.from(yf,xT,s)}render(t){const s=this.renderer,r=this.quad;let i=r.vertices;i[0]=i[6]=t._width*-t.anchor.x,i[1]=i[3]=t._height*-t.anchor.y,i[2]=i[4]=t._width*(1-t.anchor.x),i[5]=i[7]=t._height*(1-t.anchor.y);const n=t.uvRespectAnchor?t.anchor.x:0,o=t.uvRespectAnchor?t.anchor.y:0;i=r.uvs,i[0]=i[6]=-n,i[1]=i[3]=-o,i[2]=i[4]=1-n,i[5]=i[7]=1-o,r.invalidate();const a=t._texture,l=a.baseTexture,h=l.alphaMode>0,c=t.tileTransform.localTransform,u=t.uvMatrix;let f=l.isPowerOfTwo&&a.frame.width===l.width&&a.frame.height===l.height;f&&(l._glTextures[s.CONTEXT_UID]?f=l.wrapMode!==ks.CLAMP:l.wrapMode===ks.CLAMP&&(l.wrapMode=ks.REPEAT));const p=f?this.simpleShader:this.shader,d=a.width,m=a.height,g=t._width,y=t._height;Ln.set(c.a*d/g,c.b*d/y,c.c*m/g,c.d*m/y,c.tx/g,c.ty/y),Ln.invert(),f?Ln.prepend(u.mapCoord):(p.uniforms.uMapCoord=u.mapCoord.toArray(!0),p.uniforms.uClampFrame=u.uClampFrame,p.uniforms.uClampOffset=u.uClampOffset),p.uniforms.uTransform=Ln.toArray(!0),p.uniforms.uColor=Ft.shared.setValue(t.tint).premultiply(t.worldAlpha,h).toArray(p.uniforms.uColor),p.uniforms.translationMatrix=t.transform.worldTransform.toArray(!0),p.uniforms.uSampler=a,s.shader.bind(p),s.geometry.bind(r),this.state.blendMode=ap(t.blendMode,h),s.state.set(this.state),s.geometry.draw(this.renderer.gl.TRIANGLES,6,0)}}hm.extension={name:"tilingSprite",type:Z.RendererPlugin};nt.add(hm);const Ci=class{constructor(e,t,s=null){this.linkedSheets=[],this._texture=e instanceof J?e:null,this.baseTexture=e instanceof mt?e:this._texture.baseTexture,this.textures={},this.animations={},this.data=t;const r=this.baseTexture.resource;this.resolution=this._updateResolution(s||(r?r.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}_updateResolution(e=null){const{scale:t}=this.data.meta;let s=Hs(e,null);return s===null&&(s=parseFloat(t??"1")),s!==1&&this.baseTexture.setResolution(s),s}parse(){return new Promise(e=>{this._callback=e,this._batchIndex=0,this._frameKeys.length<=Ci.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(e){let t=e;const s=Ci.BATCH_SIZE;for(;t-e<s&&t<this._frameKeys.length;){const r=this._frameKeys[t],i=this._frames[r],n=i.frame;if(n){let o=null,a=null;const l=i.trimmed!==!1&&i.sourceSize?i.sourceSize:i.frame,h=new yt(0,0,Math.floor(l.w)/this.resolution,Math.floor(l.h)/this.resolution);i.rotated?o=new yt(Math.floor(n.x)/this.resolution,Math.floor(n.y)/this.resolution,Math.floor(n.h)/this.resolution,Math.floor(n.w)/this.resolution):o=new yt(Math.floor(n.x)/this.resolution,Math.floor(n.y)/this.resolution,Math.floor(n.w)/this.resolution,Math.floor(n.h)/this.resolution),i.trimmed!==!1&&i.spriteSourceSize&&(a=new yt(Math.floor(i.spriteSourceSize.x)/this.resolution,Math.floor(i.spriteSourceSize.y)/this.resolution,Math.floor(n.w)/this.resolution,Math.floor(n.h)/this.resolution)),this.textures[r]=new J(this.baseTexture,o,h,a,i.rotated?2:0,i.anchor,i.borders),J.addToCache(this.textures[r],r)}t++}}_processAnimations(){const e=this.data.animations||{};for(const t in e){this.animations[t]=[];for(let s=0;s<e[t].length;s++){const r=e[t][s];this.animations[t].push(this.textures[r])}}}_parseComplete(){const e=this._callback;this._callback=null,this._batchIndex=0,e.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*Ci.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*Ci.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(e=!1){var t;for(const s in this.textures)this.textures[s].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,e&&((t=this._texture)==null||t.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null,this.linkedSheets=[]}};let Ql=Ci;Ql.BATCH_SIZE=1e3;const bT=["jpg","png","jpeg","avif","webp"];function cm(e,t,s){const r={};if(e.forEach(i=>{r[i]=t}),Object.keys(t.textures).forEach(i=>{r[i]=t.textures[i]}),!s){const i=fe.dirname(e[0]);t.linkedSheets.forEach((n,o)=>{const a=cm([`${i}/${t.data.meta.related_multi_packs[o]}`],n,!0);Object.assign(r,a)})}return r}const wT={extension:Z.Asset,cache:{test:e=>e instanceof Ql,getCacheableAssets:(e,t)=>cm(e,t,!1)},resolver:{test:e=>{const s=e.split("?")[0].split("."),r=s.pop(),i=s.pop();return r==="json"&&bT.includes(i)},parse:e=>{var s;const t=e.split(".");return{resolution:parseFloat(((s=q.RETINA_PREFIX.exec(e))==null?void 0:s[1])??"1"),format:t[t.length-2],src:e}}},loader:{name:"spritesheetLoader",extension:{type:Z.LoadParser,priority:hs.Normal},async testParse(e,t){return fe.extname(t.src).toLowerCase()===".json"&&!!e.frames},async parse(e,t,s){var h,c;let r=fe.dirname(t.src);r&&r.lastIndexOf("/")!==r.length-1&&(r+="/");let i=r+e.meta.image;i=Kl(i,t.src);const o=(await s.load([i]))[i],a=new Ql(o.baseTexture,e,t.src);await a.parse();const l=(h=e==null?void 0:e.meta)==null?void 0:h.related_multi_packs;if(Array.isArray(l)){const u=[];for(const p of l){if(typeof p!="string")continue;let d=r+p;(c=t.data)!=null&&c.ignoreMultiPack||(d=Kl(d,t.src),u.push(s.load({src:d,data:{ignoreMultiPack:!0}})))}const f=await Promise.all(u);a.linkedSheets=f,f.forEach(p=>{p.linkedSheets=[a].concat(a.linkedSheets.filter(d=>d!==p))})}return a},unload(e){e.destroy(!0)}}};nt.add(wT);class To{constructor(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]}}class Kn{static test(t){return typeof t=="string"&&t.startsWith("info face=")}static parse(t){const s=t.match(/^[a-z]+\s+.+$/gm),r={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const n in s){const o=s[n].match(/^[a-z]+/gm)[0],a=s[n].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),l={};for(const h in a){const c=a[h].split("="),u=c[0],f=c[1].replace(/"/gm,""),p=parseFloat(f),d=isNaN(p)?f:p;l[u]=d}r[o].push(l)}const i=new To;return r.info.forEach(n=>i.info.push({face:n.face,size:parseInt(n.size,10)})),r.common.forEach(n=>i.common.push({lineHeight:parseInt(n.lineHeight,10)})),r.page.forEach(n=>i.page.push({id:parseInt(n.id,10),file:n.file})),r.char.forEach(n=>i.char.push({id:parseInt(n.id,10),page:parseInt(n.page,10),x:parseInt(n.x,10),y:parseInt(n.y,10),width:parseInt(n.width,10),height:parseInt(n.height,10),xoffset:parseInt(n.xoffset,10),yoffset:parseInt(n.yoffset,10),xadvance:parseInt(n.xadvance,10)})),r.kerning.forEach(n=>i.kerning.push({first:parseInt(n.first,10),second:parseInt(n.second,10),amount:parseInt(n.amount,10)})),r.distanceField.forEach(n=>i.distanceField.push({distanceRange:parseInt(n.distanceRange,10),fieldType:n.fieldType})),i}}class th{static test(t){const s=t;return"getElementsByTagName"in s&&s.getElementsByTagName("page").length&&s.getElementsByTagName("info")[0].getAttribute("face")!==null}static parse(t){const s=new To,r=t.getElementsByTagName("info"),i=t.getElementsByTagName("common"),n=t.getElementsByTagName("page"),o=t.getElementsByTagName("char"),a=t.getElementsByTagName("kerning"),l=t.getElementsByTagName("distanceField");for(let h=0;h<r.length;h++)s.info.push({face:r[h].getAttribute("face"),size:parseInt(r[h].getAttribute("size"),10)});for(let h=0;h<i.length;h++)s.common.push({lineHeight:parseInt(i[h].getAttribute("lineHeight"),10)});for(let h=0;h<n.length;h++)s.page.push({id:parseInt(n[h].getAttribute("id"),10)||0,file:n[h].getAttribute("file")});for(let h=0;h<o.length;h++){const c=o[h];s.char.push({id:parseInt(c.getAttribute("id"),10),page:parseInt(c.getAttribute("page"),10)||0,x:parseInt(c.getAttribute("x"),10),y:parseInt(c.getAttribute("y"),10),width:parseInt(c.getAttribute("width"),10),height:parseInt(c.getAttribute("height"),10),xoffset:parseInt(c.getAttribute("xoffset"),10),yoffset:parseInt(c.getAttribute("yoffset"),10),xadvance:parseInt(c.getAttribute("xadvance"),10)})}for(let h=0;h<a.length;h++)s.kerning.push({first:parseInt(a[h].getAttribute("first"),10),second:parseInt(a[h].getAttribute("second"),10),amount:parseInt(a[h].getAttribute("amount"),10)});for(let h=0;h<l.length;h++)s.distanceField.push({fieldType:l[h].getAttribute("fieldType"),distanceRange:parseInt(l[h].getAttribute("distanceRange"),10)});return s}}class eh{static test(t){return typeof t=="string"&&t.includes("<font>")?th.test(q.ADAPTER.parseXML(t)):!1}static parse(t){return th.parse(q.ADAPTER.parseXML(t))}}const qa=[Kn,th,eh];function TT(e){for(let t=0;t<qa.length;t++)if(qa[t].test(e))return qa[t];return null}function ST(e,t,s,r,i,n){const o=s.fill;if(Array.isArray(o)){if(o.length===1)return o[0]}else return o;let a;const l=s.dropShadow?s.dropShadowDistance:0,h=s.padding||0,c=e.width/r-l-h*2,u=e.height/r-l-h*2,f=o.slice(),p=s.fillGradientStops.slice();if(!p.length){const d=f.length+1;for(let m=1;m<d;++m)p.push(m/d)}if(f.unshift(o[0]),p.unshift(0),f.push(o[o.length-1]),p.push(1),s.fillGradientType===Zo.LINEAR_VERTICAL){a=t.createLinearGradient(c/2,h,c/2,u+h);let d=0;const g=(n.fontProperties.fontSize+s.strokeThickness)/u;for(let y=0;y<i.length;y++){const E=n.lineHeight*y;for(let _=0;_<f.length;_++){let v=0;typeof p[_]=="number"?v=p[_]:v=_/f.length;const S=E/u+v*g;let A=Math.max(d,S);A=Math.min(A,1),a.addColorStop(A,f[_]),d=A}}}else{a=t.createLinearGradient(h,u/2,c+h,u/2);const d=f.length+1;let m=1;for(let g=0;g<f.length;g++){let y;typeof p[g]=="number"?y=p[g]:y=m/d,a.addColorStop(y,f[g]),m++}}return a}function AT(e,t,s,r,i,n,o){const a=s.text,l=s.fontProperties;t.translate(r,i),t.scale(n,n);const h=o.strokeThickness/2,c=-(o.strokeThickness/2);if(t.font=o.toFontString(),t.lineWidth=o.strokeThickness,t.textBaseline=o.textBaseline,t.lineJoin=o.lineJoin,t.miterLimit=o.miterLimit,t.fillStyle=ST(e,t,o,n,[a],s),t.strokeStyle=o.stroke,o.dropShadow){const u=o.dropShadowColor,f=o.dropShadowBlur*n,p=o.dropShadowDistance*n;t.shadowColor=Ft.shared.setValue(u).setAlpha(o.dropShadowAlpha).toRgbaString(),t.shadowBlur=f,t.shadowOffsetX=Math.cos(o.dropShadowAngle)*p,t.shadowOffsetY=Math.sin(o.dropShadowAngle)*p}else t.shadowColor="black",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0;o.stroke&&o.strokeThickness&&t.strokeText(a,h,c+s.lineHeight-l.descent),o.fill&&t.fillText(a,h,c+s.lineHeight-l.descent),t.setTransform(1,0,0,1,0,0),t.fillStyle="rgba(0, 0, 0, 0)"}function qn(e){return e.codePointAt?e.codePointAt(0):e.charCodeAt(0)}function um(e){return Array.from?Array.from(e):e.split("")}function IT(e){typeof e=="string"&&(e=[e]);const t=[];for(let s=0,r=e.length;s<r;s++){const i=e[s];if(Array.isArray(i)){if(i.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${i.length}.`);const n=i[0].charCodeAt(0),o=i[1].charCodeAt(0);if(o<n)throw new Error("[BitmapFont]: Invalid character range.");for(let a=n,l=o;a<=l;a++)t.push(String.fromCharCode(a))}else t.push(...um(i))}if(t.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return t}const Fe=class{constructor(e,t,s){var h;const[r]=e.info,[i]=e.common,[n]=e.page,[o]=e.distanceField,a=Hs(n.file),l={};this._ownsTextures=s,this.font=r.face,this.size=r.size,this.lineHeight=i.lineHeight/a,this.chars={},this.pageTextures=l;for(let c=0;c<e.page.length;c++){const{id:u,file:f}=e.page[c];l[u]=t instanceof Array?t[c]:t[f],o!=null&&o.fieldType&&o.fieldType!=="none"&&(l[u].baseTexture.alphaMode=Ve.NO_PREMULTIPLIED_ALPHA,l[u].baseTexture.mipmap=as.OFF)}for(let c=0;c<e.char.length;c++){const{id:u,page:f}=e.char[c];let{x:p,y:d,width:m,height:g,xoffset:y,yoffset:E,xadvance:_}=e.char[c];p/=a,d/=a,m/=a,g/=a,y/=a,E/=a,_/=a;const v=new yt(p+l[f].frame.x/a,d+l[f].frame.y/a,m,g);this.chars[u]={xOffset:y,yOffset:E,xAdvance:_,kerning:{},texture:new J(l[f].baseTexture,v),page:f}}for(let c=0;c<e.kerning.length;c++){let{first:u,second:f,amount:p}=e.kerning[c];u/=a,f/=a,p/=a,this.chars[f]&&(this.chars[f].kerning[u]=p)}this.distanceFieldRange=o==null?void 0:o.distanceRange,this.distanceFieldType=((h=o==null?void 0:o.fieldType)==null?void 0:h.toLowerCase())??"none"}destroy(){for(const e in this.chars)this.chars[e].texture.destroy(),this.chars[e].texture=null;for(const e in this.pageTextures)this._ownsTextures&&this.pageTextures[e].destroy(!0),this.pageTextures[e]=null;this.chars=null,this.pageTextures=null}static install(e,t,s){let r;if(e instanceof To)r=e;else{const n=TT(e);if(!n)throw new Error("Unrecognized data format for font.");r=n.parse(e)}t instanceof J&&(t=[t]);const i=new Fe(r,t,s);return Fe.available[i.font]=i,i}static uninstall(e){const t=Fe.available[e];if(!t)throw new Error(`No font found named '${e}'`);t.destroy(),delete Fe.available[e]}static from(e,t,s){if(!e)throw new Error("[BitmapFont] Property `name` is required.");const{chars:r,padding:i,resolution:n,textureWidth:o,textureHeight:a,...l}=Object.assign({},Fe.defaultOptions,s),h=IT(r),c=t instanceof ws?t:new ws(t),u=o,f=new To;f.info[0]={face:c.fontFamily,size:c.fontSize},f.common[0]={lineHeight:c.fontSize};let p=0,d=0,m,g,y,E=0;const _=[];for(let S=0;S<h.length;S++){m||(m=q.ADAPTER.createCanvas(),m.width=o,m.height=a,g=m.getContext("2d"),y=new mt(m,{resolution:n,...l}),_.push(new J(y)),f.page.push({id:_.length-1,file:""}));const A=h[S],w=ne.measureText(A,c,!1,m),b=w.width,R=Math.ceil(w.height),F=Math.ceil((c.fontStyle==="italic"?2:1)*b);if(d>=a-R*n){if(d===0)throw new Error(`[BitmapFont] textureHeight ${a}px is too small (fontFamily: '${c.fontFamily}', fontSize: ${c.fontSize}px, char: '${A}')`);--S,m=null,g=null,y=null,d=0,p=0,E=0;continue}if(E=Math.max(R+w.fontProperties.descent,E),F*n+p>=u){if(p===0)throw new Error(`[BitmapFont] textureWidth ${o}px is too small (fontFamily: '${c.fontFamily}', fontSize: ${c.fontSize}px, char: '${A}')`);--S,d+=E*n,d=Math.ceil(d),p=0,E=0;continue}AT(m,g,w,p,d,n,c);const U=qn(w.text);f.char.push({id:U,page:_.length-1,x:p/n,y:d/n,width:F,height:R,xoffset:0,yoffset:0,xadvance:b-(c.dropShadow?c.dropShadowDistance:0)-(c.stroke?c.strokeThickness:0)}),p+=(F+2*i)*n,p=Math.ceil(p)}for(let S=0,A=h.length;S<A;S++){const w=h[S];for(let b=0;b<A;b++){const R=h[b],F=g.measureText(w).width,U=g.measureText(R).width,B=g.measureText(w+R).width-(F+U);B&&f.kerning.push({first:qn(w),second:qn(R),amount:B})}}const v=new Fe(f,_,!0);return Fe.available[e]!==void 0&&Fe.uninstall(e),Fe.available[e]=v,v}};let ge=Fe;ge.ALPHA=[["a","z"],["A","Z"]," "];ge.NUMERIC=[["0","9"]];ge.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "];ge.ASCII=[[" ","~"]];ge.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:Fe.ALPHANUMERIC};ge.available={};var CT=`// Pixi texture info\r
varying vec2 vTextureCoord;\r
uniform sampler2D uSampler;\r
\r
// Tint\r
uniform vec4 uColor;\r
\r
// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r
uniform float uFWidth;\r
\r
void main(void) {\r
\r
  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r
  vec4 texColor = texture2D(uSampler, vTextureCoord);\r
\r
  // MSDF\r
  float median = texColor.r + texColor.g + texColor.b -\r
                  min(texColor.r, min(texColor.g, texColor.b)) -\r
                  max(texColor.r, max(texColor.g, texColor.b));\r
  // SDF\r
  median = min(median, texColor.a);\r
\r
  float screenPxDistance = uFWidth * (median - 0.5);\r
  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r
  if (median < 0.01) {\r
    alpha = 0.0;\r
  } else if (median > 0.99) {\r
    alpha = 1.0;\r
  }\r
\r
  // Gamma correction for coverage-like alpha\r
  float luma = dot(uColor.rgb, vec3(0.299, 0.587, 0.114));\r
  float gamma = mix(1.0, 1.0 / 2.2, luma);\r
  float coverage = pow(uColor.a * alpha, gamma);  \r
\r
  // NPM Textures, NPM outputs\r
  gl_FragColor = vec4(uColor.rgb, coverage);\r
}\r
`,RT=`// Mesh material default fragment\r
attribute vec2 aVertexPosition;\r
attribute vec2 aTextureCoord;\r
\r
uniform mat3 projectionMatrix;\r
uniform mat3 translationMatrix;\r
uniform mat3 uTextureMatrix;\r
\r
varying vec2 vTextureCoord;\r
\r
void main(void)\r
{\r
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r
\r
    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r
}\r
`;const vf=[],xf=[],Ef=[],fm=class extends ye{constructor(e,t={}){super();const{align:s,tint:r,maxWidth:i,letterSpacing:n,fontName:o,fontSize:a}=Object.assign({},fm.styleDefaults,t);if(!ge.available[o])throw new Error(`Missing BitmapFont "${o}"`);this._activePagesMeshData=[],this._textWidth=0,this._textHeight=0,this._align=s,this._tintColor=new Ft(r),this._font=void 0,this._fontName=o,this._fontSize=a,this.text=e,this._maxWidth=i,this._maxLineHeight=0,this._letterSpacing=n,this._anchor=new Fs(()=>{this.dirty=!0},this,0,0),this._roundPixels=q.ROUND_PIXELS,this.dirty=!0,this._resolution=q.RESOLUTION,this._autoResolution=!0,this._textureCache={}}updateText(){var F;const e=ge.available[this._fontName],t=this.fontSize,s=t/e.size,r=new It,i=[],n=[],o=[],a=this._text.replace(/(?:\r\n|\r)/g,`
`)||" ",l=um(a),h=this._maxWidth*e.size/t,c=e.distanceFieldType==="none"?vf:xf;let u=null,f=0,p=0,d=0,m=-1,g=0,y=0,E=0,_=0;for(let U=0;U<l.length;U++){const H=l[U],B=qn(H);if(/(?:\s)/.test(H)&&(m=U,g=f,_++),H==="\r"||H===`
`){n.push(f),o.push(-1),p=Math.max(p,f),++d,++y,r.x=0,r.y+=e.lineHeight,u=null,_=0;continue}const C=e.chars[B];if(!C)continue;u&&C.kerning[u]&&(r.x+=C.kerning[u]);const ht=Ef.pop()||{texture:J.EMPTY,line:0,charCode:0,prevSpaces:0,position:new It};ht.texture=C.texture,ht.line=d,ht.charCode=B,ht.position.x=Math.round(r.x+C.xOffset+this._letterSpacing/2),ht.position.y=Math.round(r.y+C.yOffset),ht.prevSpaces=_,i.push(ht),f=ht.position.x+Math.max(C.xAdvance-C.xOffset,C.texture.orig.width),r.x+=C.xAdvance+this._letterSpacing,E=Math.max(E,C.yOffset+C.texture.height),u=B,m!==-1&&h>0&&r.x>h&&(++y,Xr(i,1+m-y,1+U-m),U=m,m=-1,n.push(g),o.push(i.length>0?i[i.length-1].prevSpaces:0),p=Math.max(p,g),d++,r.x=0,r.y+=e.lineHeight,u=null,_=0)}const v=l[l.length-1];v!=="\r"&&v!==`
`&&(/(?:\s)/.test(v)&&(f=g),n.push(f),p=Math.max(p,f),o.push(-1));const S=[];for(let U=0;U<=d;U++){let H=0;this._align==="right"?H=p-n[U]:this._align==="center"?H=(p-n[U])/2:this._align==="justify"&&(H=o[U]<0?0:(p-n[U])/o[U]),S.push(H)}const A=i.length,w={},b=[],R=this._activePagesMeshData;c.push(...R);for(let U=0;U<A;U++){const H=i[U].texture,B=H.baseTexture.uid;if(!w[B]){let C=c.pop();if(!C){const Q=new tT;let G,rt;e.distanceFieldType==="none"?(G=new gf(J.EMPTY),rt=ut.NORMAL):(G=new gf(J.EMPTY,{program:ke.from(RT,CT),uniforms:{uFWidth:0}}),rt=ut.NORMAL_NPM);const Ct=new Zl(Q,G);Ct.blendMode=rt,C={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:Ct,vertices:null,uvs:null,indices:null}}C.index=0,C.indexCount=0,C.vertexCount=0,C.uvsCount=0,C.total=0;const{_textureCache:ht}=this;ht[B]=ht[B]||new J(H.baseTexture),C.mesh.texture=ht[B],C.mesh.tint=this._tintColor.value,b.push(C),w[B]=C}w[B].total++}for(let U=0;U<R.length;U++)b.includes(R[U])||this.removeChild(R[U].mesh);for(let U=0;U<b.length;U++)b[U].mesh.parent!==this&&this.addChild(b[U].mesh);this._activePagesMeshData=b;for(const U in w){const H=w[U],B=H.total;if(!(((F=H.indices)==null?void 0:F.length)>6*B)||H.vertices.length<Zl.BATCHABLE_SIZE*2)H.vertices=new Float32Array(4*2*B),H.uvs=new Float32Array(4*2*B),H.indices=new Uint16Array(6*B);else{const C=H.total,ht=H.vertices;for(let Q=C*4*2;Q<ht.length;Q++)ht[Q]=0}H.mesh.size=6*B}for(let U=0;U<A;U++){const H=i[U];let B=H.position.x+S[H.line]*(this._align==="justify"?H.prevSpaces:1);this._roundPixels&&(B=Math.round(B));const C=B*s,ht=H.position.y*s,Q=H.texture,G=w[Q.baseTexture.uid],rt=Q.frame,Ct=Q._uvs,L=G.index++;G.indices[L*6+0]=0+L*4,G.indices[L*6+1]=1+L*4,G.indices[L*6+2]=2+L*4,G.indices[L*6+3]=0+L*4,G.indices[L*6+4]=2+L*4,G.indices[L*6+5]=3+L*4,G.vertices[L*8+0]=C,G.vertices[L*8+1]=ht,G.vertices[L*8+2]=C+rt.width*s,G.vertices[L*8+3]=ht,G.vertices[L*8+4]=C+rt.width*s,G.vertices[L*8+5]=ht+rt.height*s,G.vertices[L*8+6]=C,G.vertices[L*8+7]=ht+rt.height*s,G.uvs[L*8+0]=Ct.x0,G.uvs[L*8+1]=Ct.y0,G.uvs[L*8+2]=Ct.x1,G.uvs[L*8+3]=Ct.y1,G.uvs[L*8+4]=Ct.x2,G.uvs[L*8+5]=Ct.y2,G.uvs[L*8+6]=Ct.x3,G.uvs[L*8+7]=Ct.y3}this._textWidth=p*s,this._textHeight=(r.y+e.lineHeight)*s;for(const U in w){const H=w[U];if(this.anchor.x!==0||this.anchor.y!==0){let Q=0;const G=this._textWidth*this.anchor.x,rt=this._textHeight*this.anchor.y;for(let Ct=0;Ct<H.total;Ct++)H.vertices[Q++]-=G,H.vertices[Q++]-=rt,H.vertices[Q++]-=G,H.vertices[Q++]-=rt,H.vertices[Q++]-=G,H.vertices[Q++]-=rt,H.vertices[Q++]-=G,H.vertices[Q++]-=rt}this._maxLineHeight=E*s;const B=H.mesh.geometry.getBuffer("aVertexPosition"),C=H.mesh.geometry.getBuffer("aTextureCoord"),ht=H.mesh.geometry.getIndex();B.data=H.vertices,C.data=H.uvs,ht.data=H.indices,B.update(),C.update(),ht.update()}for(let U=0;U<i.length;U++)Ef.push(i[U]);this._font=e,this.dirty=!1}updateTransform(){this.validate(),this.containerUpdateTransform()}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0);const{distanceFieldRange:t,distanceFieldType:s,size:r}=ge.available[this._fontName];if(s!=="none"){const{a:i,b:n,c:o,d:a}=this.worldTransform,l=Math.sqrt(i*i+n*n),h=Math.sqrt(o*o+a*a),c=(Math.abs(l)+Math.abs(h))/2,u=this.fontSize/r,f=e._view.resolution;for(const p of this._activePagesMeshData)p.mesh.shader.uniforms.uFWidth=c*t*u*f}super._render(e)}getLocalBounds(){return this.validate(),super.getLocalBounds()}validate(){const e=ge.available[this._fontName];if(!e)throw new Error(`Missing BitmapFont "${this._fontName}"`);this._font!==e&&(this.dirty=!0),this.dirty&&this.updateText()}get tint(){return this._tintColor.value}set tint(e){if(this.tint!==e){this._tintColor.setValue(e);for(let t=0;t<this._activePagesMeshData.length;t++)this._activePagesMeshData[t].mesh.tint=e}}get align(){return this._align}set align(e){this._align!==e&&(this._align=e,this.dirty=!0)}get fontName(){return this._fontName}set fontName(e){if(!ge.available[e])throw new Error(`Missing BitmapFont "${e}"`);this._fontName!==e&&(this._fontName=e,this.dirty=!0)}get fontSize(){return this._fontSize??ge.available[this._fontName].size}set fontSize(e){this._fontSize!==e&&(this._fontSize=e,this.dirty=!0)}get anchor(){return this._anchor}set anchor(e){typeof e=="number"?this._anchor.set(e):this._anchor.copyFrom(e)}get text(){return this._text}set text(e){e=String(e??""),this._text!==e&&(this._text=e,this.dirty=!0)}get maxWidth(){return this._maxWidth}set maxWidth(e){this._maxWidth!==e&&(this._maxWidth=e,this.dirty=!0)}get maxLineHeight(){return this.validate(),this._maxLineHeight}get textWidth(){return this.validate(),this._textWidth}get letterSpacing(){return this._letterSpacing}set letterSpacing(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.dirty=!0)}get roundPixels(){return this._roundPixels}set roundPixels(e){e!==this._roundPixels&&(this._roundPixels=e,this.dirty=!0)}get textHeight(){return this.validate(),this._textHeight}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}destroy(e){const{_textureCache:t}=this,r=ge.available[this._fontName].distanceFieldType==="none"?vf:xf;r.push(...this._activePagesMeshData);for(const i of this._activePagesMeshData)this.removeChild(i.mesh);this._activePagesMeshData=[],r.filter(i=>t[i.mesh.texture.baseTexture.uid]).forEach(i=>{i.mesh.texture=J.EMPTY});for(const i in t)t[i].destroy(),delete t[i];this._font=null,this._tintColor=null,this._textureCache=null,super.destroy(e)}};let PT=fm;PT.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0};const MT=[".xml",".fnt"],OT={extension:{type:Z.LoadParser,priority:hs.Normal},name:"loadBitmapFont",test(e){return MT.includes(fe.extname(e).toLowerCase())},async testParse(e){return Kn.test(e)||eh.test(e)},async parse(e,t,s){const r=Kn.test(e)?Kn.parse(e):eh.parse(e),{src:i}=t,{page:n}=r,o=[];for(let h=0;h<n.length;++h){const c=n[h].file;let u=fe.join(fe.dirname(i),c);u=Kl(u,i),o.push(u)}const a=await s.load(o),l=o.map(h=>a[h]);return ge.install(r,l,!0)},async load(e,t){return(await q.ADAPTER.fetch(e)).text()},unload(e){e.destroy()}};nt.add(OT);const Mr=class extends ws{constructor(){super(...arguments),this._fonts=[],this._overrides=[],this._stylesheet="",this.fontsDirty=!1}static from(e){return new Mr(Object.keys(Mr.defaultOptions).reduce((t,s)=>({...t,[s]:e[s]}),{}))}cleanFonts(){this._fonts.length>0&&(this._fonts.forEach(e=>{URL.revokeObjectURL(e.src),e.refs--,e.refs===0&&(e.fontFace&&document.fonts.delete(e.fontFace),delete Mr.availableFonts[e.originalUrl])}),this.fontFamily="Arial",this._fonts.length=0,this.styleID++,this.fontsDirty=!0)}loadFont(e,t={}){const{availableFonts:s}=Mr;if(s[e]){const r=s[e];return this._fonts.push(r),r.refs++,this.styleID++,this.fontsDirty=!0,Promise.resolve()}return q.ADAPTER.fetch(e).then(r=>r.blob()).then(async r=>new Promise((i,n)=>{const o=URL.createObjectURL(r),a=new FileReader;a.onload=()=>i([o,a.result]),a.onerror=n,a.readAsDataURL(r)})).then(async([r,i])=>{const n=Object.assign({family:fe.basename(e,fe.extname(e)),weight:"normal",style:"normal",src:r,dataSrc:i,refs:1,originalUrl:e,fontFace:null},t);s[e]=n,this._fonts.push(n),this.styleID++;const o=new FontFace(n.family,`url(${n.src})`,{weight:n.weight,style:n.style});n.fontFace=o,await o.load(),document.fonts.add(o),await document.fonts.ready,this.styleID++,this.fontsDirty=!0})}addOverride(...e){const t=e.filter(s=>!this._overrides.includes(s));t.length>0&&(this._overrides.push(...t),this.styleID++)}removeOverride(...e){const t=e.filter(s=>this._overrides.includes(s));t.length>0&&(this._overrides=this._overrides.filter(s=>!t.includes(s)),this.styleID++)}toCSS(e){return[`transform: scale(${e})`,"transform-origin: top left","display: inline-block",`color: ${this.normalizeColor(this.fill)}`,`font-size: ${this.fontSize}px`,`font-family: ${this.fontFamily}`,`font-weight: ${this.fontWeight}`,`font-style: ${this.fontStyle}`,`font-variant: ${this.fontVariant}`,`letter-spacing: ${this.letterSpacing}px`,`text-align: ${this.align}`,`padding: ${this.padding}px`,`white-space: ${this.whiteSpace}`,...this.lineHeight?[`line-height: ${this.lineHeight}px`]:[],...this.wordWrap?[`word-wrap: ${this.breakWords?"break-all":"break-word"}`,`max-width: ${this.wordWrapWidth}px`]:[],...this.strokeThickness?[`-webkit-text-stroke-width: ${this.strokeThickness}px`,`-webkit-text-stroke-color: ${this.normalizeColor(this.stroke)}`,`text-stroke-width: ${this.strokeThickness}px`,`text-stroke-color: ${this.normalizeColor(this.stroke)}`,"paint-order: stroke"]:[],...this.dropShadow?[this.dropShadowToCSS()]:[],...this._overrides].join(";")}toGlobalCSS(){return this._fonts.reduce((e,t)=>`${e}
            @font-face {
                font-family: "${t.family}";
                src: url('${t.dataSrc}');
                font-weight: ${t.weight};
                font-style: ${t.style}; 
            }`,this._stylesheet)}get stylesheet(){return this._stylesheet}set stylesheet(e){this._stylesheet!==e&&(this._stylesheet=e,this.styleID++)}normalizeColor(e){return Array.isArray(e)&&(e=F0(e)),typeof e=="number"?D0(e):e}dropShadowToCSS(){let e=this.normalizeColor(this.dropShadowColor);const t=this.dropShadowAlpha,s=Math.round(Math.cos(this.dropShadowAngle)*this.dropShadowDistance),r=Math.round(Math.sin(this.dropShadowAngle)*this.dropShadowDistance);e.startsWith("#")&&t<1&&(e+=(t*255|0).toString(16).padStart(2,"0"));const i=`${s}px ${r}px`;return this.dropShadowBlur>0?`text-shadow: ${i} ${this.dropShadowBlur}px ${e}`:`text-shadow: ${i} ${e}`}reset(){Object.assign(this,Mr.defaultOptions)}onBeforeDraw(){const{fontsDirty:e}=this;return this.fontsDirty=!1,this.isSafari&&this._fonts.length>0&&e?new Promise(t=>setTimeout(t,100)):Promise.resolve()}get isSafari(){const{userAgent:e}=q.ADAPTER.getNavigator();return/^((?!chrome|android).)*safari/i.test(e)}set fillGradientStops(e){console.warn("[HTMLTextStyle] fillGradientStops is not supported by HTMLText")}get fillGradientStops(){return super.fillGradientStops}set fillGradientType(e){console.warn("[HTMLTextStyle] fillGradientType is not supported by HTMLText")}get fillGradientType(){return super.fillGradientType}set miterLimit(e){console.warn("[HTMLTextStyle] miterLimit is not supported by HTMLText")}get miterLimit(){return super.miterLimit}set trim(e){console.warn("[HTMLTextStyle] trim is not supported by HTMLText")}get trim(){return super.trim}set textBaseline(e){console.warn("[HTMLTextStyle] textBaseline is not supported by HTMLText")}get textBaseline(){return super.textBaseline}set leading(e){console.warn("[HTMLTextStyle] leading is not supported by HTMLText")}get leading(){return super.leading}set lineJoin(e){console.warn("[HTMLTextStyle] lineJoin is not supported by HTMLText")}get lineJoin(){return super.lineJoin}};let Ui=Mr;Ui.availableFonts={};Ui.defaultOptions={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,padding:0,stroke:"black",strokeThickness:0,whiteSpace:"normal",wordWrap:!1,wordWrapWidth:100};const Or=class extends yr{constructor(e="",t={}){super(J.EMPTY),this._text=null,this._style=null,this._autoResolution=!0,this._loading=!1,this.localStyleID=-1,this.dirty=!1,this.ownsStyle=!1;const s=new Image,r=J.from(s,{scaleMode:q.SCALE_MODE,resourceOptions:{autoLoad:!1}});r.orig=new yt,r.trim=new yt,this.texture=r;const i="http://www.w3.org/2000/svg",n="http://www.w3.org/1999/xhtml",o=document.createElementNS(i,"svg"),a=document.createElementNS(i,"foreignObject"),l=document.createElementNS(n,"div"),h=document.createElementNS(n,"style");a.setAttribute("width","10000"),a.setAttribute("height","10000"),a.style.overflow="hidden",o.appendChild(a),this.maxWidth=Or.defaultMaxWidth,this.maxHeight=Or.defaultMaxHeight,this._domElement=l,this._styleElement=h,this._svgRoot=o,this._foreignObject=a,this._foreignObject.appendChild(h),this._foreignObject.appendChild(l),this._image=s,this._loadImage=new Image,this._autoResolution=Or.defaultAutoResolution,this._resolution=Or.defaultResolution??q.RESOLUTION,this.text=e,this.style=t}measureText(e){var a,l;const{text:t,style:s,resolution:r}=Object.assign({text:this._text,style:this._style,resolution:this._resolution},e);Object.assign(this._domElement,{innerHTML:t,style:s.toCSS(r)}),this._styleElement.textContent=s.toGlobalCSS(),document.body.appendChild(this._svgRoot);const i=this._domElement.getBoundingClientRect();this._svgRoot.remove();const n=Math.min(this.maxWidth,Math.ceil(i.width)),o=Math.min(this.maxHeight,Math.ceil(i.height));return this._svgRoot.setAttribute("width",n.toString()),this._svgRoot.setAttribute("height",o.toString()),t!==this._text&&(this._domElement.innerHTML=this._text),s!==this._style&&(Object.assign(this._domElement,{style:(a=this._style)==null?void 0:a.toCSS(r)}),this._styleElement.textContent=(l=this._style)==null?void 0:l.toGlobalCSS()),{width:n+s.padding*2,height:o+s.padding*2}}async updateText(e=!0){const{style:t,_image:s,_loadImage:r}=this;if(this.localStyleID!==t.styleID&&(this.dirty=!0,this.localStyleID=t.styleID),!this.dirty&&e)return;const{width:i,height:n}=this.measureText();s.width=r.width=Math.ceil(Math.max(1,i)),s.height=r.height=Math.ceil(Math.max(1,n)),this._loading||(this._loading=!0,await new Promise(o=>{r.onload=async()=>{await t.onBeforeDraw(),this._loading=!1,s.src=r.src,r.onload=null,r.src="",this.updateTexture(),o()};const a=new XMLSerializer().serializeToString(this._svgRoot);r.src=`data:image/svg+xml;charset=utf8,${encodeURIComponent(a)}`}))}get source(){return this._image}updateTexture(){const{style:e,texture:t,_image:s,resolution:r}=this,{padding:i}=e,{baseTexture:n}=t;t.trim.width=t._frame.width=s.width/r,t.trim.height=t._frame.height=s.height/r,t.trim.x=-i,t.trim.y=-i,t.orig.width=t._frame.width-i*2,t.orig.height=t._frame.height-i*2,this._onTextureUpdate(),n.setRealSize(s.width,s.height,r),this.dirty=!1}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._render(e)}_renderCanvas(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._renderCanvas(e)}getLocalBounds(e){return this.updateText(!0),super.getLocalBounds(e)}_calculateBounds(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_onStyleChange(){this.dirty=!0}destroy(e){var s,r,i,n,o;typeof e=="boolean"&&(e={children:e}),e=Object.assign({},Or.defaultDestroyOptions,e),super.destroy(e);const t=null;this.ownsStyle&&((s=this._style)==null||s.cleanFonts()),this._style=t,(r=this._svgRoot)==null||r.remove(),this._svgRoot=t,(i=this._domElement)==null||i.remove(),this._domElement=t,(n=this._foreignObject)==null||n.remove(),this._foreignObject=t,(o=this._styleElement)==null||o.remove(),this._styleElement=t,this._loadImage.src="",this._loadImage.onload=null,this._loadImage=t,this._image.src="",this._image=t}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._image.width/this.resolution}set width(e){this.updateText(!0);const t=Ds(this.scale.x)||1;this.scale.x=t*e/this._image.width/this.resolution,this._width=e}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._image.height/this.resolution}set height(e){this.updateText(!0);const t=Ds(this.scale.y)||1;this.scale.y=t*e/this._image.height/this.resolution,this._height=e}get style(){return this._style}set style(e){this._style!==e&&(e=e||{},e instanceof Ui?(this.ownsStyle=!1,this._style=e):e instanceof ws?(console.warn("[HTMLText] Cloning TextStyle, if this is not what you want, use HTMLTextStyle"),this.ownsStyle=!0,this._style=Ui.from(e)):(this.ownsStyle=!0,this._style=new Ui(e)),this.localStyleID=-1,this.dirty=!0)}get text(){return this._text}set text(e){e=String(e===""||e===null||e===void 0?" ":e),e=this.sanitiseText(e),this._text!==e&&(this._text=e,this.dirty=!0)}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}sanitiseText(e){return e.replace(/<br>/gi,"<br/>").replace(/<hr>/gi,"<hr/>").replace(/&nbsp;/gi,"&#160;")}};let Jo=Or;Jo.defaultDestroyOptions={texture:!0,children:!1,baseTexture:!0};Jo.defaultMaxWidth=2024;Jo.defaultMaxHeight=2024;Jo.defaultAutoResolution=!0;let bf=0,wf=0,Za=0,Ja=0,Qa=0;const Tf=5,tc=(e,t)=>(e&&t&&(bf=e.maxX,wf=e.maxY,Za=t.width,Ja=t.height,Za>Ja?Qa=Ja*((100-Tf)/100)/(wf+1):Qa=Za*((100-Tf)/100)/(bf+1)),Qa),dm=tc(),BT=33*dm,DT=18*dm,FT={powerPreference:"high-performance",width:BT,height:DT,autoDensity:!0,preserveDrawingBuffer:!0,antialias:!0},LT=8,NT=100,pr=80,UT="/things/game_sprites.json",kT=()=>(q.RENDER_OPTIONS.hello=!1,Se.defaultMode=Uo.AUTO,we.defaultBatchSize=Math.min(we.defaultBatchSize,16),new Kh(FT));let Nn;const GT=new Uint8Array(16);function HT(){if(!Nn&&(Nn=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Nn))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Nn(GT)}const ie=[];for(let e=0;e<256;++e)ie.push((e+256).toString(16).slice(1));function $T(e,t=0){return(ie[e[t+0]]+ie[e[t+1]]+ie[e[t+2]]+ie[e[t+3]]+"-"+ie[e[t+4]]+ie[e[t+5]]+"-"+ie[e[t+6]]+ie[e[t+7]]+"-"+ie[e[t+8]]+ie[e[t+9]]+"-"+ie[e[t+10]]+ie[e[t+11]]+ie[e[t+12]]+ie[e[t+13]]+ie[e[t+14]]+ie[e[t+15]]).toLowerCase()}const WT=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Sf={randomUUID:WT};function XT(e,t,s){if(Sf.randomUUID&&!t&&!e)return Sf.randomUUID();e=e||{};const r=e.random||(e.rng||HT)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,t){s=s||0;for(let i=0;i<16;++i)t[s+i]=r[i];return t}return $T(r)}const mr=()=>XT();globalThis&&globalThis.__spreadArray;var zT=function(e){return e._tag==="Some"},VT={_tag:"None"},jT=function(e){return{_tag:"Some",value:e}},Ot=VT,se=jT,es=zT,Tt=function(e){return e._tag==="None"};class YT{constructor(){X(this,"_containerPackages",[]);X(this,"_emptyContainerPackages",[])}get _nonEmptySize(){return this._containerPackages.length}_removeContainerPackage(t){const s=this._containerPackages.findIndex(r=>r.id===t);if(s===-1){if(this._emptyContainerPackages.findIndex(i=>i.id===t)===-1)throw new Error(`containerPackage ${t} does not exist.`);this._emptyContainerPackages.splice(s,1);return}this._containerPackages.splice(s,1)}hasContainerById(t){return this._containerPackages.concat(this._emptyContainerPackages).findIndex(s=>s.id===t)!==-1}hasContainerByName(t){return this._containerPackages.concat(this._emptyContainerPackages).findIndex(s=>s.name===t)!==-1}hasAnyContainer(){return this._containerPackages.concat(this._emptyContainerPackages).length!==0}getNonEmptyContainerByIndex(t){const s=this._nonEmptySize;if(t<0||t>=s)throw new Error(`Index ${t} out of range`);const r=this._containerPackages[t];if(!r)throw new Error(`Container package ${t} not a valid container package`);return this._removeContainerPackage(r.id),r.container}getEmptyContainer(){const t=this._emptyContainerPackages.length;if(t===0)return Ot;const s=this._emptyContainerPackages[t-1];return this._removeContainerPackage(s.id),se(s.container)}getContainerByName(t){let s=this._containerPackages.find(r=>r.name===t);if(!s){const r=this._emptyContainerPackages.find(i=>i.name===t);if(!r)throw new Error(`Invalid container ${t} not found`);s=r}return this._removeContainerPackage(s.id),s.container}addContainer(t,s,r){const n={id:mr(),name:s,container:t};t.children.length===0&&this._emptyContainerPackages.splice(Number(r),0,n),this._containerPackages.splice(Number(r),0,n)}}const KT=()=>new YT;class jr{constructor(t){X(this,"compare");this.compare=t||jr.defaultCompareFunction}static defaultCompareFunction(t,s){return t===s?0:t<s?-1:1}equal(t,s){return this.compare(t,s)===0}lessThan(t,s){return this.compare(t,s)<0}greaterThan(t,s){return this.compare(t,s)>0}lessThanOrEqual(t,s){return this.lessThan(t,s)||this.equal(t,s)}greaterThanOrEqual(t,s){return this.greaterThan(t,s)||this.equal(t,s)}reverse(){const t=this.compare;this.compare=(s,r)=>t(r,s)}}class ec{constructor(t){X(this,"compare");X(this,"heapContainer");if(new.target===ec)throw new TypeError("Cannot construct Heap instance directly");this.heapContainer=[],this.compare=new jr(t)}getLeftChildIndex(t){return 2*t+1}getRightChildIndex(t){return 2*t+2}getParentIndex(t){return Math.floor((t-1)/2)}hasParent(t){return this.getParentIndex(t)>=0}hasLeftChild(t){return this.getLeftChildIndex(t)<this.heapContainer.length}hasRightChild(t){return this.getRightChildIndex(t)<this.heapContainer.length}leftChild(t){return this.heapContainer[this.getLeftChildIndex(t)]}rightChild(t){return this.heapContainer[this.getRightChildIndex(t)]}parent(t){return this.heapContainer[this.getParentIndex(t)]}swap(t,s){const r=this.heapContainer[s];this.heapContainer[s]=this.heapContainer[t],this.heapContainer[t]=r}peek(){return this.heapContainer.length===0?null:this.heapContainer[0]}poll(){if(this.heapContainer.length===0)return null;if(this.heapContainer.length===1)return this.heapContainer.pop();const t=this.heapContainer[0];return this.heapContainer[0]=this.heapContainer.pop(),this.heapifyDown(),t}add(t){return this.heapContainer.push(t),this.heapifyUp(),this}remove(t,s=this.compare){const r=this.find(t,s).length;for(let i=0;i<r;i+=1){const n=Number(this.find(t,s).pop());if(n===this.heapContainer.length-1)this.heapContainer.pop();else{this.heapContainer[n]=this.heapContainer.pop();const o=this.parent(n);this.hasLeftChild(n)&&(!o||this.pairIsInCorrectOrder(o,this.heapContainer[n]))?this.heapifyDown(n):this.heapifyUp(n)}}return this}find(t,s=this.compare){const r=[];for(let i=0;i<this.heapContainer.length;i+=1)s.equal(t,this.heapContainer[i])&&r.push(i);return r}isEmpty(){return!this.heapContainer.length}toString(){return this.heapContainer.toString()}heapifyUp(t){let s=t||this.heapContainer.length-1;for(;this.hasParent(s)&&!this.pairIsInCorrectOrder(this.parent(s),this.heapContainer[s]);)this.swap(s,this.getParentIndex(s)),s=this.getParentIndex(s)}heapifyDown(t=0){let s=t,r=null;for(;this.hasLeftChild(s)&&(this.hasRightChild(s)&&this.pairIsInCorrectOrder(this.rightChild(s),this.leftChild(s))?r=this.getRightChildIndex(s):r=this.getLeftChildIndex(s),!this.pairIsInCorrectOrder(this.heapContainer[s],this.heapContainer[r]));)this.swap(s,r),s=r}pairIsInCorrectOrder(t,s){throw new Error(`
      You have to implement heap pair comparision method
      for ${t} and ${s} values.
    `)}clear(){this.heapContainer.length=0}heapSize(){return this.heapContainer.length}}class qT extends ec{pairIsInCorrectOrder(t,s){return this.compare.lessThanOrEqual(t,s)}}class pm extends qT{constructor(){super();X(this,"priorities");this.priorities=new Map,this.compare=new jr(this.comparePriority.bind(this))}add(s,r=0){return this.priorities.set(s,r),super.add(s),this}remove(s,r){return super.remove(s,r),this.priorities.delete(s),this}changePriority(s,r){return this.remove(s,new jr(this.compareValue)),this.add(s,r),this}findByValue(s){return this.find(s,new jr(this.compareValue))}hasValue(s){return this.findByValue(s).length>0}comparePriority(s,r){return this.priorities.get(s)===this.priorities.get(r)?0:Number(this.priorities.get(s))<Number(this.priorities.get(r))?-1:1}compareValue(s,r){return s===r?0:s<r?-1:1}size(){return this.heapSize()}}const ZT=(e,t,...s)=>{let r;return()=>{clearTimeout(r),r=setTimeout(()=>{e(s)},t)}};var mm={exports:{}};(function(e){(function(t,s,r){if(!t)return;for(var i={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},n={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},o={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},a={option:"alt",command:"meta",return:"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},l,h=1;h<20;++h)i[111+h]="f"+h;for(h=0;h<=9;++h)i[h+96]=h.toString();function c(w,b,R){if(w.addEventListener){w.addEventListener(b,R,!1);return}w.attachEvent("on"+b,R)}function u(w){if(w.type=="keypress"){var b=String.fromCharCode(w.which);return w.shiftKey||(b=b.toLowerCase()),b}return i[w.which]?i[w.which]:n[w.which]?n[w.which]:String.fromCharCode(w.which).toLowerCase()}function f(w,b){return w.sort().join(",")===b.sort().join(",")}function p(w){var b=[];return w.shiftKey&&b.push("shift"),w.altKey&&b.push("alt"),w.ctrlKey&&b.push("ctrl"),w.metaKey&&b.push("meta"),b}function d(w){if(w.preventDefault){w.preventDefault();return}w.returnValue=!1}function m(w){if(w.stopPropagation){w.stopPropagation();return}w.cancelBubble=!0}function g(w){return w=="shift"||w=="ctrl"||w=="alt"||w=="meta"}function y(){if(!l){l={};for(var w in i)w>95&&w<112||i.hasOwnProperty(w)&&(l[i[w]]=w)}return l}function E(w,b,R){return R||(R=y()[w]?"keydown":"keypress"),R=="keypress"&&b.length&&(R="keydown"),R}function _(w){return w==="+"?["+"]:(w=w.replace(/\+{2}/g,"+plus"),w.split("+"))}function v(w,b){var R,F,U,H=[];for(R=_(w),U=0;U<R.length;++U)F=R[U],a[F]&&(F=a[F]),b&&b!="keypress"&&o[F]&&(F=o[F],H.push("shift")),g(F)&&H.push(F);return b=E(F,H,b),{key:F,modifiers:H,action:b}}function S(w,b){return w===null||w===s?!1:w===b?!0:S(w.parentNode,b)}function A(w){var b=this;if(w=w||s,!(b instanceof A))return new A(w);b.target=w,b._callbacks={},b._directMap={};var R={},F,U=!1,H=!1,B=!1;function C(N){N=N||{};var Y=!1,it;for(it in R){if(N[it]){Y=!0;continue}R[it]=0}Y||(B=!1)}function ht(N,Y,it,tt,dt,_t){var ct,vt,Lt=[],Pt=it.type;if(!b._callbacks[N])return[];for(Pt=="keyup"&&g(N)&&(Y=[N]),ct=0;ct<b._callbacks[N].length;++ct)if(vt=b._callbacks[N][ct],!(!tt&&vt.seq&&R[vt.seq]!=vt.level)&&Pt==vt.action&&(Pt=="keypress"&&!it.metaKey&&!it.ctrlKey||f(Y,vt.modifiers))){var Mt=!tt&&vt.combo==dt,x=tt&&vt.seq==tt&&vt.level==_t;(Mt||x)&&b._callbacks[N].splice(ct,1),Lt.push(vt)}return Lt}function Q(N,Y,it,tt){b.stopCallback(Y,Y.target||Y.srcElement,it,tt)||N(Y,it)===!1&&(d(Y),m(Y))}b._handleKey=function(N,Y,it){var tt=ht(N,Y,it),dt,_t={},ct=0,vt=!1;for(dt=0;dt<tt.length;++dt)tt[dt].seq&&(ct=Math.max(ct,tt[dt].level));for(dt=0;dt<tt.length;++dt){if(tt[dt].seq){if(tt[dt].level!=ct)continue;vt=!0,_t[tt[dt].seq]=1,Q(tt[dt].callback,it,tt[dt].combo,tt[dt].seq);continue}vt||Q(tt[dt].callback,it,tt[dt].combo)}var Lt=it.type=="keypress"&&H;it.type==B&&!g(N)&&!Lt&&C(_t),H=vt&&it.type=="keydown"};function G(N){typeof N.which!="number"&&(N.which=N.keyCode);var Y=u(N);if(Y){if(N.type=="keyup"&&U===Y){U=!1;return}b.handleKey(Y,p(N),N)}}function rt(){clearTimeout(F),F=setTimeout(C,1e3)}function Ct(N,Y,it,tt){R[N]=0;function dt(Pt){return function(){B=Pt,++R[N],rt()}}function _t(Pt){Q(it,Pt,N),tt!=="keyup"&&(U=u(Pt)),setTimeout(C,10)}for(var ct=0;ct<Y.length;++ct){var vt=ct+1===Y.length,Lt=vt?_t:dt(tt||v(Y[ct+1]).action);L(Y[ct],Lt,tt,N,ct)}}function L(N,Y,it,tt,dt){b._directMap[N+":"+it]=Y,N=N.replace(/\s+/g," ");var _t=N.split(" "),ct;if(_t.length>1){Ct(N,_t,Y,it);return}ct=v(N,it),b._callbacks[ct.key]=b._callbacks[ct.key]||[],ht(ct.key,ct.modifiers,{type:ct.action},tt,N,dt),b._callbacks[ct.key][tt?"unshift":"push"]({callback:Y,modifiers:ct.modifiers,action:ct.action,seq:tt,level:dt,combo:N})}b._bindMultiple=function(N,Y,it){for(var tt=0;tt<N.length;++tt)L(N[tt],Y,it)},c(w,"keypress",G),c(w,"keydown",G),c(w,"keyup",G)}A.prototype.bind=function(w,b,R){var F=this;return w=w instanceof Array?w:[w],F._bindMultiple.call(F,w,b,R),F},A.prototype.unbind=function(w,b){var R=this;return R.bind.call(R,w,function(){},b)},A.prototype.trigger=function(w,b){var R=this;return R._directMap[w+":"+b]&&R._directMap[w+":"+b]({},w),R},A.prototype.reset=function(){var w=this;return w._callbacks={},w._directMap={},w},A.prototype.stopCallback=function(w,b){var R=this;if((" "+b.className+" ").indexOf(" mousetrap ")>-1||S(b,R.target))return!1;if("composedPath"in w&&typeof w.composedPath=="function"){var F=w.composedPath()[0];F!==w.target&&(b=F)}return b.tagName=="INPUT"||b.tagName=="SELECT"||b.tagName=="TEXTAREA"||b.isContentEditable},A.prototype.handleKey=function(){var w=this;return w._handleKey.apply(w,arguments)},A.addKeycodes=function(w){for(var b in w)w.hasOwnProperty(b)&&(i[b]=w[b]);l=null},A.init=function(){var w=A(s);for(var b in w)b.charAt(0)!=="_"&&(A[b]=function(R){return function(){return w[R].apply(w,arguments)}}(b))},A.init(),t.Mousetrap=A,e.exports&&(e.exports=A),typeof r=="function"&&r.amd&&r(function(){return A})})(typeof window<"u"?window:null,typeof window<"u"?document:null)})(mm);var JT=mm.exports;const Af=Dh(JT);class gm{constructor(){X(this,"_changed",!1);X(this,"_observers");this._observers=new Array}addObserver(t){if(!t)throw new Error(`observer is ${typeof t}`);this._observers.includes(t)||this._observers.push(t)}clearChanged(){this._changed=!1}countObservers(){return this._observers.length}deleteObserver(t){const s=this._observers.findIndex(r=>r.observeId===t.observeId);s!==-1&&this._observers.splice(s,1)}deleteObservers(){for(;this._observers.length;)this._observers.pop();this._observers.length=0}hasChanged(){return this._changed}async notifyObservers(...t){let s=[];this.hasChanged()&&(s=this._observers.slice(),this.clearChanged());const r=[];for(let i=s.length-1;i>=0;i--)r.push(s[i].update(this,...t));await Promise.allSettled(r)}setChanged(){this._changed=!0}}var ps=(e=>(e.UP="up",e.DOWN="down",e.LEFT="left",e.RIGHT="right",e.ESC="esc",e))(ps||{});const sh=[{command:{value:"up"},priority:1},{command:{value:"down"},priority:1},{command:{value:"left"},priority:1},{command:{value:"right"},priority:1}],QT=()=>{const e=new Map;for(const t of sh)e.set(t.command,t.priority);return e};class tS{constructor(){X(this,"_commandPackages",new pm);X(this,"_commandPrioritiesMap",QT());X(this,"_dispatchNotifier",new gm);X(this,"_commandWatchServiceStarted",!1)}_judgementCommandPriority(t){const s=this._commandPrioritiesMap.get(t);if(typeof s>"u"||s===void 0)throw new Error(`this command ${t} is not have any priority defined`);return s===0?s:Date.now()}get _size(){return this._commandPackages.size()}addCommand(t){this._size<LT&&ZT(()=>{const s=this._judgementCommandPriority(t);this._commandPackages.add({command:t,priority:s},s),this._dispatchNotifier.setChanged(),this._dispatchNotifier.notifyObservers().then()},NT)()}connectDispatchListener(t){this._dispatchNotifier.addObserver(t)}clearCommand(){this._commandPackages.clear()}nextCommand(){const t=this._commandPackages.poll();return t?se(t.command):Ot}initCommandWatchService(){if(!this._commandWatchServiceStarted){for(const s of sh)Af.bind(s.command.value,()=>this.addCommand(s.command));const t=["w","s","a","d"];for(let s=0;s<4;s++)Af.bind(t[s],()=>this.addCommand(sh[s].command));this._commandWatchServiceStarted=!0}}}const eS=()=>new tS;class sS{constructor(){X(this,"_spritePackages",new Map)}_hasThisSprite(t){return this._spritePackages.has(t)}_removeSpritePackage(t,s){const r=this._spritePackages.get(t);if(!r)return;const i=r.findIndex(n=>n.id===s);if(!i)throw new Error(`sprite ${s} not found`);this._spritePackages.get(t).splice(i,1)}_removeSpritePackages(t,s){return this._spritePackages.get(t)?this._spritePackages.get(t).splice(0,s):null}addSpriteByName(t,s){const i={id:mr(),sprite:s};if(!this._hasThisSprite(t)){this._spritePackages.set(t,[i]);return}this._spritePackages.get(t).push(i)}addSpritesByName(t,s){const r=(i=>{const n=[];for(const o of i){const l={id:mr(),sprite:o};n.push(l)}return n})(s);if(!this._hasThisSprite(t)){this._spritePackages.set(t,r);return}this._spritePackages.get(t).push(...r)}getSpriteAmountByName(t){return this._hasThisSprite(t)?this._spritePackages.get(t).length:0}getSpriteByName(t){if(!this._hasThisSprite(t))return Ot;const s=this._spritePackages.get(t)[0];if(!s)throw new Error(`sprite ${t} not found`);return this._removeSpritePackage(t,s.id),se(s.sprite)}getSpritesByName(t,s){if(!this._hasThisSprite(t))return Ot;const r=this.getSpriteAmountByName(t);if(r<s)throw new Error(`sprites amount in store ${r} < ${s}`);const i=this._removeSpritePackages(t,s);if(!i)throw new Error(`sprites ${t} can not be removed`);const n=[];for(const o of i)n.push(o.sprite);return se(n)}}const rS=()=>new sS;class iS{constructor(){X(this,"_resourcesSheet");X(this,"_loadingProgress",0)}async _prepareLoadedResources(t){const s=await Si.load(t.trim());if(!s)throw new Error("Could not get game resources!");this._resourcesSheet=s}async loadResources(t){this._resourcesSheet||await this._prepareLoadedResources(t)}getLoadingProgress(){return this._loadingProgress}getAnimationTextures(t,s){const r=this._resourcesSheet.animations[`${t}/${s}`];if(!r)throw new Error(`Could not found the resource of ${t}/${s} !`);return r}}const nS=()=>new iS;class oS{constructor(){X(this,"_dispatchServer");X(this,"_ruleController");X(this,"_mapController")}getDispatchServer(){return this._dispatchServer}setDispatchServer(t){this._dispatchServer=t}initDispatchServer(){this._dispatchServer.enableService()}disposeDispatchServer(){this._dispatchServer.disableService()}getRuleController(){return this._ruleController}getMapController(){return this._mapController}setRuleController(t){this._ruleController=t}setMapController(t){this._mapController=t}changeMapSize(t){this._mapController.changeMapSize(t)}}const aS=()=>new oS;class lS{constructor(){X(this,"_gameApp");X(this,"_edge");X(this,"_screenHeight");X(this,"_screenWidth")}getAppEdge(){return this._edge}getScreenSize(){return{width:this._screenWidth,height:this._screenHeight}}setAppSize(t,s){this._edge.maxX=t-1,this._edge.maxY=s-1,this._screenHeight=innerHeight,this._screenWidth=innerWidth;const r=tc(this._edge,this.getScreenSize());this._gameApp.renderer.resize(t*r,s*r)}bindAppToScreenService(t){this._gameApp=t,this._edge={maxX:this._gameApp.screen.x,maxY:this._gameApp.screen.y}}}const hS=()=>new lS;class cS{constructor(){X(this,"_scanner")}getScanner(){return this._scanner}setScanner(t){this._scanner=t}}const uS=()=>new cS;class fS{constructor(){X(this,"_stageBuilder");X(this,"_containerBuilder");X(this,"_spriteBuilder")}getContainerBuilder(){return this._containerBuilder}getSpriteBuilder(){return this._spriteBuilder}getStageBuilder(){return this._stageBuilder}setContainerBuilder(t){this._containerBuilder=t}setSpriteBuilder(t){this._spriteBuilder=t}setStageBuilder(t){this._stageBuilder=t}}const dS=()=>new fS,pS=()=>{const e=KT(),t=eS(),s=rS(),r=nS(),i=aS(),n=hS(),o=uS(),a=dS();return{containerService:e,commandService:t,spriteService:s,textureService:r,controllerService:i,screenService:n,scannerService:o,builderService:a}},mS=e=>({getContainerByName:t=>e.getContainerByName(t),getNonEmptyContainerByIndex:t=>e.getNonEmptyContainerByIndex(t),getEmptyContainer:()=>e.getEmptyContainer(),addContainer:(t,s,r)=>e.addContainer(t,s,r),hasContainerById:t=>e.hasContainerById(t),hasContainerByName:t=>e.hasContainerByName(t),hasAnyContainer:()=>e.hasAnyContainer()}),gS=e=>({getSpriteByName:t=>e.getSpriteByName(t),getSpritesByName:(t,s)=>e.getSpritesByName(t,s),getSpriteAmountByName:t=>e.getSpriteAmountByName(t),addSpriteByName:(t,s)=>e.addSpriteByName(t,s),addSpritesByName:(t,s)=>e.addSpritesByName(t,s)}),_S=e=>({loadResources:t=>e.loadResources(t),getAnimationTextures:(t,s)=>e.getAnimationTextures(t,s),getLoadingProgress:()=>e.getLoadingProgress()}),yS=e=>({setDispatchServer:t=>e.setDispatchServer(t),getDispatchServer:()=>e.getDispatchServer(),initDispatchServer:()=>e.initDispatchServer(),disposeDispatchServer:()=>e.disposeDispatchServer(),setRuleController:t=>e.setRuleController(t),setMapController:t=>e.setMapController(t),getRuleController:()=>e.getRuleController(),getMapController:()=>e.getMapController(),changeMapSize:t=>e.changeMapSize(t)}),vS=e=>({nextCommand:()=>e.nextCommand(),addCommand:t=>e.addCommand(t),clearCommand:()=>e.clearCommand(),initCommandWatchService:()=>e.initCommandWatchService(),connectDispatchListener:t=>e.connectDispatchListener(t)}),xS=e=>({setAppSize:(t,s)=>e.setAppSize(t,s),getAppEdge:()=>e.getAppEdge(),bindAppToScreenService:t=>e.bindAppToScreenService(t),getScreenSize:()=>e.getScreenSize()}),ES=e=>({setScanner:t=>e.setScanner(t),getScanner:()=>e.getScanner()}),bS=e=>({setStageBuilder:t=>e.setStageBuilder(t),setContainerBuilder:t=>e.setContainerBuilder(t),setSpriteBuilder:t=>e.setSpriteBuilder(t),getStageBuilder:()=>e.getStageBuilder(),getContainerBuilder:()=>e.getContainerBuilder(),getSpriteBuilder:()=>e.getSpriteBuilder()}),wS=()=>{const e=pS(),t=mS(e.containerService),s=gS(e.spriteService),r=_S(e.textureService),i=yS(e.controllerService),n=vS(e.commandService),o=xS(e.screenService),a=ES(e.scannerService),l=bS(e.builderService);return{...t,...n,...s,...r,...i,...o,...a,...l}};class _m{constructor(){X(this,"_stage");X(this,"_container")}}class TS extends _m{setArgs(t,s){this._stage=t,this._container=s}async execute(){return await new Promise(t=>{this._stage.removeChild(this._container),t()})}}class SS extends _m{constructor(){super(...arguments);X(this,"_mountAtIndex")}setArgs(s,r,i){this._stage=s,this._container=r,this._mountAtIndex=i}async execute(){await new Promise(s=>{this._stage.addChildAt(this._container,this._mountAtIndex),s()})}}class AS{constructor(t){X(this,"_stage");X(this,"_containerBuilder");this._stage=t,this._stage.sortableChildren=!0,this._containerBuilder=j.getContainerBuilder()}async addGameScene(t){j.setAppSize(t.sceneWidth,t.sceneHeight),j.changeMapSize(j.getAppEdge());const s=await this._containerBuilder.createGameScene(t),r=new SS;r.setArgs(this._stage,s,0),await r.execute()}async removeScene(){const t=this._containerBuilder.gameScene,s=new TS;s.setArgs(this._stage,t),await s.execute()}}const IS=e=>new AS(e);class ym{}class CS extends ym{constructor(){super(...arguments);X(this,"_things");X(this,"_container")}setArgs(s,r){this._things=r,this._container=s}async execute(){return await new Promise(s=>{this._container.addChild(...this._things),s(this._container)})}}class RS extends ym{constructor(){super(...arguments);X(this,"_container");X(this,"_target")}setArgs(s,r){this._container=r,this._target=s}async execute(){return await new Promise(s=>{const r=this._container.getChildIndex(this._target),i=this._container.removeChildAt(r);s(i)})}}class PS{constructor(){X(this,"_spriteController");X(this,"gameScene",new ye);this._spriteController=j.getSpriteBuilder()}async createEmptyScene(){const t=j.getEmptyContainer();return Tt(t)?new ye:t.value}async createGameScene(t){const s=await this.createEmptyScene(),r=await this._spriteController.getThings(t.thingsMap);await this._spriteController.connectThingsToThingController(r),j.getScanner().findRulesFromMap(j.getAppEdge());const i=new CS;return i.setArgs(s,r),await i.execute(),this.gameScene=s,s}async removeThingFromGameScene(t){const s=new RS;s.setArgs(t,this.gameScene),await s.execute()}}const MS=()=>new PS;var O=(e=>(e[e.TOP=0]="TOP",e[e.DOWN=1]="DOWN",e[e.RIGHT=2]="RIGHT",e[e.LEFT=3]="LEFT",e[e.UNDEFINED=4]="UNDEFINED",e))(O||{}),wt=(e=>(e.AUTO="Text_AUTO",e.RIGHT="Text_RIGHT",e.UP="Text_UP",e.LEFT="Text_LEFT",e.DOWN="Text_DOWN",e.RED="Text_RED",e.BLUE="Text_BLUE",e.ORANGE="Text_ORANGE",e.YELLOW="Text_YELLOW",e.LIME="Text_LIME",e.GREEN="Text_GREEN",e.CYAN="Text_CYAN",e.PURPLE="Text_PURPLE",e.PINK="Text_PINK",e.ROSY="Text_ROSY",e.GREY="Text_GREY",e.BLACK="Text_BLACK",e.SILVER="Text_SILVER",e.WHITE="Text_WHITE",e.BROWN="Text_BROWN",e.BEST="Text_BEST",e.SAD="Text_SAD",e.WONDER="Text_WONDER",e.PARTY="Text_PARTY",e.BROKEN="Text_BROKEN",e.CHILL="Text_CHILL",e.DEFEAT="Text_DEFEAT",e.BACK="Text_BACK",e.FALLDOWN="Text_FALLDOWN",e.FALLRIGHT="Text_FALLRIGHT",e.FALLUP="Text_FALLUP",e.FALLLEFT="Text_FALLLEFT",e.NUDGEDOWN="Text_NUDGEDOWN",e.NUDGERIGHT="Text_NUDGERIGHT",e.NUDGEUP="Text_NUDGEUP",e.NUDGELEFT="Text_NUDGELEFT",e.TURNCLOCKWISE="Text_TURNCLOCKWISE",e.TURNCOUNTERCLOCKWISE="Text_TURNCOUNTERCLOCKWISE",e.FLOAT="Text_FLOAT",e.PHANTOM="Text_PHANTOM",e.HIDE="Text_HIDE",e.HOT="Text_HOT",e.MELT="Text_MELT",e.MORE="Text_MORE",e.MOVE="Text_MOVE",e.OPEN="Text_OPEN",e.SHUT="Text_SHUT",e.POWER="Text_POWER",e.PULL="Text_PULL",e.PUSH="Text_PUSH",e.SAFE="Text_SAFE",e.SHIFT="Text_SHIFT",e.SINK="Text_SINK",e.SLEEP="Text_SLEEP",e.STILL="Text_STILL",e.LOCKEDDOWN="Text_LOCKEDDOWN",e.LOCKEDRIGHT="Text_LOCKEDRIGHT",e.LOCKEDLEFT="Text_LOCKEDLEFT",e.LOCKEDUP="Text_LOCKEDUP",e.STOP="Text_STOP",e.SWAP="Text_SWAP",e.TELE="Text_TELE",e.WEAK="Text_WEAK",e.WIN="Text_WIN",e.WORD="Text_WORD",e.YOU="Text_YOU",e.YOU2="Text_YOU2",e.BONUS="Text_BONUS",e.END="Text_END",e.DONE="Text_DONE",e.REVERT="Text_REVERT",e.SELECT="Text_SELECT",e))(wt||{});const Qo=e=>e===O.UNDEFINED?e:e%2?e-1:e+1,OS=async(e,t,s)=>{switch(s){case O.DOWN:if(e.atTopEdge())return!1;break;case O.TOP:if(e.atBottomEdge())return!1;break;case O.RIGHT:if(e.atLeftEdge())return!1;break;case O.LEFT:if(e.atRightEdge())return!1;break}return await t.canIEncounter(e,Qo(s))};class As{constructor(t){X(this,"_id");X(this,"_subject");X(this,"_priority");this._id=mr(),this._subject=t}setPriority(t){this._priority=t}getPriority(){return this._priority}}class sc extends As{async perform(){}async unperform(){}}var vm=(e=>(e.ALGAE="ALGAE",e.ARROW="ARROW",e.BABA="BABA",e.BANANA="BANANA",e.BAT="BAT",e.BEE="BEE",e.BELT="BELT",e.BIRD="BIRD",e.BLOB="BLOB",e.BOAT="BOAT",e.BOG="BOG",e.BOLT="BOLT",e.BOOK="BOOK",e.BOX="BOX",e.BRICK="BRICK",e.BUBBLE="BUBBLE",e.BUCKET="BUCKET",e.BURGER="BURGER",e.BUG="BUG",e.CAKE="CAKE",e.CART="CART",e.CASH="CASH",e.CIRCLE="CIRCLE",e.CLIFF="CLIFF",e.CLOUD="CLOUD",e.COG="COG",e.CRAB="CRAB",e.CRYSTAL="CRYSTAL",e.CUP="CUP",e.DOOR="DOOR",e.DOT="DOT",e.DRINK="DRINK",e.DRUM="DRUM",e.DUST="DUST",e.EAR="EAR",e.EYE="EYE",e.FENCE="FENCE",e.FIRE="FIRE",e.FISH="FISH",e.FLAG="FLAG",e.FLOWER="FLOWER",e.FOFO="FOFO",e.FOLIAGE="FOLIAGE",e.FOOT="FOOT",e.FORT="FORT",e.FRUIT="FRUIT",e.FUNGI="FUNGI",e.FUNGUS="FUNGUS",e.GATE="GATE",e.GEM="GEM",e.GHOST="GHOST",e.GRASS="GRASS",e.GUITAR="GUITAR",e.HAND="HAND",e.HEDGE="HEDGE",e.HIHAT="HIHAT",e.HOUSE="HOUSE",e.HUSK="HUSK",e.HUSKS="HUSKS",e.ICE="ICE",e.IT="IT",e.JELLY="JELLY",e.JIJI="JIJI",e.KEKE="KEKE",e.KEY="KEY",e.LADDER="LADDER",e.LAMP="LAMP",e.LAVA="LAVA",e.LEAF="LEAF",e.LIFT="LIFT",e.LINE="LINE",e.LIZARD="LIZARD",e.LOVE="LOVE",e.ME="ME",e.MONITOR="MONITOR",e.MOON="MOON",e.NOSE="NOSE",e.ORB="ORB",e.PANTS="PANTS",e.PIANO="PIANO",e.PILLAR="PILLAR",e.PIPE="PIPE",e.PIXEL="PIXEL",e.PLANE="PLANE",e.PLANET="PLANET",e.PUMPKIN="PUMPKIN",e.REED="REED",e.RING="RING",e.ROAD="ROAD",e.ROBOT="ROBOT",e.ROCK="ROCK",e.ROCKET="ROCKET",e.ROSE="ROSE",e.RUBBLE="RUBBLE",e.SAX="SAX",e.SEED="SEED",e.SHELL="SHELL",e.SHIRT="SHIRT",e.SHOVEL="SHOVEL",e.SIGN="SIGN",e.SKULL="SKULL",e.SPIKE="SPIKE",e.SPROUT="SPROUT",e.SQUARE="SQUARE",e.STAR="STAR",e.STATUE="STATUE",e.STICK="STICK",e.STUMP="STUMP",e.SUN="SUN",e.TILE="TILE",e.TOWER="TOWER",e.TRACK="TRACK",e.TRAIN="TRAIN",e.TREE="TREE",e.TREES="TREES",e.TRIANGLE="TRIANGLE",e.TURNIP="TURNIP",e.UFO="UFO",e.VINE="VINE",e.WALL="WALL",e.WATER="WATER",e.WIND="WIND",e.WORM="WORM",e))(vm||{}),$t=(e=>(e.CHARACTERS="characters",e.NOUNS="nouns",e.OPERATORS="operators",e.PROPERTIES="properties",e))($t||{}),rc=(e=>(e.ALGAE="Text_ALGAE",e.ARROW="Text_ARROW",e.BABA="Text_BABA",e.BANANA="Text_BANANA",e.BAT="Text_BAT",e.BEE="Text_BEE",e.BELT="Text_BELT",e.BIRD="Text_BIRD",e.BLOB="Text_BLOB",e.BOAT="Text_BOAT",e.BOG="Text_BOG",e.BOLT="Text_BOLT",e.BOOK="Text_BOOK",e.BOX="Text_BOX",e.BRICK="Text_BRICK",e.BUBBLE="Text_BUBBLE",e.BUCKET="Text_BUCKET",e.BURGER="Text_BURGER",e.BUG="Text_BUG",e.CAKE="Text_CAKE",e.CART="Text_CART",e.CASH="Text_CASH",e.CIRCLE="Text_CIRCLE",e.CLIFF="Text_CLIFF",e.CLOUD="Text_CLOUD",e.COG="Text_COG",e.CRAB="Text_CRAB",e.CRYSTAL="Text_CRYSTAL",e.CUP="Text_CUP",e.DOOR="Text_DOOR",e.DOT="Text_DOT",e.DRINK="Text_DRINK",e.DRUM="Text_DRUM",e.DUST="Text_DUST",e.EAR="Text_EAR",e.EYE="Text_EYE",e.FENCE="Text_FENCE",e.FIRE="Text_FIRE",e.FISH="Text_FISH",e.FLAG="Text_FLAG",e.FLOWER="Text_FLOWER",e.FOFO="Text_FOFO",e.FOLIAGE="Text_FOLIAGE",e.FOOT="Text_FOOT",e.FORT="Text_FORT",e.FRUIT="Text_FRUIT",e.FUNGI="Text_FUNGI",e.FUNGUS="Text_FUNGUS",e.GATE="Text_GATE",e.GEM="Text_GEM",e.GHOST="Text_GHOST",e.GRASS="Text_GRASS",e.GUITAR="Text_GUITAR",e.HAND="Text_HAND",e.HEDGE="Text_HEDGE",e.HIHAT="Text_HIHAT",e.HOUSE="Text_HOUSE",e.HUSK="Text_HUSK",e.HUSKS="Text_HUSKS",e.ICE="Text_ICE",e.IT="Text_IT",e.JELLY="Text_JELLY",e.JIJI="Text_JIJI",e.KEKE="Text_KEKE",e.KEY="Text_KEY",e.LADDER="Text_LADDER",e.LAMP="Text_LAMP",e.LAVA="Text_LAVA",e.LEAF="Text_LEAF",e.LIFT="Text_LIFT",e.LINE="Text_LINE",e.LIZARD="Text_LIZARD",e.LOVE="Text_LOVE",e.ME="Text_ME",e.MONITOR="Text_MONITOR",e.MOON="Text_MOON",e.NOSE="Text_NOSE",e.ORB="Text_ORB",e.PANTS="Text_PANTS",e.PIANO="Text_PIANO",e.PILLAR="Text_PILLAR",e.PIPE="Text_PIPE",e.PIXEL="Text_PIXEL",e.PLANE="Text_PLANE",e.PLANET="Text_PLANET",e.PUMPKIN="Text_PUMPKIN",e.REED="Text_REED",e.RING="Text_RING",e.ROAD="Text_ROAD",e.ROBOT="Text_ROBOT",e.ROCK="Text_ROCK",e.ROCKET="Text_ROCKET",e.ROSE="Text_ROSE",e.RUBBLE="Text_RUBBLE",e.SAX="Text_SAX",e.SEED="Text_SEED",e.SHELL="Text_SHELL",e.SHIRT="Text_SHIRT",e.SHOVEL="Text_SHOVEL",e.SIGN="Text_SIGN",e.SKULL="Text_SKULL",e.SPIKE="Text_SPIKE",e.SPROUT="Text_SPROUT",e.SQUARE="Text_SQUARE",e.STAR="Text_STAR",e.STATUE="Text_STATUE",e.STICK="Text_STICK",e.STUMP="Text_STUMP",e.SUN="Text_SUN",e.TILE="Text_TILE",e.TOWER="Text_TOWER",e.TRACK="Text_TRACK",e.TRAIN="Text_TRAIN",e.TREE="Text_TREE",e.TREES="Text_TREES",e.TRIANGLE="Text_TRIANGLE",e.TURNIP="Text_TURNIP",e.UFO="Text_UFO",e.VINE="Text_VINE",e.WALL="Text_WALL",e.WATER="Text_WATER",e.WIND="Text_WIND",e.WORM="Text_WORM",e))(rc||{}),Bt=(e=>(e.IS="Text_IS",e.HAS="Text_HAS",e.MAKE="Text_MAKE",e.AND="Text_AND",e.NOT="Text_NOT",e.ON="Text_ON",e.NEAR="Text_NEAR",e.FACING="Text_FACING",e.LONELY="Text_LONELY",e.FEAR="Text_FEAR",e.EAT="Text_EAT",e.FOLLOW="Text_FOLLOW",e.MIMIC="Text_MIMIC",e.IDLE="Text_IDLE",e.POWERED="Text_POWERED",e.WITHOUT="Text_WITHOUT",e.ABOVE="Text_ABOVE",e.BELOW="Text_BELOW",e.FEELING="Text_FEELING",e.PLAY="Text_PLAY",e.OFTEN="Text_OFTEN",e.SELDOM="Text_SELDOM",e.NEVER="Text_NEVER",e))(Bt||{});const xm=e=>e.substring(5),BS=e=>Object.values(vm).includes(e),Em=e=>Object.values(rc).includes(e),DS=e=>Object.values(Bt).includes(e),FS=e=>Object.values(wt).includes(e),LS=e=>{if(BS(e))return $t.CHARACTERS;if(Em(e))return $t.NOUNS;if(DS(e))return $t.OPERATORS;if(FS(e))return $t.PROPERTIES;throw new Error(`ThingType ${e} does not exist in all Species`)},ri=async e=>{await new Promise(t=>setTimeout(()=>t(),e))};class NS extends As{constructor(s){super(s);X(this,"_originalName");X(this,"_originalTexture");X(this,"_thingTypes");this._originalName=this._subject.name,this._originalTexture=this._subject.texture,this._thingTypes=Ot}addTransformName(s){es(this._thingTypes)?this._thingTypes.value.push(s):this._thingTypes=se([s])}async perform(){if(Tt(this._thingTypes)||this._thingTypes.value.length>1)return;await ri(pr);const s=xm(this._thingTypes.value[0]);this._subject.name=s;const r=LS(s);this._subject.textures=j.getAnimationTextures(r,this._subject.name)}async unperform(){await ri(pr),this._subject.texture=this._originalTexture,this._subject.name=this._originalName}}var Re=(e=>(e.UP="up",e.DOWN="down",e.RIGHT="right",e.LEFT="left",e.APPEAR="appear",e.DISAPPEAR="disappear",e))(Re||{});class US{constructor(){X(this,"_gameMap");X(this,"maxX");X(this,"maxY");this.maxX=0,this.maxY=0,this._gameMap=new Array(this.maxX+1);for(let t=0;t<=this.maxX;t++)this._gameMap[t]=new Array(this.maxY+1);this._resetMap()}_resetMap(){for(let t=0;t<=this.maxX;t++)for(let s=0;s<=this.maxY;s++)this._gameMap[t][s]=Ot}_placeToPosition(t,s,r){if(t<0||t>this.maxX||s<0||s>this.maxY)throw new Error(`Map system error, pos @ x:${t} y:${s} is out of range!`);if(Tt(this._gameMap[t][s]))this._gameMap[t][s]=se([r]);else if(es(this._gameMap[t][s]))this._gameMap[t][s].value.push(r);else throw new Error(`Map system error, pos @ x:${t} y:${s} is invalid type!`)}_removeFromPosition(t,s,r){if(t<0||t>this.maxX||s<0||s>this.maxY)throw new Error(`Map system error, pos @ x:${t} y:${s} is out of range!`);if(es(this._gameMap[t][s])){const i=this._gameMap[t][s].value.findIndex(n=>n.id===r.id);if(i===-1)throw new Error(`Thing ${r.id} name = ${r.name} is not in the pos @ x:${t} y:${s}, can't be removed!`);this._gameMap[t][s].value.splice(i,1)}else throw new Error(`Map system error, pos @ x:${t} y:${s} is invalid type!`)}async canIEncounter(t,s){const r=t.blockX,i=t.blockY;switch(s){case O.UNDEFINED:return!1;case O.LEFT:return t.atLeftEdge()?!1:Tt(this._gameMap[r-1][i])?!0:(await Promise.all(this._gameMap[r-1][i].value.map(n=>n.handleEncounter(t,O.RIGHT)))).reduce((n,o)=>n&&o,!0);case O.RIGHT:return t.atRightEdge()?!1:Tt(this._gameMap[r+1][i])?!0:(await Promise.all(this._gameMap[r+1][i].value.map(n=>n.handleEncounter(t,O.LEFT)))).reduce((n,o)=>n&&o,!0);case O.TOP:return t.atTopEdge()?!1:Tt(this._gameMap[r][i-1])?!0:(await Promise.all(this._gameMap[r][i-1].value.map(n=>n.handleEncounter(t,O.DOWN)))).reduce((n,o)=>n&&o,!0);case O.DOWN:return t.atBottomEdge()?!1:Tt(this._gameMap[r][i+1])?!0:(await Promise.all(this._gameMap[r][i+1].value.map(n=>n.handleEncounter(t,O.TOP)))).reduce((n,o)=>n&&o,!0)}}async notifyBeside(t,s){const r=t.blockX,i=t.blockY;await Promise.allSettled(s.map(n=>{switch(n){case O.UNDEFINED:return Promise.resolve();case O.LEFT:return t.atLeftEdge()||Tt(this._gameMap[r-1][i])?Promise.resolve():Promise.allSettled(this._gameMap[r-1][i].value.map(o=>o.handleBeside(t,O.RIGHT)));case O.RIGHT:return t.atRightEdge()||Tt(this._gameMap[r+1][i])?Promise.resolve():Promise.allSettled(this._gameMap[r+1][i].value.map(o=>o.handleBeside(t,O.LEFT)));case O.TOP:return t.atTopEdge()||Tt(this._gameMap[r][i-1])?Promise.resolve():Promise.allSettled(this._gameMap[r][i-1].value.map(o=>o.handleBeside(t,O.DOWN)));case O.DOWN:return t.atBottomEdge()||Tt(this._gameMap[r][i+1])?Promise.resolve():Promise.allSettled(this._gameMap[r][i+1].value.map(o=>o.handleBeside(t,O.TOP)))}}))}async notifyLeave(t,s){const r=t.blockX,i=t.blockY;await Promise.allSettled(s.map(n=>{switch(n){case O.UNDEFINED:return Promise.resolve();case O.LEFT:return t.atLeftEdge()||Tt(this._gameMap[r-1][i])?Promise.resolve():Promise.allSettled(this._gameMap[r-1][i].value.map(o=>o.handleLeave(t,O.RIGHT)));case O.RIGHT:return t.atRightEdge()||Tt(this._gameMap[r+1][i])?Promise.resolve():Promise.allSettled(this._gameMap[r+1][i].value.map(o=>o.handleLeave(t,O.LEFT)));case O.TOP:return t.atTopEdge()||Tt(this._gameMap[r][i-1])?Promise.resolve():Promise.allSettled(this._gameMap[r][i-1].value.map(o=>o.handleLeave(t,O.DOWN)));case O.DOWN:return t.atBottomEdge()||Tt(this._gameMap[r][i+1])?Promise.resolve():Promise.allSettled(this._gameMap[r][i+1].value.map(o=>o.handleLeave(t,O.TOP)))}}))}async update(t,s){const r=t.blockX,i=t.blockY;switch(s){case"appear":this._placeToPosition(r,i,t);break;case"disappear":this._removeFromPosition(r,i,t);break;case"up":this._removeFromPosition(r,i+1,t),this._placeToPosition(r,i,t);break;case"down":this._removeFromPosition(r,i-1,t),this._placeToPosition(r,i,t);break;case"left":this._removeFromPosition(r+1,i,t),this._placeToPosition(r,i,t);break;case"right":this._removeFromPosition(r-1,i,t),this._placeToPosition(r,i,t);break}}async appendTransformInstructions(t){for(let s=0;s<=this.maxX;s++)for(let r=0;r<=this.maxY;r++){const i=this._gameMap[s][r];if(!Tt(i))for(const n of i.value){const o=t.get(n.name);if(!o||o.length===0)continue;const a=new NS(n);for(const l of o)a.addTransformName(l.feature);a.setPriority(9999999990002),n.thingController.addNewInstruction(a),n.thingController.pushInstructions()}}}async processMoveInstructions(t){for(let s=0;s<=this.maxX;s++)for(let r=0;r<=this.maxY;r++){const i=this._gameMap[s][r];if(!Tt(i))for(const n of i.value){const o=t.get(n.name);if(o&&o.length!==0){for(const a of o)if(a.feature===wt.MOVE){const l=h=>{let c;switch(h.towards){case O.TOP:c=new bm(h);break;case O.DOWN:c=new wm(h);break;case O.RIGHT:c=new Sm(h);break;case O.LEFT:c=new Tm(h);break;default:c=new sc(h)}c.setPriority(9999999990001),h.thingController.addNewInstruction(c),h.thingController.pushInstructions()};await this.canIEncounter(n,n.towards)?await l(n):await this.canIEncounter(n,Qo(n.towards))&&(await n.reverseTowards(),await l(n))}}}}}async checkYouExistsInMap(t){for(let s=0;s<=this.maxX;s++)for(let r=0;r<=this.maxY;r++){const i=this._gameMap[s][r];if(!Tt(i)){for(const n of i.value)if(t.includes(n.name))return!0}}return!1}clean(){this._resetMap()}whoAreThere(t,s){if(t<0||t>this.maxX||s<0||s>this.maxY)throw new Error(`Map system error, pos @ x:${t} y:${s} is out of range!`);return this._gameMap[t][s]}whoNearMe(t){const s=t.blockX,r=t.blockY,i=t.atTopEdge()?Ot:this._gameMap[s][r-1],n=t.atBottomEdge()?Ot:this._gameMap[s][r+1],o=t.atLeftEdge()?Ot:this._gameMap[s-1][r],a=t.atRightEdge()?Ot:this._gameMap[s+1][r];return{up:i,down:n,left:o,right:a}}changeMapSize(t){this.maxX=t.maxX,this.maxY=t.maxY,this._gameMap=new Array(this.maxX+1);for(let s=0;s<=this.maxX;s++)this._gameMap[s]=new Array(this.maxY+1);this.clean()}}const kS=()=>new US;class bm extends As{async perform(){await j.getMapController().notifyLeave(this._subject,[O.LEFT,O.RIGHT,O.DOWN]),await this._subject.moveUp(),await j.getMapController().update(this._subject,Re.UP),await j.getMapController().notifyBeside(this._subject,[O.LEFT,O.RIGHT,O.TOP])}async unperform(){await j.getMapController().notifyLeave(this._subject,[O.TOP,O.LEFT,O.RIGHT]),await j.getMapController().update(this._subject,Re.DOWN),await this._subject.moveDown(),await j.getMapController().notifyBeside(this._subject,[O.LEFT,O.RIGHT,O.DOWN])}}class wm extends As{async perform(){await j.getMapController().notifyLeave(this._subject,[O.TOP,O.RIGHT,O.LEFT]),await this._subject.moveDown(),await j.getMapController().update(this._subject,Re.DOWN),await j.getMapController().notifyBeside(this._subject,[O.DOWN,O.RIGHT,O.LEFT])}async unperform(){await j.getMapController().notifyLeave(this._subject,[O.TOP,O.RIGHT,O.LEFT]),await j.getMapController().update(this._subject,Re.UP),await this._subject.moveUp(),await j.getMapController().notifyBeside(this._subject,[O.DOWN,O.RIGHT,O.LEFT])}}class Tm extends As{async perform(){await j.getMapController().notifyLeave(this._subject,[O.TOP,O.DOWN,O.RIGHT]),await this._subject.moveLeft(),await j.getMapController().update(this._subject,Re.LEFT),await j.getMapController().notifyBeside(this._subject,[O.TOP,O.DOWN,O.LEFT])}async unperform(){await j.getMapController().notifyLeave(this._subject,[O.TOP,O.DOWN,O.LEFT]),await j.getMapController().update(this._subject,Re.RIGHT),await this._subject.moveRight(),await j.getMapController().notifyBeside(this._subject,[O.TOP,O.DOWN,O.RIGHT])}}class Sm extends As{async perform(){await j.getMapController().notifyLeave(this._subject,[O.TOP,O.DOWN,O.LEFT]),await this._subject.moveRight(),await j.getMapController().update(this._subject,Re.RIGHT),await j.getMapController().notifyBeside(this._subject,[O.TOP,O.DOWN,O.RIGHT])}async unperform(){await j.getMapController().notifyLeave(this._subject,[O.TOP,O.DOWN,O.RIGHT]),await j.getMapController().update(this._subject,Re.LEFT),await this._subject.moveLeft(),await j.getMapController().notifyBeside(this._subject,[O.TOP,O.DOWN,O.LEFT])}}const Ls={MoveUpInstruction:bm,MoveDownInstruction:wm,MoveLeftInstruction:Tm,MoveRightInstruction:Sm},GS=(e,t,s)=>{let r;switch(t){case O.TOP:r=new Ls.MoveDownInstruction(e);break;case O.DOWN:r=new Ls.MoveUpInstruction(e);break;case O.LEFT:r=new Ls.MoveRightInstruction(e);break;case O.RIGHT:r=new Ls.MoveLeftInstruction(e);break;default:r=new sc(e);break}s.addNewInstruction(r),s.pushInstructions()};function Am(e,t){return function(){return e.apply(t,arguments)}}const{toString:HS}=Object.prototype,{getPrototypeOf:ic}=Object,ta=(e=>t=>{const s=HS.call(t);return e[s]||(e[s]=s.slice(8,-1).toLowerCase())})(Object.create(null)),cs=e=>(e=e.toLowerCase(),t=>ta(t)===e),ea=e=>t=>typeof t===e,{isArray:ci}=Array,qi=ea("undefined");function $S(e){return e!==null&&!qi(e)&&e.constructor!==null&&!qi(e.constructor)&&Ce(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const Im=cs("ArrayBuffer");function WS(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&Im(e.buffer),t}const XS=ea("string"),Ce=ea("function"),Cm=ea("number"),sa=e=>e!==null&&typeof e=="object",zS=e=>e===!0||e===!1,Zn=e=>{if(ta(e)!=="object")return!1;const t=ic(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},VS=cs("Date"),jS=cs("File"),YS=cs("Blob"),KS=cs("FileList"),qS=e=>sa(e)&&Ce(e.pipe),ZS=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||Ce(e.append)&&((t=ta(e))==="formdata"||t==="object"&&Ce(e.toString)&&e.toString()==="[object FormData]"))},JS=cs("URLSearchParams"),QS=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function rn(e,t,{allOwnKeys:s=!1}={}){if(e===null||typeof e>"u")return;let r,i;if(typeof e!="object"&&(e=[e]),ci(e))for(r=0,i=e.length;r<i;r++)t.call(null,e[r],r,e);else{const n=s?Object.getOwnPropertyNames(e):Object.keys(e),o=n.length;let a;for(r=0;r<o;r++)a=n[r],t.call(null,e[a],a,e)}}function Rm(e,t){t=t.toLowerCase();const s=Object.keys(e);let r=s.length,i;for(;r-- >0;)if(i=s[r],t===i.toLowerCase())return i;return null}const Pm=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),Mm=e=>!qi(e)&&e!==Pm;function rh(){const{caseless:e}=Mm(this)&&this||{},t={},s=(r,i)=>{const n=e&&Rm(t,i)||i;Zn(t[n])&&Zn(r)?t[n]=rh(t[n],r):Zn(r)?t[n]=rh({},r):ci(r)?t[n]=r.slice():t[n]=r};for(let r=0,i=arguments.length;r<i;r++)arguments[r]&&rn(arguments[r],s);return t}const tA=(e,t,s,{allOwnKeys:r}={})=>(rn(t,(i,n)=>{s&&Ce(i)?e[n]=Am(i,s):e[n]=i},{allOwnKeys:r}),e),eA=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),sA=(e,t,s,r)=>{e.prototype=Object.create(t.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),s&&Object.assign(e.prototype,s)},rA=(e,t,s,r)=>{let i,n,o;const a={};if(t=t||{},e==null)return t;do{for(i=Object.getOwnPropertyNames(e),n=i.length;n-- >0;)o=i[n],(!r||r(o,e,t))&&!a[o]&&(t[o]=e[o],a[o]=!0);e=s!==!1&&ic(e)}while(e&&(!s||s(e,t))&&e!==Object.prototype);return t},iA=(e,t,s)=>{e=String(e),(s===void 0||s>e.length)&&(s=e.length),s-=t.length;const r=e.indexOf(t,s);return r!==-1&&r===s},nA=e=>{if(!e)return null;if(ci(e))return e;let t=e.length;if(!Cm(t))return null;const s=new Array(t);for(;t-- >0;)s[t]=e[t];return s},oA=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&ic(Uint8Array)),aA=(e,t)=>{const r=(e&&e[Symbol.iterator]).call(e);let i;for(;(i=r.next())&&!i.done;){const n=i.value;t.call(e,n[0],n[1])}},lA=(e,t)=>{let s;const r=[];for(;(s=e.exec(t))!==null;)r.push(s);return r},hA=cs("HTMLFormElement"),cA=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(s,r,i){return r.toUpperCase()+i}),If=(({hasOwnProperty:e})=>(t,s)=>e.call(t,s))(Object.prototype),uA=cs("RegExp"),Om=(e,t)=>{const s=Object.getOwnPropertyDescriptors(e),r={};rn(s,(i,n)=>{let o;(o=t(i,n,e))!==!1&&(r[n]=o||i)}),Object.defineProperties(e,r)},fA=e=>{Om(e,(t,s)=>{if(Ce(e)&&["arguments","caller","callee"].indexOf(s)!==-1)return!1;const r=e[s];if(Ce(r)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+s+"'")})}})},dA=(e,t)=>{const s={},r=i=>{i.forEach(n=>{s[n]=!0})};return ci(e)?r(e):r(String(e).split(t)),s},pA=()=>{},mA=(e,t)=>(e=+e,Number.isFinite(e)?e:t),tl="abcdefghijklmnopqrstuvwxyz",Cf="0123456789",Bm={DIGIT:Cf,ALPHA:tl,ALPHA_DIGIT:tl+tl.toUpperCase()+Cf},gA=(e=16,t=Bm.ALPHA_DIGIT)=>{let s="";const{length:r}=t;for(;e--;)s+=t[Math.random()*r|0];return s};function _A(e){return!!(e&&Ce(e.append)&&e[Symbol.toStringTag]==="FormData"&&e[Symbol.iterator])}const yA=e=>{const t=new Array(10),s=(r,i)=>{if(sa(r)){if(t.indexOf(r)>=0)return;if(!("toJSON"in r)){t[i]=r;const n=ci(r)?[]:{};return rn(r,(o,a)=>{const l=s(o,i+1);!qi(l)&&(n[a]=l)}),t[i]=void 0,n}}return r};return s(e,0)},vA=cs("AsyncFunction"),xA=e=>e&&(sa(e)||Ce(e))&&Ce(e.then)&&Ce(e.catch),P={isArray:ci,isArrayBuffer:Im,isBuffer:$S,isFormData:ZS,isArrayBufferView:WS,isString:XS,isNumber:Cm,isBoolean:zS,isObject:sa,isPlainObject:Zn,isUndefined:qi,isDate:VS,isFile:jS,isBlob:YS,isRegExp:uA,isFunction:Ce,isStream:qS,isURLSearchParams:JS,isTypedArray:oA,isFileList:KS,forEach:rn,merge:rh,extend:tA,trim:QS,stripBOM:eA,inherits:sA,toFlatObject:rA,kindOf:ta,kindOfTest:cs,endsWith:iA,toArray:nA,forEachEntry:aA,matchAll:lA,isHTMLForm:hA,hasOwnProperty:If,hasOwnProp:If,reduceDescriptors:Om,freezeMethods:fA,toObjectSet:dA,toCamelCase:cA,noop:pA,toFiniteNumber:mA,findKey:Rm,global:Pm,isContextDefined:Mm,ALPHABET:Bm,generateString:gA,isSpecCompliantForm:_A,toJSONObject:yA,isAsyncFn:vA,isThenable:xA};function At(e,t,s,r,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),s&&(this.config=s),r&&(this.request=r),i&&(this.response=i)}P.inherits(At,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:P.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const Dm=At.prototype,Fm={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Fm[e]={value:e}});Object.defineProperties(At,Fm);Object.defineProperty(Dm,"isAxiosError",{value:!0});At.from=(e,t,s,r,i,n)=>{const o=Object.create(Dm);return P.toFlatObject(e,o,function(l){return l!==Error.prototype},a=>a!=="isAxiosError"),At.call(o,e.message,t,s,r,i),o.cause=e,o.name=e.name,n&&Object.assign(o,n),o};const EA=null;function ih(e){return P.isPlainObject(e)||P.isArray(e)}function Lm(e){return P.endsWith(e,"[]")?e.slice(0,-2):e}function Rf(e,t,s){return e?e.concat(t).map(function(i,n){return i=Lm(i),!s&&n?"["+i+"]":i}).join(s?".":""):t}function bA(e){return P.isArray(e)&&!e.some(ih)}const wA=P.toFlatObject(P,{},null,function(t){return/^is[A-Z]/.test(t)});function ra(e,t,s){if(!P.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,s=P.toFlatObject(s,{metaTokens:!0,dots:!1,indexes:!1},!1,function(m,g){return!P.isUndefined(g[m])});const r=s.metaTokens,i=s.visitor||c,n=s.dots,o=s.indexes,l=(s.Blob||typeof Blob<"u"&&Blob)&&P.isSpecCompliantForm(t);if(!P.isFunction(i))throw new TypeError("visitor must be a function");function h(d){if(d===null)return"";if(P.isDate(d))return d.toISOString();if(!l&&P.isBlob(d))throw new At("Blob is not supported. Use a Buffer instead.");return P.isArrayBuffer(d)||P.isTypedArray(d)?l&&typeof Blob=="function"?new Blob([d]):Buffer.from(d):d}function c(d,m,g){let y=d;if(d&&!g&&typeof d=="object"){if(P.endsWith(m,"{}"))m=r?m:m.slice(0,-2),d=JSON.stringify(d);else if(P.isArray(d)&&bA(d)||(P.isFileList(d)||P.endsWith(m,"[]"))&&(y=P.toArray(d)))return m=Lm(m),y.forEach(function(_,v){!(P.isUndefined(_)||_===null)&&t.append(o===!0?Rf([m],v,n):o===null?m:m+"[]",h(_))}),!1}return ih(d)?!0:(t.append(Rf(g,m,n),h(d)),!1)}const u=[],f=Object.assign(wA,{defaultVisitor:c,convertValue:h,isVisitable:ih});function p(d,m){if(!P.isUndefined(d)){if(u.indexOf(d)!==-1)throw Error("Circular reference detected in "+m.join("."));u.push(d),P.forEach(d,function(y,E){(!(P.isUndefined(y)||y===null)&&i.call(t,y,P.isString(E)?E.trim():E,m,f))===!0&&p(y,m?m.concat(E):[E])}),u.pop()}}if(!P.isObject(e))throw new TypeError("data must be an object");return p(e),t}function Pf(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(r){return t[r]})}function nc(e,t){this._pairs=[],e&&ra(e,this,t)}const Nm=nc.prototype;Nm.append=function(t,s){this._pairs.push([t,s])};Nm.toString=function(t){const s=t?function(r){return t.call(this,r,Pf)}:Pf;return this._pairs.map(function(i){return s(i[0])+"="+s(i[1])},"").join("&")};function TA(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Um(e,t,s){if(!t)return e;const r=s&&s.encode||TA,i=s&&s.serialize;let n;if(i?n=i(t,s):n=P.isURLSearchParams(t)?t.toString():new nc(t,s).toString(r),n){const o=e.indexOf("#");o!==-1&&(e=e.slice(0,o)),e+=(e.indexOf("?")===-1?"?":"&")+n}return e}class SA{constructor(){this.handlers=[]}use(t,s,r){return this.handlers.push({fulfilled:t,rejected:s,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){P.forEach(this.handlers,function(r){r!==null&&t(r)})}}const Mf=SA,km={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},AA=typeof URLSearchParams<"u"?URLSearchParams:nc,IA=typeof FormData<"u"?FormData:null,CA=typeof Blob<"u"?Blob:null,RA=(()=>{let e;return typeof navigator<"u"&&((e=navigator.product)==="ReactNative"||e==="NativeScript"||e==="NS")?!1:typeof window<"u"&&typeof document<"u"})(),PA=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),Ge={isBrowser:!0,classes:{URLSearchParams:AA,FormData:IA,Blob:CA},isStandardBrowserEnv:RA,isStandardBrowserWebWorkerEnv:PA,protocols:["http","https","file","blob","url","data"]};function MA(e,t){return ra(e,new Ge.classes.URLSearchParams,Object.assign({visitor:function(s,r,i,n){return Ge.isNode&&P.isBuffer(s)?(this.append(r,s.toString("base64")),!1):n.defaultVisitor.apply(this,arguments)}},t))}function OA(e){return P.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function BA(e){const t={},s=Object.keys(e);let r;const i=s.length;let n;for(r=0;r<i;r++)n=s[r],t[n]=e[n];return t}function Gm(e){function t(s,r,i,n){let o=s[n++];const a=Number.isFinite(+o),l=n>=s.length;return o=!o&&P.isArray(i)?i.length:o,l?(P.hasOwnProp(i,o)?i[o]=[i[o],r]:i[o]=r,!a):((!i[o]||!P.isObject(i[o]))&&(i[o]=[]),t(s,r,i[o],n)&&P.isArray(i[o])&&(i[o]=BA(i[o])),!a)}if(P.isFormData(e)&&P.isFunction(e.entries)){const s={};return P.forEachEntry(e,(r,i)=>{t(OA(r),i,s,0)}),s}return null}function DA(e,t,s){if(P.isString(e))try{return(t||JSON.parse)(e),P.trim(e)}catch(r){if(r.name!=="SyntaxError")throw r}return(s||JSON.stringify)(e)}const oc={transitional:km,adapter:Ge.isNode?"http":"xhr",transformRequest:[function(t,s){const r=s.getContentType()||"",i=r.indexOf("application/json")>-1,n=P.isObject(t);if(n&&P.isHTMLForm(t)&&(t=new FormData(t)),P.isFormData(t))return i&&i?JSON.stringify(Gm(t)):t;if(P.isArrayBuffer(t)||P.isBuffer(t)||P.isStream(t)||P.isFile(t)||P.isBlob(t))return t;if(P.isArrayBufferView(t))return t.buffer;if(P.isURLSearchParams(t))return s.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let a;if(n){if(r.indexOf("application/x-www-form-urlencoded")>-1)return MA(t,this.formSerializer).toString();if((a=P.isFileList(t))||r.indexOf("multipart/form-data")>-1){const l=this.env&&this.env.FormData;return ra(a?{"files[]":t}:t,l&&new l,this.formSerializer)}}return n||i?(s.setContentType("application/json",!1),DA(t)):t}],transformResponse:[function(t){const s=this.transitional||oc.transitional,r=s&&s.forcedJSONParsing,i=this.responseType==="json";if(t&&P.isString(t)&&(r&&!this.responseType||i)){const o=!(s&&s.silentJSONParsing)&&i;try{return JSON.parse(t)}catch(a){if(o)throw a.name==="SyntaxError"?At.from(a,At.ERR_BAD_RESPONSE,this,null,this.response):a}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Ge.classes.FormData,Blob:Ge.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};P.forEach(["delete","get","head","post","put","patch"],e=>{oc.headers[e]={}});const ac=oc,FA=P.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),LA=e=>{const t={};let s,r,i;return e&&e.split(`
`).forEach(function(o){i=o.indexOf(":"),s=o.substring(0,i).trim().toLowerCase(),r=o.substring(i+1).trim(),!(!s||t[s]&&FA[s])&&(s==="set-cookie"?t[s]?t[s].push(r):t[s]=[r]:t[s]=t[s]?t[s]+", "+r:r)}),t},Of=Symbol("internals");function xi(e){return e&&String(e).trim().toLowerCase()}function Jn(e){return e===!1||e==null?e:P.isArray(e)?e.map(Jn):String(e)}function NA(e){const t=Object.create(null),s=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=s.exec(e);)t[r[1]]=r[2];return t}const UA=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function el(e,t,s,r,i){if(P.isFunction(r))return r.call(this,t,s);if(i&&(t=s),!!P.isString(t)){if(P.isString(r))return t.indexOf(r)!==-1;if(P.isRegExp(r))return r.test(t)}}function kA(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,s,r)=>s.toUpperCase()+r)}function GA(e,t){const s=P.toCamelCase(" "+t);["get","set","has"].forEach(r=>{Object.defineProperty(e,r+s,{value:function(i,n,o){return this[r].call(this,t,i,n,o)},configurable:!0})})}class ia{constructor(t){t&&this.set(t)}set(t,s,r){const i=this;function n(a,l,h){const c=xi(l);if(!c)throw new Error("header name must be a non-empty string");const u=P.findKey(i,c);(!u||i[u]===void 0||h===!0||h===void 0&&i[u]!==!1)&&(i[u||l]=Jn(a))}const o=(a,l)=>P.forEach(a,(h,c)=>n(h,c,l));return P.isPlainObject(t)||t instanceof this.constructor?o(t,s):P.isString(t)&&(t=t.trim())&&!UA(t)?o(LA(t),s):t!=null&&n(s,t,r),this}get(t,s){if(t=xi(t),t){const r=P.findKey(this,t);if(r){const i=this[r];if(!s)return i;if(s===!0)return NA(i);if(P.isFunction(s))return s.call(this,i,r);if(P.isRegExp(s))return s.exec(i);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,s){if(t=xi(t),t){const r=P.findKey(this,t);return!!(r&&this[r]!==void 0&&(!s||el(this,this[r],r,s)))}return!1}delete(t,s){const r=this;let i=!1;function n(o){if(o=xi(o),o){const a=P.findKey(r,o);a&&(!s||el(r,r[a],a,s))&&(delete r[a],i=!0)}}return P.isArray(t)?t.forEach(n):n(t),i}clear(t){const s=Object.keys(this);let r=s.length,i=!1;for(;r--;){const n=s[r];(!t||el(this,this[n],n,t,!0))&&(delete this[n],i=!0)}return i}normalize(t){const s=this,r={};return P.forEach(this,(i,n)=>{const o=P.findKey(r,n);if(o){s[o]=Jn(i),delete s[n];return}const a=t?kA(n):String(n).trim();a!==n&&delete s[n],s[a]=Jn(i),r[a]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const s=Object.create(null);return P.forEach(this,(r,i)=>{r!=null&&r!==!1&&(s[i]=t&&P.isArray(r)?r.join(", "):r)}),s}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,s])=>t+": "+s).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...s){const r=new this(t);return s.forEach(i=>r.set(i)),r}static accessor(t){const r=(this[Of]=this[Of]={accessors:{}}).accessors,i=this.prototype;function n(o){const a=xi(o);r[a]||(GA(i,o),r[a]=!0)}return P.isArray(t)?t.forEach(n):n(t),this}}ia.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);P.reduceDescriptors(ia.prototype,({value:e},t)=>{let s=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(r){this[s]=r}}});P.freezeMethods(ia);const Es=ia;function sl(e,t){const s=this||ac,r=t||s,i=Es.from(r.headers);let n=r.data;return P.forEach(e,function(a){n=a.call(s,n,i.normalize(),t?t.status:void 0)}),i.normalize(),n}function Hm(e){return!!(e&&e.__CANCEL__)}function nn(e,t,s){At.call(this,e??"canceled",At.ERR_CANCELED,t,s),this.name="CanceledError"}P.inherits(nn,At,{__CANCEL__:!0});function HA(e,t,s){const r=s.config.validateStatus;!s.status||!r||r(s.status)?e(s):t(new At("Request failed with status code "+s.status,[At.ERR_BAD_REQUEST,At.ERR_BAD_RESPONSE][Math.floor(s.status/100)-4],s.config,s.request,s))}const $A=Ge.isStandardBrowserEnv?function(){return{write:function(s,r,i,n,o,a){const l=[];l.push(s+"="+encodeURIComponent(r)),P.isNumber(i)&&l.push("expires="+new Date(i).toGMTString()),P.isString(n)&&l.push("path="+n),P.isString(o)&&l.push("domain="+o),a===!0&&l.push("secure"),document.cookie=l.join("; ")},read:function(s){const r=document.cookie.match(new RegExp("(^|;\\s*)("+s+")=([^;]*)"));return r?decodeURIComponent(r[3]):null},remove:function(s){this.write(s,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}();function WA(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function XA(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}function $m(e,t){return e&&!WA(t)?XA(e,t):t}const zA=Ge.isStandardBrowserEnv?function(){const t=/(msie|trident)/i.test(navigator.userAgent),s=document.createElement("a");let r;function i(n){let o=n;return t&&(s.setAttribute("href",o),o=s.href),s.setAttribute("href",o),{href:s.href,protocol:s.protocol?s.protocol.replace(/:$/,""):"",host:s.host,search:s.search?s.search.replace(/^\?/,""):"",hash:s.hash?s.hash.replace(/^#/,""):"",hostname:s.hostname,port:s.port,pathname:s.pathname.charAt(0)==="/"?s.pathname:"/"+s.pathname}}return r=i(window.location.href),function(o){const a=P.isString(o)?i(o):o;return a.protocol===r.protocol&&a.host===r.host}}():function(){return function(){return!0}}();function VA(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function jA(e,t){e=e||10;const s=new Array(e),r=new Array(e);let i=0,n=0,o;return t=t!==void 0?t:1e3,function(l){const h=Date.now(),c=r[n];o||(o=h),s[i]=l,r[i]=h;let u=n,f=0;for(;u!==i;)f+=s[u++],u=u%e;if(i=(i+1)%e,i===n&&(n=(n+1)%e),h-o<t)return;const p=c&&h-c;return p?Math.round(f*1e3/p):void 0}}function Bf(e,t){let s=0;const r=jA(50,250);return i=>{const n=i.loaded,o=i.lengthComputable?i.total:void 0,a=n-s,l=r(a),h=n<=o;s=n;const c={loaded:n,total:o,progress:o?n/o:void 0,bytes:a,rate:l||void 0,estimated:l&&o&&h?(o-n)/l:void 0,event:i};c[t?"download":"upload"]=!0,e(c)}}const YA=typeof XMLHttpRequest<"u",KA=YA&&function(e){return new Promise(function(s,r){let i=e.data;const n=Es.from(e.headers).normalize(),o=e.responseType;let a;function l(){e.cancelToken&&e.cancelToken.unsubscribe(a),e.signal&&e.signal.removeEventListener("abort",a)}P.isFormData(i)&&(Ge.isStandardBrowserEnv||Ge.isStandardBrowserWebWorkerEnv?n.setContentType(!1):n.setContentType("multipart/form-data;",!1));let h=new XMLHttpRequest;if(e.auth){const p=e.auth.username||"",d=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";n.set("Authorization","Basic "+btoa(p+":"+d))}const c=$m(e.baseURL,e.url);h.open(e.method.toUpperCase(),Um(c,e.params,e.paramsSerializer),!0),h.timeout=e.timeout;function u(){if(!h)return;const p=Es.from("getAllResponseHeaders"in h&&h.getAllResponseHeaders()),m={data:!o||o==="text"||o==="json"?h.responseText:h.response,status:h.status,statusText:h.statusText,headers:p,config:e,request:h};HA(function(y){s(y),l()},function(y){r(y),l()},m),h=null}if("onloadend"in h?h.onloadend=u:h.onreadystatechange=function(){!h||h.readyState!==4||h.status===0&&!(h.responseURL&&h.responseURL.indexOf("file:")===0)||setTimeout(u)},h.onabort=function(){h&&(r(new At("Request aborted",At.ECONNABORTED,e,h)),h=null)},h.onerror=function(){r(new At("Network Error",At.ERR_NETWORK,e,h)),h=null},h.ontimeout=function(){let d=e.timeout?"timeout of "+e.timeout+"ms exceeded":"timeout exceeded";const m=e.transitional||km;e.timeoutErrorMessage&&(d=e.timeoutErrorMessage),r(new At(d,m.clarifyTimeoutError?At.ETIMEDOUT:At.ECONNABORTED,e,h)),h=null},Ge.isStandardBrowserEnv){const p=(e.withCredentials||zA(c))&&e.xsrfCookieName&&$A.read(e.xsrfCookieName);p&&n.set(e.xsrfHeaderName,p)}i===void 0&&n.setContentType(null),"setRequestHeader"in h&&P.forEach(n.toJSON(),function(d,m){h.setRequestHeader(m,d)}),P.isUndefined(e.withCredentials)||(h.withCredentials=!!e.withCredentials),o&&o!=="json"&&(h.responseType=e.responseType),typeof e.onDownloadProgress=="function"&&h.addEventListener("progress",Bf(e.onDownloadProgress,!0)),typeof e.onUploadProgress=="function"&&h.upload&&h.upload.addEventListener("progress",Bf(e.onUploadProgress)),(e.cancelToken||e.signal)&&(a=p=>{h&&(r(!p||p.type?new nn(null,e,h):p),h.abort(),h=null)},e.cancelToken&&e.cancelToken.subscribe(a),e.signal&&(e.signal.aborted?a():e.signal.addEventListener("abort",a)));const f=VA(c);if(f&&Ge.protocols.indexOf(f)===-1){r(new At("Unsupported protocol "+f+":",At.ERR_BAD_REQUEST,e));return}h.send(i||null)})},Qn={http:EA,xhr:KA};P.forEach(Qn,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const Wm={getAdapter:e=>{e=P.isArray(e)?e:[e];const{length:t}=e;let s,r;for(let i=0;i<t&&(s=e[i],!(r=P.isString(s)?Qn[s.toLowerCase()]:s));i++);if(!r)throw r===!1?new At(`Adapter ${s} is not supported by the environment`,"ERR_NOT_SUPPORT"):new Error(P.hasOwnProp(Qn,s)?`Adapter '${s}' is not available in the build`:`Unknown adapter '${s}'`);if(!P.isFunction(r))throw new TypeError("adapter is not a function");return r},adapters:Qn};function rl(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new nn(null,e)}function Df(e){return rl(e),e.headers=Es.from(e.headers),e.data=sl.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),Wm.getAdapter(e.adapter||ac.adapter)(e).then(function(r){return rl(e),r.data=sl.call(e,e.transformResponse,r),r.headers=Es.from(r.headers),r},function(r){return Hm(r)||(rl(e),r&&r.response&&(r.response.data=sl.call(e,e.transformResponse,r.response),r.response.headers=Es.from(r.response.headers))),Promise.reject(r)})}const Ff=e=>e instanceof Es?e.toJSON():e;function ii(e,t){t=t||{};const s={};function r(h,c,u){return P.isPlainObject(h)&&P.isPlainObject(c)?P.merge.call({caseless:u},h,c):P.isPlainObject(c)?P.merge({},c):P.isArray(c)?c.slice():c}function i(h,c,u){if(P.isUndefined(c)){if(!P.isUndefined(h))return r(void 0,h,u)}else return r(h,c,u)}function n(h,c){if(!P.isUndefined(c))return r(void 0,c)}function o(h,c){if(P.isUndefined(c)){if(!P.isUndefined(h))return r(void 0,h)}else return r(void 0,c)}function a(h,c,u){if(u in t)return r(h,c);if(u in e)return r(void 0,h)}const l={url:n,method:n,data:n,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:a,headers:(h,c)=>i(Ff(h),Ff(c),!0)};return P.forEach(Object.keys(Object.assign({},e,t)),function(c){const u=l[c]||i,f=u(e[c],t[c],c);P.isUndefined(f)&&u!==a||(s[c]=f)}),s}const Xm="1.5.0",lc={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{lc[e]=function(r){return typeof r===e||"a"+(t<1?"n ":" ")+e}});const Lf={};lc.transitional=function(t,s,r){function i(n,o){return"[Axios v"+Xm+"] Transitional option '"+n+"'"+o+(r?". "+r:"")}return(n,o,a)=>{if(t===!1)throw new At(i(o," has been removed"+(s?" in "+s:"")),At.ERR_DEPRECATED);return s&&!Lf[o]&&(Lf[o]=!0,console.warn(i(o," has been deprecated since v"+s+" and will be removed in the near future"))),t?t(n,o,a):!0}};function qA(e,t,s){if(typeof e!="object")throw new At("options must be an object",At.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let i=r.length;for(;i-- >0;){const n=r[i],o=t[n];if(o){const a=e[n],l=a===void 0||o(a,n,e);if(l!==!0)throw new At("option "+n+" must be "+l,At.ERR_BAD_OPTION_VALUE);continue}if(s!==!0)throw new At("Unknown option "+n,At.ERR_BAD_OPTION)}}const nh={assertOptions:qA,validators:lc},Rs=nh.validators;class So{constructor(t){this.defaults=t,this.interceptors={request:new Mf,response:new Mf}}request(t,s){typeof t=="string"?(s=s||{},s.url=t):s=t||{},s=ii(this.defaults,s);const{transitional:r,paramsSerializer:i,headers:n}=s;r!==void 0&&nh.assertOptions(r,{silentJSONParsing:Rs.transitional(Rs.boolean),forcedJSONParsing:Rs.transitional(Rs.boolean),clarifyTimeoutError:Rs.transitional(Rs.boolean)},!1),i!=null&&(P.isFunction(i)?s.paramsSerializer={serialize:i}:nh.assertOptions(i,{encode:Rs.function,serialize:Rs.function},!0)),s.method=(s.method||this.defaults.method||"get").toLowerCase();let o=n&&P.merge(n.common,n[s.method]);n&&P.forEach(["delete","get","head","post","put","patch","common"],d=>{delete n[d]}),s.headers=Es.concat(o,n);const a=[];let l=!0;this.interceptors.request.forEach(function(m){typeof m.runWhen=="function"&&m.runWhen(s)===!1||(l=l&&m.synchronous,a.unshift(m.fulfilled,m.rejected))});const h=[];this.interceptors.response.forEach(function(m){h.push(m.fulfilled,m.rejected)});let c,u=0,f;if(!l){const d=[Df.bind(this),void 0];for(d.unshift.apply(d,a),d.push.apply(d,h),f=d.length,c=Promise.resolve(s);u<f;)c=c.then(d[u++],d[u++]);return c}f=a.length;let p=s;for(u=0;u<f;){const d=a[u++],m=a[u++];try{p=d(p)}catch(g){m.call(this,g);break}}try{c=Df.call(this,p)}catch(d){return Promise.reject(d)}for(u=0,f=h.length;u<f;)c=c.then(h[u++],h[u++]);return c}getUri(t){t=ii(this.defaults,t);const s=$m(t.baseURL,t.url);return Um(s,t.params,t.paramsSerializer)}}P.forEach(["delete","get","head","options"],function(t){So.prototype[t]=function(s,r){return this.request(ii(r||{},{method:t,url:s,data:(r||{}).data}))}});P.forEach(["post","put","patch"],function(t){function s(r){return function(n,o,a){return this.request(ii(a||{},{method:t,headers:r?{"Content-Type":"multipart/form-data"}:{},url:n,data:o}))}}So.prototype[t]=s(),So.prototype[t+"Form"]=s(!0)});const to=So;class hc{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let s;this.promise=new Promise(function(n){s=n});const r=this;this.promise.then(i=>{if(!r._listeners)return;let n=r._listeners.length;for(;n-- >0;)r._listeners[n](i);r._listeners=null}),this.promise.then=i=>{let n;const o=new Promise(a=>{r.subscribe(a),n=a}).then(i);return o.cancel=function(){r.unsubscribe(n)},o},t(function(n,o,a){r.reason||(r.reason=new nn(n,o,a),s(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const s=this._listeners.indexOf(t);s!==-1&&this._listeners.splice(s,1)}static source(){let t;return{token:new hc(function(i){t=i}),cancel:t}}}const ZA=hc;function JA(e){return function(s){return e.apply(null,s)}}function QA(e){return P.isObject(e)&&e.isAxiosError===!0}const oh={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(oh).forEach(([e,t])=>{oh[t]=e});const t1=oh;function zm(e){const t=new to(e),s=Am(to.prototype.request,t);return P.extend(s,to.prototype,t,{allOwnKeys:!0}),P.extend(s,t,null,{allOwnKeys:!0}),s.create=function(i){return zm(ii(e,i))},s}const Kt=zm(ac);Kt.Axios=to;Kt.CanceledError=nn;Kt.CancelToken=ZA;Kt.isCancel=Hm;Kt.VERSION=Xm;Kt.toFormData=ra;Kt.AxiosError=At;Kt.Cancel=Kt.CanceledError;Kt.all=function(t){return Promise.all(t)};Kt.spread=JA;Kt.isAxiosError=QA;Kt.mergeConfig=ii;Kt.AxiosHeaders=Es;Kt.formToJSON=e=>Gm(P.isHTMLForm(e)?new FormData(e):e);Kt.getAdapter=Wm.getAdapter;Kt.HttpStatusCode=t1;Kt.default=Kt;const Vm=Kt;Vm.defaults.baseURL="/sceneSetups/";const e1=e=>{const t=e.sceneWidth,s=e.sceneHeight,r=new Map;for(const i of e.thingsMap){const n={species:i.species,name:i.name},o=new Array;for(const a of i.thingSetup){const l={defaultBlockX:a.defaultBlockX,defaultBlockY:a.defaultBlockY,textureName:a.textureName,defaultTowards:a.defaultTowards};o.push(l)}r.set(n,o)}return{id:e.id,name:e.name,sceneWidth:t,sceneHeight:s,thingsMap:r}},s1=async e=>{try{const{data:t}=await Vm.get(e);return t}catch(t){throw new Error("Error occurred while loading JSON from local"+t)}},r1=async e=>e1(await s1(e));class cc extends gm{constructor(){super();X(this,"_runningCommand",!1);X(this,"_isActive",!1);X(this,"_pendingInstructions");X(this,"_needScanRule",!1);X(this,"_existYou",!0);X(this,"commandListener");this._pendingInstructions=new pm,this.commandListener={observeId:mr(),update:async()=>{await this._run()}}}_setRunning(){this._runningCommand=!0}_setNotRunning(){this._runningCommand=!1}enableService(){this._isActive=!0}disableService(){this._isActive=!1}static _judgementInstructionPriority(s){const r=s.getPriority();return r||Date.now()}addInstructions(s){for(const r of s){const i=cc._judgementInstructionPriority(r);this._pendingInstructions.add(r,i)}}_nextInstruction(){const s=this._pendingInstructions.poll();return s?se(s):Ot}needScanRule(){this._needScanRule=!0}async _executeInstructions(){let s=this._nextInstruction();for(;es(s);)await s.value.perform(),s=this._nextInstruction()}async _run(){const s=j.nextCommand();if(!this._isActive||this._runningCommand||Tt(s))return;this._setRunning(),this.setChanged(),await this.notifyObservers(s.value),await this._executeInstructions(),this._needScanRule&&(j.getRuleController().refreshAll(),j.getScanner().findRulesFromMap(j.getAppEdge()),await j.getRuleController().processImmediateChanges(),this._needScanRule=!1),await this._executeInstructions();const r=await j.getRuleController().checkYouExistsInLevel();r!==this._existYou&&(this._existYou=r,setTimeout(()=>{Ym(this._existYou)},2e3)),this._setNotRunning()}}const i1=()=>new cc;class n1{constructor(t){X(this,"_features");X(this,"_patterns");X(this,"_mapController");this._features=new Map,this._patterns=new Map,this._mapController=t,this._giveDefaultRules()}refreshAll(){this._features.clear(),this._giveDefaultRules()}_giveDefaultRules(){const t={_is:[{feature:wt.PUSH,on:[],near:[],facing:[]}],_has:[],_make:[]},s=[...Object.values(rc),...Object.values(wt),...Object.values(Bt)];for(const r of s)this._features.set(r,t)}async processImmediateChanges(){const t=new Map;this._features.forEach((r,i)=>{const n=r._is.filter(o=>Em(o.feature));t.set(i,n)}),await this._mapController.appendTransformInstructions(t);const s=new Map;this._features.forEach((r,i)=>{const n=r._is.filter(o=>{switch(o.feature){case wt.MOVE:case wt.TELE:return!0;default:return!1}});s.set(i,n)}),await this._mapController.processMoveInstructions(s)}async checkYouExistsInLevel(){const t=[];return this._features.forEach((s,r)=>{for(const i of s._is)if(i.feature===wt.YOU){t.push(r);break}}),t.length===0?!1:await this._mapController.checkYouExistsInMap(t)}$is(t,s){const r=t.name,i=this._features.get(r);if(!i)return!1;const n=!!i._is.find(o=>o.feature===s);return!!(i&&n)}$has(t,s){const r=t.name,i=this._features.get(r);if(!i)return!1;const n=!!i._has.find(o=>o.feature===s);return!!(i&&n)}$make(t,s){const r=t.name,i=this._features.get(r);if(!i)return!1;const n=!!i._make.find(o=>o.feature===s);return!!(i&&n)}getFeaturesOfThing(t,s){if(t.species!==$t.CHARACTERS)throw new Error('[MY FAULT] Feature "getFeaturesOfThings" for Text-type things are not implemented yet');const r=t.name;if(!this._features.has(r))return Ot;const i=this._features.get(r);if(!i)throw new Error(`Thing ${r} in featureList has unexpected undefined value`);switch(s){case Bt.IS:return se(i._is);case Bt.HAS:return se(i._has);case Bt.MAKE:return se(i._make);default:throw new Error(`operator ${s} should be a verb (OperatorType.IS, OperatorType.HAS, OperatorType.MAKE) instead of an adjective`)}}addFeature(t,s,r){if(!this._features.has(t)){const i={_is:[],_has:[],_make:[]};this._features.set(t,i)}switch(s){case Bt.IS:this._features.get(t)._is.push(r);break;case Bt.HAS:this._features.get(t)._has.push(r);break;case Bt.MAKE:this._features.get(t)._make.push(r);break;default:throw new Error(`operator ${s} should be a verb (OperatorType.IS, OperatorType.HAS, OperatorType.MAKE) instead of an adjective`)}}removeFeature(t,s,r){if(!this._features.has(t))throw new Error(`thingType ${t} not been recorded yet`);let i=-1;switch(s){case Bt.IS:if(i=this._features.get(t)._is.indexOf(r),i===-1)throw new Error(`thingType ${t} does not contain feature ${r}`);this._features.get(t)._is.splice(i,1);break;case Bt.HAS:if(i=this._features.get(t)._has.indexOf(r),i===-1)throw new Error(`thingType ${t} does not contain feature ${r}`);this._features.get(t)._has.splice(i,1);break;case Bt.MAKE:if(i=this._features.get(t)._make.indexOf(r),i===-1)throw new Error(`thingType ${t} does not contain feature ${r}`);this._features.get(t)._make.splice(i,1);break;default:throw new Error(`operator ${s} should be a verb (OperatorType.IS, OperatorType.HAS, OperatorType.MAKE) instead of an adjective`)}}}const o1=e=>new n1(e);class a1{constructor(t,s){X(this,"_ruleController");X(this,"_mapController");this._ruleController=t,this._mapController=s}scanRule(t,s,r,i,n){if(n===O.LEFT||n===O.TOP)throw new Error(`scan direction ${n} should be Direction.RIGHT or Direction.DOWN`);const o=[Bt.IS,Bt.HAS,Bt.MAKE],a=[Bt.ON,Bt.NEAR,Bt.FACING];let l=t,h=s,c=!1;const u={primaryCharacters:Ot,conditionSettings:Ot,effectRules:Ot};for(;;){if(l>=r||h>=i)return Ot;const E=this._mapController.whoAreThere(l,h);if(Tt(E))return Ot;if(c){let _=!1;for(const v of E.value)if(v.name===Bt.AND){_=!0;break}if(!_)break}else{let _=!1;for(const v of E.value)if(v.species===$t.NOUNS)if(Tt(u.primaryCharacters)&&(u.primaryCharacters=se([])),es(u.primaryCharacters)){const A=v.name;u.primaryCharacters.value.push(A),_=!0}else throw new Error("unexpected error cause by rulePattern.primaryCharacters is not a some value");if(!_)return Ot}c=!c,n===O.RIGHT&&l++,n===O.DOWN&&h++}c=!1;let f=!1,p=!0,d=Ot;for(;;){if(l>=r||h>=i)return Ot;const E=this._mapController.whoAreThere(l,h);if(Tt(E))return Ot;const _=(v,S)=>{if(!a.includes(S))throw new Error(`currentAdj ${S} was passed in as unacceptable OperatorType`);const A=v.name;if(Tt(u.conditionSettings)&&(u.conditionSettings=se(new Map)),es(u.conditionSettings))if(u.conditionSettings.value.has(S)){const w=u.conditionSettings.value.get(S);w&&(w.push(A),u.conditionSettings.value.set(S,w))}else u.conditionSettings.value.set(S,[A]);else throw new Error("unexpected error cause by rulePattern.conditionSettings is not a some value")};if(p&&f)for(const v of E.value){const S=v.species;if(S===$t.NOUNS){if(Tt(d))throw new Error(`adjective ${d} should not be none`);if(!a.includes(d.value))throw new Error(`currentAdj ${d} should be an adjective operator`);_(v,d.value),f=!1,p=!1,c=!0}if(S===$t.OPERATORS){const A=v.name;if(a.includes(A))d=se(A),f=!0,p=!1,c=!1;else return Ot}}else if(p){let v=!1,S=!1;for(const A of E.value)if(A.species===$t.OPERATORS){const b=A.name;if(b===Bt.AND)return Ot;if(a.includes(b))d=se(b),v=!0;else if(o.includes(b)){S=!0;break}}if(S)break;if(!v)return Ot;p=!1,f=!0}else if(f)for(const v of E.value){if(v.species===$t.NOUNS){if(Tt(d))throw new Error(`adjective ${d} should not be none`);if(!a.includes(d.value))throw new Error(`currentAdj ${d} should be an adjective operator`);_(v,d.value)}else return Ot;c=!0,f=!1}else if(c){let v=!1;for(const S of E.value)if(S.species===$t.OPERATORS){const w=S.name;if(w!==Bt.AND)return Ot;if(o.includes(w)){v=!1;break}}else return Ot;if(v)break;c=!1,p=!0,f=!0}else throw new Error("unexpected error occurred caused by nonexistent scan condition");n===O.RIGHT&&l++,n===O.DOWN&&h++}c=!1;let m=!1,g=!0,y=Ot;for(;!(l>=r||h>=i);){const E=this._mapController.whoAreThere(l,h);if(Tt(E))break;const _=(S,A)=>{if(!o.includes(A))throw new Error(`currentVerb ${A} was passed in as unacceptable OperatorType`);const w=S.name;if(Tt(u.effectRules)&&(u.effectRules=se(new Map)),es(u.effectRules))if(u.effectRules.value.has(A)){const b=u.effectRules.value.get(A);b&&(b.push(w),u.effectRules.value.set(A,b))}else u.effectRules.value.set(A,[w]);else throw new Error("unexpected error cause by rulePattern.effectRules is not a some value")};let v=!1;if(g&&m){let S=!1;for(const A of E.value){const w=A.species;if(w===$t.OPERATORS){const b=A.name;o.includes(b)&&(y=se(b),S=!0)}else if(w===$t.PROPERTIES){if(Tt(y))throw new Error(`verb ${y} should not be none`);y.value===Bt.IS&&(_(A,y.value),S=!0)}else if(w===$t.NOUNS){if(Tt(y))throw new Error(`verb ${y} should not be none`);if(!o.includes(y.value))throw new Error(`currentVerb ${y} should be a verb operator`);_(A,y.value),S=!0}}S||(v=!0)}else if(g){let S=!1;for(const A of E.value)if(A.species===$t.OPERATORS){const b=A.name;o.includes(b)&&(y=se(b),S=!0)}if(!S)return Ot;m=!0,g=!1}else if(m){let S=!1;for(const A of E.value){if(Tt(y))throw new Error(`verb ${y} should not be none`);if(!o.includes(y.value))throw new Error(`currentVerb ${y} should be a verb operator`);const w=A.species;(w===$t.PROPERTIES&&y.value===Bt.IS||w===$t.NOUNS)&&(_(A,y.value),S=!0)}S||(v=!0),m=!1,c=!0}else if(c){let S=!1;for(const A of E.value)A.name===Bt.AND&&(S=!0);S||(v=!0),c=!1,g=!0,m=!0}else return Ot;if(n===O.RIGHT&&l++,n===O.DOWN&&h++,v)break}return se(u)}addRulesFromRulePattern(t){if(Tt(t.primaryCharacters)||Tt(t.effectRules))return;const s=[Bt.IS,Bt.HAS,Bt.MAKE];for(const r of t.primaryCharacters.value){const i=xm(r);for(const n of s){const o=t.effectRules.value.get(n);if(o)for(const a of o){const l={feature:a,on:[],near:[],facing:[]};es(t.conditionSettings)&&(l.on=t.conditionSettings.value.get(Bt.ON)||[],l.near=t.conditionSettings.value.get(Bt.NEAR)||[],l.facing=t.conditionSettings.value.get(Bt.FACING)||[]),this._ruleController.addFeature(i,n,l)}}}}findRulesFromMap(t){const s=t.maxX+1,r=t.maxY+1;for(let i=0;i<s;i++)for(let n=0;n<r;n++){const o=this._mapController.whoAreThere(i,n);if(!Tt(o)){for(const a of o.value)if(a.species===$t.NOUNS){const l=this.scanRule(i,n,s,r,O.RIGHT);es(l)&&this.addRulesFromRulePattern(l.value);const h=this.scanRule(i,n,s,r,O.DOWN);es(h)&&this.addRulesFromRulePattern(h.value)}}}}}const l1=(e,t)=>new a1(e,t),h1=async e=>{const t=j.getStageBuilder();j.getDispatchServer()&&j.disposeDispatchServer(),await j.loadResources(UT);const s=kS();j.setMapController(s);const r=o1(s);j.setRuleController(r);const i=l1(r,s);j.setScanner(i);const n=i1();j.setDispatchServer(n),j.connectDispatchListener(n.commandListener),await t.removeScene();const o=await r1(e);await t.addGameScene(o),j.initDispatchServer(),j.initCommandWatchService()};let jm,Ym;const c1=e=>{Ym=async t=>{await e(t)}},u1=e=>{jm=async t=>{const s=j.getStageBuilder();j.disposeDispatchServer(),await ri(300),await e(t),await s.removeScene()}},f1=()=>{j.disposeDispatchServer()},d1=()=>{j.initDispatchServer()};var Km=(e=>(e.WIN="WIN",e.LEAVE="LEAVE",e.RESTART="RESTART",e))(Km||{});class p1 extends As{async perform(){await ri(pr),await jm(Km.WIN)}async unperform(){return Promise.reject()}}const Nf=(e,t)=>{const s=new p1(e);s.setPriority(9999999999999),t.addNewInstruction(s),t.pushInstructions()};class ah extends As{async perform(){await ri(pr),this._subject.thingController.disconnect(),await j.getMapController().update(this._subject,Re.DISAPPEAR),await j.getContainerBuilder().removeThingFromGameScene(this._subject)}async unperform(){await ri(pr),await j.getMapController().update(this._subject,Re.APPEAR)}}const Ar=async(e,t)=>{const s=new ah(e);s.setPriority(9999999990001),t.addNewInstruction(s),t.pushInstructions()},Un=async(e,t,s)=>{const r=new ah(e),i=new ah(t);r.setPriority(9999999990001),i.setPriority(9999999990001),s.addNewInstruction(r),s.addNewInstruction(i),s.pushInstructions()},m1=async(e,t,s,r)=>{const n=j.getRuleController(),o=j.getMapController(),a=n.$is(e,wt.YOU)||n.$is(e,wt.YOU2),l=n.$is(t,wt.YOU)||n.$is(t,wt.YOU2),h=n.$is(e,wt.FLOAT),c=n.$is(t,wt.FLOAT),u=h===c,f=n.$is(e,wt.WIN),p=n.$is(t,wt.WIN);if(a&&f||l&&p||h===c&&(f&&l||p&&a))return Nf(e,r),!0;if(n.$is(e,wt.PUSH))return await OS(e,o,s)?(GS(e,s,r),!0):!1;const m=n.$is(e,wt.OPEN),g=n.$is(t,wt.OPEN);if(m&&n.$is(t,wt.SHUT))return await Un(e,t,r),!0;if(g&&n.$is(e,wt.SHUT))return await Un(e,t,r),!0;const y=n.$is(e,wt.WEAK),E=n.$is(t,wt.WEAK);if(y&&E)return await Un(e,t,r),!0;if(y)return await Ar(e,r),!0;if(E)return await Ar(t,r),!0;if(y?!1:n.$is(e,wt.STOP))return!1;if(u){const F=n.$is(e,wt.SINK),U=n.$is(t,wt.SINK);if(F||U)return await Un(e,t,r),!0}const v=n.$is(e,wt.DEFEAT),S=n.$is(t,wt.DEFEAT);if(u){if(v&&l)return await Ar(t,r),!0;if(S&&a)return await Ar(e,r),!0}const A=n.$is(e,wt.HOT),w=n.$is(t,wt.HOT),b=n.$is(e,wt.MELT),R=n.$is(t,wt.MELT);if(u){if(A&&R)return await Ar(t,r),!0;if(w&&b)return await Ar(e,r),!0}return!0};var cr=Object.freeze({Linear:Object.freeze({None:function(e){return e},In:function(e){return this.None(e)},Out:function(e){return this.None(e)},InOut:function(e){return this.None(e)}}),Quadratic:Object.freeze({In:function(e){return e*e},Out:function(e){return e*(2-e)},InOut:function(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)}}),Cubic:Object.freeze({In:function(e){return e*e*e},Out:function(e){return--e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)}}),Quartic:Object.freeze({In:function(e){return e*e*e*e},Out:function(e){return 1- --e*e*e*e},InOut:function(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)}}),Quintic:Object.freeze({In:function(e){return e*e*e*e*e},Out:function(e){return--e*e*e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)}}),Sinusoidal:Object.freeze({In:function(e){return 1-Math.sin((1-e)*Math.PI/2)},Out:function(e){return Math.sin(e*Math.PI/2)},InOut:function(e){return .5*(1-Math.sin(Math.PI*(.5-e)))}}),Exponential:Object.freeze({In:function(e){return e===0?0:Math.pow(1024,e-1)},Out:function(e){return e===1?1:1-Math.pow(2,-10*e)},InOut:function(e){return e===0?0:e===1?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(-Math.pow(2,-10*(e-1))+2)}}),Circular:Object.freeze({In:function(e){return 1-Math.sqrt(1-e*e)},Out:function(e){return Math.sqrt(1- --e*e)},InOut:function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)}}),Elastic:Object.freeze({In:function(e){return e===0?0:e===1?1:-Math.pow(2,10*(e-1))*Math.sin((e-1.1)*5*Math.PI)},Out:function(e){return e===0?0:e===1?1:Math.pow(2,-10*e)*Math.sin((e-.1)*5*Math.PI)+1},InOut:function(e){return e===0?0:e===1?1:(e*=2,e<1?-.5*Math.pow(2,10*(e-1))*Math.sin((e-1.1)*5*Math.PI):.5*Math.pow(2,-10*(e-1))*Math.sin((e-1.1)*5*Math.PI)+1)}}),Back:Object.freeze({In:function(e){var t=1.70158;return e===1?1:e*e*((t+1)*e-t)},Out:function(e){var t=1.70158;return e===0?0:--e*e*((t+1)*e+t)+1},InOut:function(e){var t=2.5949095;return(e*=2)<1?.5*(e*e*((t+1)*e-t)):.5*((e-=2)*e*((t+1)*e+t)+2)}}),Bounce:Object.freeze({In:function(e){return 1-cr.Bounce.Out(1-e)},Out:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},InOut:function(e){return e<.5?cr.Bounce.In(e*2)*.5:cr.Bounce.Out(e*2-1)*.5+.5}}),generatePow:function(e){return e===void 0&&(e=4),e=e<Number.EPSILON?Number.EPSILON:e,e=e>1e4?1e4:e,{In:function(t){return Math.pow(t,e)},Out:function(t){return 1-Math.pow(1-t,e)},InOut:function(t){return t<.5?Math.pow(t*2,e)/2:(1-Math.pow(2-t*2,e))/2+.5}}}}),Ri=function(){return performance.now()},g1=function(){function e(){this._tweens={},this._tweensAddedDuringUpdate={}}return e.prototype.getAll=function(){var t=this;return Object.keys(this._tweens).map(function(s){return t._tweens[s]})},e.prototype.removeAll=function(){this._tweens={}},e.prototype.add=function(t){this._tweens[t.getId()]=t,this._tweensAddedDuringUpdate[t.getId()]=t},e.prototype.remove=function(t){delete this._tweens[t.getId()],delete this._tweensAddedDuringUpdate[t.getId()]},e.prototype.update=function(t,s){t===void 0&&(t=Ri()),s===void 0&&(s=!1);var r=Object.keys(this._tweens);if(r.length===0)return!1;for(;r.length>0;){this._tweensAddedDuringUpdate={};for(var i=0;i<r.length;i++){var n=this._tweens[r[i]],o=!s;n&&n.update(t,o)===!1&&!s&&delete this._tweens[r[i]]}r=Object.keys(this._tweensAddedDuringUpdate)}return!0},e}(),Fr={Linear:function(e,t){var s=e.length-1,r=s*t,i=Math.floor(r),n=Fr.Utils.Linear;return t<0?n(e[0],e[1],r):t>1?n(e[s],e[s-1],s-r):n(e[i],e[i+1>s?s:i+1],r-i)},Bezier:function(e,t){for(var s=0,r=e.length-1,i=Math.pow,n=Fr.Utils.Bernstein,o=0;o<=r;o++)s+=i(1-t,r-o)*i(t,o)*e[o]*n(r,o);return s},CatmullRom:function(e,t){var s=e.length-1,r=s*t,i=Math.floor(r),n=Fr.Utils.CatmullRom;return e[0]===e[s]?(t<0&&(i=Math.floor(r=s*(1+t))),n(e[(i-1+s)%s],e[i],e[(i+1)%s],e[(i+2)%s],r-i)):t<0?e[0]-(n(e[0],e[0],e[1],e[1],-r)-e[0]):t>1?e[s]-(n(e[s],e[s],e[s-1],e[s-1],r-s)-e[s]):n(e[i?i-1:0],e[i],e[s<i+1?s:i+1],e[s<i+2?s:i+2],r-i)},Utils:{Linear:function(e,t,s){return(t-e)*s+e},Bernstein:function(e,t){var s=Fr.Utils.Factorial;return s(e)/s(t)/s(e-t)},Factorial:function(){var e=[1];return function(t){var s=1;if(e[t])return e[t];for(var r=t;r>1;r--)s*=r;return e[t]=s,s}}(),CatmullRom:function(e,t,s,r,i){var n=(s-e)*.5,o=(r-t)*.5,a=i*i,l=i*a;return(2*t-2*s+n+o)*l+(-3*t+3*s-2*n-o)*a+n*i+t}}},_1=function(){function e(){}return e.nextId=function(){return e._nextId++},e._nextId=0,e}(),lh=new g1,Uf=function(){function e(t,s){s===void 0&&(s=lh),this._object=t,this._group=s,this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._isDynamic=!1,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=cr.Linear.None,this._interpolationFunction=Fr.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._id=_1.nextId(),this._isChainStopped=!1,this._propertiesAreSetUp=!1,this._goToEnd=!1}return e.prototype.getId=function(){return this._id},e.prototype.isPlaying=function(){return this._isPlaying},e.prototype.isPaused=function(){return this._isPaused},e.prototype.to=function(t,s){if(s===void 0&&(s=1e3),this._isPlaying)throw new Error("Can not call Tween.to() while Tween is already started or paused. Stop the Tween first.");return this._valuesEnd=t,this._propertiesAreSetUp=!1,this._duration=s,this},e.prototype.duration=function(t){return t===void 0&&(t=1e3),this._duration=t,this},e.prototype.dynamic=function(t){return t===void 0&&(t=!1),this._isDynamic=t,this},e.prototype.start=function(t,s){if(t===void 0&&(t=Ri()),s===void 0&&(s=!1),this._isPlaying)return this;if(this._group&&this._group.add(this),this._repeat=this._initialRepeat,this._reversed){this._reversed=!1;for(var r in this._valuesStartRepeat)this._swapEndStartRepeatValues(r),this._valuesStart[r]=this._valuesStartRepeat[r]}if(this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=t,this._startTime+=this._delayTime,!this._propertiesAreSetUp||s){if(this._propertiesAreSetUp=!0,!this._isDynamic){var i={};for(var n in this._valuesEnd)i[n]=this._valuesEnd[n];this._valuesEnd=i}this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat,s)}return this},e.prototype.startFromCurrentValues=function(t){return this.start(t,!0)},e.prototype._setupProperties=function(t,s,r,i,n){for(var o in r){var a=t[o],l=Array.isArray(a),h=l?"array":typeof a,c=!l&&Array.isArray(r[o]);if(!(h==="undefined"||h==="function")){if(c){var u=r[o];if(u.length===0)continue;for(var f=[a],p=0,d=u.length;p<d;p+=1){var m=this._handleRelativeValue(a,u[p]);if(isNaN(m)){c=!1,console.warn("Found invalid interpolation list. Skipping.");break}f.push(m)}c&&(r[o]=f)}if((h==="object"||l)&&a&&!c){s[o]=l?[]:{};var g=a;for(var y in g)s[o][y]=g[y];i[o]=l?[]:{};var u=r[o];if(!this._isDynamic){var E={};for(var y in u)E[y]=u[y];r[o]=u=E}this._setupProperties(g,s[o],u,i[o],n)}else(typeof s[o]>"u"||n)&&(s[o]=a),l||(s[o]*=1),c?i[o]=r[o].slice().reverse():i[o]=s[o]||0}}},e.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group&&this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},e.prototype.end=function(){return this._goToEnd=!0,this.update(1/0),this},e.prototype.pause=function(t){return t===void 0&&(t=Ri()),this._isPaused||!this._isPlaying?this:(this._isPaused=!0,this._pauseStart=t,this._group&&this._group.remove(this),this)},e.prototype.resume=function(t){return t===void 0&&(t=Ri()),!this._isPaused||!this._isPlaying?this:(this._isPaused=!1,this._startTime+=t-this._pauseStart,this._pauseStart=0,this._group&&this._group.add(this),this)},e.prototype.stopChainedTweens=function(){for(var t=0,s=this._chainedTweens.length;t<s;t++)this._chainedTweens[t].stop();return this},e.prototype.group=function(t){return t===void 0&&(t=lh),this._group=t,this},e.prototype.delay=function(t){return t===void 0&&(t=0),this._delayTime=t,this},e.prototype.repeat=function(t){return t===void 0&&(t=0),this._initialRepeat=t,this._repeat=t,this},e.prototype.repeatDelay=function(t){return this._repeatDelayTime=t,this},e.prototype.yoyo=function(t){return t===void 0&&(t=!1),this._yoyo=t,this},e.prototype.easing=function(t){return t===void 0&&(t=cr.Linear.None),this._easingFunction=t,this},e.prototype.interpolation=function(t){return t===void 0&&(t=Fr.Linear),this._interpolationFunction=t,this},e.prototype.chain=function(){for(var t=[],s=0;s<arguments.length;s++)t[s]=arguments[s];return this._chainedTweens=t,this},e.prototype.onStart=function(t){return this._onStartCallback=t,this},e.prototype.onEveryStart=function(t){return this._onEveryStartCallback=t,this},e.prototype.onUpdate=function(t){return this._onUpdateCallback=t,this},e.prototype.onRepeat=function(t){return this._onRepeatCallback=t,this},e.prototype.onComplete=function(t){return this._onCompleteCallback=t,this},e.prototype.onStop=function(t){return this._onStopCallback=t,this},e.prototype.update=function(t,s){if(t===void 0&&(t=Ri()),s===void 0&&(s=!0),this._isPaused)return!0;var r,i,n=this._startTime+this._duration;if(!this._goToEnd&&!this._isPlaying){if(t>n)return!1;s&&this.start(t,!0)}if(this._goToEnd=!1,t<this._startTime)return!0;this._onStartCallbackFired===!1&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),this._onEveryStartCallbackFired===!1&&(this._onEveryStartCallback&&this._onEveryStartCallback(this._object),this._onEveryStartCallbackFired=!0),i=(t-this._startTime)/this._duration,i=this._duration===0||i>1?1:i;var o=this._easingFunction(i);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,o),this._onUpdateCallback&&this._onUpdateCallback(this._object,i),i===1)if(this._repeat>0){isFinite(this._repeat)&&this._repeat--;for(r in this._valuesStartRepeat)!this._yoyo&&typeof this._valuesEnd[r]=="string"&&(this._valuesStartRepeat[r]=this._valuesStartRepeat[r]+parseFloat(this._valuesEnd[r])),this._yoyo&&this._swapEndStartRepeatValues(r),this._valuesStart[r]=this._valuesStartRepeat[r];return this._yoyo&&(this._reversed=!this._reversed),this._repeatDelayTime!==void 0?this._startTime=t+this._repeatDelayTime:this._startTime=t+this._delayTime,this._onRepeatCallback&&this._onRepeatCallback(this._object),this._onEveryStartCallbackFired=!1,!0}else{this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var a=0,l=this._chainedTweens.length;a<l;a++)this._chainedTweens[a].start(this._startTime+this._duration,!1);return this._isPlaying=!1,!1}return!0},e.prototype._updateProperties=function(t,s,r,i){for(var n in r)if(s[n]!==void 0){var o=s[n]||0,a=r[n],l=Array.isArray(t[n]),h=Array.isArray(a),c=!l&&h;c?t[n]=this._interpolationFunction(a,i):typeof a=="object"&&a?this._updateProperties(t[n],o,a,i):(a=this._handleRelativeValue(o,a),typeof a=="number"&&(t[n]=o+(a-o)*i))}},e.prototype._handleRelativeValue=function(t,s){return typeof s!="string"?s:s.charAt(0)==="+"||s.charAt(0)==="-"?t+parseFloat(s):parseFloat(s)},e.prototype._swapEndStartRepeatValues=function(t){var s=this._valuesStartRepeat[t],r=this._valuesEnd[t];typeof r=="string"?this._valuesStartRepeat[t]=this._valuesStartRepeat[t]+parseFloat(r):this._valuesStartRepeat[t]=this._valuesEnd[t],this._valuesEnd[t]=s},e}(),ls=lh;ls.getAll.bind(ls);ls.removeAll.bind(ls);ls.add.bind(ls);ls.remove.bind(ls);var kf=ls.update.bind(ls);class y1 extends wo{constructor(s,r,i,n,o,a,l,h,c){super(i);X(this,"_id");X(this,"_species");X(this,"_blockX");X(this,"_blockY");X(this,"_maxBlockX");X(this,"_maxBlockY");X(this,"_blockSize");X(this,"_towards");X(this,"thingController");this._id=mr(),this.name=s,this._species=r,this._blockX=n,this._blockY=o,this._maxBlockX=l,this._maxBlockY=h,this._towards=c??0,this.updateTowards(this._towards),this._blockSize=a,this.height=a,this.width=a,this.anchor.set(.5),this.x=(this._blockX+.5)*this._blockSize,this.y=(this._blockY+.5)*this._blockSize,super.animationSpeed=.08,super.play()}bindThingController(s){this.thingController=s}setup(s){this.blockX=s.defaultBlockX,this.blockY=s.defaultBlockY,this.updateTowards(s.defaultTowards)}get blockX(){return Number(this._blockX)}set blockX(s){this._blockX=s;const r={x:this.x},i={x:(s+.5)*this._blockSize};let n=0;const o=a=>{n=requestAnimationFrame(o),kf(a)};n=requestAnimationFrame(o),new Uf(r).to(i,pr).onUpdate(()=>this.x=r.x).easing(cr.Quadratic.Out).onComplete(()=>cancelAnimationFrame(n)).start()}get blockY(){return Number(this._blockY)}set blockY(s){this._blockY=s;const r={y:this.y},i={y:(s+.5)*this._blockSize};let n=0;const o=a=>{n=requestAnimationFrame(o),kf(a)};n=requestAnimationFrame(o),new Uf(r).to(i,pr).easing(cr.Quadratic.Out).onUpdate(()=>this.y=r.y).onComplete(()=>cancelAnimationFrame(n)).start()}updateTowards(s){switch(s){case O.LEFT:this.scale.x=-1*Math.abs(this.scale.x);break;case O.RIGHT:this.scale.x=Math.abs(this.scale.x);break}this.towards=s}set towards(s){this._towards=s}get towards(){return this._towards}get id(){return this._id}get species(){return this._species}atRightEdge(){return this.blockX===this._maxBlockX}atLeftEdge(){return this.blockX===0}atTopEdge(){return this.blockY===0}atBottomEdge(){return this.blockY===this._maxBlockY}async moveUp(){await new Promise((s,r)=>{this.atTopEdge()?r():this.blockY--,s()})}async moveDown(){await new Promise((s,r)=>{this.atBottomEdge()?r():this.blockY++,s()})}async moveRight(){await new Promise((s,r)=>{this.atRightEdge()?r():this.blockX++,s()})}async moveLeft(){await new Promise((s,r)=>{this.atLeftEdge()?r():this.blockX--,s()})}async reverseTowards(){await new Promise((s,r)=>{this.towards===O.UNDEFINED?r():(this.updateTowards(Qo(this.towards)),s())})}handleBeside(){return Promise.resolve(void 0)}async handleEncounter(s,r){return await m1(this,s,r,this.thingController)}handleLeave(){return Promise.resolve(void 0)}}class v1{constructor(t,s){X(this,"_species");X(this,"_name");this._species=t,this._name=s}createInstance(t,s,r,i,n,o,a,l,h){return new y1(t,s,r,i,n,o,a,l,h)}}class kn extends As{constructor(s,r){super(s);X(this,"_towards");this._towards=r}async perform(){this._subject.updateTowards(this._towards)}async unperform(){this._subject.updateTowards(Qo(this._towards))}}class x1{constructor(t){X(this,"observeId");X(this,"_instructions");X(this,"_thing");this.observeId=mr(),this._instructions=[],j.getDispatchServer().addObserver(this),this._thing=t,this._thing.bindThingController(this),j.getMapController().update(this._thing,Re.APPEAR).then()}clearInstructions(){this._instructions=[]}addNewInstruction(t){this._instructions.push(t)}pushInstructions(){j.getDispatchServer().addInstructions(this._instructions),this.clearInstructions()}async update(t,s){if(!(j.getRuleController().$is(this._thing,wt.YOU)||j.getRuleController().$is(this._thing,wt.YOU2))||!await j.getMapController().canIEncounter(this._thing,(()=>{switch(s.value){case ps.UP:return O.TOP;case ps.DOWN:return O.DOWN;case ps.LEFT:return O.LEFT;case ps.RIGHT:return O.RIGHT;default:return O.UNDEFINED}})()))return;let n;switch(s.value){case ps.UP:n=new Ls.MoveUpInstruction(this._thing),this._thing.species===$t.CHARACTERS&&this.addNewInstruction(new kn(this._thing,O.TOP));break;case ps.DOWN:n=new Ls.MoveDownInstruction(this._thing),this._thing.species===$t.CHARACTERS&&this.addNewInstruction(new kn(this._thing,O.DOWN));break;case ps.LEFT:n=new Ls.MoveLeftInstruction(this._thing),this._thing.species===$t.CHARACTERS&&this.addNewInstruction(new kn(this._thing,O.LEFT));break;case ps.RIGHT:n=new Ls.MoveRightInstruction(this._thing),this._thing.species===$t.CHARACTERS&&this.addNewInstruction(new kn(this._thing,O.RIGHT));break;default:n=new sc(this._thing);break}j.getDispatchServer().needScanRule(),this.addNewInstruction(n),this.pushInstructions()}stopDispatcher(){j.getDispatchServer().disableService()}disconnect(){j.getDispatchServer().deleteObserver(this)}}const E1=e=>new x1(e);class qm{}class b1 extends qm{constructor(){super(...arguments);X(this,"_name");X(this,"_species");X(this,"_textures");X(this,"_defaultBlockX");X(this,"_defaultBlockY");X(this,"_blockSize");X(this,"_maxBlockX");X(this,"_maxBlockY");X(this,"_defaultTowards")}setArgs(s,r,i,n,o,a,l,h,c){this._name=s,this._species=r,this._textures=i,this._defaultBlockX=n,this._defaultBlockY=o,this._blockSize=a,this._maxBlockX=l,this._maxBlockY=h,this._defaultTowards=c}async execute(){return await new Promise((s,r)=>{const i=new v1(this._species,this._name).createInstance(this._name,this._species,this._textures,this._defaultBlockX,this._defaultBlockY,this._blockSize,this._maxBlockX,this._maxBlockY,this._defaultTowards);i&&s(i),r(i)})}}class w1 extends qm{constructor(){super(...arguments);X(this,"_thing")}setArgs(s){this._thing=s}async execute(){return await new Promise(s=>{E1(this._thing),s()})}}class T1{async getThings(t){const s=[];for(const[{species:r,name:i},n]of t){const o=n.length;if(!o)break;const a=j.getSpriteAmountByName(i),l=j.getSpritesByName(i,Math.min(a,o));let h=[];Tt(l)||(h=l.value);let c=0;for(const u of h)u.setup({...n[c++]});if(a<o){const u=o-a,f=j.getAnimationTextures(r,i),p=new b1,d=tc(),{maxX:m,maxY:g}=j.getAppEdge();for(let y=0;y<u;y++){const E=n[c++];p.setArgs(i,r,f,E.defaultBlockX,E.defaultBlockY,d,m,g,E.defaultTowards),h.push(await p.execute())}}s.push(...h)}return s}async connectThingsToThingController(t){const s=new w1;for(const r of t)s.setArgs(r),await s.execute()}}const S1=()=>new T1,uc=kT(),j=wS();j.bindAppToScreenService(uc);const A1=S1();j.setSpriteBuilder(A1);const I1=MS();j.setContainerBuilder(I1);const C1=IS(uc.stage);j.setStageBuilder(C1);const R1={gameView:uc.view,startLevel:h1,pause:f1,resume:d1,setYouGoneOutsideHandler:c1,setGameOverOutsideHandler:u1},Y1=new Promise(e=>e(R1));export{$1 as A,M1 as B,V1 as C,G1 as D,F1 as E,gs as F,Y1 as G,Af as H,Km as I,z1 as J,j1 as K,D1 as L,W1 as M,Bd as a,N1 as b,k_ as c,Hg as d,a_ as e,Eh as f,ty as g,H1 as h,$n as i,Pi as j,Mi as k,X1 as l,k1 as m,Ah as n,N_ as o,I_ as p,ph as q,L1 as r,$g as s,ae as t,hd as u,O1 as v,Qg as w,B1 as x,$_ as y,U1 as z};
