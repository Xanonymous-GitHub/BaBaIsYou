var sp=Object.defineProperty;var ip=(e,t,s)=>t in e?sp(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s;var $=(e,t,s)=>(ip(e,typeof t!="symbol"?t+"":t,s),s);function Va(e,t){const s=Object.create(null),i=e.split(",");for(let r=0;r<i.length;r++)s[i[r]]=!0;return t?r=>!!s[r.toLowerCase()]:r=>!!s[r]}function Ya(e){if(mt(e)){const t={};for(let s=0;s<e.length;s++){const i=e[s],r=zt(i)?ap(i):Ya(i);if(r)for(const n in r)t[n]=r[n]}return t}else{if(zt(e))return e;if(Ut(e))return e}}const rp=/;(?![^(]*\))/g,np=/:([^]+)/,op=/\/\*.*?\*\//gs;function ap(e){const t={};return e.replace(op,"").split(rp).forEach(s=>{if(s){const i=s.split(np);i.length>1&&(t[i[0].trim()]=i[1].trim())}}),t}function Ka(e){let t="";if(zt(e))t=e;else if(mt(e))for(let s=0;s<e.length;s++){const i=Ka(e[s]);i&&(t+=i+" ")}else if(Ut(e))for(const s in e)e[s]&&(t+=s+" ");return t.trim()}const lp="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",hp=Va(lp);function Yc(e){return!!e||e===""}const CA=e=>zt(e)?e:e==null?"":mt(e)||Ut(e)&&(e.toString===Jc||!gt(e.toString))?JSON.stringify(e,Kc,2):String(e),Kc=(e,t)=>t&&t.__v_isRef?Kc(e,t.value):mi(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((s,[i,r])=>(s[`${i} =>`]=r,s),{})}:qc(t)?{[`Set(${t.size})`]:[...t.values()]}:Ut(t)&&!mt(t)&&!Qc(t)?String(t):t,Lt={},pi=[],Oe=()=>{},cp=()=>!1,up=/^on[^a-z]/,Fn=e=>up.test(e),qa=e=>e.startsWith("onUpdate:"),ne=Object.assign,Za=(e,t)=>{const s=e.indexOf(t);s>-1&&e.splice(s,1)},dp=Object.prototype.hasOwnProperty,wt=(e,t)=>dp.call(e,t),mt=Array.isArray,mi=e=>Ln(e)==="[object Map]",qc=e=>Ln(e)==="[object Set]",gt=e=>typeof e=="function",zt=e=>typeof e=="string",Ja=e=>typeof e=="symbol",Ut=e=>e!==null&&typeof e=="object",Zc=e=>Ut(e)&&gt(e.then)&&gt(e.catch),Jc=Object.prototype.toString,Ln=e=>Jc.call(e),fp=e=>Ln(e).slice(8,-1),Qc=e=>Ln(e)==="[object Object]",Qa=e=>zt(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,Jr=Va(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Nn=e=>{const t=Object.create(null);return s=>t[s]||(t[s]=e(s))},pp=/-(\w)/g,Ze=Nn(e=>e.replace(pp,(t,s)=>s?s.toUpperCase():"")),mp=/\B([A-Z])/g,Mi=Nn(e=>e.replace(mp,"-$1").toLowerCase()),Un=Nn(e=>e.charAt(0).toUpperCase()+e.slice(1)),lo=Nn(e=>e?`on${Un(e)}`:""),rr=(e,t)=>!Object.is(e,t),ho=(e,t)=>{for(let s=0;s<e.length;s++)e[s](t)},fn=(e,t,s)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:s})},tu=e=>{const t=parseFloat(e);return isNaN(t)?e:t};let $l;const gp=()=>$l||($l=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});let fe;class eu{constructor(t=!1){this.detached=t,this.active=!0,this.effects=[],this.cleanups=[],this.parent=fe,!t&&fe&&(this.index=(fe.scopes||(fe.scopes=[])).push(this)-1)}run(t){if(this.active){const s=fe;try{return fe=this,t()}finally{fe=s}}}on(){fe=this}off(){fe=this.parent}stop(t){if(this.active){let s,i;for(s=0,i=this.effects.length;s<i;s++)this.effects[s].stop();for(s=0,i=this.cleanups.length;s<i;s++)this.cleanups[s]();if(this.scopes)for(s=0,i=this.scopes.length;s<i;s++)this.scopes[s].stop(!0);if(!this.detached&&this.parent&&!t){const r=this.parent.scopes.pop();r&&r!==this&&(this.parent.scopes[this.index]=r,r.index=this.index)}this.parent=void 0,this.active=!1}}}function _p(e){return new eu(e)}function xp(e,t=fe){t&&t.active&&t.effects.push(e)}function vp(){return fe}function yp(e){fe&&fe.cleanups.push(e)}const tl=e=>{const t=new Set(e);return t.w=0,t.n=0,t},su=e=>(e.w&ws)>0,iu=e=>(e.n&ws)>0,Ep=({deps:e})=>{if(e.length)for(let t=0;t<e.length;t++)e[t].w|=ws},bp=e=>{const{deps:t}=e;if(t.length){let s=0;for(let i=0;i<t.length;i++){const r=t[i];su(r)&&!iu(r)?r.delete(e):t[s++]=r,r.w&=~ws,r.n&=~ws}t.length=s}},Yo=new WeakMap;let zi=0,ws=1;const Ko=30;let Re;const Xs=Symbol(""),qo=Symbol("");class el{constructor(t,s=null,i){this.fn=t,this.scheduler=s,this.active=!0,this.deps=[],this.parent=void 0,xp(this,i)}run(){if(!this.active)return this.fn();let t=Re,s=Es;for(;t;){if(t===this)return;t=t.parent}try{return this.parent=Re,Re=this,Es=!0,ws=1<<++zi,zi<=Ko?Ep(this):Xl(this),this.fn()}finally{zi<=Ko&&bp(this),ws=1<<--zi,Re=this.parent,Es=s,this.parent=void 0,this.deferStop&&this.stop()}}stop(){Re===this?this.deferStop=!0:this.active&&(Xl(this),this.onStop&&this.onStop(),this.active=!1)}}function Xl(e){const{deps:t}=e;if(t.length){for(let s=0;s<t.length;s++)t[s].delete(e);t.length=0}}let Es=!0;const ru=[];function Oi(){ru.push(Es),Es=!1}function Bi(){const e=ru.pop();Es=e===void 0?!0:e}function _e(e,t,s){if(Es&&Re){let i=Yo.get(e);i||Yo.set(e,i=new Map);let r=i.get(s);r||i.set(s,r=tl()),nu(r)}}function nu(e,t){let s=!1;zi<=Ko?iu(e)||(e.n|=ws,s=!su(e)):s=!e.has(Re),s&&(e.add(Re),Re.deps.push(e))}function hs(e,t,s,i,r,n){const o=Yo.get(e);if(!o)return;let a=[];if(t==="clear")a=[...o.values()];else if(s==="length"&&mt(e)){const l=tu(i);o.forEach((h,c)=>{(c==="length"||c>=l)&&a.push(h)})}else switch(s!==void 0&&a.push(o.get(s)),t){case"add":mt(e)?Qa(s)&&a.push(o.get("length")):(a.push(o.get(Xs)),mi(e)&&a.push(o.get(qo)));break;case"delete":mt(e)||(a.push(o.get(Xs)),mi(e)&&a.push(o.get(qo)));break;case"set":mi(e)&&a.push(o.get(Xs));break}if(a.length===1)a[0]&&Zo(a[0]);else{const l=[];for(const h of a)h&&l.push(...h);Zo(tl(l))}}function Zo(e,t){const s=mt(e)?e:[...e];for(const i of s)i.computed&&jl(i);for(const i of s)i.computed||jl(i)}function jl(e,t){(e!==Re||e.allowRecurse)&&(e.scheduler?e.scheduler():e.run())}const Tp=Va("__proto__,__v_isRef,__isVue"),ou=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(Ja)),wp=sl(),Sp=sl(!1,!0),Ap=sl(!0),zl=Cp();function Cp(){const e={};return["includes","indexOf","lastIndexOf"].forEach(t=>{e[t]=function(...s){const i=It(this);for(let n=0,o=this.length;n<o;n++)_e(i,"get",n+"");const r=i[t](...s);return r===-1||r===!1?i[t](...s.map(It)):r}}),["push","pop","shift","unshift","splice"].forEach(t=>{e[t]=function(...s){Oi();const i=It(this)[t].apply(this,s);return Bi(),i}}),e}function sl(e=!1,t=!1){return function(i,r,n){if(r==="__v_isReactive")return!e;if(r==="__v_isReadonly")return e;if(r==="__v_isShallow")return t;if(r==="__v_raw"&&n===(e?t?$p:uu:t?cu:hu).get(i))return i;const o=mt(i);if(!e&&o&&wt(zl,r))return Reflect.get(zl,r,n);const a=Reflect.get(i,r,n);return(Ja(r)?ou.has(r):Tp(r))||(e||_e(i,"get",r),t)?a:re(a)?o&&Qa(r)?a:a.value:Ut(a)?e?du(a):nl(a):a}}const Ip=au(),Rp=au(!0);function au(e=!1){return function(s,i,r,n){let o=s[i];if(Si(o)&&re(o)&&!re(r))return!1;if(!e&&(!pn(r)&&!Si(r)&&(o=It(o),r=It(r)),!mt(s)&&re(o)&&!re(r)))return o.value=r,!0;const a=mt(s)&&Qa(i)?Number(i)<s.length:wt(s,i),l=Reflect.set(s,i,r,n);return s===It(n)&&(a?rr(r,o)&&hs(s,"set",i,r):hs(s,"add",i,r)),l}}function Pp(e,t){const s=wt(e,t);e[t];const i=Reflect.deleteProperty(e,t);return i&&s&&hs(e,"delete",t,void 0),i}function Mp(e,t){const s=Reflect.has(e,t);return(!Ja(t)||!ou.has(t))&&_e(e,"has",t),s}function Op(e){return _e(e,"iterate",mt(e)?"length":Xs),Reflect.ownKeys(e)}const lu={get:wp,set:Ip,deleteProperty:Pp,has:Mp,ownKeys:Op},Bp={get:Ap,set(e,t){return!0},deleteProperty(e,t){return!0}},Dp=ne({},lu,{get:Sp,set:Rp}),il=e=>e,kn=e=>Reflect.getPrototypeOf(e);function wr(e,t,s=!1,i=!1){e=e.__v_raw;const r=It(e),n=It(t);s||(t!==n&&_e(r,"get",t),_e(r,"get",n));const{has:o}=kn(r),a=i?il:s?al:nr;if(o.call(r,t))return a(e.get(t));if(o.call(r,n))return a(e.get(n));e!==r&&e.get(t)}function Sr(e,t=!1){const s=this.__v_raw,i=It(s),r=It(e);return t||(e!==r&&_e(i,"has",e),_e(i,"has",r)),e===r?s.has(e):s.has(e)||s.has(r)}function Ar(e,t=!1){return e=e.__v_raw,!t&&_e(It(e),"iterate",Xs),Reflect.get(e,"size",e)}function Vl(e){e=It(e);const t=It(this);return kn(t).has.call(t,e)||(t.add(e),hs(t,"add",e,e)),this}function Yl(e,t){t=It(t);const s=It(this),{has:i,get:r}=kn(s);let n=i.call(s,e);n||(e=It(e),n=i.call(s,e));const o=r.call(s,e);return s.set(e,t),n?rr(t,o)&&hs(s,"set",e,t):hs(s,"add",e,t),this}function Kl(e){const t=It(this),{has:s,get:i}=kn(t);let r=s.call(t,e);r||(e=It(e),r=s.call(t,e)),i&&i.call(t,e);const n=t.delete(e);return r&&hs(t,"delete",e,void 0),n}function ql(){const e=It(this),t=e.size!==0,s=e.clear();return t&&hs(e,"clear",void 0,void 0),s}function Cr(e,t){return function(i,r){const n=this,o=n.__v_raw,a=It(o),l=t?il:e?al:nr;return!e&&_e(a,"iterate",Xs),o.forEach((h,c)=>i.call(r,l(h),l(c),n))}}function Ir(e,t,s){return function(...i){const r=this.__v_raw,n=It(r),o=mi(n),a=e==="entries"||e===Symbol.iterator&&o,l=e==="keys"&&o,h=r[e](...i),c=s?il:t?al:nr;return!t&&_e(n,"iterate",l?qo:Xs),{next(){const{value:u,done:d}=h.next();return d?{value:u,done:d}:{value:a?[c(u[0]),c(u[1])]:c(u),done:d}},[Symbol.iterator](){return this}}}}function ps(e){return function(...t){return e==="delete"?!1:this}}function Fp(){const e={get(n){return wr(this,n)},get size(){return Ar(this)},has:Sr,add:Vl,set:Yl,delete:Kl,clear:ql,forEach:Cr(!1,!1)},t={get(n){return wr(this,n,!1,!0)},get size(){return Ar(this)},has:Sr,add:Vl,set:Yl,delete:Kl,clear:ql,forEach:Cr(!1,!0)},s={get(n){return wr(this,n,!0)},get size(){return Ar(this,!0)},has(n){return Sr.call(this,n,!0)},add:ps("add"),set:ps("set"),delete:ps("delete"),clear:ps("clear"),forEach:Cr(!0,!1)},i={get(n){return wr(this,n,!0,!0)},get size(){return Ar(this,!0)},has(n){return Sr.call(this,n,!0)},add:ps("add"),set:ps("set"),delete:ps("delete"),clear:ps("clear"),forEach:Cr(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(n=>{e[n]=Ir(n,!1,!1),s[n]=Ir(n,!0,!1),t[n]=Ir(n,!1,!0),i[n]=Ir(n,!0,!0)}),[e,s,t,i]}const[Lp,Np,Up,kp]=Fp();function rl(e,t){const s=t?e?kp:Up:e?Np:Lp;return(i,r,n)=>r==="__v_isReactive"?!e:r==="__v_isReadonly"?e:r==="__v_raw"?i:Reflect.get(wt(s,r)&&r in i?s:i,r,n)}const Gp={get:rl(!1,!1)},Hp={get:rl(!1,!0)},Wp={get:rl(!0,!1)},hu=new WeakMap,cu=new WeakMap,uu=new WeakMap,$p=new WeakMap;function Xp(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function jp(e){return e.__v_skip||!Object.isExtensible(e)?0:Xp(fp(e))}function nl(e){return Si(e)?e:ol(e,!1,lu,Gp,hu)}function zp(e){return ol(e,!1,Dp,Hp,cu)}function du(e){return ol(e,!0,Bp,Wp,uu)}function ol(e,t,s,i,r){if(!Ut(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const n=r.get(e);if(n)return n;const o=jp(e);if(o===0)return e;const a=new Proxy(e,o===2?i:s);return r.set(e,a),a}function gi(e){return Si(e)?gi(e.__v_raw):!!(e&&e.__v_isReactive)}function Si(e){return!!(e&&e.__v_isReadonly)}function pn(e){return!!(e&&e.__v_isShallow)}function fu(e){return gi(e)||Si(e)}function It(e){const t=e&&e.__v_raw;return t?It(t):e}function pu(e){return fn(e,"__v_skip",!0),e}const nr=e=>Ut(e)?nl(e):e,al=e=>Ut(e)?du(e):e;function mu(e){Es&&Re&&(e=It(e),nu(e.dep||(e.dep=tl())))}function gu(e,t){e=It(e),e.dep&&Zo(e.dep)}function re(e){return!!(e&&e.__v_isRef===!0)}function tr(e){return _u(e,!1)}function Vp(e){return _u(e,!0)}function _u(e,t){return re(e)?e:new Yp(e,t)}class Yp{constructor(t,s){this.__v_isShallow=s,this.dep=void 0,this.__v_isRef=!0,this._rawValue=s?t:It(t),this._value=s?t:nr(t)}get value(){return mu(this),this._value}set value(t){const s=this.__v_isShallow||pn(t)||Si(t);t=s?t:It(t),rr(t,this._rawValue)&&(this._rawValue=t,this._value=s?t:nr(t),gu(this))}}function xu(e){return re(e)?e.value:e}const Kp={get:(e,t,s)=>xu(Reflect.get(e,t,s)),set:(e,t,s,i)=>{const r=e[t];return re(r)&&!re(s)?(r.value=s,!0):Reflect.set(e,t,s,i)}};function vu(e){return gi(e)?e:new Proxy(e,Kp)}var yu;class qp{constructor(t,s,i,r){this._setter=s,this.dep=void 0,this.__v_isRef=!0,this[yu]=!1,this._dirty=!0,this.effect=new el(t,()=>{this._dirty||(this._dirty=!0,gu(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!r,this.__v_isReadonly=i}get value(){const t=It(this);return mu(t),(t._dirty||!t._cacheable)&&(t._dirty=!1,t._value=t.effect.run()),t._value}set value(t){this._setter(t)}}yu="__v_isReadonly";function Zp(e,t,s=!1){let i,r;const n=gt(e);return n?(i=e,r=Oe):(i=e.get,r=e.set),new qp(i,r,n||!r,s)}function bs(e,t,s,i){let r;try{r=i?e(...i):e()}catch(n){xr(n,t,s)}return r}function Ee(e,t,s,i){if(gt(e)){const n=bs(e,t,s,i);return n&&Zc(n)&&n.catch(o=>{xr(o,t,s)}),n}const r=[];for(let n=0;n<e.length;n++)r.push(Ee(e[n],t,s,i));return r}function xr(e,t,s,i=!0){const r=t?t.vnode:null;if(t){let n=t.parent;const o=t.proxy,a=s;for(;n;){const h=n.ec;if(h){for(let c=0;c<h.length;c++)if(h[c](e,o,a)===!1)return}n=n.parent}const l=t.appContext.config.errorHandler;if(l){bs(l,null,10,[e,o,a]);return}}Jp(e,s,r,i)}function Jp(e,t,s,i=!0){console.error(e)}let or=!1,Jo=!1;const ie=[];let ze=0;const _i=[];let rs=null,ks=0;const Eu=Promise.resolve();let ll=null;function hl(e){const t=ll||Eu;return e?t.then(this?e.bind(this):e):t}function Qp(e){let t=ze+1,s=ie.length;for(;t<s;){const i=t+s>>>1;ar(ie[i])<e?t=i+1:s=i}return t}function Gn(e){(!ie.length||!ie.includes(e,or&&e.allowRecurse?ze+1:ze))&&(e.id==null?ie.push(e):ie.splice(Qp(e.id),0,e),bu())}function bu(){!or&&!Jo&&(Jo=!0,ll=Eu.then(wu))}function tm(e){const t=ie.indexOf(e);t>ze&&ie.splice(t,1)}function em(e){mt(e)?_i.push(...e):(!rs||!rs.includes(e,e.allowRecurse?ks+1:ks))&&_i.push(e),bu()}function Zl(e,t=or?ze+1:0){for(;t<ie.length;t++){const s=ie[t];s&&s.pre&&(ie.splice(t,1),t--,s())}}function Tu(e){if(_i.length){const t=[...new Set(_i)];if(_i.length=0,rs){rs.push(...t);return}for(rs=t,rs.sort((s,i)=>ar(s)-ar(i)),ks=0;ks<rs.length;ks++)rs[ks]();rs=null,ks=0}}const ar=e=>e.id==null?1/0:e.id,sm=(e,t)=>{const s=ar(e)-ar(t);if(s===0){if(e.pre&&!t.pre)return-1;if(t.pre&&!e.pre)return 1}return s};function wu(e){Jo=!1,or=!0,ie.sort(sm);const t=Oe;try{for(ze=0;ze<ie.length;ze++){const s=ie[ze];s&&s.active!==!1&&bs(s,null,14)}}finally{ze=0,ie.length=0,Tu(),or=!1,ll=null,(ie.length||_i.length)&&wu()}}function im(e,t,...s){if(e.isUnmounted)return;const i=e.vnode.props||Lt;let r=s;const n=t.startsWith("update:"),o=n&&t.slice(7);if(o&&o in i){const c=`${o==="modelValue"?"model":o}Modifiers`,{number:u,trim:d}=i[c]||Lt;d&&(r=s.map(p=>zt(p)?p.trim():p)),u&&(r=s.map(tu))}let a,l=i[a=lo(t)]||i[a=lo(Ze(t))];!l&&n&&(l=i[a=lo(Mi(t))]),l&&Ee(l,e,6,r);const h=i[a+"Once"];if(h){if(!e.emitted)e.emitted={};else if(e.emitted[a])return;e.emitted[a]=!0,Ee(h,e,6,r)}}function Su(e,t,s=!1){const i=t.emitsCache,r=i.get(e);if(r!==void 0)return r;const n=e.emits;let o={},a=!1;if(!gt(e)){const l=h=>{const c=Su(h,t,!0);c&&(a=!0,ne(o,c))};!s&&t.mixins.length&&t.mixins.forEach(l),e.extends&&l(e.extends),e.mixins&&e.mixins.forEach(l)}return!n&&!a?(Ut(e)&&i.set(e,null),null):(mt(n)?n.forEach(l=>o[l]=null):ne(o,n),Ut(e)&&i.set(e,o),o)}function Hn(e,t){return!e||!Fn(t)?!1:(t=t.slice(2).replace(/Once$/,""),wt(e,t[0].toLowerCase()+t.slice(1))||wt(e,Mi(t))||wt(e,t))}let ge=null,Wn=null;function mn(e){const t=ge;return ge=e,Wn=e&&e.type.__scopeId||null,t}function IA(e){Wn=e}function RA(){Wn=null}function rm(e,t=ge,s){if(!t||e._n)return e;const i=(...r)=>{i._d&&ah(-1);const n=mn(t);let o;try{o=e(...r)}finally{mn(n),i._d&&ah(1)}return o};return i._n=!0,i._c=!0,i._d=!0,i}function co(e){const{type:t,vnode:s,proxy:i,withProxy:r,props:n,propsOptions:[o],slots:a,attrs:l,emit:h,render:c,renderCache:u,data:d,setupState:p,ctx:f,inheritAttrs:m}=e;let _,v;const T=mn(e);try{if(s.shapeFlag&4){const b=r||i;_=We(c.call(b,b,u,n,p,d,f)),v=l}else{const b=t;_=We(b.length>1?b(n,{attrs:l,slots:a,emit:h}):b(n,null)),v=t.props?l:nm(l)}}catch(b){ir.length=0,xr(b,e,1),_=ee(Be)}let g=_;if(v&&m!==!1){const b=Object.keys(v),{shapeFlag:S}=g;b.length&&S&7&&(o&&b.some(qa)&&(v=om(v,o)),g=Ss(g,v))}return s.dirs&&(g=Ss(g),g.dirs=g.dirs?g.dirs.concat(s.dirs):s.dirs),s.transition&&(g.transition=s.transition),_=g,mn(T),_}const nm=e=>{let t;for(const s in e)(s==="class"||s==="style"||Fn(s))&&((t||(t={}))[s]=e[s]);return t},om=(e,t)=>{const s={};for(const i in e)(!qa(i)||!(i.slice(9)in t))&&(s[i]=e[i]);return s};function am(e,t,s){const{props:i,children:r,component:n}=e,{props:o,children:a,patchFlag:l}=t,h=n.emitsOptions;if(t.dirs||t.transition)return!0;if(s&&l>=0){if(l&1024)return!0;if(l&16)return i?Jl(i,o,h):!!o;if(l&8){const c=t.dynamicProps;for(let u=0;u<c.length;u++){const d=c[u];if(o[d]!==i[d]&&!Hn(h,d))return!0}}}else return(r||a)&&(!a||!a.$stable)?!0:i===o?!1:i?o?Jl(i,o,h):!0:!!o;return!1}function Jl(e,t,s){const i=Object.keys(t);if(i.length!==Object.keys(e).length)return!0;for(let r=0;r<i.length;r++){const n=i[r];if(t[n]!==e[n]&&!Hn(s,n))return!0}return!1}function lm({vnode:e,parent:t},s){for(;t&&t.subTree===e;)(e=t.vnode).el=s,t=t.parent}const hm=e=>e.__isSuspense;function cm(e,t){t&&t.pendingBranch?mt(e)?t.effects.push(...e):t.effects.push(e):em(e)}function um(e,t){if(Yt){let s=Yt.provides;const i=Yt.parent&&Yt.parent.provides;i===s&&(s=Yt.provides=Object.create(i)),s[e]=t}}function Qr(e,t,s=!1){const i=Yt||ge;if(i){const r=i.parent==null?i.vnode.appContext&&i.vnode.appContext.provides:i.parent.provides;if(r&&e in r)return r[e];if(arguments.length>1)return s&&gt(t)?t.call(i.proxy):t}}const Rr={};function er(e,t,s){return Au(e,t,s)}function Au(e,t,{immediate:s,deep:i,flush:r,onTrack:n,onTrigger:o}=Lt){const a=Yt;let l,h=!1,c=!1;if(re(e)?(l=()=>e.value,h=pn(e)):gi(e)?(l=()=>e,i=!0):mt(e)?(c=!0,h=e.some(g=>gi(g)||pn(g)),l=()=>e.map(g=>{if(re(g))return g.value;if(gi(g))return Ws(g);if(gt(g))return bs(g,a,2)})):gt(e)?t?l=()=>bs(e,a,2):l=()=>{if(!(a&&a.isUnmounted))return u&&u(),Ee(e,a,3,[d])}:l=Oe,t&&i){const g=l;l=()=>Ws(g())}let u,d=g=>{u=v.onStop=()=>{bs(g,a,4)}},p;if(Ci)if(d=Oe,t?s&&Ee(t,a,3,[l(),c?[]:void 0,d]):l(),r==="sync"){const g=lg();p=g.__watcherHandles||(g.__watcherHandles=[])}else return Oe;let f=c?new Array(e.length).fill(Rr):Rr;const m=()=>{if(v.active)if(t){const g=v.run();(i||h||(c?g.some((b,S)=>rr(b,f[S])):rr(g,f)))&&(u&&u(),Ee(t,a,3,[g,f===Rr?void 0:c&&f[0]===Rr?[]:f,d]),f=g)}else v.run()};m.allowRecurse=!!t;let _;r==="sync"?_=m:r==="post"?_=()=>le(m,a&&a.suspense):(m.pre=!0,a&&(m.id=a.uid),_=()=>Gn(m));const v=new el(l,_);t?s?m():f=v.run():r==="post"?le(v.run.bind(v),a&&a.suspense):v.run();const T=()=>{v.stop(),a&&a.scope&&Za(a.scope.effects,v)};return p&&p.push(T),T}function dm(e,t,s){const i=this.proxy,r=zt(e)?e.includes(".")?Cu(i,e):()=>i[e]:e.bind(i,i);let n;gt(t)?n=t:(n=t.handler,s=t);const o=Yt;Ai(this);const a=Au(r,n.bind(i),s);return o?Ai(o):js(),a}function Cu(e,t){const s=t.split(".");return()=>{let i=e;for(let r=0;r<s.length&&i;r++)i=i[s[r]];return i}}function Ws(e,t){if(!Ut(e)||e.__v_skip||(t=t||new Set,t.has(e)))return e;if(t.add(e),re(e))Ws(e.value,t);else if(mt(e))for(let s=0;s<e.length;s++)Ws(e[s],t);else if(qc(e)||mi(e))e.forEach(s=>{Ws(s,t)});else if(Qc(e))for(const s in e)Ws(e[s],t);return e}function fm(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return cl(()=>{e.isMounted=!0}),Mu(()=>{e.isUnmounting=!0}),e}const xe=[Function,Array],pm={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:xe,onEnter:xe,onAfterEnter:xe,onEnterCancelled:xe,onBeforeLeave:xe,onLeave:xe,onAfterLeave:xe,onLeaveCancelled:xe,onBeforeAppear:xe,onAppear:xe,onAfterAppear:xe,onAppearCancelled:xe},setup(e,{slots:t}){const s=zu(),i=fm();let r;return()=>{const n=t.default&&Ru(t.default(),!0);if(!n||!n.length)return;let o=n[0];if(n.length>1){for(const m of n)if(m.type!==Be){o=m;break}}const a=It(e),{mode:l}=a;if(i.isLeaving)return uo(o);const h=Ql(o);if(!h)return uo(o);const c=Qo(h,a,i,s);ta(h,c);const u=s.subTree,d=u&&Ql(u);let p=!1;const{getTransitionKey:f}=h.type;if(f){const m=f();r===void 0?r=m:m!==r&&(r=m,p=!0)}if(d&&d.type!==Be&&(!Gs(h,d)||p)){const m=Qo(d,a,i,s);if(ta(d,m),l==="out-in")return i.isLeaving=!0,m.afterLeave=()=>{i.isLeaving=!1,s.update.active!==!1&&s.update()},uo(o);l==="in-out"&&h.type!==Be&&(m.delayLeave=(_,v,T)=>{const g=Iu(i,d);g[String(d.key)]=d,_._leaveCb=()=>{v(),_._leaveCb=void 0,delete c.delayedLeave},c.delayedLeave=T})}return o}}},mm=pm;function Iu(e,t){const{leavingVNodes:s}=e;let i=s.get(t.type);return i||(i=Object.create(null),s.set(t.type,i)),i}function Qo(e,t,s,i){const{appear:r,mode:n,persisted:o=!1,onBeforeEnter:a,onEnter:l,onAfterEnter:h,onEnterCancelled:c,onBeforeLeave:u,onLeave:d,onAfterLeave:p,onLeaveCancelled:f,onBeforeAppear:m,onAppear:_,onAfterAppear:v,onAppearCancelled:T}=t,g=String(e.key),b=Iu(s,e),S=(E,I)=>{E&&Ee(E,i,9,I)},A=(E,I)=>{const F=I[1];S(E,I),mt(E)?E.every(L=>L.length<=1)&&F():E.length<=1&&F()},y={mode:n,persisted:o,beforeEnter(E){let I=a;if(!s.isMounted)if(r)I=m||a;else return;E._leaveCb&&E._leaveCb(!0);const F=b[g];F&&Gs(e,F)&&F.el._leaveCb&&F.el._leaveCb(),S(I,[E])},enter(E){let I=l,F=h,L=c;if(!s.isMounted)if(r)I=_||l,F=v||h,L=T||c;else return;let j=!1;const D=E._enterCb=P=>{j||(j=!0,P?S(L,[E]):S(F,[E]),y.delayedLeave&&y.delayedLeave(),E._enterCb=void 0)};I?A(I,[E,D]):D()},leave(E,I){const F=String(e.key);if(E._enterCb&&E._enterCb(!0),s.isUnmounting)return I();S(u,[E]);let L=!1;const j=E._leaveCb=D=>{L||(L=!0,I(),D?S(f,[E]):S(p,[E]),E._leaveCb=void 0,b[F]===e&&delete b[F])};b[F]=e,d?A(d,[E,j]):j()},clone(E){return Qo(E,t,s,i)}};return y}function uo(e){if(vr(e))return e=Ss(e),e.children=null,e}function Ql(e){return vr(e)?e.children?e.children[0]:void 0:e}function ta(e,t){e.shapeFlag&6&&e.component?ta(e.component.subTree,t):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function Ru(e,t=!1,s){let i=[],r=0;for(let n=0;n<e.length;n++){let o=e[n];const a=s==null?o.key:String(s)+String(o.key!=null?o.key:n);o.type===He?(o.patchFlag&128&&r++,i=i.concat(Ru(o.children,t,a))):(t||o.type!==Be)&&i.push(a!=null?Ss(o,{key:a}):o)}if(r>1)for(let n=0;n<i.length;n++)i[n].patchFlag=-2;return i}function gm(e){return gt(e)?{setup:e,name:e.name}:e}const tn=e=>!!e.type.__asyncLoader;function PA(e){gt(e)&&(e={loader:e});const{loader:t,loadingComponent:s,errorComponent:i,delay:r=200,timeout:n,suspensible:o=!0,onError:a}=e;let l=null,h,c=0;const u=()=>(c++,l=null,d()),d=()=>{let p;return l||(p=l=t().catch(f=>{if(f=f instanceof Error?f:new Error(String(f)),a)return new Promise((m,_)=>{a(f,()=>m(u()),()=>_(f),c+1)});throw f}).then(f=>p!==l&&l?l:(f&&(f.__esModule||f[Symbol.toStringTag]==="Module")&&(f=f.default),h=f,f)))};return gm({name:"AsyncComponentWrapper",__asyncLoader:d,get __asyncResolved(){return h},setup(){const p=Yt;if(h)return()=>fo(h,p);const f=T=>{l=null,xr(T,p,13,!i)};if(o&&p.suspense||Ci)return d().then(T=>()=>fo(T,p)).catch(T=>(f(T),()=>i?ee(i,{error:T}):null));const m=tr(!1),_=tr(),v=tr(!!r);return r&&setTimeout(()=>{v.value=!1},r),n!=null&&setTimeout(()=>{if(!m.value&&!_.value){const T=new Error(`Async component timed out after ${n}ms.`);f(T),_.value=T}},n),d().then(()=>{m.value=!0,p.parent&&vr(p.parent.vnode)&&Gn(p.parent.update)}).catch(T=>{f(T),_.value=T}),()=>{if(m.value&&h)return fo(h,p);if(_.value&&i)return ee(i,{error:_.value});if(s&&!v.value)return ee(s)}}})}function fo(e,t){const{ref:s,props:i,children:r,ce:n}=t.vnode,o=ee(e,i,r);return o.ref=s,o.ce=n,delete t.vnode.ce,o}const vr=e=>e.type.__isKeepAlive;function _m(e,t){Pu(e,"a",t)}function xm(e,t){Pu(e,"da",t)}function Pu(e,t,s=Yt){const i=e.__wdc||(e.__wdc=()=>{let r=s;for(;r;){if(r.isDeactivated)return;r=r.parent}return e()});if($n(t,i,s),s){let r=s.parent;for(;r&&r.parent;)vr(r.parent.vnode)&&vm(i,t,s,r),r=r.parent}}function vm(e,t,s,i){const r=$n(t,e,i,!0);Ou(()=>{Za(i[t],r)},s)}function $n(e,t,s=Yt,i=!1){if(s){const r=s[e]||(s[e]=[]),n=t.__weh||(t.__weh=(...o)=>{if(s.isUnmounted)return;Oi(),Ai(s);const a=Ee(t,s,e,o);return js(),Bi(),a});return i?r.unshift(n):r.push(n),n}}const cs=e=>(t,s=Yt)=>(!Ci||e==="sp")&&$n(e,(...i)=>t(...i),s),ym=cs("bm"),cl=cs("m"),Em=cs("bu"),bm=cs("u"),Mu=cs("bum"),Ou=cs("um"),Tm=cs("sp"),wm=cs("rtg"),Sm=cs("rtc");function Am(e,t=Yt){$n("ec",e,t)}function MA(e,t){const s=ge;if(s===null)return e;const i=zn(s)||s.proxy,r=e.dirs||(e.dirs=[]);for(let n=0;n<t.length;n++){let[o,a,l,h=Lt]=t[n];o&&(gt(o)&&(o={mounted:o,updated:o}),o.deep&&Ws(a),r.push({dir:o,instance:i,value:a,oldValue:void 0,arg:l,modifiers:h}))}return e}function Ps(e,t,s,i){const r=e.dirs,n=t&&t.dirs;for(let o=0;o<r.length;o++){const a=r[o];n&&(a.oldValue=n[o].value);let l=a.dir[i];l&&(Oi(),Ee(l,s,8,[e.el,a,e,t]),Bi())}}const ul="components";function OA(e,t){return Du(ul,e,!0,t)||e}const Bu=Symbol();function BA(e){return zt(e)?Du(ul,e,!1)||e:e||Bu}function Du(e,t,s=!0,i=!1){const r=ge||Yt;if(r){const n=r.type;if(e===ul){const a=rg(n,!1);if(a&&(a===t||a===Ze(t)||a===Un(Ze(t))))return n}const o=th(r[e]||n[e],t)||th(r.appContext[e],t);return!o&&i?n:o}}function th(e,t){return e&&(e[t]||e[Ze(t)]||e[Un(Ze(t))])}function DA(e,t,s,i){let r;const n=s&&s[i];if(mt(e)||zt(e)){r=new Array(e.length);for(let o=0,a=e.length;o<a;o++)r[o]=t(e[o],o,void 0,n&&n[o])}else if(typeof e=="number"){r=new Array(e);for(let o=0;o<e;o++)r[o]=t(o+1,o,void 0,n&&n[o])}else if(Ut(e))if(e[Symbol.iterator])r=Array.from(e,(o,a)=>t(o,a,void 0,n&&n[a]));else{const o=Object.keys(e);r=new Array(o.length);for(let a=0,l=o.length;a<l;a++){const h=o[a];r[a]=t(e[h],h,a,n&&n[a])}}else r=[];return s&&(s[i]=r),r}const ea=e=>e?Vu(e)?zn(e)||e.proxy:ea(e.parent):null,sr=ne(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>ea(e.parent),$root:e=>ea(e.root),$emit:e=>e.emit,$options:e=>dl(e),$forceUpdate:e=>e.f||(e.f=()=>Gn(e.update)),$nextTick:e=>e.n||(e.n=hl.bind(e.proxy)),$watch:e=>dm.bind(e)}),po=(e,t)=>e!==Lt&&!e.__isScriptSetup&&wt(e,t),Cm={get({_:e},t){const{ctx:s,setupState:i,data:r,props:n,accessCache:o,type:a,appContext:l}=e;let h;if(t[0]!=="$"){const p=o[t];if(p!==void 0)switch(p){case 1:return i[t];case 2:return r[t];case 4:return s[t];case 3:return n[t]}else{if(po(i,t))return o[t]=1,i[t];if(r!==Lt&&wt(r,t))return o[t]=2,r[t];if((h=e.propsOptions[0])&&wt(h,t))return o[t]=3,n[t];if(s!==Lt&&wt(s,t))return o[t]=4,s[t];sa&&(o[t]=0)}}const c=sr[t];let u,d;if(c)return t==="$attrs"&&_e(e,"get",t),c(e);if((u=a.__cssModules)&&(u=u[t]))return u;if(s!==Lt&&wt(s,t))return o[t]=4,s[t];if(d=l.config.globalProperties,wt(d,t))return d[t]},set({_:e},t,s){const{data:i,setupState:r,ctx:n}=e;return po(r,t)?(r[t]=s,!0):i!==Lt&&wt(i,t)?(i[t]=s,!0):wt(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(n[t]=s,!0)},has({_:{data:e,setupState:t,accessCache:s,ctx:i,appContext:r,propsOptions:n}},o){let a;return!!s[o]||e!==Lt&&wt(e,o)||po(t,o)||(a=n[0])&&wt(a,o)||wt(i,o)||wt(sr,o)||wt(r.config.globalProperties,o)},defineProperty(e,t,s){return s.get!=null?e._.accessCache[t]=0:wt(s,"value")&&this.set(e,t,s.value,null),Reflect.defineProperty(e,t,s)}};let sa=!0;function Im(e){const t=dl(e),s=e.proxy,i=e.ctx;sa=!1,t.beforeCreate&&eh(t.beforeCreate,e,"bc");const{data:r,computed:n,methods:o,watch:a,provide:l,inject:h,created:c,beforeMount:u,mounted:d,beforeUpdate:p,updated:f,activated:m,deactivated:_,beforeDestroy:v,beforeUnmount:T,destroyed:g,unmounted:b,render:S,renderTracked:A,renderTriggered:y,errorCaptured:E,serverPrefetch:I,expose:F,inheritAttrs:L,components:j,directives:D,filters:P}=t;if(h&&Rm(h,i,null,e.appContext.config.unwrapInjectedRef),o)for(const G in o){const st=o[G];gt(st)&&(i[G]=st.bind(s))}if(r){const G=r.call(s,s);Ut(G)&&(e.data=nl(G))}if(sa=!0,n)for(const G in n){const st=n[G],At=gt(st)?st.bind(s,s):gt(st.get)?st.get.bind(s,s):Oe,N=!gt(st)&&gt(st.set)?st.set.bind(s):Oe,U=og({get:At,set:N});Object.defineProperty(i,G,{enumerable:!0,configurable:!0,get:()=>U.value,set:Y=>U.value=Y})}if(a)for(const G in a)Fu(a[G],i,s,G);if(l){const G=gt(l)?l.call(s):l;Reflect.ownKeys(G).forEach(st=>{um(st,G[st])})}c&&eh(c,e,"c");function nt(G,st){mt(st)?st.forEach(At=>G(At.bind(s))):st&&G(st.bind(s))}if(nt(ym,u),nt(cl,d),nt(Em,p),nt(bm,f),nt(_m,m),nt(xm,_),nt(Am,E),nt(Sm,A),nt(wm,y),nt(Mu,T),nt(Ou,b),nt(Tm,I),mt(F))if(F.length){const G=e.exposed||(e.exposed={});F.forEach(st=>{Object.defineProperty(G,st,{get:()=>s[st],set:At=>s[st]=At})})}else e.exposed||(e.exposed={});S&&e.render===Oe&&(e.render=S),L!=null&&(e.inheritAttrs=L),j&&(e.components=j),D&&(e.directives=D)}function Rm(e,t,s=Oe,i=!1){mt(e)&&(e=ia(e));for(const r in e){const n=e[r];let o;Ut(n)?"default"in n?o=Qr(n.from||r,n.default,!0):o=Qr(n.from||r):o=Qr(n),re(o)&&i?Object.defineProperty(t,r,{enumerable:!0,configurable:!0,get:()=>o.value,set:a=>o.value=a}):t[r]=o}}function eh(e,t,s){Ee(mt(e)?e.map(i=>i.bind(t.proxy)):e.bind(t.proxy),t,s)}function Fu(e,t,s,i){const r=i.includes(".")?Cu(s,i):()=>s[i];if(zt(e)){const n=t[e];gt(n)&&er(r,n)}else if(gt(e))er(r,e.bind(s));else if(Ut(e))if(mt(e))e.forEach(n=>Fu(n,t,s,i));else{const n=gt(e.handler)?e.handler.bind(s):t[e.handler];gt(n)&&er(r,n,e)}}function dl(e){const t=e.type,{mixins:s,extends:i}=t,{mixins:r,optionsCache:n,config:{optionMergeStrategies:o}}=e.appContext,a=n.get(t);let l;return a?l=a:!r.length&&!s&&!i?l=t:(l={},r.length&&r.forEach(h=>gn(l,h,o,!0)),gn(l,t,o)),Ut(t)&&n.set(t,l),l}function gn(e,t,s,i=!1){const{mixins:r,extends:n}=t;n&&gn(e,n,s,!0),r&&r.forEach(o=>gn(e,o,s,!0));for(const o in t)if(!(i&&o==="expose")){const a=Pm[o]||s&&s[o];e[o]=a?a(e[o],t[o]):t[o]}return e}const Pm={data:sh,props:Ds,emits:Ds,methods:Ds,computed:Ds,beforeCreate:oe,created:oe,beforeMount:oe,mounted:oe,beforeUpdate:oe,updated:oe,beforeDestroy:oe,beforeUnmount:oe,destroyed:oe,unmounted:oe,activated:oe,deactivated:oe,errorCaptured:oe,serverPrefetch:oe,components:Ds,directives:Ds,watch:Om,provide:sh,inject:Mm};function sh(e,t){return t?e?function(){return ne(gt(e)?e.call(this,this):e,gt(t)?t.call(this,this):t)}:t:e}function Mm(e,t){return Ds(ia(e),ia(t))}function ia(e){if(mt(e)){const t={};for(let s=0;s<e.length;s++)t[e[s]]=e[s];return t}return e}function oe(e,t){return e?[...new Set([].concat(e,t))]:t}function Ds(e,t){return e?ne(ne(Object.create(null),e),t):t}function Om(e,t){if(!e)return t;if(!t)return e;const s=ne(Object.create(null),e);for(const i in t)s[i]=oe(e[i],t[i]);return s}function Bm(e,t,s,i=!1){const r={},n={};fn(n,jn,1),e.propsDefaults=Object.create(null),Lu(e,t,r,n);for(const o in e.propsOptions[0])o in r||(r[o]=void 0);s?e.props=i?r:zp(r):e.type.props?e.props=r:e.props=n,e.attrs=n}function Dm(e,t,s,i){const{props:r,attrs:n,vnode:{patchFlag:o}}=e,a=It(r),[l]=e.propsOptions;let h=!1;if((i||o>0)&&!(o&16)){if(o&8){const c=e.vnode.dynamicProps;for(let u=0;u<c.length;u++){let d=c[u];if(Hn(e.emitsOptions,d))continue;const p=t[d];if(l)if(wt(n,d))p!==n[d]&&(n[d]=p,h=!0);else{const f=Ze(d);r[f]=ra(l,a,f,p,e,!1)}else p!==n[d]&&(n[d]=p,h=!0)}}}else{Lu(e,t,r,n)&&(h=!0);let c;for(const u in a)(!t||!wt(t,u)&&((c=Mi(u))===u||!wt(t,c)))&&(l?s&&(s[u]!==void 0||s[c]!==void 0)&&(r[u]=ra(l,a,u,void 0,e,!0)):delete r[u]);if(n!==a)for(const u in n)(!t||!wt(t,u))&&(delete n[u],h=!0)}h&&hs(e,"set","$attrs")}function Lu(e,t,s,i){const[r,n]=e.propsOptions;let o=!1,a;if(t)for(let l in t){if(Jr(l))continue;const h=t[l];let c;r&&wt(r,c=Ze(l))?!n||!n.includes(c)?s[c]=h:(a||(a={}))[c]=h:Hn(e.emitsOptions,l)||(!(l in i)||h!==i[l])&&(i[l]=h,o=!0)}if(n){const l=It(s),h=a||Lt;for(let c=0;c<n.length;c++){const u=n[c];s[u]=ra(r,l,u,h[u],e,!wt(h,u))}}return o}function ra(e,t,s,i,r,n){const o=e[s];if(o!=null){const a=wt(o,"default");if(a&&i===void 0){const l=o.default;if(o.type!==Function&&gt(l)){const{propsDefaults:h}=r;s in h?i=h[s]:(Ai(r),i=h[s]=l.call(null,t),js())}else i=l}o[0]&&(n&&!a?i=!1:o[1]&&(i===""||i===Mi(s))&&(i=!0))}return i}function Nu(e,t,s=!1){const i=t.propsCache,r=i.get(e);if(r)return r;const n=e.props,o={},a=[];let l=!1;if(!gt(e)){const c=u=>{l=!0;const[d,p]=Nu(u,t,!0);ne(o,d),p&&a.push(...p)};!s&&t.mixins.length&&t.mixins.forEach(c),e.extends&&c(e.extends),e.mixins&&e.mixins.forEach(c)}if(!n&&!l)return Ut(e)&&i.set(e,pi),pi;if(mt(n))for(let c=0;c<n.length;c++){const u=Ze(n[c]);ih(u)&&(o[u]=Lt)}else if(n)for(const c in n){const u=Ze(c);if(ih(u)){const d=n[c],p=o[u]=mt(d)||gt(d)?{type:d}:Object.assign({},d);if(p){const f=oh(Boolean,p.type),m=oh(String,p.type);p[0]=f>-1,p[1]=m<0||f<m,(f>-1||wt(p,"default"))&&a.push(u)}}}const h=[o,a];return Ut(e)&&i.set(e,h),h}function ih(e){return e[0]!=="$"}function rh(e){const t=e&&e.toString().match(/^\s*function (\w+)/);return t?t[1]:e===null?"null":""}function nh(e,t){return rh(e)===rh(t)}function oh(e,t){return mt(t)?t.findIndex(s=>nh(s,e)):gt(t)&&nh(t,e)?0:-1}const Uu=e=>e[0]==="_"||e==="$stable",fl=e=>mt(e)?e.map(We):[We(e)],Fm=(e,t,s)=>{if(t._n)return t;const i=rm((...r)=>fl(t(...r)),s);return i._c=!1,i},ku=(e,t,s)=>{const i=e._ctx;for(const r in e){if(Uu(r))continue;const n=e[r];if(gt(n))t[r]=Fm(r,n,i);else if(n!=null){const o=fl(n);t[r]=()=>o}}},Gu=(e,t)=>{const s=fl(t);e.slots.default=()=>s},Lm=(e,t)=>{if(e.vnode.shapeFlag&32){const s=t._;s?(e.slots=It(t),fn(t,"_",s)):ku(t,e.slots={})}else e.slots={},t&&Gu(e,t);fn(e.slots,jn,1)},Nm=(e,t,s)=>{const{vnode:i,slots:r}=e;let n=!0,o=Lt;if(i.shapeFlag&32){const a=t._;a?s&&a===1?n=!1:(ne(r,t),!s&&a===1&&delete r._):(n=!t.$stable,ku(t,r)),o=t}else t&&(Gu(e,t),o={default:1});if(n)for(const a in r)!Uu(a)&&!(a in o)&&delete r[a]};function Hu(){return{app:null,config:{isNativeTag:cp,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Um=0;function km(e,t){return function(i,r=null){gt(i)||(i=Object.assign({},i)),r!=null&&!Ut(r)&&(r=null);const n=Hu(),o=new Set;let a=!1;const l=n.app={_uid:Um++,_component:i,_props:r,_container:null,_context:n,_instance:null,version:hg,get config(){return n.config},set config(h){},use(h,...c){return o.has(h)||(h&&gt(h.install)?(o.add(h),h.install(l,...c)):gt(h)&&(o.add(h),h(l,...c))),l},mixin(h){return n.mixins.includes(h)||n.mixins.push(h),l},component(h,c){return c?(n.components[h]=c,l):n.components[h]},directive(h,c){return c?(n.directives[h]=c,l):n.directives[h]},mount(h,c,u){if(!a){const d=ee(i,r);return d.appContext=n,c&&t?t(d,h):e(d,h,u),a=!0,l._container=h,h.__vue_app__=l,zn(d.component)||d.component.proxy}},unmount(){a&&(e(null,l._container),delete l._container.__vue_app__)},provide(h,c){return n.provides[h]=c,l}};return l}}function na(e,t,s,i,r=!1){if(mt(e)){e.forEach((d,p)=>na(d,t&&(mt(t)?t[p]:t),s,i,r));return}if(tn(i)&&!r)return;const n=i.shapeFlag&4?zn(i.component)||i.component.proxy:i.el,o=r?null:n,{i:a,r:l}=e,h=t&&t.r,c=a.refs===Lt?a.refs={}:a.refs,u=a.setupState;if(h!=null&&h!==l&&(zt(h)?(c[h]=null,wt(u,h)&&(u[h]=null)):re(h)&&(h.value=null)),gt(l))bs(l,a,12,[o,c]);else{const d=zt(l),p=re(l);if(d||p){const f=()=>{if(e.f){const m=d?wt(u,l)?u[l]:c[l]:l.value;r?mt(m)&&Za(m,n):mt(m)?m.includes(n)||m.push(n):d?(c[l]=[n],wt(u,l)&&(u[l]=c[l])):(l.value=[n],e.k&&(c[e.k]=l.value))}else d?(c[l]=o,wt(u,l)&&(u[l]=o)):p&&(l.value=o,e.k&&(c[e.k]=o))};o?(f.id=-1,le(f,s)):f()}}}const le=cm;function Gm(e){return Hm(e)}function Hm(e,t){const s=gp();s.__VUE__=!0;const{insert:i,remove:r,patchProp:n,createElement:o,createText:a,createComment:l,setText:h,setElementText:c,parentNode:u,nextSibling:d,setScopeId:p=Oe,insertStaticContent:f}=e,m=(x,w,C,M=null,B=null,W=null,Z=!1,H=null,z=!!w.dynamicChildren)=>{if(x===w)return;x&&!Gs(x,w)&&(M=ht(x),Y(x,B,W,!0),x=null),w.patchFlag===-2&&(z=!1,w.dynamicChildren=null);const{type:k,ref:ot,shapeFlag:tt}=w;switch(k){case Xn:_(x,w,C,M);break;case Be:v(x,w,C,M);break;case mo:x==null&&T(w,C,M,Z);break;case He:j(x,w,C,M,B,W,Z,H,z);break;default:tt&1?S(x,w,C,M,B,W,Z,H,z):tt&6?D(x,w,C,M,B,W,Z,H,z):(tt&64||tt&128)&&k.process(x,w,C,M,B,W,Z,H,z,Bt)}ot!=null&&B&&na(ot,x&&x.ref,W,w||x,!w)},_=(x,w,C,M)=>{if(x==null)i(w.el=a(w.children),C,M);else{const B=w.el=x.el;w.children!==x.children&&h(B,w.children)}},v=(x,w,C,M)=>{x==null?i(w.el=l(w.children||""),C,M):w.el=x.el},T=(x,w,C,M)=>{[x.el,x.anchor]=f(x.children,w,C,M,x.el,x.anchor)},g=({el:x,anchor:w},C,M)=>{let B;for(;x&&x!==w;)B=d(x),i(x,C,M),x=B;i(w,C,M)},b=({el:x,anchor:w})=>{let C;for(;x&&x!==w;)C=d(x),r(x),x=C;r(w)},S=(x,w,C,M,B,W,Z,H,z)=>{Z=Z||w.type==="svg",x==null?A(w,C,M,B,W,Z,H,z):I(x,w,B,W,Z,H,z)},A=(x,w,C,M,B,W,Z,H)=>{let z,k;const{type:ot,props:tt,shapeFlag:at,transition:ft,dirs:vt}=x;if(z=x.el=o(x.type,W,tt&&tt.is,tt),at&8?c(z,x.children):at&16&&E(x.children,z,null,M,B,W&&ot!=="foreignObject",Z,H),vt&&Ps(x,null,M,"created"),tt){for(const Dt in tt)Dt!=="value"&&!Jr(Dt)&&n(z,Dt,null,tt[Dt],W,x.children,M,B,_t);"value"in tt&&n(z,"value",null,tt.value),(k=tt.onVnodeBeforeMount)&&ke(k,M,x)}y(z,x,x.scopeId,Z,M),vt&&Ps(x,null,M,"beforeMount");const Ft=(!B||B&&!B.pendingBranch)&&ft&&!ft.persisted;Ft&&ft.beforeEnter(z),i(z,w,C),((k=tt&&tt.onVnodeMounted)||Ft||vt)&&le(()=>{k&&ke(k,M,x),Ft&&ft.enter(z),vt&&Ps(x,null,M,"mounted")},B)},y=(x,w,C,M,B)=>{if(C&&p(x,C),M)for(let W=0;W<M.length;W++)p(x,M[W]);if(B){let W=B.subTree;if(w===W){const Z=B.vnode;y(x,Z,Z.scopeId,Z.slotScopeIds,B.parent)}}},E=(x,w,C,M,B,W,Z,H,z=0)=>{for(let k=z;k<x.length;k++){const ot=x[k]=H?_s(x[k]):We(x[k]);m(null,ot,w,C,M,B,W,Z,H)}},I=(x,w,C,M,B,W,Z)=>{const H=w.el=x.el;let{patchFlag:z,dynamicChildren:k,dirs:ot}=w;z|=x.patchFlag&16;const tt=x.props||Lt,at=w.props||Lt;let ft;C&&Ms(C,!1),(ft=at.onVnodeBeforeUpdate)&&ke(ft,C,w,x),ot&&Ps(w,x,C,"beforeUpdate"),C&&Ms(C,!0);const vt=B&&w.type!=="foreignObject";if(k?F(x.dynamicChildren,k,H,C,M,vt,W):Z||st(x,w,H,null,C,M,vt,W,!1),z>0){if(z&16)L(H,w,tt,at,C,M,B);else if(z&2&&tt.class!==at.class&&n(H,"class",null,at.class,B),z&4&&n(H,"style",tt.style,at.style,B),z&8){const Ft=w.dynamicProps;for(let Dt=0;Dt<Ft.length;Dt++){const $t=Ft[Dt],Te=tt[$t],si=at[$t];(si!==Te||$t==="value")&&n(H,$t,Te,si,B,x.children,C,M,_t)}}z&1&&x.children!==w.children&&c(H,w.children)}else!Z&&k==null&&L(H,w,tt,at,C,M,B);((ft=at.onVnodeUpdated)||ot)&&le(()=>{ft&&ke(ft,C,w,x),ot&&Ps(w,x,C,"updated")},M)},F=(x,w,C,M,B,W,Z)=>{for(let H=0;H<w.length;H++){const z=x[H],k=w[H],ot=z.el&&(z.type===He||!Gs(z,k)||z.shapeFlag&70)?u(z.el):C;m(z,k,ot,null,M,B,W,Z,!0)}},L=(x,w,C,M,B,W,Z)=>{if(C!==M){if(C!==Lt)for(const H in C)!Jr(H)&&!(H in M)&&n(x,H,C[H],null,Z,w.children,B,W,_t);for(const H in M){if(Jr(H))continue;const z=M[H],k=C[H];z!==k&&H!=="value"&&n(x,H,k,z,Z,w.children,B,W,_t)}"value"in M&&n(x,"value",C.value,M.value)}},j=(x,w,C,M,B,W,Z,H,z)=>{const k=w.el=x?x.el:a(""),ot=w.anchor=x?x.anchor:a("");let{patchFlag:tt,dynamicChildren:at,slotScopeIds:ft}=w;ft&&(H=H?H.concat(ft):ft),x==null?(i(k,C,M),i(ot,C,M),E(w.children,C,ot,B,W,Z,H,z)):tt>0&&tt&64&&at&&x.dynamicChildren?(F(x.dynamicChildren,at,C,B,W,Z,H),(w.key!=null||B&&w===B.subTree)&&Wu(x,w,!0)):st(x,w,C,ot,B,W,Z,H,z)},D=(x,w,C,M,B,W,Z,H,z)=>{w.slotScopeIds=H,x==null?w.shapeFlag&512?B.ctx.activate(w,C,M,Z,z):P(w,C,M,B,W,Z,z):ut(x,w,z)},P=(x,w,C,M,B,W,Z)=>{const H=x.component=Qm(x,M,B);if(vr(x)&&(H.ctx.renderer=Bt),tg(H),H.asyncDep){if(B&&B.registerDep(H,nt),!x.el){const z=H.subTree=ee(Be);v(null,z,w,C)}return}nt(H,x,w,C,B,W,Z)},ut=(x,w,C)=>{const M=w.component=x.component;if(am(x,w,C))if(M.asyncDep&&!M.asyncResolved){G(M,w,C);return}else M.next=w,tm(M.update),M.update();else w.el=x.el,M.vnode=w},nt=(x,w,C,M,B,W,Z)=>{const H=()=>{if(x.isMounted){let{next:ot,bu:tt,u:at,parent:ft,vnode:vt}=x,Ft=ot,Dt;Ms(x,!1),ot?(ot.el=vt.el,G(x,ot,Z)):ot=vt,tt&&ho(tt),(Dt=ot.props&&ot.props.onVnodeBeforeUpdate)&&ke(Dt,ft,ot,vt),Ms(x,!0);const $t=co(x),Te=x.subTree;x.subTree=$t,m(Te,$t,u(Te.el),ht(Te),x,B,W),ot.el=$t.el,Ft===null&&lm(x,$t.el),at&&le(at,B),(Dt=ot.props&&ot.props.onVnodeUpdated)&&le(()=>ke(Dt,ft,ot,vt),B)}else{let ot;const{el:tt,props:at}=w,{bm:ft,m:vt,parent:Ft}=x,Dt=tn(w);if(Ms(x,!1),ft&&ho(ft),!Dt&&(ot=at&&at.onVnodeBeforeMount)&&ke(ot,Ft,w),Ms(x,!0),tt&&Pt){const $t=()=>{x.subTree=co(x),Pt(tt,x.subTree,x,B,null)};Dt?w.type.__asyncLoader().then(()=>!x.isUnmounted&&$t()):$t()}else{const $t=x.subTree=co(x);m(null,$t,C,M,x,B,W),w.el=$t.el}if(vt&&le(vt,B),!Dt&&(ot=at&&at.onVnodeMounted)){const $t=w;le(()=>ke(ot,Ft,$t),B)}(w.shapeFlag&256||Ft&&tn(Ft.vnode)&&Ft.vnode.shapeFlag&256)&&x.a&&le(x.a,B),x.isMounted=!0,w=C=M=null}},z=x.effect=new el(H,()=>Gn(k),x.scope),k=x.update=()=>z.run();k.id=x.uid,Ms(x,!0),k()},G=(x,w,C)=>{w.component=x;const M=x.vnode.props;x.vnode=w,x.next=null,Dm(x,w.props,M,C),Nm(x,w.children,C),Oi(),Zl(),Bi()},st=(x,w,C,M,B,W,Z,H,z=!1)=>{const k=x&&x.children,ot=x?x.shapeFlag:0,tt=w.children,{patchFlag:at,shapeFlag:ft}=w;if(at>0){if(at&128){N(k,tt,C,M,B,W,Z,H,z);return}else if(at&256){At(k,tt,C,M,B,W,Z,H,z);return}}ft&8?(ot&16&&_t(k,B,W),tt!==k&&c(C,tt)):ot&16?ft&16?N(k,tt,C,M,B,W,Z,H,z):_t(k,B,W,!0):(ot&8&&c(C,""),ft&16&&E(tt,C,M,B,W,Z,H,z))},At=(x,w,C,M,B,W,Z,H,z)=>{x=x||pi,w=w||pi;const k=x.length,ot=w.length,tt=Math.min(k,ot);let at;for(at=0;at<tt;at++){const ft=w[at]=z?_s(w[at]):We(w[at]);m(x[at],ft,C,null,B,W,Z,H,z)}k>ot?_t(x,B,W,!0,!1,tt):E(w,C,M,B,W,Z,H,z,tt)},N=(x,w,C,M,B,W,Z,H,z)=>{let k=0;const ot=w.length;let tt=x.length-1,at=ot-1;for(;k<=tt&&k<=at;){const ft=x[k],vt=w[k]=z?_s(w[k]):We(w[k]);if(Gs(ft,vt))m(ft,vt,C,null,B,W,Z,H,z);else break;k++}for(;k<=tt&&k<=at;){const ft=x[tt],vt=w[at]=z?_s(w[at]):We(w[at]);if(Gs(ft,vt))m(ft,vt,C,null,B,W,Z,H,z);else break;tt--,at--}if(k>tt){if(k<=at){const ft=at+1,vt=ft<ot?w[ft].el:M;for(;k<=at;)m(null,w[k]=z?_s(w[k]):We(w[k]),C,vt,B,W,Z,H,z),k++}}else if(k>at)for(;k<=tt;)Y(x[k],B,W,!0),k++;else{const ft=k,vt=k,Ft=new Map;for(k=vt;k<=at;k++){const ue=w[k]=z?_s(w[k]):We(w[k]);ue.key!=null&&Ft.set(ue.key,k)}let Dt,$t=0;const Te=at-vt+1;let si=!1,Gl=0;const Ni=new Array(Te);for(k=0;k<Te;k++)Ni[k]=0;for(k=ft;k<=tt;k++){const ue=x[k];if($t>=Te){Y(ue,B,W,!0);continue}let Ue;if(ue.key!=null)Ue=Ft.get(ue.key);else for(Dt=vt;Dt<=at;Dt++)if(Ni[Dt-vt]===0&&Gs(ue,w[Dt])){Ue=Dt;break}Ue===void 0?Y(ue,B,W,!0):(Ni[Ue-vt]=k+1,Ue>=Gl?Gl=Ue:si=!0,m(ue,w[Ue],C,null,B,W,Z,H,z),$t++)}const Hl=si?Wm(Ni):pi;for(Dt=Hl.length-1,k=Te-1;k>=0;k--){const ue=vt+k,Ue=w[ue],Wl=ue+1<ot?w[ue+1].el:M;Ni[k]===0?m(null,Ue,C,Wl,B,W,Z,H,z):si&&(Dt<0||k!==Hl[Dt]?U(Ue,C,Wl,2):Dt--)}}},U=(x,w,C,M,B=null)=>{const{el:W,type:Z,transition:H,children:z,shapeFlag:k}=x;if(k&6){U(x.component.subTree,w,C,M);return}if(k&128){x.suspense.move(w,C,M);return}if(k&64){Z.move(x,w,C,Bt);return}if(Z===He){i(W,w,C);for(let tt=0;tt<z.length;tt++)U(z[tt],w,C,M);i(x.anchor,w,C);return}if(Z===mo){g(x,w,C);return}if(M!==2&&k&1&&H)if(M===0)H.beforeEnter(W),i(W,w,C),le(()=>H.enter(W),B);else{const{leave:tt,delayLeave:at,afterLeave:ft}=H,vt=()=>i(W,w,C),Ft=()=>{tt(W,()=>{vt(),ft&&ft()})};at?at(W,vt,Ft):Ft()}else i(W,w,C)},Y=(x,w,C,M=!1,B=!1)=>{const{type:W,props:Z,ref:H,children:z,dynamicChildren:k,shapeFlag:ot,patchFlag:tt,dirs:at}=x;if(H!=null&&na(H,null,C,x,!0),ot&256){w.ctx.deactivate(x);return}const ft=ot&1&&at,vt=!tn(x);let Ft;if(vt&&(Ft=Z&&Z.onVnodeBeforeUnmount)&&ke(Ft,w,x),ot&6)dt(x.component,C,M);else{if(ot&128){x.suspense.unmount(C,M);return}ft&&Ps(x,null,w,"beforeUnmount"),ot&64?x.type.remove(x,w,C,B,Bt,M):k&&(W!==He||tt>0&&tt&64)?_t(k,w,C,!1,!0):(W===He&&tt&384||!B&&ot&16)&&_t(z,w,C),M&&it(x)}(vt&&(Ft=Z&&Z.onVnodeUnmounted)||ft)&&le(()=>{Ft&&ke(Ft,w,x),ft&&Ps(x,null,w,"unmounted")},C)},it=x=>{const{type:w,el:C,anchor:M,transition:B}=x;if(w===He){Q(C,M);return}if(w===mo){b(x);return}const W=()=>{r(C),B&&!B.persisted&&B.afterLeave&&B.afterLeave()};if(x.shapeFlag&1&&B&&!B.persisted){const{leave:Z,delayLeave:H}=B,z=()=>Z(C,W);H?H(x.el,W,z):z()}else W()},Q=(x,w)=>{let C;for(;x!==w;)C=d(x),r(x),x=C;r(w)},dt=(x,w,C)=>{const{bum:M,scope:B,update:W,subTree:Z,um:H}=x;M&&ho(M),B.stop(),W&&(W.active=!1,Y(Z,x,w,C)),H&&le(H,w),le(()=>{x.isUnmounted=!0},w),w&&w.pendingBranch&&!w.isUnmounted&&x.asyncDep&&!x.asyncResolved&&x.suspenseId===w.pendingId&&(w.deps--,w.deps===0&&w.resolve())},_t=(x,w,C,M=!1,B=!1,W=0)=>{for(let Z=W;Z<x.length;Z++)Y(x[Z],w,C,M,B)},ht=x=>x.shapeFlag&6?ht(x.component.subTree):x.shapeFlag&128?x.suspense.next():d(x.anchor||x.el),xt=(x,w,C)=>{x==null?w._vnode&&Y(w._vnode,null,null,!0):m(w._vnode||null,x,w,null,null,null,C),Zl(),Tu(),w._vnode=x},Bt={p:m,um:Y,m:U,r:it,mt:P,mc:E,pc:st,pbc:F,n:ht,o:e};let Rt,Pt;return t&&([Rt,Pt]=t(Bt)),{render:xt,hydrate:Rt,createApp:km(xt,Rt)}}function Ms({effect:e,update:t},s){e.allowRecurse=t.allowRecurse=s}function Wu(e,t,s=!1){const i=e.children,r=t.children;if(mt(i)&&mt(r))for(let n=0;n<i.length;n++){const o=i[n];let a=r[n];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=r[n]=_s(r[n]),a.el=o.el),s||Wu(o,a)),a.type===Xn&&(a.el=o.el)}}function Wm(e){const t=e.slice(),s=[0];let i,r,n,o,a;const l=e.length;for(i=0;i<l;i++){const h=e[i];if(h!==0){if(r=s[s.length-1],e[r]<h){t[i]=r,s.push(i);continue}for(n=0,o=s.length-1;n<o;)a=n+o>>1,e[s[a]]<h?n=a+1:o=a;h<e[s[n]]&&(n>0&&(t[i]=s[n-1]),s[n]=i)}}for(n=s.length,o=s[n-1];n-- >0;)s[n]=o,o=t[o];return s}const $m=e=>e.__isTeleport,He=Symbol(void 0),Xn=Symbol(void 0),Be=Symbol(void 0),mo=Symbol(void 0),ir=[];let Pe=null;function Xm(e=!1){ir.push(Pe=e?null:[])}function jm(){ir.pop(),Pe=ir[ir.length-1]||null}let lr=1;function ah(e){lr+=e}function $u(e){return e.dynamicChildren=lr>0?Pe||pi:null,jm(),lr>0&&Pe&&Pe.push(e),e}function FA(e,t,s,i,r,n){return $u(ju(e,t,s,i,r,n,!0))}function zm(e,t,s,i,r){return $u(ee(e,t,s,i,r,!0))}function oa(e){return e?e.__v_isVNode===!0:!1}function Gs(e,t){return e.type===t.type&&e.key===t.key}const jn="__vInternal",Xu=({key:e})=>e??null,en=({ref:e,ref_key:t,ref_for:s})=>e!=null?zt(e)||re(e)||gt(e)?{i:ge,r:e,k:t,f:!!s}:e:null;function ju(e,t=null,s=null,i=0,r=null,n=e===He?0:1,o=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&Xu(t),ref:t&&en(t),scopeId:Wn,slotScopeIds:null,children:s,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:n,patchFlag:i,dynamicProps:r,dynamicChildren:null,appContext:null,ctx:ge};return a?(pl(l,s),n&128&&e.normalize(l)):s&&(l.shapeFlag|=zt(s)?8:16),lr>0&&!o&&Pe&&(l.patchFlag>0||n&6)&&l.patchFlag!==32&&Pe.push(l),l}const ee=Vm;function Vm(e,t=null,s=null,i=0,r=null,n=!1){if((!e||e===Bu)&&(e=Be),oa(e)){const a=Ss(e,t,!0);return s&&pl(a,s),lr>0&&!n&&Pe&&(a.shapeFlag&6?Pe[Pe.indexOf(e)]=a:Pe.push(a)),a.patchFlag|=-2,a}if(ng(e)&&(e=e.__vccOpts),t){t=Ym(t);let{class:a,style:l}=t;a&&!zt(a)&&(t.class=Ka(a)),Ut(l)&&(fu(l)&&!mt(l)&&(l=ne({},l)),t.style=Ya(l))}const o=zt(e)?1:hm(e)?128:$m(e)?64:Ut(e)?4:gt(e)?2:0;return ju(e,t,s,i,r,o,n,!0)}function Ym(e){return e?fu(e)||jn in e?ne({},e):e:null}function Ss(e,t,s=!1){const{props:i,ref:r,patchFlag:n,children:o}=e,a=t?qm(i||{},t):i;return{__v_isVNode:!0,__v_skip:!0,type:e.type,props:a,key:a&&Xu(a),ref:t&&t.ref?s&&r?mt(r)?r.concat(en(t)):[r,en(t)]:en(t):r,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:o,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==He?n===-1?16:n|16:n,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:e.transition,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&Ss(e.ssContent),ssFallback:e.ssFallback&&Ss(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx}}function Km(e=" ",t=0){return ee(Xn,null,e,t)}function LA(e="",t=!1){return t?(Xm(),zm(Be,null,e)):ee(Be,null,e)}function We(e){return e==null||typeof e=="boolean"?ee(Be):mt(e)?ee(He,null,e.slice()):typeof e=="object"?_s(e):ee(Xn,null,String(e))}function _s(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:Ss(e)}function pl(e,t){let s=0;const{shapeFlag:i}=e;if(t==null)t=null;else if(mt(t))s=16;else if(typeof t=="object")if(i&65){const r=t.default;r&&(r._c&&(r._d=!1),pl(e,r()),r._c&&(r._d=!0));return}else{s=32;const r=t._;!r&&!(jn in t)?t._ctx=ge:r===3&&ge&&(ge.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else gt(t)?(t={default:t,_ctx:ge},s=32):(t=String(t),i&64?(s=16,t=[Km(t)]):s=8);e.children=t,e.shapeFlag|=s}function qm(...e){const t={};for(let s=0;s<e.length;s++){const i=e[s];for(const r in i)if(r==="class")t.class!==i.class&&(t.class=Ka([t.class,i.class]));else if(r==="style")t.style=Ya([t.style,i.style]);else if(Fn(r)){const n=t[r],o=i[r];o&&n!==o&&!(mt(n)&&n.includes(o))&&(t[r]=n?[].concat(n,o):o)}else r!==""&&(t[r]=i[r])}return t}function ke(e,t,s,i=null){Ee(e,t,7,[s,i])}const Zm=Hu();let Jm=0;function Qm(e,t,s){const i=e.type,r=(t?t.appContext:e.appContext)||Zm,n={uid:Jm++,vnode:e,type:i,parent:t,appContext:r,root:null,next:null,subTree:null,effect:null,update:null,scope:new eu(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(r.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Nu(i,r),emitsOptions:Su(i,r),emit:null,emitted:null,propsDefaults:Lt,inheritAttrs:i.inheritAttrs,ctx:Lt,data:Lt,props:Lt,attrs:Lt,slots:Lt,refs:Lt,setupState:Lt,setupContext:null,suspense:s,suspenseId:s?s.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return n.ctx={_:n},n.root=t?t.root:n,n.emit=im.bind(null,n),e.ce&&e.ce(n),n}let Yt=null;const zu=()=>Yt||ge,Ai=e=>{Yt=e,e.scope.on()},js=()=>{Yt&&Yt.scope.off(),Yt=null};function Vu(e){return e.vnode.shapeFlag&4}let Ci=!1;function tg(e,t=!1){Ci=t;const{props:s,children:i}=e.vnode,r=Vu(e);Bm(e,s,r,t),Lm(e,i);const n=r?eg(e,t):void 0;return Ci=!1,n}function eg(e,t){const s=e.type;e.accessCache=Object.create(null),e.proxy=pu(new Proxy(e.ctx,Cm));const{setup:i}=s;if(i){const r=e.setupContext=i.length>1?ig(e):null;Ai(e),Oi();const n=bs(i,e,0,[e.props,r]);if(Bi(),js(),Zc(n)){if(n.then(js,js),t)return n.then(o=>{lh(e,o,t)}).catch(o=>{xr(o,e,0)});e.asyncDep=n}else lh(e,n,t)}else Yu(e,t)}function lh(e,t,s){gt(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:Ut(t)&&(e.setupState=vu(t)),Yu(e,s)}let hh;function Yu(e,t,s){const i=e.type;if(!e.render){if(!t&&hh&&!i.render){const r=i.template||dl(e).template;if(r){const{isCustomElement:n,compilerOptions:o}=e.appContext.config,{delimiters:a,compilerOptions:l}=i,h=ne(ne({isCustomElement:n,delimiters:a},o),l);i.render=hh(r,h)}}e.render=i.render||Oe}Ai(e),Oi(),Im(e),Bi(),js()}function sg(e){return new Proxy(e.attrs,{get(t,s){return _e(e,"get","$attrs"),t[s]}})}function ig(e){const t=i=>{e.exposed=i||{}};let s;return{get attrs(){return s||(s=sg(e))},slots:e.slots,emit:e.emit,expose:t}}function zn(e){if(e.exposed)return e.exposeProxy||(e.exposeProxy=new Proxy(vu(pu(e.exposed)),{get(t,s){if(s in t)return t[s];if(s in sr)return sr[s](e)},has(t,s){return s in t||s in sr}}))}function rg(e,t=!0){return gt(e)?e.displayName||e.name:e.name||t&&e.__name}function ng(e){return gt(e)&&"__vccOpts"in e}const og=(e,t)=>Zp(e,t,Ci);function NA(e,t,s){const i=arguments.length;return i===2?Ut(t)&&!mt(t)?oa(t)?ee(e,null,[t]):ee(e,t):ee(e,null,t):(i>3?s=Array.prototype.slice.call(arguments,2):i===3&&oa(s)&&(s=[s]),ee(e,t,s))}const ag=Symbol(""),lg=()=>Qr(ag),hg="3.2.45",cg="http://www.w3.org/2000/svg",Hs=typeof document<"u"?document:null,ch=Hs&&Hs.createElement("template"),ug={insert:(e,t,s)=>{t.insertBefore(e,s||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,s,i)=>{const r=t?Hs.createElementNS(cg,e):Hs.createElement(e,s?{is:s}:void 0);return e==="select"&&i&&i.multiple!=null&&r.setAttribute("multiple",i.multiple),r},createText:e=>Hs.createTextNode(e),createComment:e=>Hs.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>Hs.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,s,i,r,n){const o=s?s.previousSibling:t.lastChild;if(r&&(r===n||r.nextSibling))for(;t.insertBefore(r.cloneNode(!0),s),!(r===n||!(r=r.nextSibling)););else{ch.innerHTML=i?`<svg>${e}</svg>`:e;const a=ch.content;if(i){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}t.insertBefore(a,s)}return[o?o.nextSibling:t.firstChild,s?s.previousSibling:t.lastChild]}};function dg(e,t,s){const i=e._vtc;i&&(t=(t?[t,...i]:[...i]).join(" ")),t==null?e.removeAttribute("class"):s?e.setAttribute("class",t):e.className=t}function fg(e,t,s){const i=e.style,r=zt(s);if(s&&!r){for(const n in s)aa(i,n,s[n]);if(t&&!zt(t))for(const n in t)s[n]==null&&aa(i,n,"")}else{const n=i.display;r?t!==s&&(i.cssText=s):t&&e.removeAttribute("style"),"_vod"in e&&(i.display=n)}}const uh=/\s*!important$/;function aa(e,t,s){if(mt(s))s.forEach(i=>aa(e,t,i));else if(s==null&&(s=""),t.startsWith("--"))e.setProperty(t,s);else{const i=pg(e,t);uh.test(s)?e.setProperty(Mi(i),s.replace(uh,""),"important"):e[i]=s}}const dh=["Webkit","Moz","ms"],go={};function pg(e,t){const s=go[t];if(s)return s;let i=Ze(t);if(i!=="filter"&&i in e)return go[t]=i;i=Un(i);for(let r=0;r<dh.length;r++){const n=dh[r]+i;if(n in e)return go[t]=n}return t}const fh="http://www.w3.org/1999/xlink";function mg(e,t,s,i,r){if(i&&t.startsWith("xlink:"))s==null?e.removeAttributeNS(fh,t.slice(6,t.length)):e.setAttributeNS(fh,t,s);else{const n=hp(t);s==null||n&&!Yc(s)?e.removeAttribute(t):e.setAttribute(t,n?"":s)}}function gg(e,t,s,i,r,n,o){if(t==="innerHTML"||t==="textContent"){i&&o(i,r,n),e[t]=s??"";return}if(t==="value"&&e.tagName!=="PROGRESS"&&!e.tagName.includes("-")){e._value=s;const l=s??"";(e.value!==l||e.tagName==="OPTION")&&(e.value=l),s==null&&e.removeAttribute(t);return}let a=!1;if(s===""||s==null){const l=typeof e[t];l==="boolean"?s=Yc(s):s==null&&l==="string"?(s="",a=!0):l==="number"&&(s=0,a=!0)}try{e[t]=s}catch{}a&&e.removeAttribute(t)}function _g(e,t,s,i){e.addEventListener(t,s,i)}function xg(e,t,s,i){e.removeEventListener(t,s,i)}function vg(e,t,s,i,r=null){const n=e._vei||(e._vei={}),o=n[t];if(i&&o)o.value=i;else{const[a,l]=yg(t);if(i){const h=n[t]=Tg(i,r);_g(e,a,h,l)}else o&&(xg(e,a,o,l),n[t]=void 0)}}const ph=/(?:Once|Passive|Capture)$/;function yg(e){let t;if(ph.test(e)){t={};let i;for(;i=e.match(ph);)e=e.slice(0,e.length-i[0].length),t[i[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):Mi(e.slice(2)),t]}let _o=0;const Eg=Promise.resolve(),bg=()=>_o||(Eg.then(()=>_o=0),_o=Date.now());function Tg(e,t){const s=i=>{if(!i._vts)i._vts=Date.now();else if(i._vts<=s.attached)return;Ee(wg(i,s.value),t,5,[i])};return s.value=e,s.attached=bg(),s}function wg(e,t){if(mt(t)){const s=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{s.call(e),e._stopped=!0},t.map(i=>r=>!r._stopped&&i&&i(r))}else return t}const mh=/^on[a-z]/,Sg=(e,t,s,i,r=!1,n,o,a,l)=>{t==="class"?dg(e,i,r):t==="style"?fg(e,s,i):Fn(t)?qa(t)||vg(e,t,s,i,o):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):Ag(e,t,i,r))?gg(e,t,i,n,o,a,l):(t==="true-value"?e._trueValue=i:t==="false-value"&&(e._falseValue=i),mg(e,t,i,r))};function Ag(e,t,s,i){return i?!!(t==="innerHTML"||t==="textContent"||t in e&&mh.test(t)&&gt(s)):t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA"||mh.test(t)&&zt(s)?!1:t in e}const Cg={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String};mm.props;const Ig=["ctrl","shift","alt","meta"],Rg={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>Ig.some(s=>e[`${s}Key`]&&!t.includes(s))},UA=(e,t)=>(s,...i)=>{for(let r=0;r<t.length;r++){const n=Rg[t[r]];if(n&&n(s,t))return}return e(s,...i)},kA={beforeMount(e,{value:t},{transition:s}){e._vod=e.style.display==="none"?"":e.style.display,s&&t?s.beforeEnter(e):Ui(e,t)},mounted(e,{value:t},{transition:s}){s&&t&&s.enter(e)},updated(e,{value:t,oldValue:s},{transition:i}){!t!=!s&&(i?t?(i.beforeEnter(e),Ui(e,!0),i.enter(e)):i.leave(e,()=>{Ui(e,!1)}):Ui(e,t))},beforeUnmount(e,{value:t}){Ui(e,t)}};function Ui(e,t){e.style.display=t?e._vod:"none"}const Pg=ne({patchProp:Sg},ug);let gh;function Mg(){return gh||(gh=Gm(Pg))}const GA=(...e)=>{const t=Mg().createApp(...e),{mount:s}=t;return t.mount=i=>{const r=Og(i);if(!r)return;const n=t._component;!gt(n)&&!n.render&&!n.template&&(n.template=r.innerHTML),r.innerHTML="";const o=s(r,!1,r instanceof SVGElement);return r instanceof Element&&(r.removeAttribute("v-cloak"),r.setAttribute("data-v-app","")),o},t};function Og(e){return zt(e)?document.querySelector(e):e}var _h;const Ku=typeof window<"u",Bg=e=>typeof e=="function",Dg=e=>typeof e=="string",Fg=()=>{};Ku&&((_h=window==null?void 0:window.navigator)!=null&&_h.userAgent)&&/iP(ad|hone|od)/.test(window.navigator.userAgent);function qu(e){return typeof e=="function"?e():xu(e)}function Lg(e,t){function s(...i){return new Promise((r,n)=>{Promise.resolve(e(()=>t.apply(this,i),{fn:t,thisArg:this,args:i})).then(r).catch(n)})}return s}const Zu=e=>e();function Ng(e=Zu){const t=tr(!0);function s(){t.value=!1}function i(){t.value=!0}return{isActive:t,pause:s,resume:i,eventFilter:(...n)=>{t.value&&e(...n)}}}function Ug(e){return e}function kg(e){return vp()?(yp(e),!0):!1}function HA(e){let t=!1,s;const i=_p(!0);return()=>(t||(s=i.run(e),t=!0),s)}function WA(e,t=!0){zu()?cl(e):t?e():hl(e)}var xh=Object.getOwnPropertySymbols,Gg=Object.prototype.hasOwnProperty,Hg=Object.prototype.propertyIsEnumerable,Wg=(e,t)=>{var s={};for(var i in e)Gg.call(e,i)&&t.indexOf(i)<0&&(s[i]=e[i]);if(e!=null&&xh)for(var i of xh(e))t.indexOf(i)<0&&Hg.call(e,i)&&(s[i]=e[i]);return s};function $g(e,t,s={}){const i=s,{eventFilter:r=Zu}=i,n=Wg(i,["eventFilter"]);return er(e,Lg(r,t),n)}var Xg=Object.defineProperty,jg=Object.defineProperties,zg=Object.getOwnPropertyDescriptors,_n=Object.getOwnPropertySymbols,Ju=Object.prototype.hasOwnProperty,Qu=Object.prototype.propertyIsEnumerable,vh=(e,t,s)=>t in e?Xg(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,Vg=(e,t)=>{for(var s in t||(t={}))Ju.call(t,s)&&vh(e,s,t[s]);if(_n)for(var s of _n(t))Qu.call(t,s)&&vh(e,s,t[s]);return e},Yg=(e,t)=>jg(e,zg(t)),Kg=(e,t)=>{var s={};for(var i in e)Ju.call(e,i)&&t.indexOf(i)<0&&(s[i]=e[i]);if(e!=null&&_n)for(var i of _n(e))t.indexOf(i)<0&&Qu.call(e,i)&&(s[i]=e[i]);return s};function qg(e,t,s={}){const i=s,{eventFilter:r}=i,n=Kg(i,["eventFilter"]),{eventFilter:o,pause:a,resume:l,isActive:h}=Ng(r);return{stop:$g(e,t,Yg(Vg({},n),{eventFilter:o})),pause:a,resume:l,isActive:h}}function Zg(e){var t;const s=qu(e);return(t=s==null?void 0:s.$el)!=null?t:s}const xn=Ku?window:void 0;function Jg(...e){let t,s,i,r;if(Dg(e[0])||Array.isArray(e[0])?([s,i,r]=e,t=xn):[t,s,i,r]=e,!t)return Fg;Array.isArray(s)||(s=[s]),Array.isArray(i)||(i=[i]);const n=[],o=()=>{n.forEach(c=>c()),n.length=0},a=(c,u,d)=>(c.addEventListener(u,d,r),()=>c.removeEventListener(u,d,r)),l=er(()=>Zg(t),c=>{o(),c&&n.push(...s.flatMap(u=>i.map(d=>a(c,u,d))))},{immediate:!0,flush:"post"}),h=()=>{l(),o()};return kg(h),h}const la=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ha="__vueuse_ssr_handlers__";la[ha]=la[ha]||{};const Qg=la[ha];function t_(e,t){return Qg[e]||t}function e_(e){return e==null?"any":e instanceof Set?"set":e instanceof Map?"map":e instanceof Date?"date":typeof e=="boolean"?"boolean":typeof e=="string"?"string":typeof e=="object"?"object":Number.isNaN(e)?"any":"number"}var s_=Object.defineProperty,yh=Object.getOwnPropertySymbols,i_=Object.prototype.hasOwnProperty,r_=Object.prototype.propertyIsEnumerable,Eh=(e,t,s)=>t in e?s_(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,bh=(e,t)=>{for(var s in t||(t={}))i_.call(t,s)&&Eh(e,s,t[s]);if(yh)for(var s of yh(t))r_.call(t,s)&&Eh(e,s,t[s]);return e};const n_={boolean:{read:e=>e==="true",write:e=>String(e)},object:{read:e=>JSON.parse(e),write:e=>JSON.stringify(e)},number:{read:e=>Number.parseFloat(e),write:e=>String(e)},any:{read:e=>e,write:e=>String(e)},string:{read:e=>e,write:e=>String(e)},map:{read:e=>new Map(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e.entries()))},set:{read:e=>new Set(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e))},date:{read:e=>new Date(e),write:e=>e.toISOString()}};function o_(e,t,s,i={}){var r;const{flush:n="pre",deep:o=!0,listenToStorageChanges:a=!0,writeDefaults:l=!0,mergeDefaults:h=!1,shallow:c,window:u=xn,eventFilter:d,onError:p=y=>{console.error(y)}}=i,f=(c?Vp:tr)(t);if(!s)try{s=t_("getDefaultStorage",()=>{var y;return(y=xn)==null?void 0:y.localStorage})()}catch(y){p(y)}if(!s)return f;const m=qu(t),_=e_(m),v=(r=i.serializer)!=null?r:n_[_],{pause:T,resume:g}=qg(f,()=>b(f.value),{flush:n,deep:o,eventFilter:d});return u&&a&&Jg(u,"storage",A),A(),f;function b(y){try{if(y==null)s.removeItem(e);else{const E=v.write(y),I=s.getItem(e);I!==E&&(s.setItem(e,E),u&&(u==null||u.dispatchEvent(new StorageEvent("storage",{key:e,oldValue:I,newValue:E,storageArea:s}))))}}catch(E){p(E)}}function S(y){const E=y?y.newValue:s.getItem(e);if(E==null)return l&&m!==null&&s.setItem(e,v.write(m)),m;if(!y&&h){const I=v.read(E);return Bg(h)?h(I,m):_==="object"&&!Array.isArray(I)?bh(bh({},m),I):I}else return typeof E!="string"?E:v.read(E)}function A(y){if(!(y&&y.storageArea!==s)){if(y&&y.key==null){f.value=m;return}if(!(y&&y.key!==e)){T();try{f.value=S(y)}catch(E){p(E)}finally{y?hl(g):g()}}}}}var Th;(function(e){e.UP="UP",e.RIGHT="RIGHT",e.DOWN="DOWN",e.LEFT="LEFT",e.NONE="NONE"})(Th||(Th={}));function $A(e,t,s={}){const{window:i=xn}=s;return o_(e,t,i==null?void 0:i.sessionStorage,s)}var a_=Object.defineProperty,wh=Object.getOwnPropertySymbols,l_=Object.prototype.hasOwnProperty,h_=Object.prototype.propertyIsEnumerable,Sh=(e,t,s)=>t in e?a_(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,c_=(e,t)=>{for(var s in t||(t={}))l_.call(t,s)&&Sh(e,s,t[s]);if(wh)for(var s of wh(t))h_.call(t,s)&&Sh(e,s,t[s]);return e};const u_={easeInSine:[.12,0,.39,0],easeOutSine:[.61,1,.88,1],easeInOutSine:[.37,0,.63,1],easeInQuad:[.11,0,.5,0],easeOutQuad:[.5,1,.89,1],easeInOutQuad:[.45,0,.55,1],easeInCubic:[.32,0,.67,0],easeOutCubic:[.33,1,.68,1],easeInOutCubic:[.65,0,.35,1],easeInQuart:[.5,0,.75,0],easeOutQuart:[.25,1,.5,1],easeInOutQuart:[.76,0,.24,1],easeInQuint:[.64,0,.78,0],easeOutQuint:[.22,1,.36,1],easeInOutQuint:[.83,0,.17,1],easeInExpo:[.7,0,.84,0],easeOutExpo:[.16,1,.3,1],easeInOutExpo:[.87,0,.13,1],easeInCirc:[.55,0,1,.45],easeOutCirc:[0,.55,.45,1],easeInOutCirc:[.85,0,.15,1],easeInBack:[.36,0,.66,-.56],easeOutBack:[.34,1.56,.64,1],easeInOutBack:[.68,-.6,.32,1.6]};c_({linear:Ug},u_);var ei=(e=>(e[e.WEBGL_LEGACY=0]="WEBGL_LEGACY",e[e.WEBGL=1]="WEBGL",e[e.WEBGL2=2]="WEBGL2",e))(ei||{}),ca=(e=>(e[e.COLOR=16384]="COLOR",e[e.DEPTH=256]="DEPTH",e[e.STENCIL=1024]="STENCIL",e))(ca||{}),ct=(e=>(e[e.NORMAL=0]="NORMAL",e[e.ADD=1]="ADD",e[e.MULTIPLY=2]="MULTIPLY",e[e.SCREEN=3]="SCREEN",e[e.OVERLAY=4]="OVERLAY",e[e.DARKEN=5]="DARKEN",e[e.LIGHTEN=6]="LIGHTEN",e[e.COLOR_DODGE=7]="COLOR_DODGE",e[e.COLOR_BURN=8]="COLOR_BURN",e[e.HARD_LIGHT=9]="HARD_LIGHT",e[e.SOFT_LIGHT=10]="SOFT_LIGHT",e[e.DIFFERENCE=11]="DIFFERENCE",e[e.EXCLUSION=12]="EXCLUSION",e[e.HUE=13]="HUE",e[e.SATURATION=14]="SATURATION",e[e.COLOR=15]="COLOR",e[e.LUMINOSITY=16]="LUMINOSITY",e[e.NORMAL_NPM=17]="NORMAL_NPM",e[e.ADD_NPM=18]="ADD_NPM",e[e.SCREEN_NPM=19]="SCREEN_NPM",e[e.NONE=20]="NONE",e[e.SRC_OVER=0]="SRC_OVER",e[e.SRC_IN=21]="SRC_IN",e[e.SRC_OUT=22]="SRC_OUT",e[e.SRC_ATOP=23]="SRC_ATOP",e[e.DST_OVER=24]="DST_OVER",e[e.DST_IN=25]="DST_IN",e[e.DST_OUT=26]="DST_OUT",e[e.DST_ATOP=27]="DST_ATOP",e[e.ERASE=26]="ERASE",e[e.SUBTRACT=28]="SUBTRACT",e[e.XOR=29]="XOR",e))(ct||{}),Ve=(e=>(e[e.POINTS=0]="POINTS",e[e.LINES=1]="LINES",e[e.LINE_LOOP=2]="LINE_LOOP",e[e.LINE_STRIP=3]="LINE_STRIP",e[e.TRIANGLES=4]="TRIANGLES",e[e.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",e[e.TRIANGLE_FAN=6]="TRIANGLE_FAN",e))(Ve||{}),X=(e=>(e[e.RGBA=6408]="RGBA",e[e.RGB=6407]="RGB",e[e.RG=33319]="RG",e[e.RED=6403]="RED",e[e.RGBA_INTEGER=36249]="RGBA_INTEGER",e[e.RGB_INTEGER=36248]="RGB_INTEGER",e[e.RG_INTEGER=33320]="RG_INTEGER",e[e.RED_INTEGER=36244]="RED_INTEGER",e[e.ALPHA=6406]="ALPHA",e[e.LUMINANCE=6409]="LUMINANCE",e[e.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",e[e.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",e[e.DEPTH_STENCIL=34041]="DEPTH_STENCIL",e))(X||{}),xi=(e=>(e[e.TEXTURE_2D=3553]="TEXTURE_2D",e[e.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",e[e.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",e[e.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",e[e.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",e[e.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",e[e.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",e))(xi||{}),lt=(e=>(e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",e[e.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",e[e.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",e[e.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",e[e.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",e[e.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",e[e.BYTE=5120]="BYTE",e[e.SHORT=5122]="SHORT",e[e.INT=5124]="INT",e[e.FLOAT=5126]="FLOAT",e[e.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",e[e.HALF_FLOAT=36193]="HALF_FLOAT",e))(lt||{}),ua=(e=>(e[e.FLOAT=0]="FLOAT",e[e.INT=1]="INT",e[e.UINT=2]="UINT",e))(ua||{}),ns=(e=>(e[e.NEAREST=0]="NEAREST",e[e.LINEAR=1]="LINEAR",e))(ns||{}),Ts=(e=>(e[e.CLAMP=33071]="CLAMP",e[e.REPEAT=10497]="REPEAT",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",e))(Ts||{}),Je=(e=>(e[e.OFF=0]="OFF",e[e.POW2=1]="POW2",e[e.ON=2]="ON",e[e.ON_MANUAL=3]="ON_MANUAL",e))(Je||{}),Ne=(e=>(e[e.NPM=0]="NPM",e[e.UNPACK=1]="UNPACK",e[e.PMA=2]="PMA",e[e.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",e[e.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",e[e.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",e))(Ne||{}),$e=(e=>(e[e.NO=0]="NO",e[e.YES=1]="YES",e[e.AUTO=2]="AUTO",e[e.BLEND=0]="BLEND",e[e.CLEAR=1]="CLEAR",e[e.BLIT=2]="BLIT",e))($e||{}),Vn=(e=>(e[e.AUTO=0]="AUTO",e[e.MANUAL=1]="MANUAL",e))(Vn||{}),ye=(e=>(e.LOW="lowp",e.MEDIUM="mediump",e.HIGH="highp",e))(ye||{}),Vt=(e=>(e[e.NONE=0]="NONE",e[e.SCISSOR=1]="SCISSOR",e[e.STENCIL=2]="STENCIL",e[e.SPRITE=3]="SPRITE",e[e.COLOR=4]="COLOR",e))(Vt||{}),Xt=(e=>(e[e.NONE=0]="NONE",e[e.LOW=2]="LOW",e[e.MEDIUM=4]="MEDIUM",e[e.HIGH=8]="HIGH",e))(Xt||{}),Ke=(e=>(e[e.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",e[e.ARRAY_BUFFER=34962]="ARRAY_BUFFER",e[e.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",e))(Ke||{});const d_={createCanvas:(e,t)=>{const s=document.createElement("canvas");return s.width=e,s.height=t,s},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(e,t)=>fetch(e,t),parseXML:e=>new DOMParser().parseFromString(e,"text/xml")},q={ADAPTER:d_,RESOLUTION:1,RENDER_OPTIONS:{view:null,antialias:!1,autoDensity:!1,backgroundColor:0,backgroundAlpha:1,premultipliedAlpha:!0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1,hello:!1},CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};var xo=/iPhone/i,Ah=/iPod/i,Ch=/iPad/i,Ih=/\biOS-universal(?:.+)Mac\b/i,vo=/\bAndroid(?:.+)Mobile\b/i,Rh=/Android/i,ii=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,Pr=/Silk/i,es=/Windows Phone/i,Ph=/\bWindows(?:.+)ARM\b/i,Mh=/BlackBerry/i,Oh=/BB10/i,Bh=/Opera Mini/i,Dh=/\b(CriOS|Chrome)(?:.+)Mobile/i,Fh=/Mobile(?:.+)Firefox\b/i,Lh=function(e){return typeof e<"u"&&e.platform==="MacIntel"&&typeof e.maxTouchPoints=="number"&&e.maxTouchPoints>1&&typeof MSStream>"u"};function f_(e){return function(t){return t.test(e)}}function p_(e){var t={userAgent:"",platform:"",maxTouchPoints:0};!e&&typeof navigator<"u"?t={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof e=="string"?t.userAgent=e:e&&e.userAgent&&(t={userAgent:e.userAgent,platform:e.platform,maxTouchPoints:e.maxTouchPoints||0});var s=t.userAgent,i=s.split("[FBAN");typeof i[1]<"u"&&(s=i[0]),i=s.split("Twitter"),typeof i[1]<"u"&&(s=i[0]);var r=f_(s),n={apple:{phone:r(xo)&&!r(es),ipod:r(Ah),tablet:!r(xo)&&(r(Ch)||Lh(t))&&!r(es),universal:r(Ih),device:(r(xo)||r(Ah)||r(Ch)||r(Ih)||Lh(t))&&!r(es)},amazon:{phone:r(ii),tablet:!r(ii)&&r(Pr),device:r(ii)||r(Pr)},android:{phone:!r(es)&&r(ii)||!r(es)&&r(vo),tablet:!r(es)&&!r(ii)&&!r(vo)&&(r(Pr)||r(Rh)),device:!r(es)&&(r(ii)||r(Pr)||r(vo)||r(Rh))||r(/\bokhttp\b/i)},windows:{phone:r(es),tablet:r(Ph),device:r(es)||r(Ph)},other:{blackberry:r(Mh),blackberry10:r(Oh),opera:r(Bh),firefox:r(Fh),chrome:r(Dh),device:r(Mh)||r(Oh)||r(Bh)||r(Fh)||r(Dh)},any:!1,phone:!1,tablet:!1};return n.any=n.apple.device||n.android.device||n.windows.device||n.other.device,n.phone=n.apple.phone||n.android.phone||n.windows.phone,n.tablet=n.apple.tablet||n.android.tablet||n.windows.tablet,n}const os=p_(globalThis.navigator);q.RETINA_PREFIX=/@([0-9\.]+)x/;q.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var yo=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Vs={},m_={get exports(){return Vs},set exports(e){Vs=e}};(function(e){var t=Object.prototype.hasOwnProperty,s="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(s=!1));function r(l,h,c){this.fn=l,this.context=h,this.once=c||!1}function n(l,h,c,u,d){if(typeof c!="function")throw new TypeError("The listener must be a function");var p=new r(c,u||l,d),f=s?s+h:h;return l._events[f]?l._events[f].fn?l._events[f]=[l._events[f],p]:l._events[f].push(p):(l._events[f]=p,l._eventsCount++),l}function o(l,h){--l._eventsCount===0?l._events=new i:delete l._events[h]}function a(){this._events=new i,this._eventsCount=0}a.prototype.eventNames=function(){var h=[],c,u;if(this._eventsCount===0)return h;for(u in c=this._events)t.call(c,u)&&h.push(s?u.slice(1):u);return Object.getOwnPropertySymbols?h.concat(Object.getOwnPropertySymbols(c)):h},a.prototype.listeners=function(h){var c=s?s+h:h,u=this._events[c];if(!u)return[];if(u.fn)return[u.fn];for(var d=0,p=u.length,f=new Array(p);d<p;d++)f[d]=u[d].fn;return f},a.prototype.listenerCount=function(h){var c=s?s+h:h,u=this._events[c];return u?u.fn?1:u.length:0},a.prototype.emit=function(h,c,u,d,p,f){var m=s?s+h:h;if(!this._events[m])return!1;var _=this._events[m],v=arguments.length,T,g;if(_.fn){switch(_.once&&this.removeListener(h,_.fn,void 0,!0),v){case 1:return _.fn.call(_.context),!0;case 2:return _.fn.call(_.context,c),!0;case 3:return _.fn.call(_.context,c,u),!0;case 4:return _.fn.call(_.context,c,u,d),!0;case 5:return _.fn.call(_.context,c,u,d,p),!0;case 6:return _.fn.call(_.context,c,u,d,p,f),!0}for(g=1,T=new Array(v-1);g<v;g++)T[g-1]=arguments[g];_.fn.apply(_.context,T)}else{var b=_.length,S;for(g=0;g<b;g++)switch(_[g].once&&this.removeListener(h,_[g].fn,void 0,!0),v){case 1:_[g].fn.call(_[g].context);break;case 2:_[g].fn.call(_[g].context,c);break;case 3:_[g].fn.call(_[g].context,c,u);break;case 4:_[g].fn.call(_[g].context,c,u,d);break;default:if(!T)for(S=1,T=new Array(v-1);S<v;S++)T[S-1]=arguments[S];_[g].fn.apply(_[g].context,T)}}return!0},a.prototype.on=function(h,c,u){return n(this,h,c,u,!1)},a.prototype.once=function(h,c,u){return n(this,h,c,u,!0)},a.prototype.removeListener=function(h,c,u,d){var p=s?s+h:h;if(!this._events[p])return this;if(!c)return o(this,p),this;var f=this._events[p];if(f.fn)f.fn===c&&(!d||f.once)&&(!u||f.context===u)&&o(this,p);else{for(var m=0,_=[],v=f.length;m<v;m++)(f[m].fn!==c||d&&!f[m].once||u&&f[m].context!==u)&&_.push(f[m]);_.length?this._events[p]=_.length===1?_[0]:_:o(this,p)}return this},a.prototype.removeAllListeners=function(h){var c;return h?(c=s?s+h:h,this._events[c]&&o(this,c)):(this._events=new i,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=s,a.EventEmitter=a,e.exports=a})(m_);var vn={},g_={get exports(){return vn},set exports(e){vn=e}};g_.exports=Yn;vn.default=Yn;function Yn(e,t,s){s=s||2;var i=t&&t.length,r=i?t[0]*s:e.length,n=td(e,0,r,s,!0),o=[];if(!n||n.next===n.prev)return o;var a,l,h,c,u,d,p;if(i&&(n=E_(e,t,n,s)),e.length>80*s){a=h=e[0],l=c=e[1];for(var f=s;f<r;f+=s)u=e[f],d=e[f+1],u<a&&(a=u),d<l&&(l=d),u>h&&(h=u),d>c&&(c=d);p=Math.max(h-a,c-l),p=p!==0?32767/p:0}return hr(n,o,s,a,l,p,0),o}function td(e,t,s,i,r){var n,o;if(r===pa(e,t,s,i)>0)for(n=t;n<s;n+=i)o=Nh(n,e[n],e[n+1],o);else for(n=s-i;n>=t;n-=i)o=Nh(n,e[n],e[n+1],o);return o&&Kn(o,o.next)&&(ur(o),o=o.next),o}function Ys(e,t){if(!e)return e;t||(t=e);var s=e,i;do if(i=!1,!s.steiner&&(Kn(s,s.next)||Ht(s.prev,s,s.next)===0)){if(ur(s),s=t=s.prev,s===s.next)break;i=!0}else s=s.next;while(i||s!==t);return t}function hr(e,t,s,i,r,n,o){if(e){!o&&n&&A_(e,i,r,n);for(var a=e,l,h;e.prev!==e.next;){if(l=e.prev,h=e.next,n?x_(e,i,r,n):__(e)){t.push(l.i/s|0),t.push(e.i/s|0),t.push(h.i/s|0),ur(e),e=h.next,a=h.next;continue}if(e=h,e===a){o?o===1?(e=v_(Ys(e),t,s),hr(e,t,s,i,r,n,2)):o===2&&y_(e,t,s,i,r,n):hr(Ys(e),t,s,i,r,n,1);break}}}}function __(e){var t=e.prev,s=e,i=e.next;if(Ht(t,s,i)>=0)return!1;for(var r=t.x,n=s.x,o=i.x,a=t.y,l=s.y,h=i.y,c=r<n?r<o?r:o:n<o?n:o,u=a<l?a<h?a:h:l<h?l:h,d=r>n?r>o?r:o:n>o?n:o,p=a>l?a>h?a:h:l>h?l:h,f=i.next;f!==t;){if(f.x>=c&&f.x<=d&&f.y>=u&&f.y<=p&&ui(r,a,n,l,o,h,f.x,f.y)&&Ht(f.prev,f,f.next)>=0)return!1;f=f.next}return!0}function x_(e,t,s,i){var r=e.prev,n=e,o=e.next;if(Ht(r,n,o)>=0)return!1;for(var a=r.x,l=n.x,h=o.x,c=r.y,u=n.y,d=o.y,p=a<l?a<h?a:h:l<h?l:h,f=c<u?c<d?c:d:u<d?u:d,m=a>l?a>h?a:h:l>h?l:h,_=c>u?c>d?c:d:u>d?u:d,v=da(p,f,t,s,i),T=da(m,_,t,s,i),g=e.prevZ,b=e.nextZ;g&&g.z>=v&&b&&b.z<=T;){if(g.x>=p&&g.x<=m&&g.y>=f&&g.y<=_&&g!==r&&g!==o&&ui(a,c,l,u,h,d,g.x,g.y)&&Ht(g.prev,g,g.next)>=0||(g=g.prevZ,b.x>=p&&b.x<=m&&b.y>=f&&b.y<=_&&b!==r&&b!==o&&ui(a,c,l,u,h,d,b.x,b.y)&&Ht(b.prev,b,b.next)>=0))return!1;b=b.nextZ}for(;g&&g.z>=v;){if(g.x>=p&&g.x<=m&&g.y>=f&&g.y<=_&&g!==r&&g!==o&&ui(a,c,l,u,h,d,g.x,g.y)&&Ht(g.prev,g,g.next)>=0)return!1;g=g.prevZ}for(;b&&b.z<=T;){if(b.x>=p&&b.x<=m&&b.y>=f&&b.y<=_&&b!==r&&b!==o&&ui(a,c,l,u,h,d,b.x,b.y)&&Ht(b.prev,b,b.next)>=0)return!1;b=b.nextZ}return!0}function v_(e,t,s){var i=e;do{var r=i.prev,n=i.next.next;!Kn(r,n)&&ed(r,i,i.next,n)&&cr(r,n)&&cr(n,r)&&(t.push(r.i/s|0),t.push(i.i/s|0),t.push(n.i/s|0),ur(i),ur(i.next),i=e=n),i=i.next}while(i!==e);return Ys(i)}function y_(e,t,s,i,r,n){var o=e;do{for(var a=o.next.next;a!==o.prev;){if(o.i!==a.i&&R_(o,a)){var l=sd(o,a);o=Ys(o,o.next),l=Ys(l,l.next),hr(o,t,s,i,r,n,0),hr(l,t,s,i,r,n,0);return}a=a.next}o=o.next}while(o!==e)}function E_(e,t,s,i){var r=[],n,o,a,l,h;for(n=0,o=t.length;n<o;n++)a=t[n]*i,l=n<o-1?t[n+1]*i:e.length,h=td(e,a,l,i,!1),h===h.next&&(h.steiner=!0),r.push(I_(h));for(r.sort(b_),n=0;n<r.length;n++)s=T_(r[n],s);return s}function b_(e,t){return e.x-t.x}function T_(e,t){var s=w_(e,t);if(!s)return t;var i=sd(s,e);return Ys(i,i.next),Ys(s,s.next)}function w_(e,t){var s=t,i=e.x,r=e.y,n=-1/0,o;do{if(r<=s.y&&r>=s.next.y&&s.next.y!==s.y){var a=s.x+(r-s.y)*(s.next.x-s.x)/(s.next.y-s.y);if(a<=i&&a>n&&(n=a,o=s.x<s.next.x?s:s.next,a===i))return o}s=s.next}while(s!==t);if(!o)return null;var l=o,h=o.x,c=o.y,u=1/0,d;s=o;do i>=s.x&&s.x>=h&&i!==s.x&&ui(r<c?i:n,r,h,c,r<c?n:i,r,s.x,s.y)&&(d=Math.abs(r-s.y)/(i-s.x),cr(s,e)&&(d<u||d===u&&(s.x>o.x||s.x===o.x&&S_(o,s)))&&(o=s,u=d)),s=s.next;while(s!==l);return o}function S_(e,t){return Ht(e.prev,e,t.prev)<0&&Ht(t.next,e,e.next)<0}function A_(e,t,s,i){var r=e;do r.z===0&&(r.z=da(r.x,r.y,t,s,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==e);r.prevZ.nextZ=null,r.prevZ=null,C_(r)}function C_(e){var t,s,i,r,n,o,a,l,h=1;do{for(s=e,e=null,n=null,o=0;s;){for(o++,i=s,a=0,t=0;t<h&&(a++,i=i.nextZ,!!i);t++);for(l=h;a>0||l>0&&i;)a!==0&&(l===0||!i||s.z<=i.z)?(r=s,s=s.nextZ,a--):(r=i,i=i.nextZ,l--),n?n.nextZ=r:e=r,r.prevZ=n,n=r;s=i}n.nextZ=null,h*=2}while(o>1);return e}function da(e,t,s,i,r){return e=(e-s)*r|0,t=(t-i)*r|0,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e|t<<1}function I_(e){var t=e,s=e;do(t.x<s.x||t.x===s.x&&t.y<s.y)&&(s=t),t=t.next;while(t!==e);return s}function ui(e,t,s,i,r,n,o,a){return(r-o)*(t-a)>=(e-o)*(n-a)&&(e-o)*(i-a)>=(s-o)*(t-a)&&(s-o)*(n-a)>=(r-o)*(i-a)}function R_(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!P_(e,t)&&(cr(e,t)&&cr(t,e)&&M_(e,t)&&(Ht(e.prev,e,t.prev)||Ht(e,t.prev,t))||Kn(e,t)&&Ht(e.prev,e,e.next)>0&&Ht(t.prev,t,t.next)>0)}function Ht(e,t,s){return(t.y-e.y)*(s.x-t.x)-(t.x-e.x)*(s.y-t.y)}function Kn(e,t){return e.x===t.x&&e.y===t.y}function ed(e,t,s,i){var r=Or(Ht(e,t,s)),n=Or(Ht(e,t,i)),o=Or(Ht(s,i,e)),a=Or(Ht(s,i,t));return!!(r!==n&&o!==a||r===0&&Mr(e,s,t)||n===0&&Mr(e,i,t)||o===0&&Mr(s,e,i)||a===0&&Mr(s,t,i))}function Mr(e,t,s){return t.x<=Math.max(e.x,s.x)&&t.x>=Math.min(e.x,s.x)&&t.y<=Math.max(e.y,s.y)&&t.y>=Math.min(e.y,s.y)}function Or(e){return e>0?1:e<0?-1:0}function P_(e,t){var s=e;do{if(s.i!==e.i&&s.next.i!==e.i&&s.i!==t.i&&s.next.i!==t.i&&ed(s,s.next,e,t))return!0;s=s.next}while(s!==e);return!1}function cr(e,t){return Ht(e.prev,e,e.next)<0?Ht(e,t,e.next)>=0&&Ht(e,e.prev,t)>=0:Ht(e,t,e.prev)<0||Ht(e,e.next,t)<0}function M_(e,t){var s=e,i=!1,r=(e.x+t.x)/2,n=(e.y+t.y)/2;do s.y>n!=s.next.y>n&&s.next.y!==s.y&&r<(s.next.x-s.x)*(n-s.y)/(s.next.y-s.y)+s.x&&(i=!i),s=s.next;while(s!==e);return i}function sd(e,t){var s=new fa(e.i,e.x,e.y),i=new fa(t.i,t.x,t.y),r=e.next,n=t.prev;return e.next=t,t.prev=e,s.next=r,r.prev=s,i.next=s,s.prev=i,n.next=i,i.prev=n,i}function Nh(e,t,s,i){var r=new fa(e,t,s);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function ur(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function fa(e,t,s){this.i=e,this.x=t,this.y=s,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}Yn.deviation=function(e,t,s,i){var r=t&&t.length,n=r?t[0]*s:e.length,o=Math.abs(pa(e,0,n,s));if(r)for(var a=0,l=t.length;a<l;a++){var h=t[a]*s,c=a<l-1?t[a+1]*s:e.length;o-=Math.abs(pa(e,h,c,s))}var u=0;for(a=0;a<i.length;a+=3){var d=i[a]*s,p=i[a+1]*s,f=i[a+2]*s;u+=Math.abs((e[d]-e[f])*(e[p+1]-e[d+1])-(e[d]-e[p])*(e[f+1]-e[d+1]))}return o===0&&u===0?0:Math.abs((u-o)/o)};function pa(e,t,s,i){for(var r=0,n=t,o=s-i;n<s;n+=i)r+=(e[o]-e[n])*(e[n+1]+e[o+1]),o=n;return r}Yn.flatten=function(e){for(var t=e[0][0].length,s={vertices:[],holes:[],dimensions:t},i=0,r=0;r<e.length;r++){for(var n=0;n<e[r].length;n++)for(var o=0;o<t;o++)s.vertices.push(e[r][n][o]);r>0&&(i+=e[r-1].length,s.holes.push(i))}return s};var yn={},O_={get exports(){return yn},set exports(e){yn=e}};(function(e,t){(function(s){var i=t&&!t.nodeType&&t,r=e&&!e.nodeType&&e,n=typeof yo=="object"&&yo;(n.global===n||n.window===n||n.self===n)&&(s=n);var o,a=2147483647,l=36,h=1,c=26,u=38,d=700,p=72,f=128,m="-",_=/^xn--/,v=/[^\x20-\x7E]/,T=/[\x2E\u3002\uFF0E\uFF61]/g,g={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},b=l-h,S=Math.floor,A=String.fromCharCode,y;function E(N){throw RangeError(g[N])}function I(N,U){for(var Y=N.length,it=[];Y--;)it[Y]=U(N[Y]);return it}function F(N,U){var Y=N.split("@"),it="";Y.length>1&&(it=Y[0]+"@",N=Y[1]),N=N.replace(T,".");var Q=N.split("."),dt=I(Q,U).join(".");return it+dt}function L(N){for(var U=[],Y=0,it=N.length,Q,dt;Y<it;)Q=N.charCodeAt(Y++),Q>=55296&&Q<=56319&&Y<it?(dt=N.charCodeAt(Y++),(dt&64512)==56320?U.push(((Q&1023)<<10)+(dt&1023)+65536):(U.push(Q),Y--)):U.push(Q);return U}function j(N){return I(N,function(U){var Y="";return U>65535&&(U-=65536,Y+=A(U>>>10&1023|55296),U=56320|U&1023),Y+=A(U),Y}).join("")}function D(N){return N-48<10?N-22:N-65<26?N-65:N-97<26?N-97:l}function P(N,U){return N+22+75*(N<26)-((U!=0)<<5)}function ut(N,U,Y){var it=0;for(N=Y?S(N/d):N>>1,N+=S(N/U);N>b*c>>1;it+=l)N=S(N/b);return S(it+(b+1)*N/(N+u))}function nt(N){var U=[],Y=N.length,it,Q=0,dt=f,_t=p,ht,xt,Bt,Rt,Pt,x,w,C,M;for(ht=N.lastIndexOf(m),ht<0&&(ht=0),xt=0;xt<ht;++xt)N.charCodeAt(xt)>=128&&E("not-basic"),U.push(N.charCodeAt(xt));for(Bt=ht>0?ht+1:0;Bt<Y;){for(Rt=Q,Pt=1,x=l;Bt>=Y&&E("invalid-input"),w=D(N.charCodeAt(Bt++)),(w>=l||w>S((a-Q)/Pt))&&E("overflow"),Q+=w*Pt,C=x<=_t?h:x>=_t+c?c:x-_t,!(w<C);x+=l)M=l-C,Pt>S(a/M)&&E("overflow"),Pt*=M;it=U.length+1,_t=ut(Q-Rt,it,Rt==0),S(Q/it)>a-dt&&E("overflow"),dt+=S(Q/it),Q%=it,U.splice(Q++,0,dt)}return j(U)}function G(N){var U,Y,it,Q,dt,_t,ht,xt,Bt,Rt,Pt,x=[],w,C,M,B;for(N=L(N),w=N.length,U=f,Y=0,dt=p,_t=0;_t<w;++_t)Pt=N[_t],Pt<128&&x.push(A(Pt));for(it=Q=x.length,Q&&x.push(m);it<w;){for(ht=a,_t=0;_t<w;++_t)Pt=N[_t],Pt>=U&&Pt<ht&&(ht=Pt);for(C=it+1,ht-U>S((a-Y)/C)&&E("overflow"),Y+=(ht-U)*C,U=ht,_t=0;_t<w;++_t)if(Pt=N[_t],Pt<U&&++Y>a&&E("overflow"),Pt==U){for(xt=Y,Bt=l;Rt=Bt<=dt?h:Bt>=dt+c?c:Bt-dt,!(xt<Rt);Bt+=l)B=xt-Rt,M=l-Rt,x.push(A(P(Rt+B%M,0))),xt=S(B/M);x.push(A(P(xt,0))),dt=ut(Y,C,it==Q),Y=0,++it}++Y,++U}return x.join("")}function st(N){return F(N,function(U){return _.test(U)?nt(U.slice(4).toLowerCase()):U})}function At(N){return F(N,function(U){return v.test(U)?"xn--"+G(U):U})}if(o={version:"1.3.2",ucs2:{decode:L,encode:j},decode:nt,encode:G,toASCII:At,toUnicode:st},i&&r)if(e.exports==i)r.exports=o;else for(y in o)o.hasOwnProperty(y)&&(i[y]=o[y]);else s.punycode=o})(yo)})(O_,yn);var B_={isString:function(e){return typeof e=="string"},isObject:function(e){return typeof e=="object"&&e!==null},isNull:function(e){return e===null},isNullOrUndefined:function(e){return e==null}},dr={};function D_(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var F_=function(e,t,s,i){t=t||"&",s=s||"=";var r={};if(typeof e!="string"||e.length===0)return r;var n=/\+/g;e=e.split(t);var o=1e3;i&&typeof i.maxKeys=="number"&&(o=i.maxKeys);var a=e.length;o>0&&a>o&&(a=o);for(var l=0;l<a;++l){var h=e[l].replace(n,"%20"),c=h.indexOf(s),u,d,p,f;c>=0?(u=h.substr(0,c),d=h.substr(c+1)):(u=h,d=""),p=decodeURIComponent(u),f=decodeURIComponent(d),D_(r,p)?Array.isArray(r[p])?r[p].push(f):r[p]=[r[p],f]:r[p]=f}return r},ki=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}},L_=function(e,t,s,i){return t=t||"&",s=s||"=",e===null&&(e=void 0),typeof e=="object"?Object.keys(e).map(function(r){var n=encodeURIComponent(ki(r))+s;return Array.isArray(e[r])?e[r].map(function(o){return n+encodeURIComponent(ki(o))}).join(t):n+encodeURIComponent(ki(e[r]))}).join(t):i?encodeURIComponent(ki(i))+s+encodeURIComponent(ki(e)):""};dr.decode=dr.parse=F_;dr.encode=dr.stringify=L_;var N_=yn,Xe=B_,U_=qn,k_=q_,G_=K_;function De(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var H_=/^([a-z0-9.+-]+:)/i,W_=/:[0-9]*$/,$_=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,X_=["<",">",'"',"`"," ","\r",`
`,"	"],j_=["{","}","|","\\","^","`"].concat(X_),ma=["'"].concat(j_),Uh=["%","/","?",";","#"].concat(ma),kh=["/","?","#"],z_=255,Gh=/^[+a-z0-9A-Z_-]{0,63}$/,V_=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,Y_={javascript:!0,"javascript:":!0},ga={javascript:!0,"javascript:":!0},vi={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},_a=dr;function qn(e,t,s){if(e&&Xe.isObject(e)&&e instanceof De)return e;var i=new De;return i.parse(e,t,s),i}De.prototype.parse=function(e,t,s){if(!Xe.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var i=e.indexOf("?"),r=i!==-1&&i<e.indexOf("#")?"?":"#",n=e.split(r),o=/\\/g;n[0]=n[0].replace(o,"/"),e=n.join(r);var a=e;if(a=a.trim(),!s&&e.split("#").length===1){var l=$_.exec(a);if(l)return this.path=a,this.href=a,this.pathname=l[1],l[2]?(this.search=l[2],t?this.query=_a.parse(this.search.substr(1)):this.query=this.search.substr(1)):t&&(this.search="",this.query={}),this}var h=H_.exec(a);if(h){h=h[0];var c=h.toLowerCase();this.protocol=c,a=a.substr(h.length)}if(s||h||a.match(/^\/\/[^@\/]+@[^@\/]+/)){var u=a.substr(0,2)==="//";u&&!(h&&ga[h])&&(a=a.substr(2),this.slashes=!0)}if(!ga[h]&&(u||h&&!vi[h])){for(var d=-1,p=0;p<kh.length;p++){var f=a.indexOf(kh[p]);f!==-1&&(d===-1||f<d)&&(d=f)}var m,_;d===-1?_=a.lastIndexOf("@"):_=a.lastIndexOf("@",d),_!==-1&&(m=a.slice(0,_),a=a.slice(_+1),this.auth=decodeURIComponent(m)),d=-1;for(var p=0;p<Uh.length;p++){var f=a.indexOf(Uh[p]);f!==-1&&(d===-1||f<d)&&(d=f)}d===-1&&(d=a.length),this.host=a.slice(0,d),a=a.slice(d),this.parseHost(),this.hostname=this.hostname||"";var v=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!v)for(var T=this.hostname.split(/\./),p=0,g=T.length;p<g;p++){var b=T[p];if(b&&!b.match(Gh)){for(var S="",A=0,y=b.length;A<y;A++)b.charCodeAt(A)>127?S+="x":S+=b[A];if(!S.match(Gh)){var E=T.slice(0,p),I=T.slice(p+1),F=b.match(V_);F&&(E.push(F[1]),I.unshift(F[2])),I.length&&(a="/"+I.join(".")+a),this.hostname=E.join(".");break}}}this.hostname.length>z_?this.hostname="":this.hostname=this.hostname.toLowerCase(),v||(this.hostname=N_.toASCII(this.hostname));var L=this.port?":"+this.port:"",j=this.hostname||"";this.host=j+L,this.href+=this.host,v&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),a[0]!=="/"&&(a="/"+a))}if(!Y_[c])for(var p=0,g=ma.length;p<g;p++){var D=ma[p];if(a.indexOf(D)!==-1){var P=encodeURIComponent(D);P===D&&(P=escape(D)),a=a.split(D).join(P)}}var ut=a.indexOf("#");ut!==-1&&(this.hash=a.substr(ut),a=a.slice(0,ut));var nt=a.indexOf("?");if(nt!==-1?(this.search=a.substr(nt),this.query=a.substr(nt+1),t&&(this.query=_a.parse(this.query)),a=a.slice(0,nt)):t&&(this.search="",this.query={}),a&&(this.pathname=a),vi[c]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var L=this.pathname||"",G=this.search||"";this.path=L+G}return this.href=this.format(),this};function K_(e){return Xe.isString(e)&&(e=qn(e)),e instanceof De?e.format():De.prototype.format.call(e)}De.prototype.format=function(){var e=this.auth||"";e&&(e=encodeURIComponent(e),e=e.replace(/%3A/i,":"),e+="@");var t=this.protocol||"",s=this.pathname||"",i=this.hash||"",r=!1,n="";this.host?r=e+this.host:this.hostname&&(r=e+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(r+=":"+this.port)),this.query&&Xe.isObject(this.query)&&Object.keys(this.query).length&&(n=_a.stringify(this.query));var o=this.search||n&&"?"+n||"";return t&&t.substr(-1)!==":"&&(t+=":"),this.slashes||(!t||vi[t])&&r!==!1?(r="//"+(r||""),s&&s.charAt(0)!=="/"&&(s="/"+s)):r||(r=""),i&&i.charAt(0)!=="#"&&(i="#"+i),o&&o.charAt(0)!=="?"&&(o="?"+o),s=s.replace(/[?#]/g,function(a){return encodeURIComponent(a)}),o=o.replace("#","%23"),t+r+s+o+i};function q_(e,t){return qn(e,!1,!0).resolve(t)}De.prototype.resolve=function(e){return this.resolveObject(qn(e,!1,!0)).format()};De.prototype.resolveObject=function(e){if(Xe.isString(e)){var t=new De;t.parse(e,!1,!0),e=t}for(var s=new De,i=Object.keys(this),r=0;r<i.length;r++){var n=i[r];s[n]=this[n]}if(s.hash=e.hash,e.href==="")return s.href=s.format(),s;if(e.slashes&&!e.protocol){for(var o=Object.keys(e),a=0;a<o.length;a++){var l=o[a];l!=="protocol"&&(s[l]=e[l])}return vi[s.protocol]&&s.hostname&&!s.pathname&&(s.path=s.pathname="/"),s.href=s.format(),s}if(e.protocol&&e.protocol!==s.protocol){if(!vi[e.protocol]){for(var h=Object.keys(e),c=0;c<h.length;c++){var u=h[c];s[u]=e[u]}return s.href=s.format(),s}if(s.protocol=e.protocol,!e.host&&!ga[e.protocol]){for(var g=(e.pathname||"").split("/");g.length&&!(e.host=g.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),g[0]!==""&&g.unshift(""),g.length<2&&g.unshift(""),s.pathname=g.join("/")}else s.pathname=e.pathname;if(s.search=e.search,s.query=e.query,s.host=e.host||"",s.auth=e.auth,s.hostname=e.hostname||e.host,s.port=e.port,s.pathname||s.search){var d=s.pathname||"",p=s.search||"";s.path=d+p}return s.slashes=s.slashes||e.slashes,s.href=s.format(),s}var f=s.pathname&&s.pathname.charAt(0)==="/",m=e.host||e.pathname&&e.pathname.charAt(0)==="/",_=m||f||s.host&&e.pathname,v=_,T=s.pathname&&s.pathname.split("/")||[],g=e.pathname&&e.pathname.split("/")||[],b=s.protocol&&!vi[s.protocol];if(b&&(s.hostname="",s.port=null,s.host&&(T[0]===""?T[0]=s.host:T.unshift(s.host)),s.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(g[0]===""?g[0]=e.host:g.unshift(e.host)),e.host=null),_=_&&(g[0]===""||T[0]==="")),m)s.host=e.host||e.host===""?e.host:s.host,s.hostname=e.hostname||e.hostname===""?e.hostname:s.hostname,s.search=e.search,s.query=e.query,T=g;else if(g.length)T||(T=[]),T.pop(),T=T.concat(g),s.search=e.search,s.query=e.query;else if(!Xe.isNullOrUndefined(e.search)){if(b){s.hostname=s.host=T.shift();var S=s.host&&s.host.indexOf("@")>0?s.host.split("@"):!1;S&&(s.auth=S.shift(),s.host=s.hostname=S.shift())}return s.search=e.search,s.query=e.query,(!Xe.isNull(s.pathname)||!Xe.isNull(s.search))&&(s.path=(s.pathname?s.pathname:"")+(s.search?s.search:"")),s.href=s.format(),s}if(!T.length)return s.pathname=null,s.search?s.path="/"+s.search:s.path=null,s.href=s.format(),s;for(var A=T.slice(-1)[0],y=(s.host||e.host||T.length>1)&&(A==="."||A==="..")||A==="",E=0,I=T.length;I>=0;I--)A=T[I],A==="."?T.splice(I,1):A===".."?(T.splice(I,1),E++):E&&(T.splice(I,1),E--);if(!_&&!v)for(;E--;E)T.unshift("..");_&&T[0]!==""&&(!T[0]||T[0].charAt(0)!=="/")&&T.unshift(""),y&&T.join("/").substr(-1)!=="/"&&T.push("");var F=T[0]===""||T[0]&&T[0].charAt(0)==="/";if(b){s.hostname=s.host=F?"":T.length?T.shift():"";var S=s.host&&s.host.indexOf("@")>0?s.host.split("@"):!1;S&&(s.auth=S.shift(),s.host=s.hostname=S.shift())}return _=_||s.host&&T.length,_&&!F&&T.unshift(""),T.length?s.pathname=T.join("/"):(s.pathname=null,s.path=null),(!Xe.isNull(s.pathname)||!Xe.isNull(s.search))&&(s.path=(s.pathname?s.pathname:"")+(s.search?s.search:"")),s.auth=e.auth||s.auth,s.slashes=s.slashes||e.slashes,s.href=s.format(),s};De.prototype.parseHost=function(){var e=this.host,t=W_.exec(e);t&&(t=t[0],t!==":"&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)};const Z_={parse:U_,format:G_,resolve:k_};function we(e){if(typeof e!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(e)}`)}function Gi(e){return e.split("?")[0].split("#")[0]}function J_(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Q_(e,t,s){return e.replace(new RegExp(J_(t),"g"),s)}function tx(e,t){let s="",i=0,r=-1,n=0,o=-1;for(let a=0;a<=e.length;++a){if(a<e.length)o=e.charCodeAt(a);else{if(o===47)break;o=47}if(o===47){if(!(r===a-1||n===1))if(r!==a-1&&n===2){if(s.length<2||i!==2||s.charCodeAt(s.length-1)!==46||s.charCodeAt(s.length-2)!==46){if(s.length>2){const l=s.lastIndexOf("/");if(l!==s.length-1){l===-1?(s="",i=0):(s=s.slice(0,l),i=s.length-1-s.lastIndexOf("/")),r=a,n=0;continue}}else if(s.length===2||s.length===1){s="",i=0,r=a,n=0;continue}}t&&(s.length>0?s+="/..":s="..",i=2)}else s.length>0?s+=`/${e.slice(r+1,a)}`:s=e.slice(r+1,a),i=a-r-1;r=a,n=0}else o===46&&n!==-1?++n:n=-1}return s}const se={toPosix(e){return Q_(e,"\\","/")},isUrl(e){return/^https?:/.test(this.toPosix(e))},isDataUrl(e){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(e)},hasProtocol(e){return/^[^/:]+:\//.test(this.toPosix(e))},getProtocol(e){we(e),e=this.toPosix(e);let t="";const s=/^file:\/\/\//.exec(e),i=/^[^/:]+:\/\//.exec(e),r=/^[^/:]+:\//.exec(e);if(s||i||r){const n=(s==null?void 0:s[0])||(i==null?void 0:i[0])||(r==null?void 0:r[0]);t=n,e=e.slice(n.length)}return t},toAbsolute(e,t,s){if(this.isDataUrl(e))return e;const i=Gi(this.toPosix(t??q.ADAPTER.getBaseUrl())),r=Gi(this.toPosix(s??this.rootname(i)));return we(e),e=this.toPosix(e),e.startsWith("/")?se.join(r,e.slice(1)):this.isAbsolute(e)?e:this.join(i,e)},normalize(e){if(e=this.toPosix(e),we(e),e.length===0)return".";let t="";const s=e.startsWith("/");this.hasProtocol(e)&&(t=this.rootname(e),e=e.slice(t.length));const i=e.endsWith("/");return e=tx(e,!1),e.length>0&&i&&(e+="/"),s?`/${e}`:t+e},isAbsolute(e){return we(e),e=this.toPosix(e),this.hasProtocol(e)?!0:e.startsWith("/")},join(...e){if(e.length===0)return".";let t;for(let s=0;s<e.length;++s){const i=e[s];if(we(i),i.length>0)if(t===void 0)t=i;else{const r=e[s-1]??"";this.extname(r)?t+=`/../${i}`:t+=`/${i}`}}return t===void 0?".":this.normalize(t)},dirname(e){if(we(e),e.length===0)return".";e=this.toPosix(e);let t=e.charCodeAt(0);const s=t===47;let i=-1,r=!0;const n=this.getProtocol(e),o=e;e=e.slice(n.length);for(let a=e.length-1;a>=1;--a)if(t=e.charCodeAt(a),t===47){if(!r){i=a;break}}else r=!1;return i===-1?s?"/":this.isUrl(o)?n+e:n:s&&i===1?"//":n+e.slice(0,i)},rootname(e){we(e),e=this.toPosix(e);let t="";if(e.startsWith("/")?t="/":t=this.getProtocol(e),this.isUrl(e)){const s=e.indexOf("/",t.length);s!==-1?t=e.slice(0,s):t=e,t.endsWith("/")||(t+="/")}return t},basename(e,t){we(e),t&&we(t),e=Gi(this.toPosix(e));let s=0,i=-1,r=!0,n;if(t!==void 0&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return"";let o=t.length-1,a=-1;for(n=e.length-1;n>=0;--n){const l=e.charCodeAt(n);if(l===47){if(!r){s=n+1;break}}else a===-1&&(r=!1,a=n+1),o>=0&&(l===t.charCodeAt(o)?--o===-1&&(i=n):(o=-1,i=a))}return s===i?i=a:i===-1&&(i=e.length),e.slice(s,i)}for(n=e.length-1;n>=0;--n)if(e.charCodeAt(n)===47){if(!r){s=n+1;break}}else i===-1&&(r=!1,i=n+1);return i===-1?"":e.slice(s,i)},extname(e){we(e),e=Gi(this.toPosix(e));let t=-1,s=0,i=-1,r=!0,n=0;for(let o=e.length-1;o>=0;--o){const a=e.charCodeAt(o);if(a===47){if(!r){s=o+1;break}continue}i===-1&&(r=!1,i=o+1),a===46?t===-1?t=o:n!==1&&(n=1):t!==-1&&(n=-1)}return t===-1||i===-1||n===0||n===1&&t===i-1&&t===s+1?"":e.slice(t,i)},parse(e){we(e);const t={root:"",dir:"",base:"",ext:"",name:""};if(e.length===0)return t;e=Gi(this.toPosix(e));let s=e.charCodeAt(0);const i=this.isAbsolute(e);let r;t.root=this.rootname(e),i||this.hasProtocol(e)?r=1:r=0;let n=-1,o=0,a=-1,l=!0,h=e.length-1,c=0;for(;h>=r;--h){if(s=e.charCodeAt(h),s===47){if(!l){o=h+1;break}continue}a===-1&&(l=!1,a=h+1),s===46?n===-1?n=h:c!==1&&(c=1):n!==-1&&(c=-1)}return n===-1||a===-1||c===0||c===1&&n===a-1&&n===o+1?a!==-1&&(o===0&&i?t.base=t.name=e.slice(1,a):t.base=t.name=e.slice(o,a)):(o===0&&i?(t.name=e.slice(1,n),t.base=e.slice(1,a)):(t.name=e.slice(o,n),t.base=e.slice(o,a)),t.ext=e.slice(n,a)),t.dir=this.dirname(e),t},sep:"/",delimiter:":"},Hh={};function Ct(e,t,s=3){if(Hh[t])return;let i=new Error().stack;typeof i>"u"?console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${e}`):(i=i.split(`
`).splice(s).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${t}
Deprecated since v${e}`),console.warn(i),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${e}`),console.warn(i))),Hh[t]=!0}let Eo;function ex(){return typeof Eo>"u"&&(Eo=function(){var s;const t={stencil:!0,failIfMajorPerformanceCaveat:q.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!q.ADAPTER.getWebGLRenderingContext())return!1;const i=q.ADAPTER.createCanvas();let r=i.getContext("webgl",t)||i.getContext("experimental-webgl",t);const n=!!((s=r==null?void 0:r.getContextAttributes())!=null&&s.stencil);if(r){const o=r.getExtension("WEBGL_lose_context");o&&o.loseContext()}return r=null,n}catch{return!1}}()),Eo}var sx="#f0f8ff",ix="#faebd7",rx="#00ffff",nx="#7fffd4",ox="#f0ffff",ax="#f5f5dc",lx="#ffe4c4",hx="#000000",cx="#ffebcd",ux="#0000ff",dx="#8a2be2",fx="#a52a2a",px="#deb887",mx="#5f9ea0",gx="#7fff00",_x="#d2691e",xx="#ff7f50",vx="#6495ed",yx="#fff8dc",Ex="#dc143c",bx="#00ffff",Tx="#00008b",wx="#008b8b",Sx="#b8860b",Ax="#a9a9a9",Cx="#006400",Ix="#a9a9a9",Rx="#bdb76b",Px="#8b008b",Mx="#556b2f",Ox="#ff8c00",Bx="#9932cc",Dx="#8b0000",Fx="#e9967a",Lx="#8fbc8f",Nx="#483d8b",Ux="#2f4f4f",kx="#2f4f4f",Gx="#00ced1",Hx="#9400d3",Wx="#ff1493",$x="#00bfff",Xx="#696969",jx="#696969",zx="#1e90ff",Vx="#b22222",Yx="#fffaf0",Kx="#228b22",qx="#ff00ff",Zx="#dcdcdc",Jx="#f8f8ff",Qx="#daa520",t0="#ffd700",e0="#808080",s0="#008000",i0="#adff2f",r0="#808080",n0="#f0fff0",o0="#ff69b4",a0="#cd5c5c",l0="#4b0082",h0="#fffff0",c0="#f0e68c",u0="#fff0f5",d0="#e6e6fa",f0="#7cfc00",p0="#fffacd",m0="#add8e6",g0="#f08080",_0="#e0ffff",x0="#fafad2",v0="#d3d3d3",y0="#90ee90",E0="#d3d3d3",b0="#ffb6c1",T0="#ffa07a",w0="#20b2aa",S0="#87cefa",A0="#778899",C0="#778899",I0="#b0c4de",R0="#ffffe0",P0="#00ff00",M0="#32cd32",O0="#faf0e6",B0="#ff00ff",D0="#800000",F0="#66cdaa",L0="#0000cd",N0="#ba55d3",U0="#9370db",k0="#3cb371",G0="#7b68ee",H0="#00fa9a",W0="#48d1cc",$0="#c71585",X0="#191970",j0="#f5fffa",z0="#ffe4e1",V0="#ffe4b5",Y0="#ffdead",K0="#000080",q0="#fdf5e6",Z0="#808000",J0="#6b8e23",Q0="#ffa500",tv="#ff4500",ev="#da70d6",sv="#eee8aa",iv="#98fb98",rv="#afeeee",nv="#db7093",ov="#ffefd5",av="#ffdab9",lv="#cd853f",hv="#ffc0cb",cv="#dda0dd",uv="#b0e0e6",dv="#800080",fv="#663399",pv="#ff0000",mv="#bc8f8f",gv="#4169e1",_v="#8b4513",xv="#fa8072",vv="#f4a460",yv="#2e8b57",Ev="#fff5ee",bv="#a0522d",Tv="#c0c0c0",wv="#87ceeb",Sv="#6a5acd",Av="#708090",Cv="#708090",Iv="#fffafa",Rv="#00ff7f",Pv="#4682b4",Mv="#d2b48c",Ov="#008080",Bv="#d8bfd8",Dv="#ff6347",Fv="#40e0d0",Lv="#ee82ee",Nv="#f5deb3",Uv="#ffffff",kv="#f5f5f5",Gv="#ffff00",Hv="#9acd32",Wv={aliceblue:sx,antiquewhite:ix,aqua:rx,aquamarine:nx,azure:ox,beige:ax,bisque:lx,black:hx,blanchedalmond:cx,blue:ux,blueviolet:dx,brown:fx,burlywood:px,cadetblue:mx,chartreuse:gx,chocolate:_x,coral:xx,cornflowerblue:vx,cornsilk:yx,crimson:Ex,cyan:bx,darkblue:Tx,darkcyan:wx,darkgoldenrod:Sx,darkgray:Ax,darkgreen:Cx,darkgrey:Ix,darkkhaki:Rx,darkmagenta:Px,darkolivegreen:Mx,darkorange:Ox,darkorchid:Bx,darkred:Dx,darksalmon:Fx,darkseagreen:Lx,darkslateblue:Nx,darkslategray:Ux,darkslategrey:kx,darkturquoise:Gx,darkviolet:Hx,deeppink:Wx,deepskyblue:$x,dimgray:Xx,dimgrey:jx,dodgerblue:zx,firebrick:Vx,floralwhite:Yx,forestgreen:Kx,fuchsia:qx,gainsboro:Zx,ghostwhite:Jx,goldenrod:Qx,gold:t0,gray:e0,green:s0,greenyellow:i0,grey:r0,honeydew:n0,hotpink:o0,indianred:a0,indigo:l0,ivory:h0,khaki:c0,lavenderblush:u0,lavender:d0,lawngreen:f0,lemonchiffon:p0,lightblue:m0,lightcoral:g0,lightcyan:_0,lightgoldenrodyellow:x0,lightgray:v0,lightgreen:y0,lightgrey:E0,lightpink:b0,lightsalmon:T0,lightseagreen:w0,lightskyblue:S0,lightslategray:A0,lightslategrey:C0,lightsteelblue:I0,lightyellow:R0,lime:P0,limegreen:M0,linen:O0,magenta:B0,maroon:D0,mediumaquamarine:F0,mediumblue:L0,mediumorchid:N0,mediumpurple:U0,mediumseagreen:k0,mediumslateblue:G0,mediumspringgreen:H0,mediumturquoise:W0,mediumvioletred:$0,midnightblue:X0,mintcream:j0,mistyrose:z0,moccasin:V0,navajowhite:Y0,navy:K0,oldlace:q0,olive:Z0,olivedrab:J0,orange:Q0,orangered:tv,orchid:ev,palegoldenrod:sv,palegreen:iv,paleturquoise:rv,palevioletred:nv,papayawhip:ov,peachpuff:av,peru:lv,pink:hv,plum:cv,powderblue:uv,purple:dv,rebeccapurple:fv,red:pv,rosybrown:mv,royalblue:gv,saddlebrown:_v,salmon:xv,sandybrown:vv,seagreen:yv,seashell:Ev,sienna:bv,silver:Tv,skyblue:wv,slateblue:Sv,slategray:Av,slategrey:Cv,snow:Iv,springgreen:Rv,steelblue:Pv,tan:Mv,teal:Ov,thistle:Bv,tomato:Dv,turquoise:Fv,violet:Lv,wheat:Nv,white:Uv,whitesmoke:kv,yellow:Gv,yellowgreen:Hv};function fr(e,t=[]){return t[0]=(e>>16&255)/255,t[1]=(e>>8&255)/255,t[2]=(e&255)/255,t}function id(e){let t=e.toString(16);return t="000000".substring(0,6-t.length)+t,`#${t}`}function ml(e){if(typeof e=="string"&&(e=Wv[e.toLowerCase()]||e,e[0]==="#"&&(e=e.slice(1)),e.length===3)){const[t,s,i]=e;e=t+t+s+s+i+i}return parseInt(e,16)}function $v(){const e=[],t=[];for(let i=0;i<32;i++)e[i]=i,t[i]=i;e[ct.NORMAL_NPM]=ct.NORMAL,e[ct.ADD_NPM]=ct.ADD,e[ct.SCREEN_NPM]=ct.SCREEN,t[ct.NORMAL]=ct.NORMAL_NPM,t[ct.ADD]=ct.ADD_NPM,t[ct.SCREEN]=ct.SCREEN_NPM;const s=[];return s.push(t),s.push(e),s}const rd=$v();function nd(e,t){return rd[t?1:0][e]}function Xv(e,t,s,i){return s=s||new Float32Array(4),i||i===void 0?(s[0]=e[0]*t,s[1]=e[1]*t,s[2]=e[2]*t):(s[0]=e[0],s[1]=e[1],s[2]=e[2]),s[3]=t,s}function gl(e,t){if(t===1)return(t*255<<24)+e;if(t===0)return 0;let s=e>>16&255,i=e>>8&255,r=e&255;return s=s*t+.5|0,i=i*t+.5|0,r=r*t+.5|0,(t*255<<24)+(s<<16)+(i<<8)+r}function od(e,t,s,i){return s=s||new Float32Array(4),s[0]=(e>>16&255)/255,s[1]=(e>>8&255)/255,s[2]=(e&255)/255,(i||i===void 0)&&(s[0]*=t,s[1]*=t,s[2]*=t),s[3]=t,s}function jv(e,t=null){const s=e*6;if(t=t||new Uint16Array(s),t.length!==s)throw new Error(`Out buffer length is incorrect, got ${t.length} and expected ${s}`);for(let i=0,r=0;i<s;i+=6,r+=4)t[i+0]=r+0,t[i+1]=r+1,t[i+2]=r+2,t[i+3]=r+0,t[i+4]=r+2,t[i+5]=r+3;return t}function ad(e){if(e.BYTES_PER_ELEMENT===4)return e instanceof Float32Array?"Float32Array":e instanceof Uint32Array?"Uint32Array":"Int32Array";if(e.BYTES_PER_ELEMENT===2){if(e instanceof Uint16Array)return"Uint16Array"}else if(e.BYTES_PER_ELEMENT===1&&e instanceof Uint8Array)return"Uint8Array";return null}function En(e){return e+=e===0?1:0,--e,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e+1}function Wh(e){return!(e&e-1)&&!!e}function $h(e){let t=(e>65535?1:0)<<4;e>>>=t;let s=(e>255?1:0)<<3;return e>>>=s,t|=s,s=(e>15?1:0)<<2,e>>>=s,t|=s,s=(e>3?1:0)<<1,e>>>=s,t|=s,t|e>>1}function yi(e,t,s){const i=e.length;let r;if(t>=i||s===0)return;s=t+s>i?i-t:s;const n=i-s;for(r=t;r<n;++r)e[r]=e[r+s];e.length=n}function di(e){return e===0?0:e<0?-1:1}let zv=0;function Ks(){return++zv}const ld=class{constructor(e,t,s,i){this.left=e,this.top=t,this.right=s,this.bottom=i}get width(){return this.right-this.left}get height(){return this.bottom-this.top}isEmpty(){return this.left===this.right||this.top===this.bottom}};let xa=ld;xa.EMPTY=new ld(0,0,0,0);const Xh={},Ge=Object.create(null),ms=Object.create(null);class jh{constructor(t,s,i){this._canvas=q.ADAPTER.createCanvas(),this._context=this._canvas.getContext("2d"),this.resolution=i||q.RESOLUTION,this.resize(t,s)}clear(){this._checkDestroyed(),this._context.setTransform(1,0,0,1,0,0),this._context.clearRect(0,0,this._canvas.width,this._canvas.height)}resize(t,s){this._checkDestroyed(),this._canvas.width=Math.round(t*this.resolution),this._canvas.height=Math.round(s*this.resolution)}destroy(){this._context=null,this._canvas=null}get width(){return this._checkDestroyed(),this._canvas.width}set width(t){this._checkDestroyed(),this._canvas.width=Math.round(t)}get height(){return this._checkDestroyed(),this._canvas.height}set height(t){this._checkDestroyed(),this._canvas.height=Math.round(t)}get canvas(){return this._checkDestroyed(),this._canvas}get context(){return this._checkDestroyed(),this._context}_checkDestroyed(){if(this._canvas===null)throw new TypeError("The CanvasRenderTarget has already been destroyed")}}function zh(e,t,s){for(let i=0,r=4*s*t;i<t;++i,r+=4)if(e[r+3]!==0)return!1;return!0}function Vh(e,t,s,i,r){const n=4*t;for(let o=i,a=i*n+4*s;o<=r;++o,a+=n)if(e[a+3]!==0)return!1;return!0}function Vv(e){const{width:t,height:s}=e,i=e.getContext("2d",{willReadFrequently:!0});if(i===null)throw new TypeError("Failed to get canvas 2D context");const n=i.getImageData(0,0,t,s).data;let o=0,a=0,l=t-1,h=s-1;for(;a<s&&zh(n,t,a);)++a;if(a===s)return xa.EMPTY;for(;zh(n,t,h);)--h;for(;Vh(n,t,o,a,h);)++o;for(;Vh(n,t,l,a,h);)--l;return++l,++h,new xa(o,a,l,h)}function Yv(e){const t=Vv(e),{width:s,height:i}=t;let r=null;if(!t.isEmpty()){const n=e.getContext("2d");if(n===null)throw new TypeError("Failed to get canvas 2D context");r=n.getImageData(t.left,t.top,s,i)}return{width:s,height:i,data:r}}let Br;function Kv(e,t=globalThis.location){if(e.startsWith("data:"))return"";t=t||globalThis.location,Br||(Br=document.createElement("a")),Br.href=e;const s=Z_.parse(Br.href),i=!s.port&&t.port===""||s.port===t.port;return s.hostname!==t.hostname||!i||s.protocol!==t.protocol?"anonymous":""}function As(e,t=1){var i;const s=(i=q.RETINA_PREFIX)==null?void 0:i.exec(e);return s?parseFloat(s[1]):t}var K=(e=>(e.Renderer="renderer",e.Application="application",e.RendererSystem="renderer-webgl-system",e.RendererPlugin="renderer-webgl-plugin",e.CanvasRendererSystem="renderer-canvas-system",e.CanvasRendererPlugin="renderer-canvas-plugin",e.Asset="asset",e.LoadParser="load-parser",e.ResolveParser="resolve-parser",e.CacheParser="cache-parser",e.DetectionParser="detection-parser",e))(K||{});const va=e=>{if(typeof e=="function"||typeof e=="object"&&e.extension){if(!e.extension)throw new Error("Extension class must have an extension object");e={...typeof e.extension!="object"?{type:e.extension}:e.extension,ref:e}}if(typeof e=="object")e={...e};else throw new Error("Invalid extension type");return typeof e.type=="string"&&(e.type=[e.type]),e},Yh=(e,t)=>va(e).priority??t,rt={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...e){return e.map(va).forEach(t=>{t.type.forEach(s=>{var i,r;return(r=(i=this._removeHandlers)[s])==null?void 0:r.call(i,t)})}),this},add(...e){return e.map(va).forEach(t=>{t.type.forEach(s=>{const i=this._addHandlers,r=this._queue;i[s]?i[s](t):(r[s]=r[s]||[],r[s].push(t))})}),this},handle(e,t,s){const i=this._addHandlers,r=this._removeHandlers;if(i[e]||r[e])throw new Error(`Extension type ${e} already has a handler`);i[e]=t,r[e]=s;const n=this._queue;return n[e]&&(n[e].forEach(o=>t(o)),delete n[e]),this},handleByMap(e,t){return this.handle(e,s=>{t[s.name]=s.ref},s=>{delete t[s.name]})},handleByList(e,t,s=-1){return this.handle(e,i=>{t.includes(i.ref)||(t.push(i.ref),t.sort((r,n)=>Yh(n,s)-Yh(r,s)))},i=>{const r=t.indexOf(i.ref);r!==-1&&t.splice(r,1)})}};class ya{constructor(t){typeof t=="number"?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get uint16View(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}view(t){return this[`${t}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${t} isn't a valid view type`)}}}const qv=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function Zv(e){let t="";for(let s=0;s<e;++s)s>0&&(t+=`
else `),s<e-1&&(t+=`if(test == ${s}.0){}`);return t}function Jv(e,t){if(e===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const s=t.createShader(t.FRAGMENT_SHADER);for(;;){const i=qv.replace(/%forloop%/gi,Zv(e));if(t.shaderSource(s,i),t.compileShader(s),!t.getShaderParameter(s,t.COMPILE_STATUS))e=e/2|0;else break}return e}const bo=0,To=1,wo=2,So=3,Ao=4,Co=5;class us{constructor(){this.data=0,this.blendMode=ct.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<bo)}set blend(t){!!(this.data&1<<bo)!==t&&(this.data^=1<<bo)}get offsets(){return!!(this.data&1<<To)}set offsets(t){!!(this.data&1<<To)!==t&&(this.data^=1<<To)}get culling(){return!!(this.data&1<<wo)}set culling(t){!!(this.data&1<<wo)!==t&&(this.data^=1<<wo)}get depthTest(){return!!(this.data&1<<So)}set depthTest(t){!!(this.data&1<<So)!==t&&(this.data^=1<<So)}get depthMask(){return!!(this.data&1<<Co)}set depthMask(t){!!(this.data&1<<Co)!==t&&(this.data^=1<<Co)}get clockwiseFrontFace(){return!!(this.data&1<<Ao)}set clockwiseFrontFace(t){!!(this.data&1<<Ao)!==t&&(this.data^=1<<Ao)}get blendMode(){return this._blendMode}set blendMode(t){this.blend=t!==ct.NONE,this._blendMode=t}get polygonOffset(){return this._polygonOffset}set polygonOffset(t){this.offsets=!!t,this._polygonOffset=t}toString(){return`[@pixi/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`}static for2d(){const t=new us;return t.depthTest=!1,t.blend=!0,t}}const Ea=[];function hd(e,t){if(!e)return null;let s="";if(typeof e=="string"){const i=/\.(\w{3,4})(?:$|\?|#)/i.exec(e);i&&(s=i[1].toLowerCase())}for(let i=Ea.length-1;i>=0;--i){const r=Ea[i];if(r.test&&r.test(e,s))return new r(e,t)}throw new Error("Unrecognized source type to auto-detect Resource")}class Fe{constructor(t){this.items=[],this._name=t,this._aliasCount=0}emit(t,s,i,r,n,o,a,l){if(arguments.length>8)throw new Error("max arguments reached");const{name:h,items:c}=this;this._aliasCount++;for(let u=0,d=c.length;u<d;u++)c[u][h](t,s,i,r,n,o,a,l);return c===this.items&&this._aliasCount--,this}ensureNonAliasedItems(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))}add(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this}remove(t){const s=this.items.indexOf(t);return s!==-1&&(this.ensureNonAliasedItems(),this.items.splice(s,1)),this}contains(t){return this.items.includes(t)}removeAll(){return this.ensureNonAliasedItems(),this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return this.items.length===0}get name(){return this._name}}Object.defineProperties(Fe.prototype,{dispatch:{value:Fe.prototype.emit},run:{value:Fe.prototype.emit}});class pr{constructor(t=0,s=0){this._width=t,this._height=s,this.destroyed=!1,this.internal=!1,this.onResize=new Fe("setRealSize"),this.onUpdate=new Fe("update"),this.onError=new Fe("onError")}bind(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),(this._width||this._height)&&this.onResize.emit(this._width,this._height)}unbind(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)}resize(t,s){(t!==this._width||s!==this._height)&&(this._width=t,this._height=s,this.onResize.emit(t,s))}get valid(){return!!this._width&&!!this._height}update(){this.destroyed||this.onUpdate.emit()}load(){return Promise.resolve(this)}get width(){return this._width}get height(){return this._height}style(t,s,i){return!1}dispose(){}destroy(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)}static test(t,s){return!1}}class yr extends pr{constructor(t,s){const{width:i,height:r}=s||{};if(!i||!r)throw new Error("BufferResource width or height invalid");super(i,r),this.data=t}upload(t,s,i){const r=t.gl;r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,s.alphaMode===Ne.UNPACK);const n=s.realWidth,o=s.realHeight;return i.width===n&&i.height===o?r.texSubImage2D(s.target,0,0,0,n,o,s.format,i.type,this.data):(i.width=n,i.height=o,r.texImage2D(s.target,0,i.internalFormat,n,o,0,s.format,i.type,this.data)),!0}dispose(){this.data=null}static test(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array}}const Qv={scaleMode:ns.NEAREST,format:X.RGBA,alphaMode:Ne.NPM},ai=class extends Vs{constructor(e=null,t=null){super(),t=Object.assign({},ai.defaultOptions,t);const{alphaMode:s,mipmap:i,anisotropicLevel:r,scaleMode:n,width:o,height:a,wrapMode:l,format:h,type:c,target:u,resolution:d,resourceOptions:p}=t;e&&!(e instanceof pr)&&(e=hd(e,p),e.internal=!0),this.resolution=d||q.RESOLUTION,this.width=Math.round((o||0)*this.resolution)/this.resolution,this.height=Math.round((a||0)*this.resolution)/this.resolution,this._mipmap=i,this.anisotropicLevel=r,this._wrapMode=l,this._scaleMode=n,this.format=h,this.type=c,this.target=u,this.alphaMode=s,this.uid=Ks(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=o>0&&a>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.parentTextureArray=null,this.setResource(e)}get realWidth(){return Math.round(this.width*this.resolution)}get realHeight(){return Math.round(this.height*this.resolution)}get mipmap(){return this._mipmap}set mipmap(e){this._mipmap!==e&&(this._mipmap=e,this.dirtyStyleId++)}get scaleMode(){return this._scaleMode}set scaleMode(e){this._scaleMode!==e&&(this._scaleMode=e,this.dirtyStyleId++)}get wrapMode(){return this._wrapMode}set wrapMode(e){this._wrapMode!==e&&(this._wrapMode=e,this.dirtyStyleId++)}setStyle(e,t){let s;return e!==void 0&&e!==this.scaleMode&&(this.scaleMode=e,s=!0),t!==void 0&&t!==this.mipmap&&(this.mipmap=t,s=!0),s&&this.dirtyStyleId++,this}setSize(e,t,s){return s=s||this.resolution,this.setRealSize(e*s,t*s,s)}setRealSize(e,t,s){return this.resolution=s||this.resolution,this.width=Math.round(e)/this.resolution,this.height=Math.round(t)/this.resolution,this._refreshPOT(),this.update(),this}_refreshPOT(){this.isPowerOfTwo=Wh(this.realWidth)&&Wh(this.realHeight)}setResolution(e){const t=this.resolution;return t===e?this:(this.resolution=e,this.valid&&(this.width=Math.round(this.width*t)/e,this.height=Math.round(this.height*t)/e,this.emit("update",this)),this._refreshPOT(),this)}setResource(e){if(this.resource===e)return this;if(this.resource)throw new Error("Resource can be set only once");return e.bind(this),this.resource=e,this}update(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))}onError(e){this.emit("error",this,e)}destroy(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete ms[this.cacheId],delete Ge[this.cacheId],this.cacheId=null),this.dispose(),ai.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0}dispose(){this.emit("dispose",this)}castToBaseTexture(){return this}static from(e,t,s=q.STRICT_TEXTURE_CACHE){const i=typeof e=="string";let r=null;if(i)r=e;else{if(!e._pixiId){const o=(t==null?void 0:t.pixiIdPrefix)||"pixiid";e._pixiId=`${o}_${Ks()}`}r=e._pixiId}let n=ms[r];if(i&&s&&!n)throw new Error(`The cacheId "${r}" does not exist in BaseTextureCache.`);return n||(n=new ai(e,t),n.cacheId=r,ai.addToCache(n,r)),n}static fromBuffer(e,t,s,i){e=e||new Float32Array(t*s*4);const r=new yr(e,{width:t,height:s}),n=e instanceof Float32Array?lt.FLOAT:lt.UNSIGNED_BYTE;return new ai(r,Object.assign({},Qv,i||{width:t,height:s,type:n}))}static addToCache(e,t){t&&(e.textureCacheIds.includes(t)||e.textureCacheIds.push(t),ms[t]&&ms[t]!==e&&console.warn(`BaseTexture added to the cache with an id [${t}] that already had an entry`),ms[t]=e)}static removeFromCache(e){if(typeof e=="string"){const t=ms[e];if(t){const s=t.textureCacheIds.indexOf(e);return s>-1&&t.textureCacheIds.splice(s,1),delete ms[e],t}}else if(e!=null&&e.textureCacheIds){for(let t=0;t<e.textureCacheIds.length;++t)delete ms[e.textureCacheIds[t]];return e.textureCacheIds.length=0,e}return null}};let pt=ai;pt.defaultOptions={mipmap:Je.POW2,anisotropicLevel:0,scaleMode:ns.LINEAR,wrapMode:Ts.CLAMP,alphaMode:Ne.UNPACK,target:xi.TEXTURE_2D,format:X.RGBA,type:lt.UNSIGNED_BYTE};pt._globalBatch=0;class ba{constructor(){this.texArray=null,this.blend=0,this.type=Ve.TRIANGLES,this.start=0,this.size=0,this.data=null}}let ty=0,jt=class{constructor(t,s=!0,i=!1){this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=i,this.static=s,this.id=ty++,this.disposeRunner=new Fe("disposeBuffer")}update(t){t instanceof Array&&(t=new Float32Array(t)),this.data=t||this.data,this._updateID++}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.data=null}set index(t){this.type=t?Ke.ELEMENT_ARRAY_BUFFER:Ke.ARRAY_BUFFER}get index(){return this.type===Ke.ELEMENT_ARRAY_BUFFER}static from(t){return t instanceof Array&&(t=new Float32Array(t)),new jt(t)}};class bn{constructor(t,s=0,i=!1,r=lt.FLOAT,n,o,a,l=1){this.buffer=t,this.size=s,this.normalized=i,this.type=r,this.stride=n,this.start=o,this.instance=a,this.divisor=l}destroy(){this.buffer=null}static from(t,s,i,r,n){return new bn(t,s,i,r,n)}}const ey={Float32Array,Uint32Array,Int32Array,Uint8Array};function sy(e,t){let s=0,i=0;const r={};for(let l=0;l<e.length;l++)i+=t[l],s+=e[l].length;const n=new ArrayBuffer(s*4);let o=null,a=0;for(let l=0;l<e.length;l++){const h=t[l],c=e[l],u=ad(c);r[u]||(r[u]=new ey[u](n)),o=r[u];for(let d=0;d<c.length;d++){const p=(d/h|0)*i+a,f=d%h;o[p+f]=c[d]}a+=h}return new Float32Array(n)}const Kh={5126:4,5123:2,5121:1};let iy=0;const ry={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array};class Cs{constructor(t=[],s={}){this.buffers=t,this.indexBuffer=null,this.attributes=s,this.glVertexArrayObjects={},this.id=iy++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new Fe("disposeGeometry"),this.refCount=0}addAttribute(t,s,i=0,r=!1,n,o,a,l=!1){if(!s)throw new Error("You must pass a buffer when creating an attribute");s instanceof jt||(s instanceof Array&&(s=new Float32Array(s)),s=new jt(s));const h=t.split("|");if(h.length>1){for(let u=0;u<h.length;u++)this.addAttribute(h[u],s,i,r,n);return this}let c=this.buffers.indexOf(s);return c===-1&&(this.buffers.push(s),c=this.buffers.length-1),this.attributes[t]=new bn(c,i,r,n,o,a,l),this.instanced=this.instanced||l,this}getAttribute(t){return this.attributes[t]}getBuffer(t){return this.buffers[this.getAttribute(t).buffer]}addIndex(t){return t instanceof jt||(t instanceof Array&&(t=new Uint16Array(t)),t=new jt(t)),t.type=Ke.ELEMENT_ARRAY_BUFFER,this.indexBuffer=t,this.buffers.includes(t)||this.buffers.push(t),this}getIndex(){return this.indexBuffer}interleave(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;const t=[],s=[],i=new jt;let r;for(r in this.attributes){const n=this.attributes[r],o=this.buffers[n.buffer];t.push(o.data),s.push(n.size*Kh[n.type]/4),n.buffer=0}for(i.data=sy(t,s),r=0;r<this.buffers.length;r++)this.buffers[r]!==this.indexBuffer&&this.buffers[r].destroy();return this.buffers=[i],this.indexBuffer&&this.buffers.push(this.indexBuffer),this}getSize(){for(const t in this.attributes){const s=this.attributes[t];return this.buffers[s.buffer].data.length/(s.stride/4||s.size)}return 0}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null}clone(){const t=new Cs;for(let s=0;s<this.buffers.length;s++)t.buffers[s]=new jt(this.buffers[s].data.slice(0));for(const s in this.attributes){const i=this.attributes[s];t.attributes[s]=new bn(i.buffer,i.size,i.normalized,i.type,i.stride,i.start,i.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(this.indexBuffer)],t.indexBuffer.type=Ke.ELEMENT_ARRAY_BUFFER),t}static merge(t){const s=new Cs,i=[],r=[],n=[];let o;for(let a=0;a<t.length;a++){o=t[a];for(let l=0;l<o.buffers.length;l++)r[l]=r[l]||0,r[l]+=o.buffers[l].data.length,n[l]=0}for(let a=0;a<o.buffers.length;a++)i[a]=new ry[ad(o.buffers[a].data)](r[a]),s.buffers[a]=new jt(i[a]);for(let a=0;a<t.length;a++){o=t[a];for(let l=0;l<o.buffers.length;l++)i[l].set(o.buffers[l].data,n[l]),n[l]+=o.buffers[l].data.length}if(s.attributes=o.attributes,o.indexBuffer){s.indexBuffer=s.buffers[o.buffers.indexOf(o.indexBuffer)],s.indexBuffer.type=Ke.ELEMENT_ARRAY_BUFFER;let a=0,l=0,h=0,c=0;for(let u=0;u<o.buffers.length;u++)if(o.buffers[u]!==o.indexBuffer){c=u;break}for(const u in o.attributes){const d=o.attributes[u];(d.buffer|0)===c&&(l+=d.size*Kh[d.type]/4)}for(let u=0;u<t.length;u++){const d=t[u].indexBuffer.data;for(let p=0;p<d.length;p++)s.indexBuffer.data[p+h]+=a;a+=t[u].buffers[c].data.length/l,h+=d.length}}return s}}class cd extends Cs{constructor(t=!1){super(),this._buffer=new jt(null,t,!1),this._indexBuffer=new jt(null,t,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,lt.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,lt.FLOAT).addAttribute("aColor",this._buffer,4,!0,lt.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,lt.FLOAT).addIndex(this._indexBuffer)}}const Tn=Math.PI*2,ny=180/Math.PI,oy=Math.PI/180;var te=(e=>(e[e.POLY=0]="POLY",e[e.RECT=1]="RECT",e[e.CIRC=2]="CIRC",e[e.ELIP=3]="ELIP",e[e.RREC=4]="RREC",e))(te||{});class Tt{constructor(t=0,s=0){this.x=0,this.y=0,this.x=t,this.y=s}clone(){return new Tt(this.x,this.y)}copyFrom(t){return this.set(t.x,t.y),this}copyTo(t){return t.set(this.x,this.y),t}equals(t){return t.x===this.x&&t.y===this.y}set(t=0,s=t){return this.x=t,this.y=s,this}toString(){return`[@pixi/math:Point x=${this.x} y=${this.y}]`}}const Dr=[new Tt,new Tt,new Tt,new Tt];class yt{constructor(t=0,s=0,i=0,r=0){this.x=Number(t),this.y=Number(s),this.width=Number(i),this.height=Number(r),this.type=te.RECT}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new yt(0,0,0,0)}clone(){return new yt(this.x,this.y,this.width,this.height)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t}contains(t,s){return this.width<=0||this.height<=0?!1:t>=this.x&&t<this.x+this.width&&s>=this.y&&s<this.y+this.height}intersects(t,s){if(!s){const E=this.x<t.x?t.x:this.x;if((this.right>t.right?t.right:this.right)<=E)return!1;const F=this.y<t.y?t.y:this.y;return(this.bottom>t.bottom?t.bottom:this.bottom)>F}const i=this.left,r=this.right,n=this.top,o=this.bottom;if(r<=i||o<=n)return!1;const a=Dr[0].set(t.left,t.top),l=Dr[1].set(t.left,t.bottom),h=Dr[2].set(t.right,t.top),c=Dr[3].set(t.right,t.bottom);if(h.x<=a.x||l.y<=a.y)return!1;const u=Math.sign(s.a*s.d-s.b*s.c);if(u===0||(s.apply(a,a),s.apply(l,l),s.apply(h,h),s.apply(c,c),Math.max(a.x,l.x,h.x,c.x)<=i||Math.min(a.x,l.x,h.x,c.x)>=r||Math.max(a.y,l.y,h.y,c.y)<=n||Math.min(a.y,l.y,h.y,c.y)>=o))return!1;const d=u*(l.y-a.y),p=u*(a.x-l.x),f=d*i+p*n,m=d*r+p*n,_=d*i+p*o,v=d*r+p*o;if(Math.max(f,m,_,v)<=d*a.x+p*a.y||Math.min(f,m,_,v)>=d*c.x+p*c.y)return!1;const T=u*(a.y-h.y),g=u*(h.x-a.x),b=T*i+g*n,S=T*r+g*n,A=T*i+g*o,y=T*r+g*o;return!(Math.max(b,S,A,y)<=T*a.x+g*a.y||Math.min(b,S,A,y)>=T*c.x+g*c.y)}pad(t=0,s=t){return this.x-=t,this.y-=s,this.width+=t*2,this.height+=s*2,this}fit(t){const s=Math.max(this.x,t.x),i=Math.min(this.x+this.width,t.x+t.width),r=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height);return this.x=s,this.width=Math.max(i-s,0),this.y=r,this.height=Math.max(n-r,0),this}ceil(t=1,s=.001){const i=Math.ceil((this.x+this.width-s)*t)/t,r=Math.ceil((this.y+this.height-s)*t)/t;return this.x=Math.floor((this.x+s)*t)/t,this.y=Math.floor((this.y+s)*t)/t,this.width=i-this.x,this.height=r-this.y,this}enlarge(t){const s=Math.min(this.x,t.x),i=Math.max(this.x+this.width,t.x+t.width),r=Math.min(this.y,t.y),n=Math.max(this.y+this.height,t.y+t.height);return this.x=s,this.width=i-s,this.y=r,this.height=n-r,this}toString(){return`[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}class _l{constructor(t=0,s=0,i=0){this.x=t,this.y=s,this.radius=i,this.type=te.CIRC}clone(){return new _l(this.x,this.y,this.radius)}contains(t,s){if(this.radius<=0)return!1;const i=this.radius*this.radius;let r=this.x-t,n=this.y-s;return r*=r,n*=n,r+n<=i}getBounds(){return new yt(this.x-this.radius,this.y-this.radius,this.radius*2,this.radius*2)}toString(){return`[@pixi/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}}class xl{constructor(t=0,s=0,i=0,r=0){this.x=t,this.y=s,this.width=i,this.height=r,this.type=te.ELIP}clone(){return new xl(this.x,this.y,this.width,this.height)}contains(t,s){if(this.width<=0||this.height<=0)return!1;let i=(t-this.x)/this.width,r=(s-this.y)/this.height;return i*=i,r*=r,i+r<=1}getBounds(){return new yt(this.x-this.width,this.y-this.height,this.width,this.height)}toString(){return`[@pixi/math:Ellipse x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}class Ei{constructor(...t){let s=Array.isArray(t[0])?t[0]:t;if(typeof s[0]!="number"){const i=[];for(let r=0,n=s.length;r<n;r++)i.push(s[r].x,s[r].y);s=i}this.points=s,this.type=te.POLY,this.closeStroke=!0}clone(){const t=this.points.slice(),s=new Ei(t);return s.closeStroke=this.closeStroke,s}contains(t,s){let i=!1;const r=this.points.length/2;for(let n=0,o=r-1;n<r;o=n++){const a=this.points[n*2],l=this.points[n*2+1],h=this.points[o*2],c=this.points[o*2+1];l>s!=c>s&&t<(h-a)*((s-l)/(c-l))+a&&(i=!i)}return i}toString(){return`[@pixi/math:PolygoncloseStroke=${this.closeStroke}points=${this.points.reduce((t,s)=>`${t}, ${s}`,"")}]`}}class vl{constructor(t=0,s=0,i=0,r=0,n=20){this.x=t,this.y=s,this.width=i,this.height=r,this.radius=n,this.type=te.RREC}clone(){return new vl(this.x,this.y,this.width,this.height,this.radius)}contains(t,s){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&s>=this.y&&s<=this.y+this.height){const i=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(s>=this.y+i&&s<=this.y+this.height-i||t>=this.x+i&&t<=this.x+this.width-i)return!0;let r=t-(this.x+i),n=s-(this.y+i);const o=i*i;if(r*r+n*n<=o||(r=t-(this.x+this.width-i),r*r+n*n<=o)||(n=s-(this.y+this.height-i),r*r+n*n<=o)||(r=t-(this.x+i),r*r+n*n<=o))return!0}return!1}toString(){return`[@pixi/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}}class Nt{constructor(t=1,s=0,i=0,r=1,n=0,o=0){this.array=null,this.a=t,this.b=s,this.c=i,this.d=r,this.tx=n,this.ty=o}fromArray(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]}set(t,s,i,r,n,o){return this.a=t,this.b=s,this.c=i,this.d=r,this.tx=n,this.ty=o,this}toArray(t,s){this.array||(this.array=new Float32Array(9));const i=s||this.array;return t?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty,i[8]=1):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0,i[8]=1),i}apply(t,s){s=s||new Tt;const i=t.x,r=t.y;return s.x=this.a*i+this.c*r+this.tx,s.y=this.b*i+this.d*r+this.ty,s}applyInverse(t,s){s=s||new Tt;const i=1/(this.a*this.d+this.c*-this.b),r=t.x,n=t.y;return s.x=this.d*i*r+-this.c*i*n+(this.ty*this.c-this.tx*this.d)*i,s.y=this.a*i*n+-this.b*i*r+(-this.ty*this.a+this.tx*this.b)*i,s}translate(t,s){return this.tx+=t,this.ty+=s,this}scale(t,s){return this.a*=t,this.d*=s,this.c*=t,this.b*=s,this.tx*=t,this.ty*=s,this}rotate(t){const s=Math.cos(t),i=Math.sin(t),r=this.a,n=this.c,o=this.tx;return this.a=r*s-this.b*i,this.b=r*i+this.b*s,this.c=n*s-this.d*i,this.d=n*i+this.d*s,this.tx=o*s-this.ty*i,this.ty=o*i+this.ty*s,this}append(t){const s=this.a,i=this.b,r=this.c,n=this.d;return this.a=t.a*s+t.b*r,this.b=t.a*i+t.b*n,this.c=t.c*s+t.d*r,this.d=t.c*i+t.d*n,this.tx=t.tx*s+t.ty*r+this.tx,this.ty=t.tx*i+t.ty*n+this.ty,this}setTransform(t,s,i,r,n,o,a,l,h){return this.a=Math.cos(a+h)*n,this.b=Math.sin(a+h)*n,this.c=-Math.sin(a-l)*o,this.d=Math.cos(a-l)*o,this.tx=t-(i*this.a+r*this.c),this.ty=s-(i*this.b+r*this.d),this}prepend(t){const s=this.tx;if(t.a!==1||t.b!==0||t.c!==0||t.d!==1){const i=this.a,r=this.c;this.a=i*t.a+this.b*t.c,this.b=i*t.b+this.b*t.d,this.c=r*t.a+this.d*t.c,this.d=r*t.b+this.d*t.d}return this.tx=s*t.a+this.ty*t.c+t.tx,this.ty=s*t.b+this.ty*t.d+t.ty,this}decompose(t){const s=this.a,i=this.b,r=this.c,n=this.d,o=t.pivot,a=-Math.atan2(-r,n),l=Math.atan2(i,s),h=Math.abs(a+l);return h<1e-5||Math.abs(Tn-h)<1e-5?(t.rotation=l,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=a,t.skew.y=l),t.scale.x=Math.sqrt(s*s+i*i),t.scale.y=Math.sqrt(r*r+n*n),t.position.x=this.tx+(o.x*s+o.y*r),t.position.y=this.ty+(o.x*i+o.y*n),t}invert(){const t=this.a,s=this.b,i=this.c,r=this.d,n=this.tx,o=t*r-s*i;return this.a=r/o,this.b=-s/o,this.c=-i/o,this.d=t/o,this.tx=(i*this.ty-r*n)/o,this.ty=-(t*this.ty-s*n)/o,this}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const t=new Nt;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyTo(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyFrom(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this}toString(){return`[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return new Nt}static get TEMP_MATRIX(){return new Nt}}const Fs=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],Ls=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],Ns=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],Us=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Ta=[],ud=[],Fr=Math.sign;function ay(){for(let e=0;e<16;e++){const t=[];Ta.push(t);for(let s=0;s<16;s++){const i=Fr(Fs[e]*Fs[s]+Ns[e]*Ls[s]),r=Fr(Ls[e]*Fs[s]+Us[e]*Ls[s]),n=Fr(Fs[e]*Ns[s]+Ns[e]*Us[s]),o=Fr(Ls[e]*Ns[s]+Us[e]*Us[s]);for(let a=0;a<16;a++)if(Fs[a]===i&&Ls[a]===r&&Ns[a]===n&&Us[a]===o){t.push(a);break}}}for(let e=0;e<16;e++){const t=new Nt;t.set(Fs[e],Ls[e],Ns[e],Us[e],0,0),ud.push(t)}}ay();const kt={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:e=>Fs[e],uY:e=>Ls[e],vX:e=>Ns[e],vY:e=>Us[e],inv:e=>e&8?e&15:-e&7,add:(e,t)=>Ta[e][t],sub:(e,t)=>Ta[e][kt.inv(t)],rotate180:e=>e^4,isVertical:e=>(e&3)===2,byDirection:(e,t)=>Math.abs(e)*2<=Math.abs(t)?t>=0?kt.S:kt.N:Math.abs(t)*2<=Math.abs(e)?e>0?kt.E:kt.W:t>0?e>0?kt.SE:kt.SW:e>0?kt.NE:kt.NW,matrixAppendRotationInv:(e,t,s=0,i=0)=>{const r=ud[kt.inv(t)];r.tx=s,r.ty=i,e.append(r)}};class vs{constructor(t,s,i=0,r=0){this._x=i,this._y=r,this.cb=t,this.scope=s}clone(t=this.cb,s=this.scope){return new vs(t,s,this._x,this._y)}set(t=0,s=t){return(this._x!==t||this._y!==s)&&(this._x=t,this._y=s,this.cb.call(this.scope)),this}copyFrom(t){return(this._x!==t.x||this._y!==t.y)&&(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this}copyTo(t){return t.set(this._x,this._y),t}equals(t){return t.x===this._x&&t.y===this._y}toString(){return`[@pixi/math:ObservablePoint x=${0} y=${0} scope=${this.scope}]`}get x(){return this._x}set x(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))}get y(){return this._y}set y(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))}}const dd=class{constructor(){this.worldTransform=new Nt,this.localTransform=new Nt,this.position=new vs(this.onChange,this,0,0),this.scale=new vs(this.onChange,this,1,1),this.pivot=new vs(this.onChange,this,0,0),this.skew=new vs(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}onChange(){this._localID++}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++}toString(){return`[@pixi/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`}updateLocalTransform(){const e=this.localTransform;this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1)}updateTransform(e){const t=this.localTransform;if(this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==e._worldID){const s=e.worldTransform,i=this.worldTransform;i.a=t.a*s.a+t.b*s.c,i.b=t.a*s.b+t.b*s.d,i.c=t.c*s.a+t.d*s.c,i.d=t.c*s.b+t.d*s.d,i.tx=t.tx*s.a+t.ty*s.c+s.tx,i.ty=t.tx*s.b+t.ty*s.d+s.ty,this._parentID=e._worldID,this._worldID++}}setFromMatrix(e){e.decompose(this),this._localID++}get rotation(){return this._rotation}set rotation(e){this._rotation!==e&&(this._rotation=e,this.updateSkew())}};let yl=dd;yl.IDENTITY=new dd;var ly=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`,hy=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`;function qh(e,t,s){const i=e.createShader(t);return e.shaderSource(i,s),e.compileShader(i),i}function Io(e){const t=new Array(e);for(let s=0;s<t.length;s++)t[s]=!1;return t}function fd(e,t){switch(e){case"float":return 0;case"vec2":return new Float32Array(2*t);case"vec3":return new Float32Array(3*t);case"vec4":return new Float32Array(4*t);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*t);case"ivec3":return new Int32Array(3*t);case"ivec4":return new Int32Array(4*t);case"uvec2":return new Uint32Array(2*t);case"uvec3":return new Uint32Array(3*t);case"uvec4":return new Uint32Array(4*t);case"bool":return!1;case"bvec2":return Io(2*t);case"bvec3":return Io(3*t);case"bvec4":return Io(4*t);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const bi=[{test:e=>e.type==="float"&&e.size===1&&!e.isArray,code:e=>`
            if(uv["${e}"] !== ud["${e}"].value)
            {
                ud["${e}"].value = uv["${e}"]
                gl.uniform1f(ud["${e}"].location, uv["${e}"])
            }
            `},{test:(e,t)=>(e.type==="sampler2D"||e.type==="samplerCube"||e.type==="sampler2DArray")&&e.size===1&&!e.isArray&&(t==null||t.castToBaseTexture!==void 0),code:e=>`t = syncData.textureCount++;

            renderer.texture.bind(uv["${e}"], t);

            if(ud["${e}"].value !== t)
            {
                ud["${e}"].value = t;
                gl.uniform1i(ud["${e}"].location, t);
; // eslint-disable-line max-len
            }`},{test:(e,t)=>e.type==="mat3"&&e.size===1&&!e.isArray&&t.a!==void 0,code:e=>`
            gl.uniformMatrix3fv(ud["${e}"].location, false, uv["${e}"].toArray(true));
            `,codeUbo:e=>`
                var ${e}_matrix = uv.${e}.toArray(true);

                data[offset] = ${e}_matrix[0];
                data[offset+1] = ${e}_matrix[1];
                data[offset+2] = ${e}_matrix[2];
        
                data[offset + 4] = ${e}_matrix[3];
                data[offset + 5] = ${e}_matrix[4];
                data[offset + 6] = ${e}_matrix[5];
        
                data[offset + 8] = ${e}_matrix[6];
                data[offset + 9] = ${e}_matrix[7];
                data[offset + 10] = ${e}_matrix[8];
            `},{test:(e,t)=>e.type==="vec2"&&e.size===1&&!e.isArray&&t.x!==void 0,code:e=>`
                cv = ud["${e}"].value;
                v = uv["${e}"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["${e}"].location, v.x, v.y);
                }`,codeUbo:e=>`
                v = uv.${e};

                data[offset] = v.x;
                data[offset+1] = v.y;
            `},{test:e=>e.type==="vec2"&&e.size===1&&!e.isArray,code:e=>`
                cv = ud["${e}"].value;
                v = uv["${e}"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["${e}"].location, v[0], v[1]);
                }
            `},{test:(e,t)=>e.type==="vec4"&&e.size===1&&!e.isArray&&t.width!==void 0,code:e=>`
                cv = ud["${e}"].value;
                v = uv["${e}"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["${e}"].location, v.x, v.y, v.width, v.height)
                }`,codeUbo:e=>`
                    v = uv.${e};

                    data[offset] = v.x;
                    data[offset+1] = v.y;
                    data[offset+2] = v.width;
                    data[offset+3] = v.height;
                `},{test:e=>e.type==="vec4"&&e.size===1&&!e.isArray,code:e=>`
                cv = ud["${e}"].value;
                v = uv["${e}"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["${e}"].location, v[0], v[1], v[2], v[3])
                }`}],cy={float:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1f(location, v);
    }`,vec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4f(location, v[0], v[1], v[2], v[3]);
    }`,int:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,ivec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,ivec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,ivec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,uint:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1ui(location, v);
    }`,uvec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2ui(location, v[0], v[1]);
    }`,uvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3ui(location, v[0], v[1], v[2]);
    }`,uvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
    }`,bool:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1i(location, v);
    }`,bvec2:`
    if (cv[0] != v[0] || cv[1] != v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,bvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,bvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,samplerCube:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,sampler2DArray:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`},uy={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function dy(e,t){var i;const s=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
    `];for(const r in e.uniforms){const n=t[r];if(!n){(i=e.uniforms[r])!=null&&i.group&&(e.uniforms[r].ubo?s.push(`
                        renderer.shader.syncUniformBufferGroup(uv.${r}, '${r}');
                    `):s.push(`
                        renderer.shader.syncUniformGroup(uv.${r}, syncData);
                    `));continue}const o=e.uniforms[r];let a=!1;for(let l=0;l<bi.length;l++)if(bi[l].test(n,o)){s.push(bi[l].code(r,o)),a=!0;break}if(!a){const h=(n.size===1&&!n.isArray?cy:uy)[n.type].replace("location",`ud["${r}"].location`);s.push(`
            cu = ud["${r}"];
            cv = cu.value;
            v = uv["${r}"];
            ${h};`)}}return new Function("ud","uv","renderer","syncData",s.join(`
`))}const pd={};let ri=pd;function fy(){if(ri===pd||ri!=null&&ri.isContextLost()){const e=q.ADAPTER.createCanvas();let t;q.PREFER_ENV>=ei.WEBGL2&&(t=e.getContext("webgl2",{})),t||(t=e.getContext("webgl",{})||e.getContext("experimental-webgl",{}),t?t.getExtension("WEBGL_draw_buffers"):t=null),ri=t}return ri}let Lr;function py(){if(!Lr){Lr=ye.MEDIUM;const e=fy();e&&e.getShaderPrecisionFormat&&(Lr=e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision?ye.HIGH:ye.MEDIUM)}return Lr}function Zh(e,t){const s=e.getShaderSource(t).split(`
`).map((h,c)=>`${c}: ${h}`),i=e.getShaderInfoLog(t),r=i.split(`
`),n={},o=r.map(h=>parseFloat(h.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))).filter(h=>h&&!n[h]?(n[h]=!0,!0):!1),a=[""];o.forEach(h=>{s[h-1]=`%c${s[h-1]}%c`,a.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});const l=s.join(`
`);a[0]=l,console.error(i),console.groupCollapsed("click to view full shader code"),console.warn(...a),console.groupEnd()}function my(e,t,s,i){e.getProgramParameter(t,e.LINK_STATUS)||(e.getShaderParameter(s,e.COMPILE_STATUS)||Zh(e,s),e.getShaderParameter(i,e.COMPILE_STATUS)||Zh(e,i),console.error("PixiJS Error: Could not initialize shader."),e.getProgramInfoLog(t)!==""&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",e.getProgramInfoLog(t)))}const gy={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function md(e){return gy[e]}let Nr=null;const Jh={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function gd(e,t){if(!Nr){const s=Object.keys(Jh);Nr={};for(let i=0;i<s.length;++i){const r=s[i];Nr[e[r]]=Jh[r]}}return Nr[t]}function Qh(e,t,s){if(e.substring(0,9)!=="precision"){let i=t;return t===ye.HIGH&&s!==ye.HIGH&&(i=ye.MEDIUM),`precision ${i} float;
${e}`}else if(s!==ye.HIGH&&e.substring(0,15)==="precision highp")return e.replace("precision highp","precision mediump");return e}let Hi;function _y(){if(typeof Hi=="boolean")return Hi;try{Hi=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{Hi=!1}return Hi}let xy=0;const Ur={},li=class{constructor(e,t,s="pixi-shader",i={}){this.extra={},this.id=xy++,this.vertexSrc=e||li.defaultVertexSrc,this.fragmentSrc=t||li.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.extra=i,this.vertexSrc.substring(0,8)!=="#version"&&(s=s.replace(/\s+/g,"-"),Ur[s]?(Ur[s]++,s+=`-${Ur[s]}`):Ur[s]=1,this.vertexSrc=`#define SHADER_NAME ${s}
${this.vertexSrc}`,this.fragmentSrc=`#define SHADER_NAME ${s}
${this.fragmentSrc}`,this.vertexSrc=Qh(this.vertexSrc,li.defaultVertexPrecision,ye.HIGH),this.fragmentSrc=Qh(this.fragmentSrc,li.defaultFragmentPrecision,py())),this.glPrograms={},this.syncUniforms=null}static get defaultVertexSrc(){return hy}static get defaultFragmentSrc(){return ly}static from(e,t,s){const i=e+t;let r=Xh[i];return r||(Xh[i]=r=new li(e,t,s)),r}};let Me=li;Me.defaultVertexPrecision=ye.HIGH;Me.defaultFragmentPrecision=os.apple.device?ye.HIGH:ye.MEDIUM;let vy=0;class Le{constructor(t,s,i){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=vy++,this.static=!!s,this.ubo=!!i,t instanceof jt?(this.buffer=t,this.buffer.type=Ke.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=t,this.ubo&&(this.buffer=new jt(new Float32Array(1)),this.buffer.type=Ke.UNIFORM_BUFFER,this.autoManage=!0))}update(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()}add(t,s,i){if(!this.ubo)this.uniforms[t]=new Le(s,i);else throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them")}static from(t,s,i){return new Le(t,s,i)}static uboFrom(t,s){return new Le(t,s??!0,!0)}}class qe{constructor(t,s){this.uniformBindCount=0,this.program=t,s?s instanceof Le?this.uniformGroup=s:this.uniformGroup=new Le(s):this.uniformGroup=new Le({}),this.disposeRunner=new Fe("disposeShader")}checkUniformExists(t,s){if(s.uniforms[t])return!0;for(const i in s.uniforms){const r=s.uniforms[i];if(r.group&&this.checkUniformExists(t,r))return!0}return!1}destroy(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()}get uniforms(){return this.uniformGroup.uniforms}static from(t,s,i){const r=Me.from(t,s);return new qe(r,i)}}class yy{constructor(t,s){if(this.vertexSrc=t,this.fragTemplate=s,this.programCache={},this.defaultGroupCache={},!s.includes("%count%"))throw new Error('Fragment template must contain "%count%".');if(!s.includes("%forloop%"))throw new Error('Fragment template must contain "%forloop%".')}generateShader(t){if(!this.programCache[t]){const i=new Int32Array(t);for(let n=0;n<t;n++)i[n]=n;this.defaultGroupCache[t]=Le.from({uSamplers:i},!0);let r=this.fragTemplate;r=r.replace(/%count%/gi,`${t}`),r=r.replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new Me(this.vertexSrc,r)}const s={tint:new Float32Array([1,1,1,1]),translationMatrix:new Nt,default:this.defaultGroupCache[t]};return new qe(this.programCache[t],s)}generateSampleSrc(t){let s="";s+=`
`,s+=`
`;for(let i=0;i<t;i++)i>0&&(s+=`
else `),i<t-1&&(s+=`if(vTextureId < ${i}.5)`),s+=`
{`,s+=`
	color = texture2D(uSamplers[${i}], vTextureCoord);`,s+=`
}`;return s+=`
`,s+=`
`,s}}class wa{constructor(){this.elements=[],this.ids=[],this.count=0}clear(){for(let t=0;t<this.count;t++)this.elements[t]=null;this.count=0}}function Ey(){return!os.apple.device}function by(e){let t=!0;const s=q.ADAPTER.getNavigator();if(os.tablet||os.phone){if(os.apple.device){const i=s.userAgent.match(/OS (\d+)_(\d+)?/);i&&parseInt(i[1],10)<11&&(t=!1)}if(os.android.device){const i=s.userAgent.match(/Android\s([0-9.]*)/);i&&parseInt(i[1],10)<7&&(t=!1)}}return t?e:4}class Zn{constructor(t){this.renderer=t}flush(){}destroy(){this.renderer=null}start(){}stop(){this.flush()}render(t){}}var Ty=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`,wy=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`;const Ae=class extends Zn{constructor(e){super(e),this.setShaderGenerator(),this.geometryClass=cd,this.vertexSize=6,this.state=us.for2d(),this.size=Ae.defaultBatchSize*4,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.maxTextures=1,this.renderer.on("prerender",this.onPrerender,this),e.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}static get defaultMaxTextures(){return this._defaultMaxTextures=this._defaultMaxTextures??by(32),this._defaultMaxTextures}static set defaultMaxTextures(e){this._defaultMaxTextures=e}static get canUploadSameBuffer(){return this._canUploadSameBuffer=this._canUploadSameBuffer??Ey(),this._canUploadSameBuffer}static set canUploadSameBuffer(e){this._canUploadSameBuffer=e}get MAX_TEXTURES(){return Ct("7.1.0","BatchRenderer#MAX_TEXTURES renamed to BatchRenderer#maxTextures"),this.maxTextures}static get defaultVertexSrc(){return wy}static get defaultFragmentTemplate(){return Ty}setShaderGenerator({vertex:e=Ae.defaultVertexSrc,fragment:t=Ae.defaultFragmentTemplate}={}){this.shaderGenerator=new yy(e,t)}contextChange(){const e=this.renderer.gl;q.PREFER_ENV===ei.WEBGL_LEGACY?this.maxTextures=1:(this.maxTextures=Math.min(e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),Ae.defaultMaxTextures),this.maxTextures=Jv(this.maxTextures,e)),this._shader=this.shaderGenerator.generateShader(this.maxTextures);for(let t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]=new this.geometryClass;this.initFlushBuffers()}initFlushBuffers(){const{_drawCallPool:e,_textureArrayPool:t}=Ae,s=this.size/4,i=Math.floor(s/this.maxTextures)+1;for(;e.length<s;)e.push(new ba);for(;t.length<i;)t.push(new wa);for(let r=0;r<this.maxTextures;r++)this._tempBoundTextures[r]=null}onPrerender(){this._flushId=0}render(e){e._texture.valid&&(this._vertexCount+e.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=e.vertexData.length/2,this._indexCount+=e.indices.length,this._bufferedTextures[this._bufferSize]=e._texture.baseTexture,this._bufferedElements[this._bufferSize++]=e)}buildTexturesAndDrawCalls(){const{_bufferedTextures:e,maxTextures:t}=this,s=Ae._textureArrayPool,i=this.renderer.batch,r=this._tempBoundTextures,n=this.renderer.textureGC.count;let o=++pt._globalBatch,a=0,l=s[0],h=0;i.copyBoundTextures(r,t);for(let c=0;c<this._bufferSize;++c){const u=e[c];e[c]=null,u._batchEnabled!==o&&(l.count>=t&&(i.boundArray(l,r,o,t),this.buildDrawCalls(l,h,c),h=c,l=s[++a],++o),u._batchEnabled=o,u.touched=n,l.elements[l.count++]=u)}l.count>0&&(i.boundArray(l,r,o,t),this.buildDrawCalls(l,h,this._bufferSize),++a,++o);for(let c=0;c<r.length;c++)r[c]=null;pt._globalBatch=o}buildDrawCalls(e,t,s){const{_bufferedElements:i,_attributeBuffer:r,_indexBuffer:n,vertexSize:o}=this,a=Ae._drawCallPool;let l=this._dcIndex,h=this._aIndex,c=this._iIndex,u=a[l];u.start=this._iIndex,u.texArray=e;for(let d=t;d<s;++d){const p=i[d],f=p._texture.baseTexture,m=rd[f.alphaMode?1:0][p.blendMode];i[d]=null,t<d&&u.blend!==m&&(u.size=c-u.start,t=d,u=a[++l],u.texArray=e,u.start=c),this.packInterleavedGeometry(p,r,n,h,c),h+=p.vertexData.length/2*o,c+=p.indices.length,u.blend=m}t<s&&(u.size=c-u.start,++l),this._dcIndex=l,this._aIndex=h,this._iIndex=c}bindAndClearTexArray(e){const t=this.renderer.texture;for(let s=0;s<e.count;s++)t.bind(e.elements[s],e.ids[s]),e.elements[s]=null;e.count=0}updateGeometry(){const{_packedGeometries:e,_attributeBuffer:t,_indexBuffer:s}=this;Ae.canUploadSameBuffer?(e[this._flushId]._buffer.update(t.rawBinaryData),e[this._flushId]._indexBuffer.update(s),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,e[this._flushId]=new this.geometryClass),e[this._flushId]._buffer.update(t.rawBinaryData),e[this._flushId]._indexBuffer.update(s),this.renderer.geometry.bind(e[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)}drawBatches(){const e=this._dcIndex,{gl:t,state:s}=this.renderer,i=Ae._drawCallPool;let r=null;for(let n=0;n<e;n++){const{texArray:o,type:a,size:l,start:h,blend:c}=i[n];r!==o&&(r=o,this.bindAndClearTexArray(o)),this.state.blendMode=c,s.set(this.state),t.drawElements(a,l,t.UNSIGNED_SHORT,h*2)}}flush(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)}start(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.maxTextures),this.renderer.shader.bind(this._shader),Ae.canUploadSameBuffer&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])}stop(){this.flush()}destroy(){for(let e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]&&this._packedGeometries[e].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),super.destroy()}getAttributeBuffer(e){const t=En(Math.ceil(e/8)),s=$h(t),i=t*8;this._aBuffers.length<=s&&(this._iBuffers.length=s+1);let r=this._aBuffers[i];return r||(this._aBuffers[i]=r=new ya(i*this.vertexSize*4)),r}getIndexBuffer(e){const t=En(Math.ceil(e/12)),s=$h(t),i=t*12;this._iBuffers.length<=s&&(this._iBuffers.length=s+1);let r=this._iBuffers[s];return r||(this._iBuffers[s]=r=new Uint16Array(i)),r}packInterleavedGeometry(e,t,s,i,r){const{uint32View:n,float32View:o}=t,a=i/this.vertexSize,l=e.uvs,h=e.indices,c=e.vertexData,u=e._texture.baseTexture._batchLocation,d=Math.min(e.worldAlpha,1),p=d<1&&e._texture.baseTexture.alphaMode?gl(e._tintRGB,d):e._tintRGB+(d*255<<24);for(let f=0;f<c.length;f+=2)o[i++]=c[f],o[i++]=c[f+1],o[i++]=l[f],o[i++]=l[f+1],n[i++]=p,o[i++]=u;for(let f=0;f<h.length;f++)s[r++]=a+h[f]}};let me=Ae;me.defaultBatchSize=4096;me.extension={name:"batch",type:K.RendererPlugin};me._drawCallPool=[];me._textureArrayPool=[];rt.add(me);var Sy=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`,Ay=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const Vi=class extends qe{constructor(e,t,s){const i=Me.from(e||Vi.defaultVertexSrc,t||Vi.defaultFragmentSrc);super(i,s),this.padding=0,this.resolution=Vi.defaultResolution,this.multisample=Vi.defaultMultisample,this.enabled=!0,this.autoFit=!0,this.state=new us}apply(e,t,s,i,r){e.applyFilter(this,t,s,i)}get blendMode(){return this.state.blendMode}set blendMode(e){this.state.blendMode=e}get resolution(){return this._resolution}set resolution(e){this._resolution=e}static get defaultVertexSrc(){return Ay}static get defaultFragmentSrc(){return Sy}};let ae=Vi;ae.defaultResolution=1;ae.defaultMultisample=Xt.NONE;class _d{constructor(){this.clearBeforeRender=!0,this._backgroundColor=0,this._backgroundColorRgba=[0,0,0,1],this._backgroundColorString="#000000",this.color=this._backgroundColor,this.alpha=1}init(t){this.clearBeforeRender=t.clearBeforeRender,t.color&&(this.color=typeof t.color=="string"?ml(t.color):t.color),this.alpha=t.alpha}get color(){return this._backgroundColor}set color(t){this._backgroundColor=t,this._backgroundColorString=id(t),fr(t,this._backgroundColorRgba)}get alpha(){return this._backgroundColorRgba[3]}set alpha(t){this._backgroundColorRgba[3]=t}get colorRgba(){return this._backgroundColorRgba}get colorString(){return this._backgroundColorString}destroy(){}}_d.extension={type:[K.RendererSystem,K.CanvasRendererSystem],name:"background"};rt.add(_d);class xd{constructor(t){this.renderer=t,this.emptyRenderer=new Zn(t),this.currentRenderer=this.emptyRenderer}setObjectRenderer(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())}flush(){this.setObjectRenderer(this.emptyRenderer)}reset(){this.setObjectRenderer(this.emptyRenderer)}copyBoundTextures(t,s){const{boundTextures:i}=this.renderer.texture;for(let r=s-1;r>=0;--r)t[r]=i[r]||null,t[r]&&(t[r]._batchLocation=r)}boundArray(t,s,i,r){const{elements:n,ids:o,count:a}=t;let l=0;for(let h=0;h<a;h++){const c=n[h],u=c._batchLocation;if(u>=0&&u<r&&s[u]===c){o[h]=u;continue}for(;l<r;){const d=s[l];if(d&&d._batchEnabled===i&&d._batchLocation===l){l++;continue}o[h]=l,c._batchLocation=l,s[l]=c;break}}}destroy(){this.renderer=null}}xd.extension={type:K.RendererSystem,name:"batch"};rt.add(xd);let tc=0;class vd{constructor(t){this.renderer=t,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=tc++}init(t){if(t.context)this.initFromContext(t.context);else{const s=this.renderer.background.alpha<1,i=t.premultipliedAlpha;this.preserveDrawingBuffer=t.preserveDrawingBuffer,this.useContextAlpha=t.useContextAlpha,this.powerPreference=t.powerPreference,this.initFromOptions({alpha:s,premultipliedAlpha:i,antialias:t.antialias,stencil:!0,preserveDrawingBuffer:t.preserveDrawingBuffer,powerPreference:t.powerPreference})}}initFromContext(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=tc++,this.renderer.runners.contextChange.emit(t);const s=this.renderer.view;s.addEventListener!==void 0&&(s.addEventListener("webglcontextlost",this.handleContextLost,!1),s.addEventListener("webglcontextrestored",this.handleContextRestored,!1))}initFromOptions(t){const s=this.createContext(this.renderer.view,t);this.initFromContext(s)}createContext(t,s){let i;if(q.PREFER_ENV>=ei.WEBGL2&&(i=t.getContext("webgl2",s)),i)this.webGLVersion=2;else if(this.webGLVersion=1,i=t.getContext("webgl",s)||t.getContext("experimental-webgl",s),!i)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=i,this.getExtensions(),this.gl}getExtensions(){const{gl:t}=this,s={loseContext:t.getExtension("WEBGL_lose_context"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),s3tc:t.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:t.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:t.getExtension("WEBGL_compressed_texture_etc"),etc1:t.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:t.getExtension("WEBGL_compressed_texture_atc"),astc:t.getExtension("WEBGL_compressed_texture_astc")};this.webGLVersion===1?Object.assign(this.extensions,s,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBGL_depth_texture"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension("OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):this.webGLVersion===2&&Object.assign(this.extensions,s,{colorBufferFloat:t.getExtension("EXT_color_buffer_float")})}handleContextLost(t){t.preventDefault(),setTimeout(()=>{this.gl.isContextLost()&&this.extensions.loseContext&&this.extensions.loseContext.restoreContext()},0)}handleContextRestored(){this.renderer.runners.contextChange.emit(this.gl)}destroy(){const t=this.renderer.view;this.renderer=null,t.removeEventListener!==void 0&&(t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener("webglcontextrestored",this.handleContextRestored)),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()}postrender(){this.renderer.objectRenderer.renderingToScreen&&this.gl.flush()}validateContext(t){const s=t.getContextAttributes(),i="WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext;i&&(this.webGLVersion=2),s&&!s.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");const r=i||!!t.getExtension("OES_element_index_uint");this.supports.uint32Indices=r,r||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")}}vd.extension={type:K.RendererSystem,name:"context"};rt.add(vd);class Cy extends yr{upload(t,s,i){const r=t.gl;r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,s.alphaMode===Ne.UNPACK);const n=s.realWidth,o=s.realHeight;return i.width===n&&i.height===o?r.texSubImage2D(s.target,0,0,0,n,o,s.format,i.type,this.data):(i.width=n,i.height=o,r.texImage2D(s.target,0,i.internalFormat,n,o,0,s.format,i.type,this.data)),!0}}class Sa{constructor(t,s){this.width=Math.round(t||100),this.height=Math.round(s||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new Fe("disposeFramebuffer"),this.multisample=Xt.NONE}get colorTexture(){return this.colorTextures[0]}addColorTexture(t=0,s){return this.colorTextures[t]=s||new pt(null,{scaleMode:ns.NEAREST,resolution:1,mipmap:Je.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this}addDepthTexture(t){return this.depthTexture=t||new pt(new Cy(null,{width:this.width,height:this.height}),{scaleMode:ns.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:Je.OFF,format:X.DEPTH_COMPONENT,type:lt.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this}enableDepth(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this}enableStencil(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this}resize(t,s){if(t=Math.round(t),s=Math.round(s),!(t===this.width&&s===this.height)){this.width=t,this.height=s,this.dirtyId++,this.dirtySize++;for(let i=0;i<this.colorTextures.length;i++){const r=this.colorTextures[i],n=r.resolution;r.setSize(t/n,s/n)}if(this.depthTexture){const i=this.depthTexture.resolution;this.depthTexture.setSize(t/i,s/i)}}}dispose(){this.disposeRunner.emit(this,!1)}destroyDepthTexture(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)}}class yd extends pt{constructor(t={}){if(typeof t=="number"){const s=arguments[0],i=arguments[1],r=arguments[2],n=arguments[3];t={width:s,height:i,scaleMode:r,resolution:n}}t.width=t.width||100,t.height=t.height||100,t.multisample??(t.multisample=Xt.NONE),super(null,t),this.mipmap=Je.OFF,this.valid=!0,this.clearColor=[0,0,0,0],this.framebuffer=new Sa(this.realWidth,this.realHeight).addColorTexture(0,this),this.framebuffer.multisample=t.multisample,this.maskStack=[],this.filterStack=[{}]}resize(t,s){this.framebuffer.resize(t*this.resolution,s*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)}dispose(){this.framebuffer.dispose(),super.dispose()}destroy(){super.destroy(),this.framebuffer.destroyDepthTexture(),this.framebuffer=null}}class Is extends pr{constructor(t){const s=t,i=s.naturalWidth||s.videoWidth||s.width,r=s.naturalHeight||s.videoHeight||s.height;super(i,r),this.source=t,this.noSubImage=!1}static crossOrigin(t,s,i){i===void 0&&!s.startsWith("data:")?t.crossOrigin=Kv(s):i!==!1&&(t.crossOrigin=typeof i=="string"?i:"anonymous")}upload(t,s,i,r){const n=t.gl,o=s.realWidth,a=s.realHeight;if(r=r||this.source,typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement){if(!r.complete||r.naturalWidth===0)return!1}else if(typeof HTMLVideoElement<"u"&&r instanceof HTMLVideoElement&&r.readyState<=1&&r.buffered.length===0)return!1;return n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,s.alphaMode===Ne.UNPACK),!this.noSubImage&&s.target===n.TEXTURE_2D&&i.width===o&&i.height===a?n.texSubImage2D(n.TEXTURE_2D,0,0,0,s.format,i.type,r):(i.width=o,i.height=a,n.texImage2D(s.target,0,i.internalFormat,s.format,i.type,r)),!0}update(){if(this.destroyed)return;const t=this.source,s=t.naturalWidth||t.videoWidth||t.width,i=t.naturalHeight||t.videoHeight||t.height;this.resize(s,i),super.update()}dispose(){this.source=null}}class Ed extends Is{constructor(t,s){if(s=s||{},typeof t=="string"){const i=new Image;Is.crossOrigin(i,t,s.crossorigin),i.src=t,t=i}super(t),!t.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=t.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(s.createBitmap??q.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,this.alphaMode=typeof s.alphaMode=="number"?s.alphaMode:null,this.bitmap=null,this._load=null,s.autoLoad!==!1&&this.load()}load(t){return this._load?this._load:(t!==void 0&&(this.createBitmap=t),this._load=new Promise((s,i)=>{const r=this.source;this.url=r.src;const n=()=>{this.destroyed||(r.onload=null,r.onerror=null,this.resize(r.width,r.height),this._load=null,this.createBitmap?s(this.process()):s(this))};r.complete&&r.src?n():(r.onload=n,r.onerror=o=>{i(o),this.onError.emit(o)})}),this._load)}process(){const t=this.source;if(this._process!==null)return this._process;if(this.bitmap!==null||!globalThis.createImageBitmap)return Promise.resolve(this);const s=globalThis.createImageBitmap,i=!t.crossOrigin||t.crossOrigin==="anonymous";return this._process=fetch(t.src,{mode:i?"cors":"no-cors"}).then(r=>r.blob()).then(r=>s(r,0,0,t.width,t.height,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===Ne.UNPACK?"premultiply":"none"})).then(r=>this.destroyed?Promise.reject():(this.bitmap=r,this.update(),this._process=null,Promise.resolve(this))),this._process}upload(t,s,i){if(typeof this.alphaMode=="number"&&(s.alphaMode=this.alphaMode),!this.createBitmap)return super.upload(t,s,i);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(super.upload(t,s,i,this.bitmap),!this.preserveBitmap){let r=!0;const n=s._glTextures;for(const o in n){const a=n[o];if(a!==i&&a.dirtyId!==s.dirtyId){r=!1;break}}r&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0}dispose(){this.source.onload=null,this.source.onerror=null,super.dispose(),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null}static test(t){return typeof HTMLImageElement<"u"&&(typeof t=="string"||t instanceof HTMLImageElement)}}class bd{constructor(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}set(t,s,i){const r=s.width,n=s.height;if(i){const o=t.width/2/r,a=t.height/2/n,l=t.x/r+o,h=t.y/n+a;i=kt.add(i,kt.NW),this.x0=l+o*kt.uX(i),this.y0=h+a*kt.uY(i),i=kt.add(i,2),this.x1=l+o*kt.uX(i),this.y1=h+a*kt.uY(i),i=kt.add(i,2),this.x2=l+o*kt.uX(i),this.y2=h+a*kt.uY(i),i=kt.add(i,2),this.x3=l+o*kt.uX(i),this.y3=h+a*kt.uY(i)}else this.x0=t.x/r,this.y0=t.y/n,this.x1=(t.x+t.width)/r,this.y1=t.y/n,this.x2=(t.x+t.width)/r,this.y2=(t.y+t.height)/n,this.x3=t.x/r,this.y3=(t.y+t.height)/n;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}toString(){return`[@pixi/core:TextureUvs x0=${this.x0} y0=${this.y0} x1=${this.x1} y1=${this.y1} x2=${this.x2} y2=${this.y2} x3=${this.x3} y3=${this.y3}]`}}const ec=new bd;function kr(e){e.destroy=function(){},e.on=function(){},e.once=function(){},e.emit=function(){}}class J extends Vs{constructor(t,s,i,r,n,o){if(super(),this.noFrame=!1,s||(this.noFrame=!0,s=new yt(0,0,1,1)),t instanceof J&&(t=t.baseTexture),this.baseTexture=t,this._frame=s,this.trim=r,this.valid=!1,this._uvs=ec,this.uvMatrix=null,this.orig=i||s,this._rotate=Number(n||0),n===!0)this._rotate=2;else if(this._rotate%2!==0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=o?new Tt(o.x,o.y):new Tt(0,0),this._updateID=0,this.textureCacheIds=[],t.valid?this.noFrame?t.valid&&this.onBaseTextureUpdated(t):this.frame=s:t.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&t.on("update",this.onBaseTextureUpdated,this)}update(){this.baseTexture.resource&&this.baseTexture.resource.update()}onBaseTextureUpdated(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)}destroy(t){if(this.baseTexture){if(t){const{resource:s}=this.baseTexture;s!=null&&s.url&&Ge[s.url]&&J.removeFromCache(s.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,J.removeFromCache(this),this.textureCacheIds=null}clone(){var r;const t=this._frame.clone(),s=this._frame===this.orig?t:this.orig.clone(),i=new J(this.baseTexture,!this.noFrame&&t,s,(r=this.trim)==null?void 0:r.clone(),this.rotate,this.defaultAnchor);return this.noFrame&&(i._frame=t),i}updateUvs(){this._uvs===ec&&(this._uvs=new bd),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++}static from(t,s={},i=q.STRICT_TEXTURE_CACHE){const r=typeof t=="string";let n=null;if(r)n=t;else if(t instanceof pt){if(!t.cacheId){const a=(s==null?void 0:s.pixiIdPrefix)||"pixiid";t.cacheId=`${a}-${Ks()}`,pt.addToCache(t,t.cacheId)}n=t.cacheId}else{if(!t._pixiId){const a=(s==null?void 0:s.pixiIdPrefix)||"pixiid";t._pixiId=`${a}_${Ks()}`}n=t._pixiId}let o=Ge[n];if(r&&i&&!o)throw new Error(`The cacheId "${n}" does not exist in TextureCache.`);return!o&&!(t instanceof pt)?(s.resolution||(s.resolution=As(t)),o=new J(new pt(t,s)),o.baseTexture.cacheId=n,pt.addToCache(o.baseTexture,n),J.addToCache(o,n)):!o&&t instanceof pt&&(o=new J(t),J.addToCache(o,n)),o}static fromURL(t,s){const i=Object.assign({autoLoad:!1},s==null?void 0:s.resourceOptions),r=J.from(t,Object.assign({resourceOptions:i},s),!1),n=r.baseTexture.resource;return r.baseTexture.valid?Promise.resolve(r):n.load().then(()=>Promise.resolve(r))}static fromBuffer(t,s,i,r){return new J(pt.fromBuffer(t,s,i,r))}static fromLoader(t,s,i,r){const n=new pt(t,Object.assign({scaleMode:q.SCALE_MODE,resolution:As(s)},r)),{resource:o}=n;o instanceof Ed&&(o.url=s);const a=new J(n);return i||(i=s),pt.addToCache(a.baseTexture,i),J.addToCache(a,i),i!==s&&(pt.addToCache(a.baseTexture,s),J.addToCache(a,s)),a.baseTexture.valid?Promise.resolve(a):new Promise(l=>{a.baseTexture.once("loaded",()=>l(a))})}static addToCache(t,s){s&&(t.textureCacheIds.includes(s)||t.textureCacheIds.push(s),Ge[s]&&Ge[s]!==t&&console.warn(`Texture added to the cache with an id [${s}] that already had an entry`),Ge[s]=t)}static removeFromCache(t){if(typeof t=="string"){const s=Ge[t];if(s){const i=s.textureCacheIds.indexOf(t);return i>-1&&s.textureCacheIds.splice(i,1),delete Ge[t],s}}else if(t!=null&&t.textureCacheIds){for(let s=0;s<t.textureCacheIds.length;++s)Ge[t.textureCacheIds[s]]===t&&delete Ge[t.textureCacheIds[s]];return t.textureCacheIds.length=0,t}return null}get resolution(){return this.baseTexture.resolution}get frame(){return this._frame}set frame(t){this._frame=t,this.noFrame=!1;const{x:s,y:i,width:r,height:n}=t,o=s+r>this.baseTexture.width,a=i+n>this.baseTexture.height;if(o||a){const l=o&&a?"and":"or",h=`X: ${s} + ${r} = ${s+r} > ${this.baseTexture.width}`,c=`Y: ${i} + ${n} = ${i+n} > ${this.baseTexture.height}`;throw new Error(`Texture Error: frame does not fit inside the base Texture dimensions: ${h} ${l} ${c}`)}this.valid=r&&n&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=t),this.valid&&this.updateUvs()}get rotate(){return this._rotate}set rotate(t){this._rotate=t,this.valid&&this.updateUvs()}get width(){return this.orig.width}get height(){return this.orig.height}castToBaseTexture(){return this.baseTexture}static get EMPTY(){return J._EMPTY||(J._EMPTY=new J(new pt),kr(J._EMPTY),kr(J._EMPTY.baseTexture)),J._EMPTY}static get WHITE(){if(!J._WHITE){const t=q.ADAPTER.createCanvas(16,16),s=t.getContext("2d");t.width=16,t.height=16,s.fillStyle="white",s.fillRect(0,0,16,16),J._WHITE=new J(pt.from(t)),kr(J._WHITE),kr(J._WHITE.baseTexture)}return J._WHITE}}class Rs extends J{constructor(t,s){super(t,s),this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}get framebuffer(){return this.baseTexture.framebuffer}get multisample(){return this.framebuffer.multisample}set multisample(t){this.framebuffer.multisample=t}resize(t,s,i=!0){const r=this.baseTexture.resolution,n=Math.round(t*r)/r,o=Math.round(s*r)/r;this.valid=n>0&&o>0,this._frame.width=this.orig.width=n,this._frame.height=this.orig.height=o,i&&this.baseTexture.resize(n,o),this.updateUvs()}setResolution(t){const{baseTexture:s}=this;s.resolution!==t&&(s.setResolution(t),this.resize(s.width,s.height,!1))}static create(t){return new Rs(new yd(t))}}class Td{constructor(t){this.texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}createTexture(t,s,i=Xt.NONE){const r=new yd(Object.assign({width:t,height:s,resolution:1,multisample:i},this.textureOptions));return new Rs(r)}getOptimalTexture(t,s,i=1,r=Xt.NONE){let n;t=Math.ceil(t*i-1e-6),s=Math.ceil(s*i-1e-6),!this.enableFullScreen||t!==this._pixelsWidth||s!==this._pixelsHeight?(t=En(t),s=En(s),n=((t&65535)<<16|s&65535)>>>0,r>1&&(n+=r*4294967296)):n=r>1?-r:-1,this.texturePool[n]||(this.texturePool[n]=[]);let o=this.texturePool[n].pop();return o||(o=this.createTexture(t,s,r)),o.filterPoolKey=n,o.setResolution(i),o}getFilterTexture(t,s,i){const r=this.getOptimalTexture(t.width,t.height,s||t.resolution,i||Xt.NONE);return r.filterFrame=t.filterFrame,r}returnTexture(t){const s=t.filterPoolKey;t.filterFrame=null,this.texturePool[s].push(t)}returnFilterTexture(t){this.returnTexture(t)}clear(t){if(t=t!==!1,t)for(const s in this.texturePool){const i=this.texturePool[s];if(i)for(let r=0;r<i.length;r++)i[r].destroy(!0)}this.texturePool={}}setScreenSize(t){if(!(t.width===this._pixelsWidth&&t.height===this._pixelsHeight)){this.enableFullScreen=t.width>0&&t.height>0;for(const s in this.texturePool){if(!(Number(s)<0))continue;const i=this.texturePool[s];if(i)for(let r=0;r<i.length;r++)i[r].destroy(!0);this.texturePool[s]=[]}this._pixelsWidth=t.width,this._pixelsHeight=t.height}}}Td.SCREEN_KEY=-1;class Iy extends Cs{constructor(){super(),this.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2])}}class wd extends Cs{constructor(){super(),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new jt(this.vertices),this.uvBuffer=new jt(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}map(t,s){let i=0,r=0;return this.uvs[0]=i,this.uvs[1]=r,this.uvs[2]=i+s.width/t.width,this.uvs[3]=r,this.uvs[4]=i+s.width/t.width,this.uvs[5]=r+s.height/t.height,this.uvs[6]=i,this.uvs[7]=r+s.height/t.height,i=s.x,r=s.y,this.vertices[0]=i,this.vertices[1]=r,this.vertices[2]=i+s.width,this.vertices[3]=r,this.vertices[4]=i+s.width,this.vertices[5]=r+s.height,this.vertices[6]=i,this.vertices[7]=r+s.height,this.invalidate(),this}invalidate(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this}}class Ry{constructor(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=Xt.NONE,this.sourceFrame=new yt,this.destinationFrame=new yt,this.bindingSourceFrame=new yt,this.bindingDestinationFrame=new yt,this.filters=[],this.transform=null}clear(){this.target=null,this.filters=null,this.renderTexture=null}}const Gr=[new Tt,new Tt,new Tt,new Tt],Ro=new Nt;class Sd{constructor(t){this.renderer=t,this.defaultFilterStack=[{}],this.texturePool=new Td,this.statePool=[],this.quad=new Iy,this.quadUv=new wd,this.tempRect=new yt,this.activeState={},this.globalUniforms=new Le({outputFrame:new yt,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}init(){this.texturePool.setScreenSize(this.renderer.view)}push(t,s){const i=this.renderer,r=this.defaultFilterStack,n=this.statePool.pop()||new Ry,o=this.renderer.renderTexture;let a=s[0].resolution,l=s[0].multisample,h=s[0].padding,c=s[0].autoFit,u=s[0].legacy??!0;for(let f=1;f<s.length;f++){const m=s[f];a=Math.min(a,m.resolution),l=Math.min(l,m.multisample),h=this.useMaxPadding?Math.max(h,m.padding):h+m.padding,c=c&&m.autoFit,u=u||(m.legacy??!0)}r.length===1&&(this.defaultFilterStack[0].renderTexture=o.current),r.push(n),n.resolution=a,n.multisample=l,n.legacy=u,n.target=t,n.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),n.sourceFrame.pad(h);const d=this.tempRect.copyFrom(o.sourceFrame);i.projection.transform&&this.transformAABB(Ro.copyFrom(i.projection.transform).invert(),d),c?(n.sourceFrame.fit(d),(n.sourceFrame.width<=0||n.sourceFrame.height<=0)&&(n.sourceFrame.width=0,n.sourceFrame.height=0)):n.sourceFrame.intersects(d)||(n.sourceFrame.width=0,n.sourceFrame.height=0),this.roundFrame(n.sourceFrame,o.current?o.current.resolution:i.resolution,o.sourceFrame,o.destinationFrame,i.projection.transform),n.renderTexture=this.getOptimalFilterTexture(n.sourceFrame.width,n.sourceFrame.height,a,l),n.filters=s,n.destinationFrame.width=n.renderTexture.width,n.destinationFrame.height=n.renderTexture.height;const p=this.tempRect;p.x=0,p.y=0,p.width=n.sourceFrame.width,p.height=n.sourceFrame.height,n.renderTexture.filterFrame=n.sourceFrame,n.bindingSourceFrame.copyFrom(o.sourceFrame),n.bindingDestinationFrame.copyFrom(o.destinationFrame),n.transform=i.projection.transform,i.projection.transform=null,o.bind(n.renderTexture,n.sourceFrame,p),i.framebuffer.clear(0,0,0,0)}pop(){const t=this.defaultFilterStack,s=t.pop(),i=s.filters;this.activeState=s;const r=this.globalUniforms.uniforms;r.outputFrame=s.sourceFrame,r.resolution=s.resolution;const n=r.inputSize,o=r.inputPixel,a=r.inputClamp;if(n[0]=s.destinationFrame.width,n[1]=s.destinationFrame.height,n[2]=1/n[0],n[3]=1/n[1],o[0]=Math.round(n[0]*s.resolution),o[1]=Math.round(n[1]*s.resolution),o[2]=1/o[0],o[3]=1/o[1],a[0]=.5*o[2],a[1]=.5*o[3],a[2]=s.sourceFrame.width*n[2]-.5*o[2],a[3]=s.sourceFrame.height*n[3]-.5*o[3],s.legacy){const h=r.filterArea;h[0]=s.destinationFrame.width,h[1]=s.destinationFrame.height,h[2]=s.sourceFrame.x,h[3]=s.sourceFrame.y,r.filterClamp=r.inputClamp}this.globalUniforms.update();const l=t[t.length-1];if(this.renderer.framebuffer.blit(),i.length===1)i[0].apply(this,s.renderTexture,l.renderTexture,$e.BLEND,s),this.returnFilterTexture(s.renderTexture);else{let h=s.renderTexture,c=this.getOptimalFilterTexture(h.width,h.height,s.resolution);c.filterFrame=h.filterFrame;let u=0;for(u=0;u<i.length-1;++u){u===1&&s.multisample>1&&(c=this.getOptimalFilterTexture(h.width,h.height,s.resolution),c.filterFrame=h.filterFrame),i[u].apply(this,h,c,$e.CLEAR,s);const d=h;h=c,c=d}i[u].apply(this,h,l.renderTexture,$e.BLEND,s),u>1&&s.multisample>1&&this.returnFilterTexture(s.renderTexture),this.returnFilterTexture(h),this.returnFilterTexture(c)}s.clear(),this.statePool.push(s)}bindAndClear(t,s=$e.CLEAR){const{renderTexture:i,state:r}=this.renderer;if(t===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,t!=null&&t.filterFrame){const o=this.tempRect;o.x=0,o.y=0,o.width=t.filterFrame.width,o.height=t.filterFrame.height,i.bind(t,t.filterFrame,o)}else t!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?i.bind(t):this.renderer.renderTexture.bind(t,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);const n=r.stateId&1||this.forceClear;(s===$e.CLEAR||s===$e.BLIT&&n)&&this.renderer.framebuffer.clear(0,0,0,0)}applyFilter(t,s,i,r){const n=this.renderer;n.state.set(t.state),this.bindAndClear(i,r),t.uniforms.uSampler=s,t.uniforms.filterGlobals=this.globalUniforms,n.shader.bind(t),t.legacy=!!t.program.attributeData.aTextureCoord,t.legacy?(this.quadUv.map(s._frame,s.filterFrame),n.geometry.bind(this.quadUv),n.geometry.draw(Ve.TRIANGLES)):(n.geometry.bind(this.quad),n.geometry.draw(Ve.TRIANGLE_STRIP))}calculateSpriteMatrix(t,s){const{sourceFrame:i,destinationFrame:r}=this.activeState,{orig:n}=s._texture,o=t.set(r.width,0,0,r.height,i.x,i.y),a=s.worldTransform.copyTo(Nt.TEMP_MATRIX);return a.invert(),o.prepend(a),o.scale(1/n.width,1/n.height),o.translate(s.anchor.x,s.anchor.y),o}destroy(){this.renderer=null,this.texturePool.clear(!1)}getOptimalFilterTexture(t,s,i=1,r=Xt.NONE){return this.texturePool.getOptimalTexture(t,s,i,r)}getFilterTexture(t,s,i){if(typeof t=="number"){const n=t;t=s,s=n}t=t||this.activeState.renderTexture;const r=this.texturePool.getOptimalTexture(t.width,t.height,s||t.resolution,i||Xt.NONE);return r.filterFrame=t.filterFrame,r}returnFilterTexture(t){this.texturePool.returnTexture(t)}emptyPool(){this.texturePool.clear(!0)}resize(){this.texturePool.setScreenSize(this.renderer.view)}transformAABB(t,s){const i=Gr[0],r=Gr[1],n=Gr[2],o=Gr[3];i.set(s.left,s.top),r.set(s.left,s.bottom),n.set(s.right,s.top),o.set(s.right,s.bottom),t.apply(i,i),t.apply(r,r),t.apply(n,n),t.apply(o,o);const a=Math.min(i.x,r.x,n.x,o.x),l=Math.min(i.y,r.y,n.y,o.y),h=Math.max(i.x,r.x,n.x,o.x),c=Math.max(i.y,r.y,n.y,o.y);s.x=a,s.y=l,s.width=h-a,s.height=c-l}roundFrame(t,s,i,r,n){if(!(t.width<=0||t.height<=0||i.width<=0||i.height<=0)){if(n){const{a:o,b:a,c:l,d:h}=n;if((Math.abs(a)>1e-4||Math.abs(l)>1e-4)&&(Math.abs(o)>1e-4||Math.abs(h)>1e-4))return}n=n?Ro.copyFrom(n):Ro.identity(),n.translate(-i.x,-i.y).scale(r.width/i.width,r.height/i.height).translate(r.x,r.y),this.transformAABB(n,t),t.ceil(s),this.transformAABB(n.invert(),t)}}}Sd.extension={type:K.RendererSystem,name:"filter"};rt.add(Sd);class Py{constructor(t){this.framebuffer=t,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=Xt.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}}const My=new yt;class Ad{constructor(t){this.renderer=t,this.managedFramebuffers=[],this.unknownFramebuffer=new Sa(10,10),this.msaaSamples=null}contextChange(){this.disposeAll(!0);const t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new yt,this.hasMRT=!0,this.writeDepthTexture=!0,this.renderer.context.webGLVersion===1){let s=this.renderer.context.extensions.drawBuffers,i=this.renderer.context.extensions.depthTexture;q.PREFER_ENV===ei.WEBGL_LEGACY&&(s=null,i=null),s?t.drawBuffers=r=>s.drawBuffersWEBGL(r):(this.hasMRT=!1,t.drawBuffers=()=>{}),i||(this.writeDepthTexture=!1)}else this.msaaSamples=t.getInternalformatParameter(t.RENDERBUFFER,t.RGBA8,t.SAMPLES)}bind(t,s,i=0){const{gl:r}=this;if(t){const n=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,r.bindFramebuffer(r.FRAMEBUFFER,n.framebuffer)),n.mipLevel!==i&&(t.dirtyId++,t.dirtyFormat++,n.mipLevel=i),n.dirtyId!==t.dirtyId&&(n.dirtyId=t.dirtyId,n.dirtyFormat!==t.dirtyFormat?(n.dirtyFormat=t.dirtyFormat,n.dirtySize=t.dirtySize,this.updateFramebuffer(t,i)):n.dirtySize!==t.dirtySize&&(n.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(let o=0;o<t.colorTextures.length;o++){const a=t.colorTextures[o];this.renderer.texture.unbind(a.parentTextureArray||a)}if(t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),s){const o=s.width>>i,a=s.height>>i,l=o/s.width;this.setViewport(s.x*l,s.y*l,o,a)}else{const o=t.width>>i,a=t.height>>i;this.setViewport(0,0,o,a)}}else this.current&&(this.current=null,r.bindFramebuffer(r.FRAMEBUFFER,null)),s?this.setViewport(s.x,s.y,s.width,s.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)}setViewport(t,s,i,r){const n=this.viewport;t=Math.round(t),s=Math.round(s),i=Math.round(i),r=Math.round(r),(n.width!==i||n.height!==r||n.x!==t||n.y!==s)&&(n.x=t,n.y=s,n.width=i,n.height=r,this.gl.viewport(t,s,i,r))}get size(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}}clear(t,s,i,r,n=ca.COLOR|ca.DEPTH){const{gl:o}=this;o.clearColor(t,s,i,r),o.clear(n)}initFramebuffer(t){const{gl:s}=this,i=new Py(s.createFramebuffer());return i.multisample=this.detectSamples(t.multisample),t.glFramebuffers[this.CONTEXT_UID]=i,this.managedFramebuffers.push(t),t.disposeRunner.add(this),i}resizeFramebuffer(t){const{gl:s}=this,i=t.glFramebuffers[this.CONTEXT_UID];i.stencil&&(s.bindRenderbuffer(s.RENDERBUFFER,i.stencil),i.msaaBuffer?s.renderbufferStorageMultisample(s.RENDERBUFFER,i.multisample,s.DEPTH24_STENCIL8,t.width,t.height):s.renderbufferStorage(s.RENDERBUFFER,s.DEPTH_STENCIL,t.width,t.height));const r=t.colorTextures;let n=r.length;s.drawBuffers||(n=Math.min(n,1));for(let o=0;o<n;o++){const a=r[o],l=a.parentTextureArray||a;this.renderer.texture.bind(l,0),o===0&&i.msaaBuffer&&(s.bindRenderbuffer(s.RENDERBUFFER,i.msaaBuffer),s.renderbufferStorageMultisample(s.RENDERBUFFER,i.multisample,l._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height))}t.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(t.depthTexture,0)}updateFramebuffer(t,s){const{gl:i}=this,r=t.glFramebuffers[this.CONTEXT_UID],n=t.colorTextures;let o=n.length;i.drawBuffers||(o=Math.min(o,1)),r.multisample>1&&this.canMultisampleFramebuffer(t)?r.msaaBuffer=r.msaaBuffer||i.createRenderbuffer():r.msaaBuffer&&(i.deleteRenderbuffer(r.msaaBuffer),r.msaaBuffer=null,r.blitFramebuffer&&(r.blitFramebuffer.dispose(),r.blitFramebuffer=null));const a=[];for(let l=0;l<o;l++){const h=n[l],c=h.parentTextureArray||h;this.renderer.texture.bind(c,0),l===0&&r.msaaBuffer?(i.bindRenderbuffer(i.RENDERBUFFER,r.msaaBuffer),i.renderbufferStorageMultisample(i.RENDERBUFFER,r.multisample,c._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.RENDERBUFFER,r.msaaBuffer)):(i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+l,h.target,c._glTextures[this.CONTEXT_UID].texture,s),a.push(i.COLOR_ATTACHMENT0+l))}if(a.length>1&&i.drawBuffers(a),t.depthTexture&&this.writeDepthTexture){const h=t.depthTexture;this.renderer.texture.bind(h,0),i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,h._glTextures[this.CONTEXT_UID].texture,s)}(t.stencil||t.depth)&&!(t.depthTexture&&this.writeDepthTexture)?(r.stencil=r.stencil||i.createRenderbuffer(),i.bindRenderbuffer(i.RENDERBUFFER,r.stencil),r.msaaBuffer?i.renderbufferStorageMultisample(i.RENDERBUFFER,r.multisample,i.DEPTH24_STENCIL8,t.width,t.height):i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_STENCIL,t.width,t.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.RENDERBUFFER,r.stencil)):r.stencil&&(i.deleteRenderbuffer(r.stencil),r.stencil=null)}canMultisampleFramebuffer(t){return this.renderer.context.webGLVersion!==1&&t.colorTextures.length<=1&&!t.depthTexture}detectSamples(t){const{msaaSamples:s}=this;let i=Xt.NONE;if(t<=1||s===null)return i;for(let r=0;r<s.length;r++)if(s[r]<=t){i=s[r];break}return i===1&&(i=Xt.NONE),i}blit(t,s,i){const{current:r,renderer:n,gl:o,CONTEXT_UID:a}=this;if(n.context.webGLVersion!==2||!r)return;const l=r.glFramebuffers[a];if(!l)return;if(!t){if(!l.msaaBuffer)return;const c=r.colorTextures[0];if(!c)return;l.blitFramebuffer||(l.blitFramebuffer=new Sa(r.width,r.height),l.blitFramebuffer.addColorTexture(0,c)),t=l.blitFramebuffer,t.colorTextures[0]!==c&&(t.colorTextures[0]=c,t.dirtyId++,t.dirtyFormat++),(t.width!==r.width||t.height!==r.height)&&(t.width=r.width,t.height=r.height,t.dirtyId++,t.dirtySize++)}s||(s=My,s.width=r.width,s.height=r.height),i||(i=s);const h=s.width===i.width&&s.height===i.height;this.bind(t),o.bindFramebuffer(o.READ_FRAMEBUFFER,l.framebuffer),o.blitFramebuffer(s.left,s.top,s.right,s.bottom,i.left,i.top,i.right,i.bottom,o.COLOR_BUFFER_BIT,h?o.NEAREST:o.LINEAR)}disposeFramebuffer(t,s){const i=t.glFramebuffers[this.CONTEXT_UID],r=this.gl;if(!i)return;delete t.glFramebuffers[this.CONTEXT_UID];const n=this.managedFramebuffers.indexOf(t);n>=0&&this.managedFramebuffers.splice(n,1),t.disposeRunner.remove(this),s||(r.deleteFramebuffer(i.framebuffer),i.msaaBuffer&&r.deleteRenderbuffer(i.msaaBuffer),i.stencil&&r.deleteRenderbuffer(i.stencil)),i.blitFramebuffer&&i.blitFramebuffer.dispose()}disposeAll(t){const s=this.managedFramebuffers;this.managedFramebuffers=[];for(let i=0;i<s.length;i++)this.disposeFramebuffer(s[i],t)}forceStencil(){const t=this.current;if(!t)return;const s=t.glFramebuffers[this.CONTEXT_UID];if(!s||s.stencil)return;t.stencil=!0;const i=t.width,r=t.height,n=this.gl,o=n.createRenderbuffer();n.bindRenderbuffer(n.RENDERBUFFER,o),s.msaaBuffer?n.renderbufferStorageMultisample(n.RENDERBUFFER,s.multisample,n.DEPTH24_STENCIL8,i,r):n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,i,r),s.stencil=o,n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,o)}reset(){this.current=this.unknownFramebuffer,this.viewport=new yt}destroy(){this.renderer=null}}Ad.extension={type:K.RendererSystem,name:"framebuffer"};rt.add(Ad);const Po={5126:4,5123:2,5121:1};class Cd{constructor(t){this.renderer=t,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}contextChange(){this.disposeAll(!0);const t=this.gl=this.renderer.gl,s=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,s.webGLVersion!==2){let i=this.renderer.context.extensions.vertexArrayObject;q.PREFER_ENV===ei.WEBGL_LEGACY&&(i=null),i?(t.createVertexArray=()=>i.createVertexArrayOES(),t.bindVertexArray=r=>i.bindVertexArrayOES(r),t.deleteVertexArray=r=>i.deleteVertexArrayOES(r)):(this.hasVao=!1,t.createVertexArray=()=>null,t.bindVertexArray=()=>null,t.deleteVertexArray=()=>null)}if(s.webGLVersion!==2){const i=t.getExtension("ANGLE_instanced_arrays");i?(t.vertexAttribDivisor=(r,n)=>i.vertexAttribDivisorANGLE(r,n),t.drawElementsInstanced=(r,n,o,a,l)=>i.drawElementsInstancedANGLE(r,n,o,a,l),t.drawArraysInstanced=(r,n,o,a)=>i.drawArraysInstancedANGLE(r,n,o,a)):this.hasInstance=!1}this.canUseUInt32ElementIndex=s.webGLVersion===2||!!s.extensions.uint32ElementIndex}bind(t,s){s=s||this.renderer.shader.shader;const{gl:i}=this;let r=t.glVertexArrayObjects[this.CONTEXT_UID],n=!1;r||(this.managedGeometries[t.id]=t,t.disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=r={},n=!0);const o=r[s.program.id]||this.initGeometryVao(t,s,n);this._activeGeometry=t,this._activeVao!==o&&(this._activeVao=o,this.hasVao?i.bindVertexArray(o):this.activateVao(t,s.program)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){const t=this._activeGeometry,s=this.renderer.buffer;for(let i=0;i<t.buffers.length;i++){const r=t.buffers[i];s.update(r)}}checkCompatibility(t,s){const i=t.attributes,r=s.attributeData;for(const n in r)if(!i[n])throw new Error(`shader and geometry incompatible, geometry missing the "${n}" attribute`)}getSignature(t,s){const i=t.attributes,r=s.attributeData,n=["g",t.id];for(const o in i)r[o]&&n.push(o,r[o].location);return n.join("-")}initGeometryVao(t,s,i=!0){const r=this.gl,n=this.CONTEXT_UID,o=this.renderer.buffer,a=s.program;a.glPrograms[n]||this.renderer.shader.generateProgram(s),this.checkCompatibility(t,a);const l=this.getSignature(t,a),h=t.glVertexArrayObjects[this.CONTEXT_UID];let c=h[l];if(c)return h[a.id]=c,c;const u=t.buffers,d=t.attributes,p={},f={};for(const m in u)p[m]=0,f[m]=0;for(const m in d)!d[m].size&&a.attributeData[m]?d[m].size=a.attributeData[m].size:d[m].size||console.warn(`PIXI Geometry attribute '${m}' size cannot be determined (likely the bound shader does not have the attribute)`),p[d[m].buffer]+=d[m].size*Po[d[m].type];for(const m in d){const _=d[m],v=_.size;_.stride===void 0&&(p[_.buffer]===v*Po[_.type]?_.stride=0:_.stride=p[_.buffer]),_.start===void 0&&(_.start=f[_.buffer],f[_.buffer]+=v*Po[_.type])}c=r.createVertexArray(),r.bindVertexArray(c);for(let m=0;m<u.length;m++){const _=u[m];o.bind(_),i&&_._glBuffers[n].refCount++}return this.activateVao(t,a),h[a.id]=c,h[l]=c,r.bindVertexArray(null),o.unbind(Ke.ARRAY_BUFFER),c}disposeGeometry(t,s){var a;if(!this.managedGeometries[t.id])return;delete this.managedGeometries[t.id];const i=t.glVertexArrayObjects[this.CONTEXT_UID],r=this.gl,n=t.buffers,o=(a=this.renderer)==null?void 0:a.buffer;if(t.disposeRunner.remove(this),!!i){if(o)for(let l=0;l<n.length;l++){const h=n[l]._glBuffers[this.CONTEXT_UID];h&&(h.refCount--,h.refCount===0&&!s&&o.dispose(n[l],s))}if(!s){for(const l in i)if(l[0]==="g"){const h=i[l];this._activeVao===h&&this.unbind(),r.deleteVertexArray(h)}}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}disposeAll(t){const s=Object.keys(this.managedGeometries);for(let i=0;i<s.length;i++)this.disposeGeometry(this.managedGeometries[s[i]],t)}activateVao(t,s){const i=this.gl,r=this.CONTEXT_UID,n=this.renderer.buffer,o=t.buffers,a=t.attributes;t.indexBuffer&&n.bind(t.indexBuffer);let l=null;for(const h in a){const c=a[h],u=o[c.buffer],d=u._glBuffers[r];if(s.attributeData[h]){l!==d&&(n.bind(u),l=d);const p=s.attributeData[h].location;if(i.enableVertexAttribArray(p),i.vertexAttribPointer(p,c.size,c.type||i.FLOAT,c.normalized,c.stride,c.start),c.instance)if(this.hasInstance)i.vertexAttribDivisor(p,c.divisor);else throw new Error("geometry error, GPU Instancing is not supported on this device")}}}draw(t,s,i,r){const{gl:n}=this,o=this._activeGeometry;if(o.indexBuffer){const a=o.indexBuffer.data.BYTES_PER_ELEMENT,l=a===2?n.UNSIGNED_SHORT:n.UNSIGNED_INT;a===2||a===4&&this.canUseUInt32ElementIndex?o.instanced?n.drawElementsInstanced(t,s||o.indexBuffer.data.length,l,(i||0)*a,r||1):n.drawElements(t,s||o.indexBuffer.data.length,l,(i||0)*a):console.warn("unsupported index buffer type: uint32")}else o.instanced?n.drawArraysInstanced(t,i,s||o.getSize(),r||1):n.drawArrays(t,i,s||o.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this.renderer=null}}Cd.extension={type:K.RendererSystem,name:"geometry"};rt.add(Cd);const sc=new Nt;class Id{constructor(t,s){this._texture=t,this.mapCoord=new Nt,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof s>"u"?.5:s,this.isSimple=!1}get texture(){return this._texture}set texture(t){this._texture=t,this._textureID=-1}multiplyUvs(t,s){s===void 0&&(s=t);const i=this.mapCoord;for(let r=0;r<t.length;r+=2){const n=t[r],o=t[r+1];s[r]=n*i.a+o*i.c+i.tx,s[r+1]=n*i.b+o*i.d+i.ty}return s}update(t){const s=this._texture;if(!s||!s.valid||!t&&this._textureID===s._updateID)return!1;this._textureID=s._updateID,this._updateID++;const i=s._uvs;this.mapCoord.set(i.x1-i.x0,i.y1-i.y0,i.x3-i.x0,i.y3-i.y0,i.x0,i.y0);const r=s.orig,n=s.trim;n&&(sc.set(r.width/n.width,0,0,r.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(sc));const o=s.baseTexture,a=this.uClampFrame,l=this.clampMargin/o.resolution,h=this.clampOffset;return a[0]=(s._frame.x+l+h)/o.width,a[1]=(s._frame.y+l+h)/o.height,a[2]=(s._frame.x+s._frame.width-l+h)/o.width,a[3]=(s._frame.y+s._frame.height-l+h)/o.height,this.uClampOffset[0]=h/o.realWidth,this.uClampOffset[1]=h/o.realHeight,this.isSimple=s._frame.width===o.width&&s._frame.height===o.height&&s.rotate===0,!0}}var Oy=`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`,By=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`;class Dy extends ae{constructor(t,s,i){let r=null;typeof t!="string"&&s===void 0&&i===void 0&&(r=t,t=void 0,s=void 0,i=void 0),super(t||By,s||Oy,i),this.maskSprite=r,this.maskMatrix=new Nt}get maskSprite(){return this._maskSprite}set maskSprite(t){this._maskSprite=t,this._maskSprite&&(this._maskSprite.renderable=!1)}apply(t,s,i,r){const n=this._maskSprite,o=n._texture;o.valid&&(o.uvMatrix||(o.uvMatrix=new Id(o,0)),o.uvMatrix.update(),this.uniforms.npmAlpha=o.baseTexture.alphaMode?0:1,this.uniforms.mask=o,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,n).prepend(o.uvMatrix.mapCoord),this.uniforms.alpha=n.worldAlpha,this.uniforms.maskClamp=o.uvMatrix.uClampFrame,t.applyFilter(this,s,i,r))}}class Fy{constructor(t=null){this.type=Vt.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=q.FILTER_MULTISAMPLE,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}get filter(){return this._filters?this._filters[0]:null}set filter(t){t?this._filters?this._filters[0]=t:this._filters=[t]:this._filters=null}reset(){this.pooled&&(this.maskObject=null,this.type=Vt.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null}copyCountersOrReset(t){t?(this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)}}class Rd{constructor(t){this.renderer=t,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}setMaskStack(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)}push(t,s){let i=s;if(!i.isMaskData){const n=this.maskDataPool.pop()||new Fy;n.pooled=!0,n.maskObject=s,i=n}const r=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null;if(i.copyCountersOrReset(r),i._colorMask=r?r._colorMask:15,i.autoDetect&&this.detect(i),i._target=t,i.type!==Vt.SPRITE&&this.maskStack.push(i),i.enabled)switch(i.type){case Vt.SCISSOR:this.renderer.scissor.push(i);break;case Vt.STENCIL:this.renderer.stencil.push(i);break;case Vt.SPRITE:i.copyCountersOrReset(null),this.pushSpriteMask(i);break;case Vt.COLOR:this.pushColorMask(i);break}i.type===Vt.SPRITE&&this.maskStack.push(i)}pop(t){const s=this.maskStack.pop();if(!(!s||s._target!==t)){if(s.enabled)switch(s.type){case Vt.SCISSOR:this.renderer.scissor.pop(s);break;case Vt.STENCIL:this.renderer.stencil.pop(s.maskObject);break;case Vt.SPRITE:this.popSpriteMask(s);break;case Vt.COLOR:this.popColorMask(s);break}if(s.reset(),s.pooled&&this.maskDataPool.push(s),this.maskStack.length!==0){const i=this.maskStack[this.maskStack.length-1];i.type===Vt.SPRITE&&i._filters&&(i._filters[0].maskSprite=i.maskObject)}}}detect(t){const s=t.maskObject;s?s.isSprite?t.type=Vt.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(t)?t.type=Vt.SCISSOR:t.type=Vt.STENCIL:t.type=Vt.COLOR}pushSpriteMask(t){const{maskObject:s}=t,i=t._target;let r=t._filters;r||(r=this.alphaMaskPool[this.alphaMaskIndex],r||(r=this.alphaMaskPool[this.alphaMaskIndex]=[new Dy]));const n=this.renderer,o=n.renderTexture;let a,l;if(o.current){const c=o.current;a=t.resolution||c.resolution,l=t.multisample??c.multisample}else a=t.resolution||n.resolution,l=t.multisample??n.multisample;r[0].resolution=a,r[0].multisample=l,r[0].maskSprite=s;const h=i.filterArea;i.filterArea=s.getBounds(!0),n.filter.push(i,r),i.filterArea=h,t._filters||this.alphaMaskIndex++}popSpriteMask(t){this.renderer.filter.pop(),t._filters?t._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)}pushColorMask(t){const s=t._colorMask,i=t._colorMask=s&t.colorMask;i!==s&&this.renderer.gl.colorMask((i&1)!==0,(i&2)!==0,(i&4)!==0,(i&8)!==0)}popColorMask(t){const s=t._colorMask,i=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;i!==s&&this.renderer.gl.colorMask((i&1)!==0,(i&2)!==0,(i&4)!==0,(i&8)!==0)}destroy(){this.renderer=null}}Rd.extension={type:K.RendererSystem,name:"mask"};rt.add(Rd);class Pd{constructor(t){this.renderer=t,this.maskStack=[],this.glConst=0}getStackLength(){return this.maskStack.length}setMaskStack(t){const{gl:s}=this.renderer,i=this.getStackLength();this.maskStack=t;const r=this.getStackLength();r!==i&&(r===0?s.disable(this.glConst):(s.enable(this.glConst),this._useCurrent()))}_useCurrent(){}destroy(){this.renderer=null,this.maskStack=null}}const ic=new Nt,rc=[],sn=class extends Pd{constructor(e){super(e),this.glConst=q.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST}getStackLength(){const e=this.maskStack[this.maskStack.length-1];return e?e._scissorCounter:0}calcScissorRect(e){if(e._scissorRectLocal)return;const t=e._scissorRect,{maskObject:s}=e,{renderer:i}=this,r=i.renderTexture,n=s.getBounds(!0,rc.pop()??new yt);this.roundFrameToPixels(n,r.current?r.current.resolution:i.resolution,r.sourceFrame,r.destinationFrame,i.projection.transform),t&&n.fit(t),e._scissorRectLocal=n}static isMatrixRotated(e){if(!e)return!1;const{a:t,b:s,c:i,d:r}=e;return(Math.abs(s)>1e-4||Math.abs(i)>1e-4)&&(Math.abs(t)>1e-4||Math.abs(r)>1e-4)}testScissor(e){const{maskObject:t}=e;if(!t.isFastRect||!t.isFastRect()||sn.isMatrixRotated(t.worldTransform)||sn.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(e);const s=e._scissorRectLocal;return s.width>0&&s.height>0}roundFrameToPixels(e,t,s,i,r){sn.isMatrixRotated(r)||(r=r?ic.copyFrom(r):ic.identity(),r.translate(-s.x,-s.y).scale(i.width/s.width,i.height/s.height).translate(i.x,i.y),this.renderer.filter.transformAABB(r,e),e.fit(i),e.x=Math.round(e.x*t),e.y=Math.round(e.y*t),e.width=Math.round(e.width*t),e.height=Math.round(e.height*t))}push(e){e._scissorRectLocal||this.calcScissorRect(e);const{gl:t}=this.renderer;e._scissorRect||t.enable(t.SCISSOR_TEST),e._scissorCounter++,e._scissorRect=e._scissorRectLocal,this._useCurrent()}pop(e){const{gl:t}=this.renderer;e&&rc.push(e._scissorRectLocal),this.getStackLength()>0?this._useCurrent():t.disable(t.SCISSOR_TEST)}_useCurrent(){const e=this.maskStack[this.maskStack.length-1]._scissorRect;let t;this.renderer.renderTexture.current?t=e.y:t=this.renderer.height-e.height-e.y,this.renderer.gl.scissor(e.x,t,e.width,e.height)}};let Md=sn;Md.extension={type:K.RendererSystem,name:"scissor"};rt.add(Md);class Od extends Pd{constructor(t){super(t),this.glConst=q.ADAPTER.getWebGLRenderingContext().STENCIL_TEST}getStackLength(){const t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0}push(t){const s=t.maskObject,{gl:i}=this.renderer,r=t._stencilCounter;r===0&&(this.renderer.framebuffer.forceStencil(),i.clearStencil(0),i.clear(i.STENCIL_BUFFER_BIT),i.enable(i.STENCIL_TEST)),t._stencilCounter++;const n=t._colorMask;n!==0&&(t._colorMask=0,i.colorMask(!1,!1,!1,!1)),i.stencilFunc(i.EQUAL,r,4294967295),i.stencilOp(i.KEEP,i.KEEP,i.INCR),s.renderable=!0,s.render(this.renderer),this.renderer.batch.flush(),s.renderable=!1,n!==0&&(t._colorMask=n,i.colorMask((n&1)!==0,(n&2)!==0,(n&4)!==0,(n&8)!==0)),this._useCurrent()}pop(t){const s=this.renderer.gl;if(this.getStackLength()===0)s.disable(s.STENCIL_TEST);else{const i=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null,r=i?i._colorMask:15;r!==0&&(i._colorMask=0,s.colorMask(!1,!1,!1,!1)),s.stencilOp(s.KEEP,s.KEEP,s.DECR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,r!==0&&(i._colorMask=r,s.colorMask((r&1)!==0,(r&2)!==0,(r&4)!==0,(r&8)!==0)),this._useCurrent()}}_useCurrent(){const t=this.renderer.gl;t.stencilFunc(t.EQUAL,this.getStackLength(),4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)}}Od.extension={type:K.RendererSystem,name:"stencil"};rt.add(Od);class Bd{constructor(t){this.renderer=t,this.plugins={},Object.defineProperties(this.plugins,{extract:{enumerable:!1,get(){return Ct("7.0.0","renderer.plugins.extract has moved to renderer.extract"),t.extract}},prepare:{enumerable:!1,get(){return Ct("7.0.0","renderer.plugins.prepare has moved to renderer.prepare"),t.prepare}},interaction:{enumerable:!1,get(){return Ct("7.0.0","renderer.plugins.interaction has been deprecated, use renderer.events"),t.events}}})}init(t){for(const s in t)this.plugins[s]=new t[s](this.renderer)}destroy(){for(const t in this.plugins)this.plugins[t].destroy(),this.plugins[t]=null}}Bd.extension={type:[K.RendererSystem,K.CanvasRendererSystem],name:"_plugin"};rt.add(Bd);class Dd{constructor(t){this.renderer=t,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new Nt,this.transform=null}update(t,s,i,r){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=s||this.sourceFrame||t,this.calculateProjection(this.destinationFrame,this.sourceFrame,i,r),this.transform&&this.projectionMatrix.append(this.transform);const n=this.renderer;n.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,n.globalUniforms.update(),n.shader.shader&&n.shader.syncUniformGroup(n.shader.shader.uniforms.globals)}calculateProjection(t,s,i,r){const n=this.projectionMatrix,o=r?-1:1;n.identity(),n.a=1/s.width*2,n.d=o*(1/s.height*2),n.tx=-1-s.x*n.a,n.ty=-o-s.y*n.d}setTransform(t){}destroy(){this.renderer=null}}Dd.extension={type:K.RendererSystem,name:"projection"};rt.add(Dd);const Ly=new yl;class Fd{constructor(t){this.renderer=t,this._tempMatrix=new Nt}generateTexture(t,s){const{region:i,...r}=s||{},n=i||t.getLocalBounds(null,!0);n.width===0&&(n.width=1),n.height===0&&(n.height=1);const o=Rs.create({width:n.width,height:n.height,...r});this._tempMatrix.tx=-n.x,this._tempMatrix.ty=-n.y;const a=t.transform;return t.transform=Ly,this.renderer.render(t,{renderTexture:o,transform:this._tempMatrix,skipUpdateTransform:!!t.parent,blit:!0}),t.transform=a,o}destroy(){}}Fd.extension={type:[K.RendererSystem,K.CanvasRendererSystem],name:"textureGenerator"};rt.add(Fd);const Os=new yt,Wi=new yt;class Ld{constructor(t){this.renderer=t,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new yt,this.destinationFrame=new yt,this.viewportFrame=new yt}bind(t=null,s,i){const r=this.renderer;this.current=t;let n,o,a;t?(n=t.baseTexture,a=n.resolution,s||(Os.width=t.frame.width,Os.height=t.frame.height,s=Os),i||(Wi.x=t.frame.x,Wi.y=t.frame.y,Wi.width=s.width,Wi.height=s.height,i=Wi),o=n.framebuffer):(a=r.resolution,s||(Os.width=r._view.screen.width,Os.height=r._view.screen.height,s=Os),i||(i=Os,i.width=s.width,i.height=s.height));const l=this.viewportFrame;l.x=i.x*a,l.y=i.y*a,l.width=i.width*a,l.height=i.height*a,t||(l.y=r.view.height-(l.y+l.height)),l.ceil(),this.renderer.framebuffer.bind(o,l),this.renderer.projection.update(i,s,a,!o),t?this.renderer.mask.setMaskStack(n.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(s),this.destinationFrame.copyFrom(i)}clear(t,s){this.current?t=t||this.current.baseTexture.clearColor:t=t||this.renderer.background.colorRgba;const i=this.destinationFrame,r=this.current?this.current.baseTexture:this.renderer._view.screen,n=i.width!==r.width||i.height!==r.height;if(n){let{x:o,y:a,width:l,height:h}=this.viewportFrame;o=Math.round(o),a=Math.round(a),l=Math.round(l),h=Math.round(h),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(o,a,l,h)}this.renderer.framebuffer.clear(t[0],t[1],t[2],t[3],s),n&&this.renderer.scissor.pop()}resize(){this.bind(null)}reset(){this.bind(null)}destroy(){this.renderer=null}}Ld.extension={type:K.RendererSystem,name:"renderTexture"};rt.add(Ld);class Ny{constructor(t,s){this.program=t,this.uniformData=s,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null}}function Uy(e,t){const s={},i=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES);for(let r=0;r<i;r++){const n=t.getActiveAttrib(e,r);if(n.name.startsWith("gl_"))continue;const o=gd(t,n.type),a={type:o,name:n.name,size:md(o),location:t.getAttribLocation(e,n.name)};s[n.name]=a}return s}function ky(e,t){const s={},i=t.getProgramParameter(e,t.ACTIVE_UNIFORMS);for(let r=0;r<i;r++){const n=t.getActiveUniform(e,r),o=n.name.replace(/\[.*?\]$/,""),a=!!n.name.match(/\[.*?\]$/),l=gd(t,n.type);s[o]={name:o,index:r,type:l,size:n.size,isArray:a,value:fd(l,n.size)}}return s}function Gy(e,t){var l;const s=qh(e,e.VERTEX_SHADER,t.vertexSrc),i=qh(e,e.FRAGMENT_SHADER,t.fragmentSrc),r=e.createProgram();e.attachShader(r,s),e.attachShader(r,i);const n=(l=t.extra)==null?void 0:l.transformFeedbackVaryings;if(n&&(typeof e.transformFeedbackVaryings!="function"?console.warn("TransformFeedback is not supported but TransformFeedbackVaryings are given."):e.transformFeedbackVaryings(r,n.names,n.bufferMode==="separate"?e.SEPARATE_ATTRIBS:e.INTERLEAVED_ATTRIBS)),e.linkProgram(r),e.getProgramParameter(r,e.LINK_STATUS)||my(e,r,s,i),t.attributeData=Uy(r,e),t.uniformData=ky(r,e),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(t.vertexSrc)){const h=Object.keys(t.attributeData);h.sort((c,u)=>c>u?1:-1);for(let c=0;c<h.length;c++)t.attributeData[h[c]].location=c,e.bindAttribLocation(r,c,h[c]);e.linkProgram(r)}e.deleteShader(s),e.deleteShader(i);const o={};for(const h in t.uniformData){const c=t.uniformData[h];o[h]={location:e.getUniformLocation(r,h),value:fd(c.type,c.size)}}return new Ny(r,o)}function Hy(e,t,s,i,r){s.buffer.update(r)}const Wy={float:`
        data[offset] = v;
    `,vec2:`
        data[offset] = v[0];
        data[offset+1] = v[1];
    `,vec3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

    `,vec4:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];
        data[offset+3] = v[3];
    `,mat2:`
        data[offset] = v[0];
        data[offset+1] = v[1];

        data[offset+4] = v[2];
        data[offset+5] = v[3];
    `,mat3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];

        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];
    `,mat4:`
        for(var i = 0; i < 16; i++)
        {
            data[offset + i] = v[i];
        }
    `},Nd={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:16*2,mat3:16*3,mat4:16*4};function $y(e){const t=e.map(n=>({data:n,offset:0,dataLen:0,dirty:0}));let s=0,i=0,r=0;for(let n=0;n<t.length;n++){const o=t[n];if(s=Nd[o.data.type],o.data.size>1&&(s=Math.max(s,16)*o.data.size),o.dataLen=s,i%s!==0&&i<16){const a=i%s%16;i+=a,r+=a}i+s>16?(r=Math.ceil(r/16)*16,o.offset=r,r+=s,i=s):(o.offset=r,i+=s,r+=s)}return r=Math.ceil(r/16)*16,{uboElements:t,size:r}}function Xy(e,t){const s=[];for(const i in e)t[i]&&s.push(t[i]);return s.sort((i,r)=>i.index-r.index),s}function jy(e,t){if(!e.autoManage)return{size:0,syncFunc:Hy};const s=Xy(e.uniforms,t),{uboElements:i,size:r}=$y(s),n=[`
    var v = null;
    var v2 = null;
    var cv = null;
    var t = 0;
    var gl = renderer.gl
    var index = 0;
    var data = buffer.data;
    `];for(let o=0;o<i.length;o++){const a=i[o],l=e.uniforms[a.data.name],h=a.data.name;let c=!1;for(let u=0;u<bi.length;u++){const d=bi[u];if(d.codeUbo&&d.test(a.data,l)){n.push(`offset = ${a.offset/4};`,bi[u].codeUbo(a.data.name,l)),c=!0;break}}if(!c)if(a.data.size>1){const u=md(a.data.type),d=Math.max(Nd[a.data.type]/16,1),p=u/d,f=(4-p%4)%4;n.push(`
                cv = ud.${h}.value;
                v = uv.${h};
                offset = ${a.offset/4};

                t = 0;

                for(var i=0; i < ${a.data.size*d}; i++)
                {
                    for(var j = 0; j < ${p}; j++)
                    {
                        data[offset++] = v[t++];
                    }
                    offset += ${f};
                }

                `)}else{const u=Wy[a.data.type];n.push(`
                cv = ud.${h}.value;
                v = uv.${h};
                offset = ${a.offset/4};
                ${u};
                `)}}return n.push(`
       renderer.buffer.update(buffer);
    `),{size:r,syncFunc:new Function("ud","uv","renderer","syncData","buffer",n.join(`
`))}}let zy=0;const Hr={textureCount:0,uboCount:0};class Ud{constructor(t){this.destroyed=!1,this.renderer=t,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=zy++}systemCheck(){if(!_y())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")}contextChange(t){this.gl=t,this.reset()}bind(t,s){t.disposeRunner.add(this),t.uniforms.globals=this.renderer.globalUniforms;const i=t.program,r=i.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(t);return this.shader=t,this.program!==i&&(this.program=i,this.gl.useProgram(r.program)),s||(Hr.textureCount=0,Hr.uboCount=0,this.syncUniformGroup(t.uniformGroup,Hr)),r}setUniforms(t){const s=this.shader.program,i=s.glPrograms[this.renderer.CONTEXT_UID];s.syncUniforms(i.uniformData,t,this.renderer)}syncUniformGroup(t,s){const i=this.getGlProgram();(!t.static||t.dirtyId!==i.uniformDirtyGroups[t.id])&&(i.uniformDirtyGroups[t.id]=t.dirtyId,this.syncUniforms(t,i,s))}syncUniforms(t,s,i){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(s.uniformData,t.uniforms,this.renderer,i)}createSyncGroups(t){const s=this.getSignature(t,this.shader.program.uniformData,"u");return this.cache[s]||(this.cache[s]=dy(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[s],t.syncUniforms[this.shader.program.id]}syncUniformBufferGroup(t,s){const i=this.getGlProgram();if(!t.static||t.dirtyId!==0||!i.uniformGroups[t.id]){t.dirtyId=0;const r=i.uniformGroups[t.id]||this.createSyncBufferGroup(t,i,s);t.buffer.update(),r(i.uniformData,t.uniforms,this.renderer,Hr,t.buffer)}this.renderer.buffer.bindBufferBase(t.buffer,i.uniformBufferBindings[s])}createSyncBufferGroup(t,s,i){const{gl:r}=this.renderer;this.renderer.buffer.bind(t.buffer);const n=this.gl.getUniformBlockIndex(s.program,i);s.uniformBufferBindings[i]=this.shader.uniformBindCount,r.uniformBlockBinding(s.program,n,this.shader.uniformBindCount),this.shader.uniformBindCount++;const o=this.getSignature(t,this.shader.program.uniformData,"ubo");let a=this._uboCache[o];if(a||(a=this._uboCache[o]=jy(t,this.shader.program.uniformData)),t.autoManage){const l=new Float32Array(a.size/4);t.buffer.update(l)}return s.uniformGroups[t.id]=a.syncFunc,s.uniformGroups[t.id]}getSignature(t,s,i){const r=t.uniforms,n=[`${i}-`];for(const o in r)n.push(o),s[o]&&n.push(s[o].type);return n.join("-")}getGlProgram(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null}generateProgram(t){const s=this.gl,i=t.program,r=Gy(s,i);return i.glPrograms[this.renderer.CONTEXT_UID]=r,r}reset(){this.program=null,this.shader=null}disposeShader(t){this.shader===t&&(this.shader=null)}destroy(){this.renderer=null,this.destroyed=!0}}Ud.extension={type:K.RendererSystem,name:"shader"};rt.add(Ud);class kd{constructor(t){this.renderer=t}run(t){const s=this.renderer;s.emitWithCustomOptions(s.runners.init,t),t.hello&&console.log(`PixiJS 7.1.0 - ${s.rendererLogId} - https://pixijs.com`),s.resize(this.renderer.screen.width,this.renderer.screen.height)}destroy(){}}kd.extension={type:[K.RendererSystem,K.CanvasRendererSystem],name:"startup"};rt.add(kd);function Vy(e,t=[]){return t[ct.NORMAL]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ct.ADD]=[e.ONE,e.ONE],t[ct.MULTIPLY]=[e.DST_COLOR,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ct.SCREEN]=[e.ONE,e.ONE_MINUS_SRC_COLOR,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ct.OVERLAY]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ct.DARKEN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ct.LIGHTEN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ct.COLOR_DODGE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ct.COLOR_BURN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ct.HARD_LIGHT]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ct.SOFT_LIGHT]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ct.DIFFERENCE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ct.EXCLUSION]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ct.HUE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ct.SATURATION]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ct.COLOR]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ct.LUMINOSITY]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ct.NONE]=[0,0],t[ct.NORMAL_NPM]=[e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ct.ADD_NPM]=[e.SRC_ALPHA,e.ONE,e.ONE,e.ONE],t[ct.SCREEN_NPM]=[e.SRC_ALPHA,e.ONE_MINUS_SRC_COLOR,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ct.SRC_IN]=[e.DST_ALPHA,e.ZERO],t[ct.SRC_OUT]=[e.ONE_MINUS_DST_ALPHA,e.ZERO],t[ct.SRC_ATOP]=[e.DST_ALPHA,e.ONE_MINUS_SRC_ALPHA],t[ct.DST_OVER]=[e.ONE_MINUS_DST_ALPHA,e.ONE],t[ct.DST_IN]=[e.ZERO,e.SRC_ALPHA],t[ct.DST_OUT]=[e.ZERO,e.ONE_MINUS_SRC_ALPHA],t[ct.DST_ATOP]=[e.ONE_MINUS_DST_ALPHA,e.SRC_ALPHA],t[ct.XOR]=[e.ONE_MINUS_DST_ALPHA,e.ONE_MINUS_SRC_ALPHA],t[ct.SUBTRACT]=[e.ONE,e.ONE,e.ONE,e.ONE,e.FUNC_REVERSE_SUBTRACT,e.FUNC_ADD],t}const Yy=0,Ky=1,qy=2,Zy=3,Jy=4,Qy=5,Aa=class{constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=ct.NONE,this._blendEq=!1,this.map=[],this.map[Yy]=this.setBlend,this.map[Ky]=this.setOffset,this.map[qy]=this.setCullFace,this.map[Zy]=this.setDepthTest,this.map[Jy]=this.setFrontFace,this.map[Qy]=this.setDepthMask,this.checks=[],this.defaultState=new us,this.defaultState.blend=!0}contextChange(e){this.gl=e,this.blendModes=Vy(e),this.set(this.defaultState),this.reset()}set(e){if(e=e||this.defaultState,this.stateId!==e.data){let t=this.stateId^e.data,s=0;for(;t;)t&1&&this.map[s].call(this,!!(e.data&1<<s)),t=t>>1,s++;this.stateId=e.data}for(let t=0;t<this.checks.length;t++)this.checks[t](this,e)}forceState(e){e=e||this.defaultState;for(let t=0;t<this.map.length;t++)this.map[t].call(this,!!(e.data&1<<t));for(let t=0;t<this.checks.length;t++)this.checks[t](this,e);this.stateId=e.data}setBlend(e){this.updateCheck(Aa.checkBlendMode,e),this.gl[e?"enable":"disable"](this.gl.BLEND)}setOffset(e){this.updateCheck(Aa.checkPolygonOffset,e),this.gl[e?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(e){this.gl[e?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(e){this.gl.depthMask(e)}setCullFace(e){this.gl[e?"enable":"disable"](this.gl.CULL_FACE)}setFrontFace(e){this.gl.frontFace(this.gl[e?"CW":"CCW"])}setBlendMode(e){if(e===this.blendMode)return;this.blendMode=e;const t=this.blendModes[e],s=this.gl;t.length===2?s.blendFunc(t[0],t[1]):s.blendFuncSeparate(t[0],t[1],t[2],t[3]),t.length===6?(this._blendEq=!0,s.blendEquationSeparate(t[4],t[5])):this._blendEq&&(this._blendEq=!1,s.blendEquationSeparate(s.FUNC_ADD,s.FUNC_ADD))}setPolygonOffset(e,t){this.gl.polygonOffset(e,t)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)}updateCheck(e,t){const s=this.checks.indexOf(e);t&&s===-1?this.checks.push(e):!t&&s!==-1&&this.checks.splice(s,1)}static checkBlendMode(e,t){e.setBlendMode(t.blendMode)}static checkPolygonOffset(e,t){e.setPolygonOffset(1,t.polygonOffset)}destroy(){this.gl=null}};let Gd=Aa;Gd.extension={type:K.RendererSystem,name:"state"};rt.add(Gd);class tE extends Vs{constructor(){super(...arguments),this.runners={},this._systemsHash={}}setup(t){this.addRunners(...t.runners);const s=(t.priority??[]).filter(r=>t.systems[r]),i=[...s,...Object.keys(t.systems).filter(r=>!s.includes(r))];for(const r of i)this.addSystem(t.systems[r],r)}addRunners(...t){t.forEach(s=>{this.runners[s]=new Fe(s)})}addSystem(t,s){const i=new t(this);if(this[s])throw new Error(`Whoops! The name "${s}" is already in use`);this[s]=i,this._systemsHash[s]=i;for(const r in this.runners)this.runners[r].add(i);return this}emitWithCustomOptions(t,s){const i=Object.keys(this._systemsHash);t.items.forEach(r=>{const n=i.find(o=>this._systemsHash[o]===r);r[t.name](s[n])})}destroy(){Object.values(this.runners).forEach(t=>{t.destroy()}),this._systemsHash={}}}const rn=class{constructor(e){this.renderer=e,this.count=0,this.checkCount=0,this.maxIdle=rn.defaultMaxIdle,this.checkCountMax=rn.defaultCheckCountMax,this.mode=rn.defaultMode}postrender(){this.renderer.objectRenderer.renderingToScreen&&(this.count++,this.mode!==Vn.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){const e=this.renderer.texture,t=e.managedTextures;let s=!1;for(let i=0;i<t.length;i++){const r=t[i];!r.framebuffer&&this.count-r.touched>this.maxIdle&&(e.destroyTexture(r,!0),t[i]=null,s=!0)}if(s){let i=0;for(let r=0;r<t.length;r++)t[r]!==null&&(t[i++]=t[r]);t.length=i}}unload(e){const t=this.renderer.texture,s=e._texture;s&&!s.framebuffer&&t.destroyTexture(s);for(let i=e.children.length-1;i>=0;i--)this.unload(e.children[i])}destroy(){this.renderer=null}};let ve=rn;ve.defaultMode=Vn.AUTO;ve.defaultMaxIdle=60*60;ve.defaultCheckCountMax=60*10;ve.extension={type:K.RendererSystem,name:"textureGC"};rt.add(ve);class Mo{constructor(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=lt.UNSIGNED_BYTE,this.internalFormat=X.RGBA,this.samplerType=0}}function eE(e){let t;return"WebGL2RenderingContext"in globalThis&&e instanceof globalThis.WebGL2RenderingContext?t={[lt.UNSIGNED_BYTE]:{[X.RGBA]:e.RGBA8,[X.RGB]:e.RGB8,[X.RG]:e.RG8,[X.RED]:e.R8,[X.RGBA_INTEGER]:e.RGBA8UI,[X.RGB_INTEGER]:e.RGB8UI,[X.RG_INTEGER]:e.RG8UI,[X.RED_INTEGER]:e.R8UI,[X.ALPHA]:e.ALPHA,[X.LUMINANCE]:e.LUMINANCE,[X.LUMINANCE_ALPHA]:e.LUMINANCE_ALPHA},[lt.BYTE]:{[X.RGBA]:e.RGBA8_SNORM,[X.RGB]:e.RGB8_SNORM,[X.RG]:e.RG8_SNORM,[X.RED]:e.R8_SNORM,[X.RGBA_INTEGER]:e.RGBA8I,[X.RGB_INTEGER]:e.RGB8I,[X.RG_INTEGER]:e.RG8I,[X.RED_INTEGER]:e.R8I},[lt.UNSIGNED_SHORT]:{[X.RGBA_INTEGER]:e.RGBA16UI,[X.RGB_INTEGER]:e.RGB16UI,[X.RG_INTEGER]:e.RG16UI,[X.RED_INTEGER]:e.R16UI,[X.DEPTH_COMPONENT]:e.DEPTH_COMPONENT16},[lt.SHORT]:{[X.RGBA_INTEGER]:e.RGBA16I,[X.RGB_INTEGER]:e.RGB16I,[X.RG_INTEGER]:e.RG16I,[X.RED_INTEGER]:e.R16I},[lt.UNSIGNED_INT]:{[X.RGBA_INTEGER]:e.RGBA32UI,[X.RGB_INTEGER]:e.RGB32UI,[X.RG_INTEGER]:e.RG32UI,[X.RED_INTEGER]:e.R32UI,[X.DEPTH_COMPONENT]:e.DEPTH_COMPONENT24},[lt.INT]:{[X.RGBA_INTEGER]:e.RGBA32I,[X.RGB_INTEGER]:e.RGB32I,[X.RG_INTEGER]:e.RG32I,[X.RED_INTEGER]:e.R32I},[lt.FLOAT]:{[X.RGBA]:e.RGBA32F,[X.RGB]:e.RGB32F,[X.RG]:e.RG32F,[X.RED]:e.R32F,[X.DEPTH_COMPONENT]:e.DEPTH_COMPONENT32F},[lt.HALF_FLOAT]:{[X.RGBA]:e.RGBA16F,[X.RGB]:e.RGB16F,[X.RG]:e.RG16F,[X.RED]:e.R16F},[lt.UNSIGNED_SHORT_5_6_5]:{[X.RGB]:e.RGB565},[lt.UNSIGNED_SHORT_4_4_4_4]:{[X.RGBA]:e.RGBA4},[lt.UNSIGNED_SHORT_5_5_5_1]:{[X.RGBA]:e.RGB5_A1},[lt.UNSIGNED_INT_2_10_10_10_REV]:{[X.RGBA]:e.RGB10_A2,[X.RGBA_INTEGER]:e.RGB10_A2UI},[lt.UNSIGNED_INT_10F_11F_11F_REV]:{[X.RGB]:e.R11F_G11F_B10F},[lt.UNSIGNED_INT_5_9_9_9_REV]:{[X.RGB]:e.RGB9_E5},[lt.UNSIGNED_INT_24_8]:{[X.DEPTH_STENCIL]:e.DEPTH24_STENCIL8},[lt.FLOAT_32_UNSIGNED_INT_24_8_REV]:{[X.DEPTH_STENCIL]:e.DEPTH32F_STENCIL8}}:t={[lt.UNSIGNED_BYTE]:{[X.RGBA]:e.RGBA,[X.RGB]:e.RGB,[X.ALPHA]:e.ALPHA,[X.LUMINANCE]:e.LUMINANCE,[X.LUMINANCE_ALPHA]:e.LUMINANCE_ALPHA},[lt.UNSIGNED_SHORT_5_6_5]:{[X.RGB]:e.RGB},[lt.UNSIGNED_SHORT_4_4_4_4]:{[X.RGBA]:e.RGBA},[lt.UNSIGNED_SHORT_5_5_5_1]:{[X.RGBA]:e.RGBA}},t}class Hd{constructor(t){this.renderer=t,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new pt,this.hasIntegerTextures=!1}contextChange(){const t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=eE(t);const s=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=s;for(let r=0;r<s;r++)this.boundTextures[r]=null;this.emptyTextures={};const i=new Mo(t.createTexture());t.bindTexture(t.TEXTURE_2D,i.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=i,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new Mo(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(let r=0;r<6;r++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+r,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(let r=0;r<this.boundTextures.length;r++)this.bind(null,r)}bind(t,s=0){const{gl:i}=this;if(t=t==null?void 0:t.castToBaseTexture(),t!=null&&t.valid&&!t.parentTextureArray){t.touched=this.renderer.textureGC.count;const r=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.boundTextures[s]!==t&&(this.currentLocation!==s&&(this.currentLocation=s,i.activeTexture(i.TEXTURE0+s)),i.bindTexture(t.target,r.texture)),r.dirtyId!==t.dirtyId?(this.currentLocation!==s&&(this.currentLocation=s,i.activeTexture(i.TEXTURE0+s)),this.updateTexture(t)):r.dirtyStyleId!==t.dirtyStyleId&&this.updateTextureStyle(t),this.boundTextures[s]=t}else this.currentLocation!==s&&(this.currentLocation=s,i.activeTexture(i.TEXTURE0+s)),i.bindTexture(i.TEXTURE_2D,this.emptyTextures[i.TEXTURE_2D].texture),this.boundTextures[s]=null}reset(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(let t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture}unbind(t){const{gl:s,boundTextures:i}=this;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(let r=0;r<i.length;r++)i[r]===this.unknownTexture&&this.bind(null,r)}for(let r=0;r<i.length;r++)i[r]===t&&(this.currentLocation!==r&&(s.activeTexture(s.TEXTURE0+r),this.currentLocation=r),s.bindTexture(t.target,this.emptyTextures[t.target].texture),i[r]=null)}ensureSamplerType(t){const{boundTextures:s,hasIntegerTextures:i,CONTEXT_UID:r}=this;if(i)for(let n=t-1;n>=0;--n){const o=s[n];o&&o._glTextures[r].samplerType!==ua.FLOAT&&this.renderer.texture.unbind(o)}}initTexture(t){const s=new Mo(this.gl.createTexture());return s.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=s,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),s}initTextureType(t,s){var i;s.internalFormat=((i=this.internalFormats[t.type])==null?void 0:i[t.format])??t.format,this.webGLVersion===2&&t.type===lt.HALF_FLOAT?s.type=this.gl.HALF_FLOAT:s.type=t.type}updateTexture(t){var r;const s=t._glTextures[this.CONTEXT_UID];if(!s)return;const i=this.renderer;if(this.initTextureType(t,s),(r=t.resource)!=null&&r.upload(i,t,s))s.samplerType!==ua.FLOAT&&(this.hasIntegerTextures=!0);else{const n=t.realWidth,o=t.realHeight,a=i.gl;(s.width!==n||s.height!==o||s.dirtyId<0)&&(s.width=n,s.height=o,a.texImage2D(t.target,0,s.internalFormat,n,o,0,t.format,s.type,null))}t.dirtyStyleId!==s.dirtyStyleId&&this.updateTextureStyle(t),s.dirtyId=t.dirtyId}destroyTexture(t,s){const{gl:i}=this;if(t=t.castToBaseTexture(),t._glTextures[this.CONTEXT_UID]&&(this.unbind(t),i.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!s)){const r=this.managedTextures.indexOf(t);r!==-1&&yi(this.managedTextures,r,1)}}updateTextureStyle(t){var i;const s=t._glTextures[this.CONTEXT_UID];s&&((t.mipmap===Je.POW2||this.webGLVersion!==2)&&!t.isPowerOfTwo?s.mipmap=!1:s.mipmap=t.mipmap>=1,this.webGLVersion!==2&&!t.isPowerOfTwo?s.wrapMode=Ts.CLAMP:s.wrapMode=t.wrapMode,(i=t.resource)!=null&&i.style(this.renderer,t,s)||this.setStyle(t,s),s.dirtyStyleId=t.dirtyStyleId)}setStyle(t,s){const i=this.gl;if(s.mipmap&&t.mipmap!==Je.ON_MANUAL&&i.generateMipmap(t.target),i.texParameteri(t.target,i.TEXTURE_WRAP_S,s.wrapMode),i.texParameteri(t.target,i.TEXTURE_WRAP_T,s.wrapMode),s.mipmap){i.texParameteri(t.target,i.TEXTURE_MIN_FILTER,t.scaleMode===ns.LINEAR?i.LINEAR_MIPMAP_LINEAR:i.NEAREST_MIPMAP_NEAREST);const r=this.renderer.context.extensions.anisotropicFiltering;if(r&&t.anisotropicLevel>0&&t.scaleMode===ns.LINEAR){const n=Math.min(t.anisotropicLevel,i.getParameter(r.MAX_TEXTURE_MAX_ANISOTROPY_EXT));i.texParameterf(t.target,r.TEXTURE_MAX_ANISOTROPY_EXT,n)}}else i.texParameteri(t.target,i.TEXTURE_MIN_FILTER,t.scaleMode===ns.LINEAR?i.LINEAR:i.NEAREST);i.texParameteri(t.target,i.TEXTURE_MAG_FILTER,t.scaleMode===ns.LINEAR?i.LINEAR:i.NEAREST)}destroy(){this.renderer=null}}Hd.extension={type:K.RendererSystem,name:"texture"};rt.add(Hd);class Wd{constructor(t){this.renderer=t}contextChange(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(t){const{gl:s,CONTEXT_UID:i}=this,r=t._glTransformFeedbacks[i]||this.createGLTransformFeedback(t);s.bindTransformFeedback(s.TRANSFORM_FEEDBACK,r)}unbind(){const{gl:t}=this;t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,null)}beginTransformFeedback(t,s){const{gl:i,renderer:r}=this;s&&r.shader.bind(s),i.beginTransformFeedback(t)}endTransformFeedback(){const{gl:t}=this;t.endTransformFeedback()}createGLTransformFeedback(t){const{gl:s,renderer:i,CONTEXT_UID:r}=this,n=s.createTransformFeedback();t._glTransformFeedbacks[r]=n,s.bindTransformFeedback(s.TRANSFORM_FEEDBACK,n);for(let o=0;o<t.buffers.length;o++){const a=t.buffers[o];a&&(i.buffer.update(a),a._glBuffers[r].refCount++,s.bindBufferBase(s.TRANSFORM_FEEDBACK_BUFFER,o,a._glBuffers[r].buffer||null))}return s.bindTransformFeedback(s.TRANSFORM_FEEDBACK,null),t.disposeRunner.add(this),n}disposeTransformFeedback(t,s){const i=t._glTransformFeedbacks[this.CONTEXT_UID],r=this.gl;t.disposeRunner.remove(this);const n=this.renderer.buffer;if(n)for(let o=0;o<t.buffers.length;o++){const a=t.buffers[o];if(!a)continue;const l=a._glBuffers[this.CONTEXT_UID];l&&(l.refCount--,l.refCount===0&&!s&&n.dispose(a,s))}i&&(s||r.deleteTransformFeedback(i),delete t._glTransformFeedbacks[this.CONTEXT_UID])}destroy(){this.renderer=null}}Wd.extension={type:K.RendererSystem,name:"transformFeedback"};rt.add(Wd);class $d{constructor(t){this.renderer=t}init(t){this.screen=new yt(0,0,t.width,t.height),this.element=t.view||q.ADAPTER.createCanvas(),this.resolution=t.resolution||q.RESOLUTION,this.autoDensity=!!t.autoDensity}resizeView(t,s){this.element.width=Math.round(t*this.resolution),this.element.height=Math.round(s*this.resolution);const i=this.element.width/this.resolution,r=this.element.height/this.resolution;this.screen.width=i,this.screen.height=r,this.autoDensity&&(this.element.style.width=`${i}px`,this.element.style.height=`${r}px`),this.renderer.emit("resize",i,r),this.renderer.runners.resize.emit(this.screen.width,this.screen.height)}destroy(t){var s;t&&((s=this.element.parentNode)==null||s.removeChild(this.element)),this.renderer=null,this.element=null,this.screen=null}}$d.extension={type:[K.RendererSystem,K.CanvasRendererSystem],name:"_view"};rt.add($d);q.PREFER_ENV=ei.WEBGL2;q.STRICT_TEXTURE_CACHE=!1;Object.defineProperties(q,{WRAP_MODE:{get(){return pt.defaultOptions.wrapMode},set(e){Ct("7.1.0","settings.WRAP_MODE is deprecated, use BaseTeture.defaultOptions.wrapMode"),pt.defaultOptions.wrapMode=e}},SCALE_MODE:{get(){return pt.defaultOptions.scaleMode},set(e){Ct("7.1.0","settings.SCALE_MODE is deprecated, use BaseTeture.defaultOptions.scaleMode"),pt.defaultOptions.scaleMode=e}},MIPMAP_TEXTURES:{get(){return pt.defaultOptions.mipmap},set(e){Ct("7.1.0","settings.MIPMAP_TEXTURES is deprecated, use BaseTeture.defaultOptions.mipmap"),pt.defaultOptions.mipmap=e}},ANISOTROPIC_LEVEL:{get(){return pt.defaultOptions.anisotropicLevel},set(e){Ct("7.1.0","settings.ANISOTROPIC_LEVEL is deprecated, use BaseTeture.defaultOptions.anisotropicLevel"),pt.defaultOptions.anisotropicLevel=e}},FILTER_RESOLUTION:{get(){return Ct("7.1.0","settings.FILTER_RESOLUTION is deprecated, use Filter.defaultResolution"),ae.defaultResolution},set(e){ae.defaultResolution=e}},FILTER_MULTISAMPLE:{get(){return Ct("7.1.0","settings.FILTER_MULTISAMPLE is deprecated, use Filter.defaultMultisample"),ae.defaultMultisample},set(e){ae.defaultMultisample=e}},SPRITE_MAX_TEXTURES:{get(){return me.defaultMaxTextures},set(e){Ct("7.1.0","settings.SPRITE_MAX_TEXTURES is deprecated, use BatchRenderer.defaultMaxTextures"),me.defaultMaxTextures=e}},SPRITE_BATCH_SIZE:{get(){return me.defaultBatchSize},set(e){Ct("7.1.0","settings.SPRITE_BATCH_SIZE is deprecated, use BatchRenderer.defaultBatchSize"),me.defaultBatchSize=e}},CAN_UPLOAD_SAME_BUFFER:{get(){return me.canUploadSameBuffer},set(e){Ct("7.1.0","settings.CAN_UPLOAD_SAME_BUFFER is deprecated, use BatchRenderer.canUploadSameBuffer"),me.canUploadSameBuffer=e}},GC_MODE:{get(){return ve.defaultMode},set(e){Ct("7.1.0","settings.GC_MODE is deprecated, use TextureGCSystem.defaultMode"),ve.defaultMode=e}},GC_MAX_IDLE:{get(){return ve.defaultMaxIdle},set(e){Ct("7.1.0","settings.GC_MAX_IDLE is deprecated, use TextureGCSystem.defaultMaxIdle"),ve.defaultMaxIdle=e}},GC_MAX_CHECK_COUNT:{get(){return ve.defaultCheckCountMax},set(e){Ct("7.1.0","settings.GC_MAX_CHECK_COUNT is deprecated, use TextureGCSystem.defaultCheckCountMax"),ve.defaultCheckCountMax=e}},PRECISION_VERTEX:{get(){return Me.defaultVertexPrecision},set(e){Ct("7.1.0","settings.PRECISION_VERTEX is deprecated, use Program.defaultVertexPrecision"),Me.defaultVertexPrecision=e}},PRECISION_FRAGMENT:{get(){return Me.defaultFragmentPrecision},set(e){Ct("7.1.0","settings.PRECISION_FRAGMENT is deprecated, use Program.defaultFragmentPrecision"),Me.defaultFragmentPrecision=e}}});var qs=(e=>(e[e.HIGH=25]="HIGH",e[e.NORMAL=0]="NORMAL",e[e.LOW=-25]="LOW",e[e.UTILITY=-50]="UTILITY",e))(qs||{});class Oo{constructor(t,s=null,i=0,r=!1){this.next=null,this.previous=null,this._destroyed=!1,this.fn=t,this.context=s,this.priority=i,this.once=r}match(t,s=null){return this.fn===t&&this.context===s}emit(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));const s=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),s}connect(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this}destroy(t=!1){this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const s=this.next;return this.next=t?null:s,this.previous=null,s}}const de=class{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new Oo(null,null,1/0),this.deltaMS=1/de.targetFPMS,this.elapsedMS=1/de.targetFPMS,this._tick=e=>{this._requestId=null,this.started&&(this.update(e),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(e,t,s=qs.NORMAL){return this._addListener(new Oo(e,t,s))}addOnce(e,t,s=qs.NORMAL){return this._addListener(new Oo(e,t,s,!0))}_addListener(e){let t=this._head.next,s=this._head;if(!t)e.connect(s);else{for(;t;){if(e.priority>t.priority){e.connect(s);break}s=t,t=t.next}e.previous||e.connect(s)}return this._startIfPossible(),this}remove(e,t){let s=this._head.next;for(;s;)s.match(e,t)?s=s.destroy():s=s.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let e=0,t=this._head;for(;t=t.next;)e++;return e}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let e=this._head.next;for(;e;)e=e.destroy(!0);this._head.destroy(),this._head=null}}update(e=performance.now()){let t;if(e>this.lastTime){if(t=this.elapsedMS=e-this.lastTime,t>this._maxElapsedMS&&(t=this._maxElapsedMS),t*=this.speed,this._minElapsedMS){const r=e-this._lastFrame|0;if(r<this._minElapsedMS)return;this._lastFrame=e-r%this._minElapsedMS}this.deltaMS=t,this.deltaTime=this.deltaMS*de.targetFPMS;const s=this._head;let i=s.next;for(;i;)i=i.emit(this.deltaTime);s.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=e}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(e){const t=Math.min(this.maxFPS,e),s=Math.min(Math.max(0,t)/1e3,de.targetFPMS);this._maxElapsedMS=1/s}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(e){if(e===0)this._minElapsedMS=0;else{const t=Math.max(this.minFPS,e);this._minElapsedMS=1/(t/1e3)}}static get shared(){if(!de._shared){const e=de._shared=new de;e.autoStart=!0,e._protected=!0}return de._shared}static get system(){if(!de._system){const e=de._system=new de;e.autoStart=!0,e._protected=!0}return de._system}};let Zt=de;Zt.targetFPMS=.06;Object.defineProperties(q,{TARGET_FPMS:{get(){return Zt.targetFPMS},set(e){Ct("7.1.0","settings.TARGET_FPMS is deprecated, use Ticker.targetFPMS"),Zt.targetFPMS=e}}});class Xd{static init(t){t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set(s){this._ticker&&this._ticker.remove(this.render,this),this._ticker=s,s&&s.add(this.render,this,qs.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?Zt.shared:new Zt,t.autoStart&&this.start()}static destroy(){if(this._ticker){const t=this._ticker;this.ticker=null,t.destroy()}}}Xd.extension=K.Application;rt.add(Xd);const jd=[];rt.handleByList(K.Renderer,jd);function sE(e){for(const t of jd)if(t.test(e))return new t(e);throw new Error("Unable to auto-detect a suitable renderer.")}var iE=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,rE=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const nE=iE,zd=rE;class Vd{constructor(t){this.renderer=t}contextChange(t){let s;if(this.renderer.context.webGLVersion===1){const i=t.getParameter(t.FRAMEBUFFER_BINDING);t.bindFramebuffer(t.FRAMEBUFFER,null),s=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.FRAMEBUFFER,i)}else{const i=t.getParameter(t.DRAW_FRAMEBUFFER_BINDING);t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),s=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,i)}s>=Xt.HIGH?this.multisample=Xt.HIGH:s>=Xt.MEDIUM?this.multisample=Xt.MEDIUM:s>=Xt.LOW?this.multisample=Xt.LOW:this.multisample=Xt.NONE}destroy(){}}Vd.extension={type:K.RendererSystem,name:"_multisample"};rt.add(Vd);class oE{constructor(t){this.buffer=t||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}}class Yd{constructor(t){this.renderer=t,this.managedBuffers={},this.boundBufferBases={}}destroy(){this.renderer=null}contextChange(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(t){const{gl:s,CONTEXT_UID:i}=this,r=t._glBuffers[i]||this.createGLBuffer(t);s.bindBuffer(t.type,r.buffer)}unbind(t){const{gl:s}=this;s.bindBuffer(t,null)}bindBufferBase(t,s){const{gl:i,CONTEXT_UID:r}=this;if(this.boundBufferBases[s]!==t){const n=t._glBuffers[r]||this.createGLBuffer(t);this.boundBufferBases[s]=t,i.bindBufferBase(i.UNIFORM_BUFFER,s,n.buffer)}}bindBufferRange(t,s,i){const{gl:r,CONTEXT_UID:n}=this;i=i||0;const o=t._glBuffers[n]||this.createGLBuffer(t);r.bindBufferRange(r.UNIFORM_BUFFER,s||0,o.buffer,i*256,256)}update(t){const{gl:s,CONTEXT_UID:i}=this,r=t._glBuffers[i]||this.createGLBuffer(t);if(t._updateID!==r.updateID)if(r.updateID=t._updateID,s.bindBuffer(t.type,r.buffer),r.byteLength>=t.data.byteLength)s.bufferSubData(t.type,0,t.data);else{const n=t.static?s.STATIC_DRAW:s.DYNAMIC_DRAW;r.byteLength=t.data.byteLength,s.bufferData(t.type,t.data,n)}}dispose(t,s){if(!this.managedBuffers[t.id])return;delete this.managedBuffers[t.id];const i=t._glBuffers[this.CONTEXT_UID],r=this.gl;t.disposeRunner.remove(this),i&&(s||r.deleteBuffer(i.buffer),delete t._glBuffers[this.CONTEXT_UID])}disposeAll(t){const s=Object.keys(this.managedBuffers);for(let i=0;i<s.length;i++)this.dispose(this.managedBuffers[s[i]],t)}createGLBuffer(t){const{CONTEXT_UID:s,gl:i}=this;return t._glBuffers[s]=new oE(i.createBuffer()),this.managedBuffers[t.id]=t,t.disposeRunner.add(this),t._glBuffers[s]}}Yd.extension={type:K.RendererSystem,name:"buffer"};rt.add(Yd);class Kd{constructor(t){this.renderer=t}render(t,s){const i=this.renderer;let r,n,o,a;if(s&&(r=s.renderTexture,n=s.clear,o=s.transform,a=s.skipUpdateTransform),this.renderingToScreen=!r,i.runners.prerender.emit(),i.emit("prerender"),i.projection.transform=o,!i.context.isLost){if(r||(this.lastObjectRendered=t),!a){const l=t.enableTempParent();t.updateTransform(),t.disableTempParent(l)}i.renderTexture.bind(r),i.batch.currentRenderer.start(),(n??i.background.clearBeforeRender)&&i.renderTexture.clear(),t.render(i),i.batch.currentRenderer.flush(),r&&(s.blit&&i.framebuffer.blit(),r.baseTexture.update()),i.runners.postrender.emit(),i.projection.transform=null,i.emit("postrender")}}destroy(){this.renderer=null,this.lastObjectRendered=null}}Kd.extension={type:K.RendererSystem,name:"objectRenderer"};rt.add(Kd);const Ca=class extends tE{constructor(e){super(),e=Object.assign({},q.RENDER_OPTIONS,e),this.gl=null,this.CONTEXT_UID=0,this.globalUniforms=new Le({projectionMatrix:new Nt},!0);const t={runners:["init","destroy","contextChange","resolutionChange","reset","update","postrender","prerender","resize"],systems:Ca.__systems,priority:["_view","textureGenerator","background","_plugin","startup","context","state","texture","buffer","geometry","framebuffer","transformFeedback","mask","scissor","stencil","projection","textureGC","filter","renderTexture","batch","objectRenderer","_multisample"]};this.setup(t),"useContextAlpha"in e&&(Ct("7.0.0","options.useContextAlpha is deprecated, use options.premultipliedAlpha and options.backgroundAlpha instead"),e.premultipliedAlpha=e.useContextAlpha&&e.useContextAlpha!=="notMultiplied",e.backgroundAlpha=e.useContextAlpha===!1?1:e.backgroundAlpha);const s={hello:e.hello,_plugin:Ca.__plugins,background:{alpha:e.backgroundAlpha,color:e.background??e.backgroundColor,clearBeforeRender:e.clearBeforeRender},_view:{height:e.height,width:e.width,autoDensity:e.autoDensity,resolution:e.resolution,view:e.view},context:{antialias:e.antialias,context:e.context,powerPreference:e.powerPreference,premultipliedAlpha:e.premultipliedAlpha,preserveDrawingBuffer:e.preserveDrawingBuffer}};this.startup.run(s),this.options=e}static test(e){return e!=null&&e.forceCanvas?!1:ex()}render(e,t){this.objectRenderer.render(e,t)}resize(e,t){this._view.resizeView(e,t)}reset(){return this.runners.reset.emit(),this}clear(){this.renderTexture.bind(),this.renderTexture.clear()}destroy(e=!1){this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:e}),super.destroy()}get plugins(){return this._plugin.plugins}get multisample(){return this._multisample.multisample}get width(){return this._view.element.width}get height(){return this._view.element.height}get resolution(){return this._view.resolution}set resolution(e){this._view.resolution=e,this.runners.resolutionChange.emit(e)}get autoDensity(){return this._view.autoDensity}get view(){return this._view.element}get screen(){return this._view.screen}get lastObjectRendered(){return this.objectRenderer.lastObjectRendered}get renderingToScreen(){return this.objectRenderer.renderingToScreen}get rendererLogId(){return`WebGL ${this.context.webGLVersion}`}get clearBeforeRender(){return Ct("7.0.0","renderer.clearBeforeRender has been deprecated, please use renderer.background.clearBeforeRender instead."),this.background.clearBeforeRender}get useContextAlpha(){return Ct("7.0.0","renderer.useContextAlpha has been deprecated, please use renderer.context.premultipliedAlpha instead."),this.context.useContextAlpha}get preserveDrawingBuffer(){return Ct("7.0.0","renderer.preserveDrawingBuffer has been deprecated, we cannot truly know this unless pixi created the context"),this.context.preserveDrawingBuffer}get backgroundColor(){return Ct("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color}set backgroundColor(e){Ct("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color=e}get backgroundAlpha(){return Ct("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.color}set backgroundAlpha(e){Ct("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha=e}get powerPreference(){return Ct("7.0.0","renderer.powerPreference has been deprecated, we can only know this if pixi creates the context"),this.context.powerPreference}generateTexture(e,t){return this.textureGenerator.generateTexture(e,t)}};let Di=Ca;Di.extension={type:K.Renderer,priority:1};Di.__plugins={};Di.__systems={};rt.handleByMap(K.RendererPlugin,Di.__plugins);rt.handleByMap(K.RendererSystem,Di.__systems);rt.add(Di);class qd extends pr{constructor(t,s){const{width:i,height:r}=s||{};super(i,r),this.items=[],this.itemDirtyIds=[];for(let n=0;n<t;n++){const o=new pt;this.items.push(o),this.itemDirtyIds.push(-2)}this.length=t,this._load=null,this.baseTexture=null}initFromArray(t,s){for(let i=0;i<this.length;i++)t[i]&&(t[i].castToBaseTexture?this.addBaseTextureAt(t[i].castToBaseTexture(),i):t[i]instanceof pr?this.addResourceAt(t[i],i):this.addResourceAt(hd(t[i],s),i))}dispose(){for(let t=0,s=this.length;t<s;t++)this.items[t].destroy();this.items=null,this.itemDirtyIds=null,this._load=null}addResourceAt(t,s){if(!this.items[s])throw new Error(`Index ${s} is out of bounds`);return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[s].setResource(t),this}bind(t){if(this.baseTexture!==null)throw new Error("Only one base texture per TextureArray is allowed");super.bind(t);for(let s=0;s<this.length;s++)this.items[s].parentTextureArray=t,this.items[s].on("update",t.update,t)}unbind(t){super.unbind(t);for(let s=0;s<this.length;s++)this.items[s].parentTextureArray=null,this.items[s].off("update",t.update,t)}load(){if(this._load)return this._load;const s=this.items.map(i=>i.resource).filter(i=>i).map(i=>i.load());return this._load=Promise.all(s).then(()=>{const{realWidth:i,realHeight:r}=this.items[0];return this.resize(i,r),Promise.resolve(this)}),this._load}}class aE extends qd{constructor(t,s){const{width:i,height:r}=s||{};let n,o;Array.isArray(t)?(n=t,o=t.length):o=t,super(o,{width:i,height:r}),n&&this.initFromArray(n,s)}addBaseTextureAt(t,s){if(t.resource)this.addResourceAt(t.resource,s);else throw new Error("ArrayResource does not support RenderTexture");return this}bind(t){super.bind(t),t.target=xi.TEXTURE_2D_ARRAY}upload(t,s,i){const{length:r,itemDirtyIds:n,items:o}=this,{gl:a}=t;i.dirtyId<0&&a.texImage3D(a.TEXTURE_2D_ARRAY,0,i.internalFormat,this._width,this._height,r,0,s.format,i.type,null);for(let l=0;l<r;l++){const h=o[l];n[l]<h.dirtyId&&(n[l]=h.dirtyId,h.valid&&a.texSubImage3D(a.TEXTURE_2D_ARRAY,0,0,0,l,h.resource.width,h.resource.height,1,s.format,i.type,h.resource.source))}return!0}}class lE extends Is{constructor(t){super(t)}static test(t){const{OffscreenCanvas:s}=globalThis;return s&&t instanceof s?!0:globalThis.HTMLCanvasElement&&t instanceof HTMLCanvasElement}}const Yi=class extends qd{constructor(e,t){const{width:s,height:i,autoLoad:r,linkBaseTexture:n}=t||{};if(e&&e.length!==Yi.SIDES)throw new Error(`Invalid length. Got ${e.length}, expected 6`);super(6,{width:s,height:i});for(let o=0;o<Yi.SIDES;o++)this.items[o].target=xi.TEXTURE_CUBE_MAP_POSITIVE_X+o;this.linkBaseTexture=n!==!1,e&&this.initFromArray(e,t),r!==!1&&this.load()}bind(e){super.bind(e),e.target=xi.TEXTURE_CUBE_MAP}addBaseTextureAt(e,t,s){if(s===void 0&&(s=this.linkBaseTexture),!this.items[t])throw new Error(`Index ${t} is out of bounds`);if(!this.linkBaseTexture||e.parentTextureArray||Object.keys(e._glTextures).length>0)if(e.resource)this.addResourceAt(e.resource,t);else throw new Error("CubeResource does not support copying of renderTexture.");else e.target=xi.TEXTURE_CUBE_MAP_POSITIVE_X+t,e.parentTextureArray=this.baseTexture,this.items[t]=e;return e.valid&&!this.valid&&this.resize(e.realWidth,e.realHeight),this.items[t]=e,this}upload(e,t,s){const i=this.itemDirtyIds;for(let r=0;r<Yi.SIDES;r++){const n=this.items[r];(i[r]<n.dirtyId||s.dirtyId<t.dirtyId)&&(n.valid&&n.resource?(n.resource.upload(e,n,s),i[r]=n.dirtyId):i[r]<-1&&(e.gl.texImage2D(n.target,0,s.internalFormat,t.realWidth,t.realHeight,0,t.format,s.type,null),i[r]=-1))}return!0}static test(e){return Array.isArray(e)&&e.length===Yi.SIDES}};let Zd=Yi;Zd.SIDES=6;class fi extends Is{constructor(t,s){var i=(...r)=>{super(...r)};s=s||{},typeof t=="string"?(i(fi.EMPTY),this.url=t):(i(t),this.url=null),this.crossOrigin=s.crossOrigin??!0,this.alphaMode=typeof s.alphaMode=="number"?s.alphaMode:null,this._load=null,s.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(async(t,s)=>{if(this.url===null){t(this);return}try{const i=await q.ADAPTER.fetch(this.url,{mode:this.crossOrigin?"cors":"no-cors"});if(this.destroyed)return;const r=await i.blob();if(this.destroyed)return;const n=await createImageBitmap(r,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===Ne.UNPACK?"premultiply":"none"});if(this.destroyed)return;this.source=n,this.update(),t(this)}catch(i){if(this.destroyed)return;s(i),this.onError.emit(i)}}),this._load)}upload(t,s,i){return this.source instanceof ImageBitmap?(typeof this.alphaMode=="number"&&(s.alphaMode=this.alphaMode),super.upload(t,s,i)):(this.load(),!1)}dispose(){this.source instanceof ImageBitmap&&this.source.close(),super.dispose(),this._load=null}static test(t){return!!globalThis.createImageBitmap&&typeof ImageBitmap<"u"&&(typeof t=="string"||t instanceof ImageBitmap)}static get EMPTY(){return fi._EMPTY=fi._EMPTY??q.ADAPTER.createCanvas(0,0),fi._EMPTY}}const nn=class extends Is{constructor(e,t){t=t||{},super(q.ADAPTER.createCanvas()),this._width=0,this._height=0,this.svg=e,this.scale=t.scale||1,this._overrideWidth=t.width,this._overrideHeight=t.height,this._resolve=null,this._crossorigin=t.crossorigin,this._load=null,t.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(e=>{if(this._resolve=()=>{this.resize(this.source.width,this.source.height),e(this)},nn.SVG_XML.test(this.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");this.svg=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(this.svg)))}`}this._loadSvg()}),this._load)}_loadSvg(){const e=new Image;Is.crossOrigin(e,this.svg,this._crossorigin),e.src=this.svg,e.onerror=t=>{this._resolve&&(e.onerror=null,this.onError.emit(t))},e.onload=()=>{if(!this._resolve)return;const t=e.width,s=e.height;if(!t||!s)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");let i=t*this.scale,r=s*this.scale;(this._overrideWidth||this._overrideHeight)&&(i=this._overrideWidth||this._overrideHeight/s*t,r=this._overrideHeight||this._overrideWidth/t*s),i=Math.round(i),r=Math.round(r);const n=this.source;n.width=i,n.height=r,n._pixiId=`canvas_${Ks()}`,n.getContext("2d").drawImage(e,0,0,t,s,0,0,i,r),this._resolve(),this._resolve=null}}static getSize(e){const t=nn.SVG_SIZE.exec(e),s={};return t&&(s[t[1]]=Math.round(parseFloat(t[3])),s[t[5]]=Math.round(parseFloat(t[7]))),s}dispose(){super.dispose(),this._resolve=null,this._crossorigin=null}static test(e,t){return t==="svg"||typeof e=="string"&&e.startsWith("data:image/svg+xml")||typeof e=="string"&&nn.SVG_XML.test(e)}};let mr=nn;mr.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m;mr.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;const Ia=class extends Is{constructor(e,t){if(t=t||{},!(e instanceof HTMLVideoElement)){const s=document.createElement("video");s.setAttribute("preload","auto"),s.setAttribute("webkit-playsinline",""),s.setAttribute("playsinline",""),typeof e=="string"&&(e=[e]);const i=e[0].src||e[0];Is.crossOrigin(s,i,t.crossorigin);for(let r=0;r<e.length;++r){const n=document.createElement("source");let{src:o,mime:a}=e[r];o=o||e[r];const l=o.split("?").shift().toLowerCase(),h=l.slice(l.lastIndexOf(".")+1);a=a||Ia.MIME_TYPES[h]||`video/${h}`,n.src=o,n.type=a,s.appendChild(n)}e=s}super(e),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=t.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=t.autoPlay!==!1,this._load=null,this._resolve=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),t.autoLoad!==!1&&this.load()}update(e=0){if(!this.destroyed){const t=Zt.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-t),(!this._updateFPS||this._msToNextUpdate<=0)&&(super.update(),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}}load(){if(this._load)return this._load;const e=this.source;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart.bind(this)),e.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlay),e.addEventListener("error",this._onError,!0)),this._load=new Promise(t=>{this.valid?t(this):(this._resolve=t,e.load())}),this._load}_onError(e){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(e)}_isSourcePlaying(){const e=this.source;return!e.paused&&!e.ended&&this._isSourceReady()}_isSourceReady(){return this.source.readyState>2}_onPlayStart(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(Zt.shared.add(this.update,this),this._isConnectedToTicker=!0)}_onPlayStop(){this._isConnectedToTicker&&(Zt.shared.remove(this.update,this),this._isConnectedToTicker=!1)}_onCanPlay(){const e=this.source;e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlay);const t=this.valid;this.resize(e.videoWidth,e.videoHeight),!t&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&e.play()}dispose(){this._isConnectedToTicker&&(Zt.shared.remove(this.update,this),this._isConnectedToTicker=!1);const e=this.source;e&&(e.removeEventListener("error",this._onError,!0),e.pause(),e.src="",e.load()),super.dispose()}get autoUpdate(){return this._autoUpdate}set autoUpdate(e){e!==this._autoUpdate&&(this._autoUpdate=e,!this._autoUpdate&&this._isConnectedToTicker?(Zt.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(Zt.shared.add(this.update,this),this._isConnectedToTicker=!0))}get updateFPS(){return this._updateFPS}set updateFPS(e){e!==this._updateFPS&&(this._updateFPS=e)}static test(e,t){return globalThis.HTMLVideoElement&&e instanceof HTMLVideoElement||Ia.TYPES.includes(t)}};let El=Ia;El.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"];El.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};Ea.push(fi,Ed,lE,El,mr,yr,Zd,aE);class wn{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}clear(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}getRectangle(t){return this.minX>this.maxX||this.minY>this.maxY?yt.EMPTY:(t=t||new yt(0,0,1,1),t.x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)}addPoint(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)}addPointMatrix(t,s){const{a:i,b:r,c:n,d:o,tx:a,ty:l}=t,h=i*s.x+n*s.y+a,c=r*s.x+o*s.y+l;this.minX=Math.min(this.minX,h),this.maxX=Math.max(this.maxX,h),this.minY=Math.min(this.minY,c),this.maxY=Math.max(this.maxY,c)}addQuad(t){let s=this.minX,i=this.minY,r=this.maxX,n=this.maxY,o=t[0],a=t[1];s=o<s?o:s,i=a<i?a:i,r=o>r?o:r,n=a>n?a:n,o=t[2],a=t[3],s=o<s?o:s,i=a<i?a:i,r=o>r?o:r,n=a>n?a:n,o=t[4],a=t[5],s=o<s?o:s,i=a<i?a:i,r=o>r?o:r,n=a>n?a:n,o=t[6],a=t[7],s=o<s?o:s,i=a<i?a:i,r=o>r?o:r,n=a>n?a:n,this.minX=s,this.minY=i,this.maxX=r,this.maxY=n}addFrame(t,s,i,r,n){this.addFrameMatrix(t.worldTransform,s,i,r,n)}addFrameMatrix(t,s,i,r,n){const o=t.a,a=t.b,l=t.c,h=t.d,c=t.tx,u=t.ty;let d=this.minX,p=this.minY,f=this.maxX,m=this.maxY,_=o*s+l*i+c,v=a*s+h*i+u;d=_<d?_:d,p=v<p?v:p,f=_>f?_:f,m=v>m?v:m,_=o*r+l*i+c,v=a*r+h*i+u,d=_<d?_:d,p=v<p?v:p,f=_>f?_:f,m=v>m?v:m,_=o*s+l*n+c,v=a*s+h*n+u,d=_<d?_:d,p=v<p?v:p,f=_>f?_:f,m=v>m?v:m,_=o*r+l*n+c,v=a*r+h*n+u,d=_<d?_:d,p=v<p?v:p,f=_>f?_:f,m=v>m?v:m,this.minX=d,this.minY=p,this.maxX=f,this.maxY=m}addVertexData(t,s,i){let r=this.minX,n=this.minY,o=this.maxX,a=this.maxY;for(let l=s;l<i;l+=2){const h=t[l],c=t[l+1];r=h<r?h:r,n=c<n?c:n,o=h>o?h:o,a=c>a?c:a}this.minX=r,this.minY=n,this.maxX=o,this.maxY=a}addVertices(t,s,i,r){this.addVerticesMatrix(t.worldTransform,s,i,r)}addVerticesMatrix(t,s,i,r,n=0,o=n){const a=t.a,l=t.b,h=t.c,c=t.d,u=t.tx,d=t.ty;let p=this.minX,f=this.minY,m=this.maxX,_=this.maxY;for(let v=i;v<r;v+=2){const T=s[v],g=s[v+1],b=a*T+h*g+u,S=c*g+l*T+d;p=Math.min(p,b-n),m=Math.max(m,b+n),f=Math.min(f,S-o),_=Math.max(_,S+o)}this.minX=p,this.minY=f,this.maxX=m,this.maxY=_}addBounds(t){const s=this.minX,i=this.minY,r=this.maxX,n=this.maxY;this.minX=t.minX<s?t.minX:s,this.minY=t.minY<i?t.minY:i,this.maxX=t.maxX>r?t.maxX:r,this.maxY=t.maxY>n?t.maxY:n}addBoundsMask(t,s){const i=t.minX>s.minX?t.minX:s.minX,r=t.minY>s.minY?t.minY:s.minY,n=t.maxX<s.maxX?t.maxX:s.maxX,o=t.maxY<s.maxY?t.maxY:s.maxY;if(i<=n&&r<=o){const a=this.minX,l=this.minY,h=this.maxX,c=this.maxY;this.minX=i<a?i:a,this.minY=r<l?r:l,this.maxX=n>h?n:h,this.maxY=o>c?o:c}}addBoundsMatrix(t,s){this.addFrameMatrix(s,t.minX,t.minY,t.maxX,t.maxY)}addBoundsArea(t,s){const i=t.minX>s.x?t.minX:s.x,r=t.minY>s.y?t.minY:s.y,n=t.maxX<s.x+s.width?t.maxX:s.x+s.width,o=t.maxY<s.y+s.height?t.maxY:s.y+s.height;if(i<=n&&r<=o){const a=this.minX,l=this.minY,h=this.maxX,c=this.maxY;this.minX=i<a?i:a,this.minY=r<l?r:l,this.maxX=n>h?n:h,this.maxY=o>c?o:c}}pad(t=0,s=t){this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=s,this.maxY+=s)}addFramePad(t,s,i,r,n,o){t-=n,s-=o,i+=n,r+=o,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>i?this.maxX:i,this.minY=this.minY<s?this.minY:s,this.maxY=this.maxY>r?this.maxY:r}}class Wt extends Vs{constructor(){super(),this.tempDisplayObjectParent=null,this.transform=new yl,this.alpha=1,this.visible=!0,this.renderable=!0,this.cullable=!1,this.cullArea=null,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new wn,this._localBounds=null,this._boundsID=0,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._maskRefCount=0,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}static mixin(t){const s=Object.keys(t);for(let i=0;i<s.length;++i){const r=s[i];Object.defineProperty(Wt.prototype,r,Object.getOwnPropertyDescriptor(t,r))}}get destroyed(){return this._destroyed}_recursivePostUpdateTransform(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)}updateTransform(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha}getBounds(t,s){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),s||(this._boundsRect||(this._boundsRect=new yt),s=this._boundsRect),this._bounds.getRectangle(s)}getLocalBounds(t){t||(this._localBoundsRect||(this._localBoundsRect=new yt),t=this._localBoundsRect),this._localBounds||(this._localBounds=new wn);const s=this.transform,i=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform;const r=this._bounds,n=this._boundsID;this._bounds=this._localBounds;const o=this.getBounds(!1,t);return this.parent=i,this.transform=s,this._bounds=r,this._bounds.updateID+=this._boundsID-n,o}toGlobal(t,s,i=!1){return i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,s)}toLocal(t,s,i,r){return s&&(t=s.toGlobal(t,i,r)),r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,i)}setParent(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t}removeFromParent(){var t;(t=this.parent)==null||t.removeChild(this)}setTransform(t=0,s=0,i=1,r=1,n=0,o=0,a=0,l=0,h=0){return this.position.x=t,this.position.y=s,this.scale.x=i||1,this.scale.y=r||1,this.rotation=n,this.skew.x=o,this.skew.y=a,this.pivot.x=l,this.pivot.y=h,this}destroy(t){this.removeFromParent(),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()}get _tempDisplayObjectParent(){return this.tempDisplayObjectParent===null&&(this.tempDisplayObjectParent=new hE),this.tempDisplayObjectParent}enableTempParent(){const t=this.parent;return this.parent=this._tempDisplayObjectParent,t}disableTempParent(t){this.parent=t}get x(){return this.position.x}set x(t){this.transform.position.x=t}get y(){return this.position.y}set y(t){this.transform.position.y=t}get worldTransform(){return this.transform.worldTransform}get localTransform(){return this.transform.localTransform}get position(){return this.transform.position}set position(t){this.transform.position.copyFrom(t)}get scale(){return this.transform.scale}set scale(t){this.transform.scale.copyFrom(t)}get pivot(){return this.transform.pivot}set pivot(t){this.transform.pivot.copyFrom(t)}get skew(){return this.transform.skew}set skew(t){this.transform.skew.copyFrom(t)}get rotation(){return this.transform.rotation}set rotation(t){this.transform.rotation=t}get angle(){return this.transform.rotation*ny}set angle(t){this.transform.rotation=t*oy}get zIndex(){return this._zIndex}set zIndex(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)}get worldVisible(){let t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0}get mask(){return this._mask}set mask(t){if(this._mask!==t){if(this._mask){const s=this._mask.isMaskData?this._mask.maskObject:this._mask;s&&(s._maskRefCount--,s._maskRefCount===0&&(s.renderable=!0,s.isMask=!1))}if(this._mask=t,this._mask){const s=this._mask.isMaskData?this._mask.maskObject:this._mask;s&&(s._maskRefCount===0&&(s.renderable=!1,s.isMask=!0),s._maskRefCount++)}}}}class hE extends Wt{constructor(){super(...arguments),this.sortDirty=null}}Wt.prototype.displayObjectUpdateTransform=Wt.prototype.updateTransform;const cE=new Nt;function uE(e,t){return e.zIndex===t.zIndex?e._lastSortedIndex-t._lastSortedIndex:e.zIndex-t.zIndex}const Ra=class extends Wt{constructor(){super(),this.children=[],this.sortableChildren=Ra.defaultSortableChildren,this.sortDirty=!1}onChildrenChange(e){}addChild(...e){if(e.length>1)for(let t=0;t<e.length;t++)this.addChild(e[t]);else{const t=e[0];t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.push(t),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this)}return e[0]}addChildAt(e,t){if(t<0||t>this.children.length)throw new Error(`${e}addChildAt: The index ${t} supplied is out of bounds ${this.children.length}`);return e.parent&&e.parent.removeChild(e),e.parent=this,this.sortDirty=!0,e.transform._parentID=-1,this.children.splice(t,0,e),this._boundsID++,this.onChildrenChange(t),e.emit("added",this),this.emit("childAdded",e,this,t),e}swapChildren(e,t){if(e===t)return;const s=this.getChildIndex(e),i=this.getChildIndex(t);this.children[s]=t,this.children[i]=e,this.onChildrenChange(s<i?s:i)}getChildIndex(e){const t=this.children.indexOf(e);if(t===-1)throw new Error("The supplied DisplayObject must be a child of the caller");return t}setChildIndex(e,t){if(t<0||t>=this.children.length)throw new Error(`The index ${t} supplied is out of bounds ${this.children.length}`);const s=this.getChildIndex(e);yi(this.children,s,1),this.children.splice(t,0,e),this.onChildrenChange(t)}getChildAt(e){if(e<0||e>=this.children.length)throw new Error(`getChildAt: Index (${e}) does not exist.`);return this.children[e]}removeChild(...e){if(e.length>1)for(let t=0;t<e.length;t++)this.removeChild(e[t]);else{const t=e[0],s=this.children.indexOf(t);if(s===-1)return null;t.parent=null,t.transform._parentID=-1,yi(this.children,s,1),this._boundsID++,this.onChildrenChange(s),t.emit("removed",this),this.emit("childRemoved",t,this,s)}return e[0]}removeChildAt(e){const t=this.getChildAt(e);return t.parent=null,t.transform._parentID=-1,yi(this.children,e,1),this._boundsID++,this.onChildrenChange(e),t.emit("removed",this),this.emit("childRemoved",t,this,e),t}removeChildren(e=0,t=this.children.length){const s=e,i=t,r=i-s;let n;if(r>0&&r<=i){n=this.children.splice(s,r);for(let o=0;o<n.length;++o)n[o].parent=null,n[o].transform&&(n[o].transform._parentID=-1);this._boundsID++,this.onChildrenChange(e);for(let o=0;o<n.length;++o)n[o].emit("removed",this),this.emit("childRemoved",n[o],this,o);return n}else if(r===0&&this.children.length===0)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")}sortChildren(){let e=!1;for(let t=0,s=this.children.length;t<s;++t){const i=this.children[t];i._lastSortedIndex=t,!e&&i.zIndex!==0&&(e=!0)}e&&this.children.length>1&&this.children.sort(uE),this.sortDirty=!1}updateTransform(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(let e=0,t=this.children.length;e<t;++e){const s=this.children[e];s.visible&&s.updateTransform()}}calculateBounds(){this._bounds.clear(),this._calculateBounds();for(let e=0;e<this.children.length;e++){const t=this.children[e];if(!(!t.visible||!t.renderable))if(t.calculateBounds(),t._mask){const s=t._mask.isMaskData?t._mask.maskObject:t._mask;s?(s.calculateBounds(),this._bounds.addBoundsMask(t._bounds,s._bounds)):this._bounds.addBounds(t._bounds)}else t.filterArea?this._bounds.addBoundsArea(t._bounds,t.filterArea):this._bounds.addBounds(t._bounds)}this._bounds.updateID=this._boundsID}getLocalBounds(e,t=!1){const s=super.getLocalBounds(e);if(!t)for(let i=0,r=this.children.length;i<r;++i){const n=this.children[i];n.visible&&n.updateTransform()}return s}_calculateBounds(){}_renderWithCulling(e){const t=e.renderTexture.sourceFrame;if(!(t.width>0&&t.height>0))return;let s,i;this.cullArea?(s=this.cullArea,i=this.worldTransform):this._render!==Ra.prototype._render&&(s=this.getBounds(!0));const r=e.projection.transform;if(r&&(i?(i=cE.copyFrom(i),i.prepend(r)):i=r),s&&t.intersects(s,i))this._render(e);else if(this.cullArea)return;for(let n=0,o=this.children.length;n<o;++n){const a=this.children[n],l=a.cullable;a.cullable=l||!this.cullArea,a.render(e),a.cullable=l}}render(e){var t;if(!(!this.visible||this.worldAlpha<=0||!this.renderable))if(this._mask||(t=this.filters)!=null&&t.length)this.renderAdvanced(e);else if(this.cullable)this._renderWithCulling(e);else{this._render(e);for(let s=0,i=this.children.length;s<i;++s)this.children[s].render(e)}}renderAdvanced(e){var r,n,o;const t=this.filters,s=this._mask;if(t){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(let a=0;a<t.length;a++)t[a].enabled&&this._enabledFilters.push(t[a])}const i=t&&((r=this._enabledFilters)==null?void 0:r.length)||s&&(!s.isMaskData||s.enabled&&(s.autoDetect||s.type!==Vt.NONE));if(i&&e.batch.flush(),t&&((n=this._enabledFilters)!=null&&n.length)&&e.filter.push(this,this._enabledFilters),s&&e.mask.push(this,this._mask),this.cullable)this._renderWithCulling(e);else{this._render(e);for(let a=0,l=this.children.length;a<l;++a)this.children[a].render(e)}i&&e.batch.flush(),s&&e.mask.pop(this),t&&((o=this._enabledFilters)!=null&&o.length)&&e.filter.pop()}_render(e){}destroy(e){super.destroy(),this.sortDirty=!1;const t=typeof e=="boolean"?e:e==null?void 0:e.children,s=this.removeChildren(0,this.children.length);if(t)for(let i=0;i<s.length;++i)s[i].destroy(e)}get width(){return this.scale.x*this.getLocalBounds().width}set width(e){const t=this.getLocalBounds().width;t!==0?this.scale.x=e/t:this.scale.x=1,this._width=e}get height(){return this.scale.y*this.getLocalBounds().height}set height(e){const t=this.getLocalBounds().height;t!==0?this.scale.y=e/t:this.scale.y=1,this._height=e}};let ce=Ra;ce.defaultSortableChildren=!1;ce.prototype.containerUpdateTransform=ce.prototype.updateTransform;Object.defineProperties(q,{SORTABLE_CHILDREN:{get(){return ce.defaultSortableChildren},set(e){Ct("7.1.0","settings.SORTABLE_CHILDREN is deprecated, use Container.defaultSortableChildren"),ce.defaultSortableChildren=e}}});const $i=new Tt,dE=new Uint16Array([0,1,2,0,2,3]);class Fi extends ce{constructor(t){super(),this._anchor=new vs(this._onAnchorUpdate,this,t?t.defaultAnchor.x:0,t?t.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tint=null,this._tintRGB=null,this.tint=16777215,this.blendMode=ct.NORMAL,this._cachedTint=16777215,this.uvs=null,this.texture=t||J.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=dE,this.pluginName="batch",this.isSprite=!0,this._roundPixels=q.ROUND_PIXELS}_onTextureUpdate(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=di(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=di(this.scale.y)*this._height/this._texture.orig.height)}_onAnchorUpdate(){this._transformID=-1,this._transformTrimmedID=-1}calculateVertices(){const t=this._texture;if(this._transformID===this.transform._worldID&&this._textureID===t._updateID)return;this._textureID!==t._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=t._updateID;const s=this.transform.worldTransform,i=s.a,r=s.b,n=s.c,o=s.d,a=s.tx,l=s.ty,h=this.vertexData,c=t.trim,u=t.orig,d=this._anchor;let p=0,f=0,m=0,_=0;if(c?(f=c.x-d._x*u.width,p=f+c.width,_=c.y-d._y*u.height,m=_+c.height):(f=-d._x*u.width,p=f+u.width,_=-d._y*u.height,m=_+u.height),h[0]=i*f+n*_+a,h[1]=o*_+r*f+l,h[2]=i*p+n*_+a,h[3]=o*_+r*p+l,h[4]=i*p+n*m+a,h[5]=o*m+r*p+l,h[6]=i*f+n*m+a,h[7]=o*m+r*f+l,this._roundPixels){const v=q.RESOLUTION;for(let T=0;T<h.length;++T)h[T]=Math.round(h[T]*v)/v}}calculateTrimmedVertices(){if(!this.vertexTrimmedData)this.vertexTrimmedData=new Float32Array(8);else if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return;this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;const t=this._texture,s=this.vertexTrimmedData,i=t.orig,r=this._anchor,n=this.transform.worldTransform,o=n.a,a=n.b,l=n.c,h=n.d,c=n.tx,u=n.ty,d=-r._x*i.width,p=d+i.width,f=-r._y*i.height,m=f+i.height;s[0]=o*d+l*f+c,s[1]=h*f+a*d+u,s[2]=o*p+l*f+c,s[3]=h*f+a*p+u,s[4]=o*p+l*m+c,s[5]=h*m+a*p+u,s[6]=o*d+l*m+c,s[7]=h*m+a*d+u}_render(t){this.calculateVertices(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)}_calculateBounds(){const t=this._texture.trim,s=this._texture.orig;!t||t.width===s.width&&t.height===s.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))}getLocalBounds(t){return this.children.length===0?(this._localBounds||(this._localBounds=new wn),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),t||(this._localBoundsRect||(this._localBoundsRect=new yt),t=this._localBoundsRect),this._localBounds.getRectangle(t)):super.getLocalBounds.call(this,t)}containsPoint(t){this.worldTransform.applyInverse(t,$i);const s=this._texture.orig.width,i=this._texture.orig.height,r=-s*this.anchor.x;let n=0;return $i.x>=r&&$i.x<r+s&&(n=-i*this.anchor.y,$i.y>=n&&$i.y<n+i)}destroy(t){if(super.destroy(t),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,typeof t=="boolean"?t:t==null?void 0:t.texture){const i=typeof t=="boolean"?t:t==null?void 0:t.baseTexture;this._texture.destroy(!!i)}this._texture=null}static from(t,s){const i=t instanceof J?t:J.from(t,s);return new Fi(i)}set roundPixels(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t}get roundPixels(){return this._roundPixels}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(t){const s=di(this.scale.x)||1;this.scale.x=s*t/this._texture.orig.width,this._width=t}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(t){const s=di(this.scale.y)||1;this.scale.y=s*t/this._texture.orig.height,this._height=t}get anchor(){return this._anchor}set anchor(t){this._anchor.copyFrom(t)}get tint(){return this._tint}set tint(t){this._tint=t,this._tintRGB=(t>>16)+(t&65280)+((t&255)<<16)}get texture(){return this._texture}set texture(t){this._texture!==t&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=t||J.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,t&&(t.baseTexture.valid?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))}}const Jd=new Nt;Wt.prototype._cacheAsBitmap=!1;Wt.prototype._cacheData=null;Wt.prototype._cacheAsBitmapResolution=null;Wt.prototype._cacheAsBitmapMultisample=null;class fE{constructor(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null}}Object.defineProperties(Wt.prototype,{cacheAsBitmapResolution:{get(){return this._cacheAsBitmapResolution},set(e){e!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=e,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get(){return this._cacheAsBitmapMultisample},set(e){e!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=e,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get(){return this._cacheAsBitmap},set(e){if(this._cacheAsBitmap===e)return;this._cacheAsBitmap=e;let t;e?(this._cacheData||(this._cacheData=new fE),t=this._cacheData,t.originalRender=this.render,t.originalRenderCanvas=this.renderCanvas,t.originalUpdateTransform=this.updateTransform,t.originalCalculateBounds=this.calculateBounds,t.originalGetLocalBounds=this.getLocalBounds,t.originalDestroy=this.destroy,t.originalContainsPoint=this.containsPoint,t.originalMask=this._mask,t.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(t=this._cacheData,t.sprite&&this._destroyCachedDisplayObject(),this.render=t.originalRender,this.renderCanvas=t.originalRenderCanvas,this.calculateBounds=t.originalCalculateBounds,this.getLocalBounds=t.originalGetLocalBounds,this.destroy=t.originalDestroy,this.updateTransform=t.originalUpdateTransform,this.containsPoint=t.originalContainsPoint,this._mask=t.originalMask,this.filterArea=t.originalFilterArea)}}});Wt.prototype._renderCached=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(t),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(t))};Wt.prototype._initCachedDisplayObject=function(t){var d,p;if((d=this._cacheData)!=null&&d.sprite)return;const s=this.alpha;this.alpha=1,t.batch.flush();const i=this.getLocalBounds(null,!0).clone();if((p=this.filters)!=null&&p.length){const f=this.filters[0].padding;i.pad(f)}i.ceil(q.RESOLUTION);const r=t.renderTexture.current,n=t.renderTexture.sourceFrame.clone(),o=t.renderTexture.destinationFrame.clone(),a=t.projection.transform,l=Rs.create({width:i.width,height:i.height,resolution:this.cacheAsBitmapResolution||t.resolution,multisample:this.cacheAsBitmapMultisample??t.multisample}),h=`cacheAsBitmap_${Ks()}`;this._cacheData.textureCacheId=h,pt.addToCache(l.baseTexture,h),J.addToCache(l,h);const c=this.transform.localTransform.copyTo(Jd).invert().translate(-i.x,-i.y);this.render=this._cacheData.originalRender,t.render(this,{renderTexture:l,clear:!0,transform:c,skipUpdateTransform:!1}),t.framebuffer.blit(),t.projection.transform=a,t.renderTexture.bind(r,n,o),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=s;const u=new Fi(l);u.transform.worldTransform=this.transform.worldTransform,u.anchor.x=-(i.x/i.width),u.anchor.y=-(i.y/i.height),u.alpha=s,u._bounds=this._bounds,this._cacheData.sprite=u,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=u.containsPoint.bind(u)};Wt.prototype._renderCachedCanvas=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(t),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(t))};Wt.prototype._initCachedDisplayObjectCanvas=function(t){var c;if((c=this._cacheData)!=null&&c.sprite)return;const s=this.getLocalBounds(null,!0),i=this.alpha;this.alpha=1;const r=t.canvasContext.activeContext,n=t._projTransform;s.ceil(q.RESOLUTION);const o=Rs.create({width:s.width,height:s.height}),a=`cacheAsBitmap_${Ks()}`;this._cacheData.textureCacheId=a,pt.addToCache(o.baseTexture,a),J.addToCache(o,a);const l=Jd;this.transform.localTransform.copyTo(l),l.invert(),l.tx-=s.x,l.ty-=s.y,this.renderCanvas=this._cacheData.originalRenderCanvas,t.render(this,{renderTexture:o,clear:!0,transform:l,skipUpdateTransform:!1}),t.canvasContext.activeContext=r,t._projTransform=n,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=i;const h=new Fi(o);h.transform.worldTransform=this.transform.worldTransform,h.anchor.x=-(s.x/s.width),h.anchor.y=-(s.y/s.height),h.alpha=i,h._bounds=this._bounds,this._cacheData.sprite=h,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=t._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=h.containsPoint.bind(h)};Wt.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID};Wt.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)};Wt.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,pt.removeFromCache(this._cacheData.textureCacheId),J.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null};Wt.prototype._cacheAsBitmapDestroy=function(t){this.cacheAsBitmap=!1,this.destroy(t)};Wt.prototype.name=null;ce.prototype.getChildByName=function(t,s){for(let i=0,r=this.children.length;i<r;i++)if(this.children[i].name===t)return this.children[i];if(s)for(let i=0,r=this.children.length;i<r;i++){const n=this.children[i];if(!n.getChildByName)continue;const o=n.getChildByName(t,!0);if(o)return o}return null};Wt.prototype.getGlobalPosition=function(t=new Tt,s=!1){return this.parent?this.parent.toGlobal(this.position,t,s):(t.x=this.position.x,t.y=this.position.y),t};var pE=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float uAlpha;

void main(void)
{
   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;
}
`;class mE extends ae{constructor(t=1){super(nE,pE,{uAlpha:1}),this.alpha=t}get alpha(){return this.uniforms.uAlpha}set alpha(t){this.uniforms.uAlpha=t}}const gE={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},_E=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join(`
`);function xE(e){const t=gE[e],s=t.length;let i=_E,r="";const n="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;";let o;for(let a=0;a<e;a++){let l=n.replace("%index%",a.toString());o=a,a>=s&&(o=e-a-1),l=l.replace("%value%",t[o].toString()),r+=l,r+=`
`}return i=i.replace("%blur%",r),i=i.replace("%size%",e.toString()),i}const vE=`
    attribute vec2 aVertexPosition;

    uniform mat3 projectionMatrix;

    uniform float strength;

    varying vec2 vBlurTexCoords[%size%];

    uniform vec4 inputSize;
    uniform vec4 outputFrame;

    vec4 filterVertexPosition( void )
    {
        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
    }

    vec2 filterTextureCoord( void )
    {
        return aVertexPosition * (outputFrame.zw * inputSize.zw);
    }

    void main(void)
    {
        gl_Position = filterVertexPosition();

        vec2 textureCoord = filterTextureCoord();
        %blur%
    }`;function yE(e,t){const s=Math.ceil(e/2);let i=vE,r="",n;t?n="vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":n="vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(let o=0;o<e;o++){let a=n.replace("%index%",o.toString());a=a.replace("%sampleIndex%",`${o-(s-1)}.0`),r+=a,r+=`
`}return i=i.replace("%blur%",r),i=i.replace("%size%",e.toString()),i}class Pa extends ae{constructor(t,s=8,i=4,r=q.FILTER_RESOLUTION,n=5){const o=yE(n,t),a=xE(n);super(o,a),this.horizontal=t,this.resolution=r,this._quality=0,this.quality=i,this.blur=s}apply(t,s,i,r){if(i?this.horizontal?this.uniforms.strength=1/i.width*(i.width/s.width):this.uniforms.strength=1/i.height*(i.height/s.height):this.horizontal?this.uniforms.strength=1/t.renderer.width*(t.renderer.width/s.width):this.uniforms.strength=1/t.renderer.height*(t.renderer.height/s.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,this.passes===1)t.applyFilter(this,s,i,r);else{const n=t.getFilterTexture(),o=t.renderer;let a=s,l=n;this.state.blend=!1,t.applyFilter(this,a,l,$e.CLEAR);for(let h=1;h<this.passes-1;h++){t.bindAndClear(a,$e.BLIT),this.uniforms.uSampler=l;const c=l;l=a,a=c,o.shader.bind(this),o.geometry.draw(5)}this.state.blend=!0,t.applyFilter(this,l,i,r),t.returnFilterTexture(n)}}get blur(){return this.strength}set blur(t){this.padding=1+Math.abs(t)*2,this.strength=t}get quality(){return this._quality}set quality(t){this._quality=t,this.passes=t}}class EE extends ae{constructor(t=8,s=4,i=ae.defaultResolution,r=5){super(),this.blurXFilter=new Pa(!0,t,s,i,r),this.blurYFilter=new Pa(!1,t,s,i,r),this.resolution=i,this.quality=s,this.blur=t,this.repeatEdgePixels=!1}apply(t,s,i,r){const n=Math.abs(this.blurXFilter.strength),o=Math.abs(this.blurYFilter.strength);if(n&&o){const a=t.getFilterTexture();this.blurXFilter.apply(t,s,a,$e.CLEAR),this.blurYFilter.apply(t,a,i,r),t.returnFilterTexture(a)}else o?this.blurYFilter.apply(t,s,i,r):this.blurXFilter.apply(t,s,i,r)}updatePadding(){this._repeatEdgePixels?this.padding=0:this.padding=Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))*2}get blur(){return this.blurXFilter.blur}set blur(t){this.blurXFilter.blur=this.blurYFilter.blur=t,this.updatePadding()}get quality(){return this.blurXFilter.quality}set quality(t){this.blurXFilter.quality=this.blurYFilter.quality=t}get blurX(){return this.blurXFilter.blur}set blurX(t){this.blurXFilter.blur=t,this.updatePadding()}get blurY(){return this.blurYFilter.blur}set blurY(t){this.blurYFilter.blur=t,this.updatePadding()}get blendMode(){return this.blurYFilter.blendMode}set blendMode(t){this.blurYFilter.blendMode=t}get repeatEdgePixels(){return this._repeatEdgePixels}set repeatEdgePixels(t){this._repeatEdgePixels=t,this.updatePadding()}}var bE=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float m[20];
uniform float uAlpha;

void main(void)
{
    vec4 c = texture2D(uSampler, vTextureCoord);

    if (uAlpha == 0.0) {
        gl_FragColor = c;
        return;
    }

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (c.a > 0.0) {
      c.rgb /= c.a;
    }

    vec4 result;

    result.r = (m[0] * c.r);
        result.r += (m[1] * c.g);
        result.r += (m[2] * c.b);
        result.r += (m[3] * c.a);
        result.r += m[4];

    result.g = (m[5] * c.r);
        result.g += (m[6] * c.g);
        result.g += (m[7] * c.b);
        result.g += (m[8] * c.a);
        result.g += m[9];

    result.b = (m[10] * c.r);
       result.b += (m[11] * c.g);
       result.b += (m[12] * c.b);
       result.b += (m[13] * c.a);
       result.b += m[14];

    result.a = (m[15] * c.r);
       result.a += (m[16] * c.g);
       result.a += (m[17] * c.b);
       result.a += (m[18] * c.a);
       result.a += m[19];

    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);

    // Premultiply alpha again.
    rgb *= result.a;

    gl_FragColor = vec4(rgb, result.a);
}
`;class Ma extends ae{constructor(){const t={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};super(zd,bE,t),this.alpha=1}_loadMatrix(t,s=!1){let i=t;s&&(this._multiply(i,this.uniforms.m,t),i=this._colorMatrix(i)),this.uniforms.m=i}_multiply(t,s,i){return t[0]=s[0]*i[0]+s[1]*i[5]+s[2]*i[10]+s[3]*i[15],t[1]=s[0]*i[1]+s[1]*i[6]+s[2]*i[11]+s[3]*i[16],t[2]=s[0]*i[2]+s[1]*i[7]+s[2]*i[12]+s[3]*i[17],t[3]=s[0]*i[3]+s[1]*i[8]+s[2]*i[13]+s[3]*i[18],t[4]=s[0]*i[4]+s[1]*i[9]+s[2]*i[14]+s[3]*i[19]+s[4],t[5]=s[5]*i[0]+s[6]*i[5]+s[7]*i[10]+s[8]*i[15],t[6]=s[5]*i[1]+s[6]*i[6]+s[7]*i[11]+s[8]*i[16],t[7]=s[5]*i[2]+s[6]*i[7]+s[7]*i[12]+s[8]*i[17],t[8]=s[5]*i[3]+s[6]*i[8]+s[7]*i[13]+s[8]*i[18],t[9]=s[5]*i[4]+s[6]*i[9]+s[7]*i[14]+s[8]*i[19]+s[9],t[10]=s[10]*i[0]+s[11]*i[5]+s[12]*i[10]+s[13]*i[15],t[11]=s[10]*i[1]+s[11]*i[6]+s[12]*i[11]+s[13]*i[16],t[12]=s[10]*i[2]+s[11]*i[7]+s[12]*i[12]+s[13]*i[17],t[13]=s[10]*i[3]+s[11]*i[8]+s[12]*i[13]+s[13]*i[18],t[14]=s[10]*i[4]+s[11]*i[9]+s[12]*i[14]+s[13]*i[19]+s[14],t[15]=s[15]*i[0]+s[16]*i[5]+s[17]*i[10]+s[18]*i[15],t[16]=s[15]*i[1]+s[16]*i[6]+s[17]*i[11]+s[18]*i[16],t[17]=s[15]*i[2]+s[16]*i[7]+s[17]*i[12]+s[18]*i[17],t[18]=s[15]*i[3]+s[16]*i[8]+s[17]*i[13]+s[18]*i[18],t[19]=s[15]*i[4]+s[16]*i[9]+s[17]*i[14]+s[18]*i[19]+s[19],t}_colorMatrix(t){const s=new Float32Array(t);return s[4]/=255,s[9]/=255,s[14]/=255,s[19]/=255,s}brightness(t,s){const i=[t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0];this._loadMatrix(i,s)}tint(t,s){const i=t>>16&255,r=t>>8&255,n=t&255,o=[i/255,0,0,0,0,0,r/255,0,0,0,0,0,n/255,0,0,0,0,0,1,0];this._loadMatrix(o,s)}greyscale(t,s){const i=[t,t,t,0,0,t,t,t,0,0,t,t,t,0,0,0,0,0,1,0];this._loadMatrix(i,s)}blackAndWhite(t){const s=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0];this._loadMatrix(s,t)}hue(t,s){t=(t||0)/180*Math.PI;const i=Math.cos(t),r=Math.sin(t),n=Math.sqrt,o=1/3,a=n(o),l=i+(1-i)*o,h=o*(1-i)-a*r,c=o*(1-i)+a*r,u=o*(1-i)+a*r,d=i+o*(1-i),p=o*(1-i)-a*r,f=o*(1-i)-a*r,m=o*(1-i)+a*r,_=i+o*(1-i),v=[l,h,c,0,0,u,d,p,0,0,f,m,_,0,0,0,0,0,1,0];this._loadMatrix(v,s)}contrast(t,s){const i=(t||0)+1,r=-.5*(i-1),n=[i,0,0,0,r,0,i,0,0,r,0,0,i,0,r,0,0,0,1,0];this._loadMatrix(n,s)}saturate(t=0,s){const i=t*2/3+1,r=(i-1)*-.5,n=[i,r,r,0,0,r,i,r,0,0,r,r,i,0,0,0,0,0,1,0];this._loadMatrix(n,s)}desaturate(){this.saturate(-1)}negative(t){const s=[-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0];this._loadMatrix(s,t)}sepia(t){const s=[.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0];this._loadMatrix(s,t)}technicolor(t){const s=[1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0];this._loadMatrix(s,t)}polaroid(t){const s=[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0];this._loadMatrix(s,t)}toBGR(t){const s=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0];this._loadMatrix(s,t)}kodachrome(t){const s=[1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0];this._loadMatrix(s,t)}browni(t){const s=[.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0];this._loadMatrix(s,t)}vintage(t){const s=[.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0];this._loadMatrix(s,t)}colorTone(t,s,i,r,n){t=t||.2,s=s||.15,i=i||16770432,r=r||3375104;const o=(i>>16&255)/255,a=(i>>8&255)/255,l=(i&255)/255,h=(r>>16&255)/255,c=(r>>8&255)/255,u=(r&255)/255,d=[.3,.59,.11,0,0,o,a,l,t,0,h,c,u,s,0,o-h,a-c,l-u,0,0];this._loadMatrix(d,n)}night(t,s){t=t||.1;const i=[t*-2,-t,0,0,0,-t,0,t,0,0,0,t,t*2,0,0,0,0,0,1,0];this._loadMatrix(i,s)}predator(t,s){const i=[11.224130630493164*t,-4.794486999511719*t,-2.8746118545532227*t,0*t,.40342438220977783*t,-3.6330697536468506*t,9.193157196044922*t,-2.951810836791992*t,0*t,-1.316135048866272*t,-3.2184197902679443*t,-4.2375030517578125*t,7.476448059082031*t,0*t,.8044459223747253*t,0,0,0,1,0];this._loadMatrix(i,s)}lsd(t){const s=[2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0];this._loadMatrix(s,t)}reset(){const t=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];this._loadMatrix(t,!1)}get matrix(){return this.uniforms.m}set matrix(t){this.uniforms.m=t}get alpha(){return this.uniforms.uAlpha}set alpha(t){this.uniforms.uAlpha=t}}Ma.prototype.grayscale=Ma.prototype.greyscale;var TE=`varying vec2 vFilterCoord;
varying vec2 vTextureCoord;

uniform vec2 scale;
uniform mat2 rotation;
uniform sampler2D uSampler;
uniform sampler2D mapSampler;

uniform highp vec4 inputSize;
uniform vec4 inputClamp;

void main(void)
{
  vec4 map =  texture2D(mapSampler, vFilterCoord);

  map -= 0.5;
  map.xy = scale * inputSize.zw * (rotation * map.xy);

  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));
}
`,wE=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;
uniform mat3 filterMatrix;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
	vFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;
}
`;class SE extends ae{constructor(t,s){const i=new Nt;t.renderable=!1,super(wE,TE,{mapSampler:t._texture,filterMatrix:i,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])}),this.maskSprite=t,this.maskMatrix=i,s==null&&(s=20),this.scale=new Tt(s,s)}apply(t,s,i,r){this.uniforms.filterMatrix=t.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;const n=this.maskSprite.worldTransform,o=Math.sqrt(n.a*n.a+n.b*n.b),a=Math.sqrt(n.c*n.c+n.d*n.d);o!==0&&a!==0&&(this.uniforms.rotation[0]=n.a/o,this.uniforms.rotation[1]=n.b/o,this.uniforms.rotation[2]=n.c/a,this.uniforms.rotation[3]=n.d/a),t.applyFilter(this,s,i,r)}get map(){return this.uniforms.mapSampler}set map(t){this.uniforms.mapSampler=t}}var AE=`varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;
uniform sampler2D uSampler;
uniform highp vec4 inputSize;


/**
 Basic FXAA implementation based on the code on geeks3d.com with the
 modification that the texture2DLod stuff was removed since it's
 unsupported by WebGL.

 --

 From:
 https://github.com/mitsuhiko/webgl-meincraft

 Copyright (c) 2011 by Armin Ronacher.

 Some rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions are
 met:

 * Redistributions of source code must retain the above copyright
 notice, this list of conditions and the following disclaimer.

 * Redistributions in binary form must reproduce the above
 copyright notice, this list of conditions and the following
 disclaimer in the documentation and/or other materials provided
 with the distribution.

 * The names of the contributors may not be used to endorse or
 promote products derived from this software without specific
 prior written permission.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#ifndef FXAA_REDUCE_MIN
#define FXAA_REDUCE_MIN   (1.0/ 128.0)
#endif
#ifndef FXAA_REDUCE_MUL
#define FXAA_REDUCE_MUL   (1.0 / 8.0)
#endif
#ifndef FXAA_SPAN_MAX
#define FXAA_SPAN_MAX     8.0
#endif

//optimized version for mobile, where dependent
//texture reads can be a bottleneck
vec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,
          vec2 v_rgbNW, vec2 v_rgbNE,
          vec2 v_rgbSW, vec2 v_rgbSE,
          vec2 v_rgbM) {
    vec4 color;
    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;
    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;
    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;
    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;
    vec4 texColor = texture2D(tex, v_rgbM);
    vec3 rgbM  = texColor.xyz;
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW, luma);
    float lumaNE = dot(rgbNE, luma);
    float lumaSW = dot(rgbSW, luma);
    float lumaSE = dot(rgbSE, luma);
    float lumaM  = dot(rgbM,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    mediump vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
                  dir * rcpDirMin)) * inverseVP;

    vec3 rgbA = 0.5 * (
                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +
                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);
    vec3 rgbB = rgbA * 0.5 + 0.25 * (
                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +
                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);

    float lumaB = dot(rgbB, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = vec4(rgbA, texColor.a);
    else
        color = vec4(rgbB, texColor.a);
    return color;
}

void main() {

      vec4 color;

      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);

      gl_FragColor = color;
}
`,CE=`
attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

void texcoords(vec2 fragCoord, vec2 inverseVP,
               out vec2 v_rgbNW, out vec2 v_rgbNE,
               out vec2 v_rgbSW, out vec2 v_rgbSE,
               out vec2 v_rgbM) {
    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;
    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;
    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;
    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;
    v_rgbM = vec2(fragCoord * inverseVP);
}

void main(void) {

   gl_Position = filterVertexPosition();

   vFragCoord = aVertexPosition * outputFrame.zw;

   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);
}
`;class IE extends ae{constructor(){super(CE,AE)}}var RE=`precision highp float;

varying vec2 vTextureCoord;
varying vec4 vColor;

uniform float uNoise;
uniform float uSeed;
uniform sampler2D uSampler;

float rand(vec2 co)
{
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main()
{
    vec4 color = texture2D(uSampler, vTextureCoord);
    float randomValue = rand(gl_FragCoord.xy * uSeed);
    float diff = (randomValue - 0.5) * uNoise;

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (color.a > 0.0) {
        color.rgb /= color.a;
    }

    color.r += diff;
    color.g += diff;
    color.b += diff;

    // Premultiply alpha again.
    color.rgb *= color.a;

    gl_FragColor = color;
}
`;class PE extends ae{constructor(t=.5,s=Math.random()){super(zd,RE,{uNoise:0,uSeed:0}),this.noise=t,this.seed=s}get noise(){return this.uniforms.uNoise}set noise(t){this.uniforms.uNoise=t}get seed(){return this.uniforms.uSeed}set seed(t){this.uniforms.uSeed=t}}const nc={AlphaFilter:mE,BlurFilter:EE,BlurFilterPass:Pa,ColorMatrixFilter:Ma,DisplacementFilter:SE,FXAAFilter:IE,NoiseFilter:PE};Object.entries(nc).forEach(([e,t])=>{Object.defineProperty(nc,e,{get(){return Ct("7.1.0",`filters.${e} has moved to ${e}`),t}})});class Er{constructor(t){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=Er.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new Tt,this.page=new Tt,this.AT_TARGET=1,this.BUBBLING_PHASE=2,this.CAPTURING_PHASE=3,this.NONE=0,this.manager=t}get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get data(){return this}composedPath(){return this.manager&&(!this.path||this.path[this.path.length-1]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}initEvent(t,s,i){throw new Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}initUIEvent(t,s,i,r,n){throw new Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}preventDefault(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){this.propagationStopped=!0}}class Sn extends Er{constructor(){super(...arguments),this.client=new Tt,this.movement=new Tt,this.offset=new Tt,this.global=new Tt,this.screen=new Tt}get clientX(){return this.client.x}get clientY(){return this.client.y}get x(){return this.clientX}get y(){return this.clientY}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getModifierState(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t)}initMouseEvent(t,s,i,r,n,o,a,l,h,c,u,d,p,f,m){throw new Error("Method not implemented.")}}class Ce extends Sn{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]}getPredictedEvents(){throw new Error("getPredictedEvents is not supported!")}}class Oa extends Sn{constructor(){super(...arguments),this.DOM_DELTA_LINE=0,this.DOM_DELTA_PAGE=1,this.DOM_DELTA_PIXEL=2}}const ME=2048,OE=new Tt,Bo=new Tt;class BE{constructor(t){this.dispatch=new Vs,this.moveOnAll=!1,this.mappingState={trackingData:{}},this.eventPool=new Map,this.rootTarget=t,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel)}addEventMapping(t,s){this.mappingTable[t]||(this.mappingTable[t]=[]),this.mappingTable[t].push({fn:s,priority:0}),this.mappingTable[t].sort((i,r)=>i.priority-r.priority)}dispatchEvent(t,s){t.propagationStopped=!1,t.propagationImmediatelyStopped=!1,this.propagate(t,s),this.dispatch.emit(s||t.type,t)}mapEvent(t){if(!this.rootTarget)return;const s=this.mappingTable[t.type];if(s)for(let i=0,r=s.length;i<r;i++)s[i].fn(t);else console.warn(`[EventBoundary]: Event mapping not defined for ${t.type}`)}hitTest(t,s){const i=this.hitTestRecursive(this.rootTarget,this.rootTarget.interactive,OE.set(t,s),this.hitTestFn,this.hitPruneFn);return i&&i[0]}propagate(t,s){if(!t.target)return;const i=t.composedPath();t.eventPhase=t.CAPTURING_PHASE;for(let r=0,n=i.length-1;r<n;r++)if(t.currentTarget=i[r],this.notifyTarget(t,s),t.propagationStopped||t.propagationImmediatelyStopped)return;if(t.eventPhase=t.AT_TARGET,t.currentTarget=t.target,this.notifyTarget(t,s),!(t.propagationStopped||t.propagationImmediatelyStopped)){t.eventPhase=t.BUBBLING_PHASE;for(let r=i.length-2;r>=0;r--)if(t.currentTarget=i[r],this.notifyTarget(t,s),t.propagationStopped||t.propagationImmediatelyStopped)return}}all(t,s,i=this.rootTarget){t.eventPhase=t.BUBBLING_PHASE;const r=i.children;if(r)for(let n=0;n<r.length;n++)this.all(t,s,r[n]);t.currentTarget=i,this.notifyTarget(t,s)}propagationPath(t){const s=[t];for(let i=0;i<ME&&t!==this.rootTarget;i++){if(!t.parent)throw new Error("Cannot find propagation path to disconnected target");s.push(t.parent),t=t.parent}return s.reverse(),s}hitTestRecursive(t,s,i,r,n){if(!t||!t.visible||n(t,i))return null;if(t.interactiveChildren&&t.children){const o=t.children;for(let a=o.length-1;a>=0;a--){const l=o[a],h=this.hitTestRecursive(l,s||l.interactive,i,r,n);if(h){if(h.length>0&&!h[h.length-1].parent)continue;return(h.length>0||t.interactive)&&h.push(t),h}}}return s&&r(t,i)?t.interactive?[t]:[]:null}hitPruneFn(t,s){var i;if(t.hitArea&&(t.worldTransform.applyInverse(s,Bo),!t.hitArea.contains(Bo.x,Bo.y)))return!0;if(t._mask){const r=t._mask.isMaskData?t._mask.maskObject:t._mask;if(r&&!((i=r.containsPoint)!=null&&i.call(r,s)))return!0}return!1}hitTestFn(t,s){return t.hitArea?!0:t.containsPoint?t.containsPoint(s):!1}notifyTarget(t,s){var n,o;s=s??t.type;const i=`on${s}`;(o=(n=t.currentTarget)[i])==null||o.call(n,t);const r=t.eventPhase===t.CAPTURING_PHASE||t.eventPhase===t.AT_TARGET?`${s}capture`:s;this.notifyListeners(t,r),t.eventPhase===t.AT_TARGET&&this.notifyListeners(t,s)}mapPointerDown(t){if(!(t instanceof Ce)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const s=this.createPointerEvent(t);if(this.dispatchEvent(s,"pointerdown"),s.pointerType==="touch")this.dispatchEvent(s,"touchstart");else if(s.pointerType==="mouse"||s.pointerType==="pen"){const r=s.button===2;this.dispatchEvent(s,r?"rightdown":"mousedown")}const i=this.trackingData(t.pointerId);i.pressTargetsByButton[t.button]=s.composedPath(),this.freeEvent(s)}mapPointerMove(t){var a;if(!(t instanceof Ce)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const s=this.createPointerEvent(t),i=s.pointerType==="mouse"||s.pointerType==="pen",r=this.trackingData(t.pointerId),n=this.findMountedTarget(r.overTargets);if(r.overTargets&&n!==s.target){const l=t.type==="mousemove"?"mouseout":"pointerout",h=this.createPointerEvent(t,l,n);if(this.dispatchEvent(h,"pointerout"),i&&this.dispatchEvent(h,"mouseout"),!s.composedPath().includes(n)){const c=this.createPointerEvent(t,"pointerleave",n);for(c.eventPhase=c.AT_TARGET;c.target&&!s.composedPath().includes(c.target);)c.currentTarget=c.target,this.notifyTarget(c),i&&this.notifyTarget(c,"mouseleave"),c.target=c.target.parent;this.freeEvent(c)}this.freeEvent(h)}if(n!==s.target){const l=t.type==="mousemove"?"mouseover":"pointerover",h=this.clonePointerEvent(s,l);this.dispatchEvent(h,"pointerover"),i&&this.dispatchEvent(h,"mouseover");let c=n==null?void 0:n.parent;for(;c&&c!==this.rootTarget.parent&&c!==s.target;)c=c.parent;if(!c||c===this.rootTarget.parent){const d=this.clonePointerEvent(s,"pointerenter");for(d.eventPhase=d.AT_TARGET;d.target&&d.target!==n&&d.target!==this.rootTarget.parent;)d.currentTarget=d.target,this.notifyTarget(d),i&&this.notifyTarget(d,"mouseenter"),d.target=d.target.parent;this.freeEvent(d)}this.freeEvent(h)}const o=this.moveOnAll?"all":"dispatchEvent";this[o](s,"pointermove"),s.pointerType==="touch"&&this[o](s,"touchmove"),i&&(this[o](s,"mousemove"),this.cursor=(a=s.target)==null?void 0:a.cursor),r.overTargets=s.composedPath(),this.freeEvent(s)}mapPointerOver(t){var o;if(!(t instanceof Ce)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const s=this.trackingData(t.pointerId),i=this.createPointerEvent(t),r=i.pointerType==="mouse"||i.pointerType==="pen";this.dispatchEvent(i,"pointerover"),r&&this.dispatchEvent(i,"mouseover"),i.pointerType==="mouse"&&(this.cursor=(o=i.target)==null?void 0:o.cursor);const n=this.clonePointerEvent(i,"pointerenter");for(n.eventPhase=n.AT_TARGET;n.target&&n.target!==this.rootTarget.parent;)n.currentTarget=n.target,this.notifyTarget(n),r&&this.notifyTarget(n,"mouseenter"),n.target=n.target.parent;s.overTargets=i.composedPath(),this.freeEvent(i),this.freeEvent(n)}mapPointerOut(t){if(!(t instanceof Ce)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const s=this.trackingData(t.pointerId);if(s.overTargets){const i=t.pointerType==="mouse"||t.pointerType==="pen",r=this.findMountedTarget(s.overTargets),n=this.createPointerEvent(t,"pointerout",r);this.dispatchEvent(n),i&&this.dispatchEvent(n,"mouseout");const o=this.createPointerEvent(t,"pointerleave",r);for(o.eventPhase=o.AT_TARGET;o.target&&o.target!==this.rootTarget.parent;)o.currentTarget=o.target,this.notifyTarget(o),i&&this.notifyTarget(o,"mouseleave"),o.target=o.target.parent;s.overTargets=null,this.freeEvent(n),this.freeEvent(o)}this.cursor=null}mapPointerUp(t){if(!(t instanceof Ce)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const s=performance.now(),i=this.createPointerEvent(t);if(this.dispatchEvent(i,"pointerup"),i.pointerType==="touch")this.dispatchEvent(i,"touchend");else if(i.pointerType==="mouse"||i.pointerType==="pen"){const a=i.button===2;this.dispatchEvent(i,a?"rightup":"mouseup")}const r=this.trackingData(t.pointerId),n=this.findMountedTarget(r.pressTargetsByButton[t.button]);let o=n;if(n&&!i.composedPath().includes(n)){let a=n;for(;a&&!i.composedPath().includes(a);){if(i.currentTarget=a,this.notifyTarget(i,"pointerupoutside"),i.pointerType==="touch")this.notifyTarget(i,"touchendoutside");else if(i.pointerType==="mouse"||i.pointerType==="pen"){const l=i.button===2;this.notifyTarget(i,l?"rightupoutside":"mouseupoutside")}a=a.parent}delete r.pressTargetsByButton[t.button],o=a}if(o){const a=this.clonePointerEvent(i,"click");a.target=o,a.path=null,r.clicksByButton[t.button]||(r.clicksByButton[t.button]={clickCount:0,target:a.target,timeStamp:s});const l=r.clicksByButton[t.button];l.target===a.target&&s-l.timeStamp<200?++l.clickCount:l.clickCount=1,l.target=a.target,l.timeStamp=s,a.detail=l.clickCount,a.pointerType==="mouse"?this.dispatchEvent(a,"click"):a.pointerType==="touch"&&this.dispatchEvent(a,"tap"),this.dispatchEvent(a,"pointertap"),this.freeEvent(a)}this.freeEvent(i)}mapPointerUpOutside(t){if(!(t instanceof Ce)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const s=this.trackingData(t.pointerId),i=this.findMountedTarget(s.pressTargetsByButton[t.button]),r=this.createPointerEvent(t);if(i){let n=i;for(;n;)r.currentTarget=n,this.notifyTarget(r,"pointerupoutside"),r.pointerType==="touch"?this.notifyTarget(r,"touchendoutside"):(r.pointerType==="mouse"||r.pointerType==="pen")&&this.notifyTarget(r,r.button===2?"rightupoutside":"mouseupoutside"),n=n.parent;delete s.pressTargetsByButton[t.button]}this.freeEvent(r)}mapWheel(t){if(!(t instanceof Oa)){console.warn("EventBoundary cannot map a non-wheel event as a wheel event");return}const s=this.createWheelEvent(t);this.dispatchEvent(s),this.freeEvent(s)}findMountedTarget(t){if(!t)return null;let s=t[0];for(let i=1;i<t.length&&t[i].parent===s;i++)s=t[i];return s}createPointerEvent(t,s,i){const r=this.allocateEvent(Ce);return this.copyPointerData(t,r),this.copyMouseData(t,r),this.copyData(t,r),r.nativeEvent=t.nativeEvent,r.originalEvent=t,r.target=i??this.hitTest(r.global.x,r.global.y),typeof s=="string"&&(r.type=s),r}createWheelEvent(t){const s=this.allocateEvent(Oa);return this.copyWheelData(t,s),this.copyMouseData(t,s),this.copyData(t,s),s.nativeEvent=t.nativeEvent,s.originalEvent=t,s.target=this.hitTest(s.global.x,s.global.y),s}clonePointerEvent(t,s){const i=this.allocateEvent(Ce);return i.nativeEvent=t.nativeEvent,i.originalEvent=t.originalEvent,this.copyPointerData(t,i),this.copyMouseData(t,i),this.copyData(t,i),i.target=t.target,i.path=t.composedPath().slice(),i.type=s??i.type,i}copyWheelData(t,s){s.deltaMode=t.deltaMode,s.deltaX=t.deltaX,s.deltaY=t.deltaY,s.deltaZ=t.deltaZ}copyPointerData(t,s){t instanceof Ce&&s instanceof Ce&&(s.pointerId=t.pointerId,s.width=t.width,s.height=t.height,s.isPrimary=t.isPrimary,s.pointerType=t.pointerType,s.pressure=t.pressure,s.tangentialPressure=t.tangentialPressure,s.tiltX=t.tiltX,s.tiltY=t.tiltY,s.twist=t.twist)}copyMouseData(t,s){t instanceof Sn&&s instanceof Sn&&(s.altKey=t.altKey,s.button=t.button,s.buttons=t.buttons,s.client.copyFrom(t.client),s.ctrlKey=t.ctrlKey,s.metaKey=t.metaKey,s.movement.copyFrom(t.movement),s.screen.copyFrom(t.screen),s.global.copyFrom(t.global))}copyData(t,s){s.isTrusted=t.isTrusted,s.srcElement=t.srcElement,s.timeStamp=performance.now(),s.type=t.type,s.detail=t.detail,s.view=t.view,s.which=t.which,s.layer.copyFrom(t.layer),s.page.copyFrom(t.page)}trackingData(t){return this.mappingState.trackingData[t]||(this.mappingState.trackingData[t]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[t]}allocateEvent(t){this.eventPool.has(t)||this.eventPool.set(t,[]);const s=this.eventPool.get(t).pop()||new t(this);return s.eventPhase=s.NONE,s.currentTarget=null,s.path=null,s.target=null,s}freeEvent(t){if(t.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");const s=t.constructor;this.eventPool.has(s)||this.eventPool.set(s,[]),this.eventPool.get(s).push(t)}notifyListeners(t,s){const i=t.currentTarget._events[s];if(i)if("fn"in i)i.fn.call(i.context,t);else for(let r=0,n=i.length;r<n&&!t.propagationImmediatelyStopped;r++)i[r].fn.call(i[r].context,t)}}const DE=1,FE={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"};class Qd{constructor(t){this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=t,this.rootBoundary=new BE(null),this.autoPreventDefault=!0,this.eventsAdded=!1,this.rootPointerEvent=new Ce(null),this.rootWheelEvent=new Oa(null),this.cursorStyles={default:"inherit",pointer:"pointer"},this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.onPointerOverOut=this.onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this)}init(){const{view:t,resolution:s}=this.renderer;this.setTargetElement(t),this.resolution=s}resolutionChange(t){this.resolution=t}destroy(){this.setTargetElement(null),this.renderer=null}setCursor(t){t=t||"default";let s=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(s=!1),this.currentCursor===t)return;this.currentCursor=t;const i=this.cursorStyles[t];if(i)switch(typeof i){case"string":s&&(this.domElement.style.cursor=i);break;case"function":i(t);break;case"object":s&&Object.assign(this.domElement.style,i);break}else s&&typeof t=="string"&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,t)&&(this.domElement.style.cursor=t)}onPointerDown(t){if(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&t.pointerType==="touch")return;const s=this.normalizeToPointerData(t);this.autoPreventDefault&&s[0].isNormalized&&(t.cancelable||!("cancelable"in t))&&t.preventDefault();for(let i=0,r=s.length;i<r;i++){const n=s[i],o=this.bootstrapEvent(this.rootPointerEvent,n);this.rootBoundary.mapEvent(o)}this.setCursor(this.rootBoundary.cursor)}onPointerMove(t){if(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&t.pointerType==="touch")return;const s=this.normalizeToPointerData(t);for(let i=0,r=s.length;i<r;i++){const n=this.bootstrapEvent(this.rootPointerEvent,s[i]);this.rootBoundary.mapEvent(n)}this.setCursor(this.rootBoundary.cursor)}onPointerUp(t){if(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&t.pointerType==="touch")return;let s=t.target;t.composedPath&&t.composedPath().length>0&&(s=t.composedPath()[0]);const i=s!==this.domElement?"outside":"",r=this.normalizeToPointerData(t);for(let n=0,o=r.length;n<o;n++){const a=this.bootstrapEvent(this.rootPointerEvent,r[n]);a.type+=i,this.rootBoundary.mapEvent(a)}this.setCursor(this.rootBoundary.cursor)}onPointerOverOut(t){if(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&t.pointerType==="touch")return;const s=this.normalizeToPointerData(t);for(let i=0,r=s.length;i<r;i++){const n=this.bootstrapEvent(this.rootPointerEvent,s[i]);this.rootBoundary.mapEvent(n)}this.setCursor(this.rootBoundary.cursor)}onWheel(t){const s=this.normalizeWheelEvent(t);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(s)}setTargetElement(t){this.removeEvents(),this.domElement=t,this.addEvents()}addEvents(){if(this.eventsAdded||!this.domElement)return;const t=this.domElement.style;t&&(globalThis.navigator.msPointerEnabled?(t.msContentZooming="none",t.msTouchAction="none"):this.supportsPointerEvents&&(t.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,!0),this.domElement.addEventListener("pointerdown",this.onPointerDown,!0),this.domElement.addEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.addEventListener("pointerover",this.onPointerOverOut,!0),globalThis.addEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,!0),this.domElement.addEventListener("mousedown",this.onPointerDown,!0),this.domElement.addEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.addEventListener("mouseover",this.onPointerOverOut,!0),globalThis.addEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this.onPointerDown,!0),this.domElement.addEventListener("touchend",this.onPointerUp,!0),this.domElement.addEventListener("touchmove",this.onPointerMove,!0)),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this.eventsAdded=!0}removeEvents(){if(!this.eventsAdded||!this.domElement)return;const t=this.domElement.style;globalThis.navigator.msPointerEnabled?(t.msContentZooming="",t.msTouchAction=""):this.supportsPointerEvents&&(t.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,!0),this.domElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.domElement.removeEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.removeEventListener("pointerover",this.onPointerOverOut,!0),globalThis.removeEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,!0),this.domElement.removeEventListener("mousedown",this.onPointerDown,!0),this.domElement.removeEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.removeEventListener("mouseover",this.onPointerOverOut,!0),globalThis.removeEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this.onPointerDown,!0),this.domElement.removeEventListener("touchend",this.onPointerUp,!0),this.domElement.removeEventListener("touchmove",this.onPointerMove,!0)),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}mapPositionToPoint(t,s,i){let r;this.domElement.parentElement?r=this.domElement.getBoundingClientRect():r={x:0,y:0,width:this.domElement.width,height:this.domElement.height,left:0,top:0};const n=1/this.resolution;t.x=(s-r.left)*(this.domElement.width/r.width)*n,t.y=(i-r.top)*(this.domElement.height/r.height)*n}normalizeToPointerData(t){const s=[];if(this.supportsTouchEvents&&t instanceof TouchEvent)for(let i=0,r=t.changedTouches.length;i<r;i++){const n=t.changedTouches[i];typeof n.button>"u"&&(n.button=0),typeof n.buttons>"u"&&(n.buttons=1),typeof n.isPrimary>"u"&&(n.isPrimary=t.touches.length===1&&t.type==="touchstart"),typeof n.width>"u"&&(n.width=n.radiusX||1),typeof n.height>"u"&&(n.height=n.radiusY||1),typeof n.tiltX>"u"&&(n.tiltX=0),typeof n.tiltY>"u"&&(n.tiltY=0),typeof n.pointerType>"u"&&(n.pointerType="touch"),typeof n.pointerId>"u"&&(n.pointerId=n.identifier||0),typeof n.pressure>"u"&&(n.pressure=n.force||.5),typeof n.twist>"u"&&(n.twist=0),typeof n.tangentialPressure>"u"&&(n.tangentialPressure=0),typeof n.layerX>"u"&&(n.layerX=n.offsetX=n.clientX),typeof n.layerY>"u"&&(n.layerY=n.offsetY=n.clientY),n.isNormalized=!0,n.type=t.type,s.push(n)}else if(!globalThis.MouseEvent||t instanceof MouseEvent&&(!this.supportsPointerEvents||!(t instanceof globalThis.PointerEvent))){const i=t;typeof i.isPrimary>"u"&&(i.isPrimary=!0),typeof i.width>"u"&&(i.width=1),typeof i.height>"u"&&(i.height=1),typeof i.tiltX>"u"&&(i.tiltX=0),typeof i.tiltY>"u"&&(i.tiltY=0),typeof i.pointerType>"u"&&(i.pointerType="mouse"),typeof i.pointerId>"u"&&(i.pointerId=DE),typeof i.pressure>"u"&&(i.pressure=.5),typeof i.twist>"u"&&(i.twist=0),typeof i.tangentialPressure>"u"&&(i.tangentialPressure=0),i.isNormalized=!0,s.push(i)}else s.push(t);return s}normalizeWheelEvent(t){const s=this.rootWheelEvent;return this.transferMouseData(s,t),s.deltaX=t.deltaX,s.deltaY=t.deltaY,s.deltaZ=t.deltaZ,s.deltaMode=t.deltaMode,this.mapPositionToPoint(s.screen,t.clientX,t.clientY),s.global.copyFrom(s.screen),s.offset.copyFrom(s.screen),s.nativeEvent=t,s.type=t.type,s}bootstrapEvent(t,s){return t.originalEvent=null,t.nativeEvent=s,t.pointerId=s.pointerId,t.width=s.width,t.height=s.height,t.isPrimary=s.isPrimary,t.pointerType=s.pointerType,t.pressure=s.pressure,t.tangentialPressure=s.tangentialPressure,t.tiltX=s.tiltX,t.tiltY=s.tiltY,t.twist=s.twist,this.transferMouseData(t,s),this.mapPositionToPoint(t.screen,s.clientX,s.clientY),t.global.copyFrom(t.screen),t.offset.copyFrom(t.screen),t.isTrusted=s.isTrusted,t.type==="pointerleave"&&(t.type="pointerout"),t.type.startsWith("mouse")&&(t.type=t.type.replace("mouse","pointer")),t.type.startsWith("touch")&&(t.type=FE[t.type]||t.type),t}transferMouseData(t,s){t.isTrusted=s.isTrusted,t.srcElement=s.srcElement,t.timeStamp=performance.now(),t.type=s.type,t.altKey=s.altKey,t.button=s.button,t.buttons=s.buttons,t.client.x=s.clientX,t.client.y=s.clientY,t.ctrlKey=s.ctrlKey,t.metaKey=s.metaKey,t.movement.x=s.movementX,t.movement.y=s.movementY,t.page.x=s.pageX,t.page.y=s.pageY,t.relatedTarget=null,t.shiftKey=s.shiftKey}}Qd.extension={name:"events",type:[K.RendererSystem,K.CanvasRendererSystem]};rt.add(Qd);const LE={onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,ontouchstart:null,onwheel:null,interactive:!1,interactiveChildren:!0,hitArea:null,addEventListener(e,t,s){const i=typeof s=="boolean"&&s||typeof s=="object"&&s.capture,r=typeof t=="function"?void 0:t;e=i?`${e}capture`:e,t=typeof t=="function"?t:t.handleEvent,this.on(e,t,r)},removeEventListener(e,t,s){const i=typeof s=="boolean"&&s||typeof s=="object"&&s.capture,r=typeof t=="function"?void 0:t;e=i?`${e}capture`:e,t=typeof t=="function"?t:t.handleEvent,this.off(e,t,r)},dispatchEvent(e){if(!(e instanceof Er))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");return e.defaultPrevented=!1,e.path=null,e.target=this,e.manager.dispatchEvent(e),!e.defaultPrevented}};Wt.mixin(LE);const NE={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1};Wt.mixin(NE);const UE=9,Wr=100,kE=0,GE=0,oc=2,ac=1,HE=-1e3,WE=-1e3,$E=2;class tf{constructor(t){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(os.tablet||os.phone)&&this.createTouchHook();const s=document.createElement("div");s.style.width=`${Wr}px`,s.style.height=`${Wr}px`,s.style.position="absolute",s.style.top=`${kE}px`,s.style.left=`${GE}px`,s.style.zIndex=oc.toString(),this.div=s,this.renderer=t,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}get isActive(){return this._isActive}get isMobileAccessibility(){return this._isMobileAccessibility}createTouchHook(){const t=document.createElement("button");t.style.width=`${ac}px`,t.style.height=`${ac}px`,t.style.position="absolute",t.style.top=`${HE}px`,t.style.left=`${WE}px`,t.style.zIndex=$E.toString(),t.style.backgroundColor="#FF0000",t.title="select to enable accessibility for this content",t.addEventListener("focus",()=>{this._isMobileAccessibility=!0,this.activate(),this.destroyTouchHook()}),document.body.appendChild(t),this._hookDiv=t}destroyTouchHook(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)}activate(){var t;this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),(t=this.renderer.view.parentNode)==null||t.appendChild(this.div))}deactivate(){var t;!this._isActive||this._isMobileAccessibility||(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),(t=this.div.parentNode)==null||t.removeChild(this.div))}updateAccessibleObjects(t){if(!t.visible||!t.accessibleChildren)return;t.accessible&&t.interactive&&(t._accessibleActive||this.addChild(t),t.renderId=this.renderId);const s=t.children;if(s)for(let i=0;i<s.length;i++)this.updateAccessibleObjects(s[i])}update(){const t=performance.now();if(os.android.device&&t<this.androidUpdateCount||(this.androidUpdateCount=t+this.androidUpdateFrequency,!this.renderer.renderingToScreen))return;this.renderer.lastObjectRendered&&this.updateAccessibleObjects(this.renderer.lastObjectRendered);const{x:s,y:i,width:r,height:n}=this.renderer.view.getBoundingClientRect(),{width:o,height:a,resolution:l}=this.renderer,h=r/o*l,c=n/a*l;let u=this.div;u.style.left=`${s}px`,u.style.top=`${i}px`,u.style.width=`${o}px`,u.style.height=`${a}px`;for(let d=0;d<this.children.length;d++){const p=this.children[d];if(p.renderId!==this.renderId)p._accessibleActive=!1,yi(this.children,d,1),this.div.removeChild(p._accessibleDiv),this.pool.push(p._accessibleDiv),p._accessibleDiv=null,d--;else{u=p._accessibleDiv;let f=p.hitArea;const m=p.worldTransform;p.hitArea?(u.style.left=`${(m.tx+f.x*m.a)*h}px`,u.style.top=`${(m.ty+f.y*m.d)*c}px`,u.style.width=`${f.width*m.a*h}px`,u.style.height=`${f.height*m.d*c}px`):(f=p.getBounds(),this.capHitArea(f),u.style.left=`${f.x*h}px`,u.style.top=`${f.y*c}px`,u.style.width=`${f.width*h}px`,u.style.height=`${f.height*c}px`,u.title!==p.accessibleTitle&&p.accessibleTitle!==null&&(u.title=p.accessibleTitle),u.getAttribute("aria-label")!==p.accessibleHint&&p.accessibleHint!==null&&u.setAttribute("aria-label",p.accessibleHint)),(p.accessibleTitle!==u.title||p.tabIndex!==u.tabIndex)&&(u.title=p.accessibleTitle,u.tabIndex=p.tabIndex,this.debug&&this.updateDebugHTML(u))}}this.renderId++}updateDebugHTML(t){t.innerHTML=`type: ${t.type}</br> title : ${t.title}</br> tabIndex: ${t.tabIndex}`}capHitArea(t){t.x<0&&(t.width+=t.x,t.x=0),t.y<0&&(t.height+=t.y,t.y=0);const{width:s,height:i}=this.renderer;t.x+t.width>s&&(t.width=s-t.x),t.y+t.height>i&&(t.height=i-t.y)}addChild(t){let s=this.pool.pop();s||(s=document.createElement("button"),s.style.width=`${Wr}px`,s.style.height=`${Wr}px`,s.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",s.style.position="absolute",s.style.zIndex=oc.toString(),s.style.borderStyle="none",navigator.userAgent.toLowerCase().includes("chrome")?s.setAttribute("aria-live","off"):s.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?s.setAttribute("aria-relevant","additions"):s.setAttribute("aria-relevant","text"),s.addEventListener("click",this._onClick.bind(this)),s.addEventListener("focus",this._onFocus.bind(this)),s.addEventListener("focusout",this._onFocusOut.bind(this))),s.style.pointerEvents=t.accessiblePointerEvents,s.type=t.accessibleType,t.accessibleTitle&&t.accessibleTitle!==null?s.title=t.accessibleTitle:(!t.accessibleHint||t.accessibleHint===null)&&(s.title=`displayObject ${t.tabIndex}`),t.accessibleHint&&t.accessibleHint!==null&&s.setAttribute("aria-label",t.accessibleHint),this.debug&&this.updateDebugHTML(s),t._accessibleActive=!0,t._accessibleDiv=s,s.displayObject=t,this.children.push(t),this.div.appendChild(t._accessibleDiv),t._accessibleDiv.tabIndex=t.tabIndex}_dispatchEvent(t,s){const{displayObject:i}=t.target,r=this.renderer.events.rootBoundary,n=Object.assign(new Er(r),{target:i});r.rootTarget=this.renderer.lastObjectRendered,s.forEach(o=>r.dispatchEvent(n,o))}_onClick(t){this._dispatchEvent(t,["click","pointertap","tap"])}_onFocus(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","assertive"),this._dispatchEvent(t,["mouseover"])}_onFocusOut(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","polite"),this._dispatchEvent(t,["mouseout"])}_onKeyDown(t){t.keyCode===UE&&this.activate()}_onMouseMove(t){t.movementX===0&&t.movementY===0||this.deactivate()}destroy(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null}}tf.extension={name:"accessibility",type:[K.RendererPlugin,K.CanvasRendererPlugin]};rt.add(tf);const Ba=class{constructor(e){this.stage=new ce,e=Object.assign({forceCanvas:!1},e),this.renderer=sE(e),Ba._plugins.forEach(t=>{t.init.call(this,e)})}render(){this.renderer.render(this.stage)}get view(){return this.renderer.view}get screen(){return this.renderer.screen}destroy(e,t){const s=Ba._plugins.slice(0);s.reverse(),s.forEach(i=>{i.destroy.call(this)}),this.stage.destroy(t),this.stage=null,this.renderer.destroy(e),this.renderer=null}};let bl=Ba;bl._plugins=[];rt.handleByList(K.Application,bl._plugins);class ef{static init(t){Object.defineProperty(this,"resizeTo",{set(s){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=s,s&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this.cancelResize(),this._resizeId=requestAnimationFrame(()=>this.resize()))},this.cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(!this._resizeTo)return;this.cancelResize();let s,i;if(this._resizeTo===globalThis.window)s=globalThis.innerWidth,i=globalThis.innerHeight;else{const{clientWidth:r,clientHeight:n}=this._resizeTo;s=r,i=n}this.renderer.resize(s,i),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=t.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}}ef.extension=K.Application;rt.add(ef);const lc={loader:K.LoadParser,resolver:K.ResolveParser,cache:K.CacheParser,detection:K.DetectionParser};rt.handle(K.Asset,e=>{const t=e.ref;Object.entries(lc).filter(([s])=>!!t[s]).forEach(([s,i])=>rt.add(Object.assign(t[s],{extension:t[s].extension??i})))},e=>{const t=e.ref;Object.keys(lc).filter(s=>!!t[s]).forEach(s=>rt.remove(t[s]))});class XE{constructor(t,s=!1){this._loader=t,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=s}add(t){t.forEach(s=>{this._assetList.push(s)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const t=[],s=Math.min(this._assetList.length,this._maxConcurrent);for(let i=0;i<s;i++)t.push(this._assetList.pop());await this._loader.load(t),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(t){this._isActive!==t&&(this._isActive=t,t&&!this._isLoading&&this._next())}}function sf(e,t){if(Array.isArray(t)){for(const s of t)if(e.startsWith(`data:${s}`))return!0;return!1}return e.startsWith(`data:${t}`)}function Jn(e,t){const s=e.split("?")[0],i=se.extname(s).toLowerCase();return Array.isArray(t)?t.includes(i):i===t}const as=(e,t)=>(Array.isArray(e)||(e=[e]),t?e.map(s=>typeof s=="string"?t(s):s):e);function rf(e,t,s,i,r){const n=t[s];for(let o=0;o<n.length;o++){const a=n[o];s<t.length-1?rf(e.replace(i[s],a),t,s+1,i,r):r.push(e.replace(i[s],a))}}function jE(e){const t=/\{(.*?)\}/g,s=e.match(t),i=[];if(s){const r=[];s.forEach(n=>{const o=n.substring(1,n.length-1).split(",");r.push(o)}),rf(e,r,0,s,i)}else i.push(e);return i}const An=e=>!Array.isArray(e);class zE{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(t){return this._cache.has(t)}get(t){const s=this._cache.get(t);return s||console.warn(`[Assets] Asset id ${t} was not found in the Cache`),s}set(t,s){const i=as(t);let r;for(let a=0;a<this.parsers.length;a++){const l=this.parsers[a];if(l.test(s)){r=l.getCacheableAssets(i,s);break}}r||(r={},i.forEach(a=>{r[a]=s}));const n=Object.keys(r),o={cacheKeys:n,keys:i};if(i.forEach(a=>{this._cacheMap.set(a,o)}),n.forEach(a=>{this._cache.has(a)&&this._cache.get(a)!==s&&console.warn("[Cache] already has key:",a),this._cache.set(a,r[a])}),s instanceof J){const a=s;i.forEach(l=>{a.baseTexture!==J.EMPTY.baseTexture&&pt.addToCache(a.baseTexture,l),J.addToCache(a,l)})}}remove(t){if(this._cacheMap.get(t),!this._cacheMap.has(t)){console.warn(`[Assets] Asset id ${t} was not found in the Cache`);return}const s=this._cacheMap.get(t);s.cacheKeys.forEach(r=>{this._cache.delete(r)}),s.keys.forEach(r=>{this._cacheMap.delete(r)})}get parsers(){return this._parsers}}const Xi=new zE;class VE{constructor(){this._parsers=[],this.promiseCache={}}reset(){this.promiseCache={}}_getLoadPromiseAndParser(t,s){const i={promise:null,parser:null};return i.promise=(async()=>{var n,o;let r=null;for(let a=0;a<this.parsers.length;a++){const l=this.parsers[a];if(l.load&&((n=l.test)!=null&&n.call(l,t,s,this))){r=await l.load(t,s,this),i.parser=l;break}}if(!i.parser)return console.warn(`[Assets] ${t} could not be loaded as we don't know how to parse it, ensure the correct parser has being added`),null;for(let a=0;a<this.parsers.length;a++){const l=this.parsers[a];l.parse&&l.parse&&await((o=l.testParse)==null?void 0:o.call(l,r,s,this))&&(r=await l.parse(r,s,this)||r,i.parser=l)}return r})(),i}async load(t,s){let i=0;const r={},n=An(t),o=as(t,h=>({src:h})),a=o.length,l=o.map(async h=>{const c=se.toAbsolute(h.src);if(!r[h.src])try{this.promiseCache[c]||(this.promiseCache[c]=this._getLoadPromiseAndParser(c,h)),r[h.src]=await this.promiseCache[c].promise,s&&s(++i/a)}catch(u){throw delete this.promiseCache[c],delete r[h.src],new Error(`[Loader.load] Failed to load ${c}.
${u}`)}});return await Promise.all(l),n?r[o[0].src]:r}async unload(t){const i=as(t,r=>({src:r})).map(async r=>{var a,l;const n=se.toAbsolute(r.src),o=this.promiseCache[n];if(o){const h=await o.promise;(l=(a=o.parser)==null?void 0:a.unload)==null||l.call(a,h,r,this),delete this.promiseCache[n]}});await Promise.all(i)}get parsers(){return this._parsers}}var ts=(e=>(e[e.Low=0]="Low",e[e.Normal=1]="Normal",e[e.High=2]="High",e))(ts||{});const YE={extension:{type:K.LoadParser,priority:ts.Low},test(e){return se.extname(e).toLowerCase()===".json"},async load(e){return await(await q.ADAPTER.fetch(e)).json()}};rt.add(YE);const KE={extension:{type:K.LoadParser,priority:ts.Low},test(e){return se.extname(e).toLowerCase()===".txt"},async load(e){return await(await q.ADAPTER.fetch(e)).text()}};rt.add(KE);const qE=["normal","bold","100","200","300","400","500","600","700","800","900"],ZE=[".ttf",".otf",".woff",".woff2"],JE=["font/ttf","font/otf","font/woff","font/woff2"];function QE(e){const t=se.extname(e);return se.basename(e,t).replace(/(-|_)/g," ").toLowerCase().split(" ").map(n=>n.charAt(0).toUpperCase()+n.slice(1)).join(" ")}const tb={extension:{type:K.LoadParser,priority:ts.Low},test(e){return sf(e,JE)||Jn(e,ZE)},async load(e,t){var i,r,n;if(!globalThis.navigator.onLine)throw new Error("[loadWebFont] Cannot load font - navigator is offline");const s=q.ADAPTER.getFontFaceSet();if(s){const o=[],a=((i=t.data)==null?void 0:i.family)??QE(e),l=((n=(r=t.data)==null?void 0:r.weights)==null?void 0:n.filter(c=>qE.includes(c)))??["normal"],h=t.data??{};for(let c=0;c<l.length;c++){const u=l[c],d=new FontFace(a,`url(${encodeURI(e)})`,{...h,weight:u});await d.load(),s.add(d),o.push(d)}return o.length===1?o[0]:o}return console.warn("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(e){(Array.isArray(e)?e:[e]).forEach(t=>q.ADAPTER.getFontFaceSet().delete(t))}};rt.add(tb);let hc=0,Do;const eb="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=",sb={id:"checkImageBitmap",code:`
    async function checkImageBitmap()
    {
        try
        {
            if (typeof createImageBitmap !== 'function') return false;

            const response = await fetch('${eb}');
            const imageBlob =  await response.blob();
            const imageBitmap = await createImageBitmap(imageBlob);

            return imageBitmap.width === 1 && imageBitmap.height === 1;
        }
        catch (e)
        {
            return false;
        }
    }
    checkImageBitmap().then((result) => { self.postMessage(result); });
    `},ib={id:"loadImageBitmap",code:`
    async function loadImageBitmap(url)
    {
        const response = await fetch(url);

        if (!response.ok)
        {
            throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \`
                + \`\${response.status} \${response.statusText}\`);
        }

        const imageBlob =  await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);

        return imageBitmap;
    }
    self.onmessage = async (event) =>
    {
        try
        {
            const imageBitmap = await loadImageBitmap(event.data.data[0]);

            self.postMessage({
                data: imageBitmap,
                uuid: event.data.uuid,
                id: event.data.id,
            }, [imageBitmap]);
        }
        catch(e)
        {
            self.postMessage({
                error: e,
                uuid: event.data.uuid,
                id: event.data.id,
            });
        }
    };`};let Fo;class rb{constructor(){this._initialized=!1,this._createdWorkers=0,this.workerPool=[],this.queue=[],this.resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(t=>{const s=URL.createObjectURL(new Blob([sb.code],{type:"application/javascript"})),i=new Worker(s);i.addEventListener("message",r=>{i.terminate(),URL.revokeObjectURL(s),t(r.data)})}),this._isImageBitmapSupported)}loadImageBitmap(t){return this._run("loadImageBitmap",[t])}async _initWorkers(){this._initialized||(this._initialized=!0)}getWorker(){Do===void 0&&(Do=navigator.hardwareConcurrency||4);let t=this.workerPool.pop();return!t&&this._createdWorkers<Do&&(Fo||(Fo=URL.createObjectURL(new Blob([ib.code],{type:"application/javascript"}))),this._createdWorkers++,t=new Worker(Fo),t.addEventListener("message",s=>{this.complete(s.data),this.returnWorker(s.target),this.next()})),t}returnWorker(t){this.workerPool.push(t)}complete(t){t.error!==void 0?this.resolveHash[t.uuid].reject(t.error):this.resolveHash[t.uuid].resolve(t.data),this.resolveHash[t.uuid]=null}async _run(t,s){await this._initWorkers();const i=new Promise((r,n)=>{this.queue.push({id:t,arguments:s,resolve:r,reject:n})});return this.next(),i}next(){if(!this.queue.length)return;const t=this.getWorker();if(!t)return;const s=this.queue.pop(),i=s.id;this.resolveHash[hc]={resolve:s.resolve,reject:s.reject},t.postMessage({data:s.arguments,uuid:hc++,id:i})}}const cc=new rb;function Qn(e,t,s){const i=new J(e);return i.baseTexture.on("dispose",()=>{delete t.promiseCache[s]}),i}const nb=[".jpeg",".jpg",".png",".webp",".avif"],ob=["image/jpeg","image/png","image/webp","image/avif"];async function ab(e){const t=await q.ADAPTER.fetch(e);if(!t.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${e}: ${t.status} ${t.statusText}`);const s=await t.blob();return await createImageBitmap(s)}const gr={extension:{type:K.LoadParser,priority:ts.High},config:{preferWorkers:!0},test(e){return sf(e,ob)||Jn(e,nb)},async load(e,t,s){let i=null;globalThis.createImageBitmap?this.config.preferWorkers&&await cc.isImageBitmapSupported()?i=await cc.loadImageBitmap(e):i=await ab(e):i=await new Promise(n=>{i=new Image,i.crossOrigin="anonymous",i.src=e,i.complete?n(i):i.onload=()=>{n(i)}});const r=new pt(i,{resolution:As(e),...t.data});return r.resource.src=e,Qn(r,s,e)},unload(e){e.destroy(!0)}};rt.add(gr);const lb={extension:{type:K.LoadParser,priority:ts.High},test(e){return se.extname(e).toLowerCase()===".svg"},async testParse(e){return mr.test(e)},async parse(e,t,s){var o,a,l;const i=new mr(e,(o=t==null?void 0:t.data)==null?void 0:o.resourceOptions),r=new pt(i,{resolution:As(e),...t==null?void 0:t.data});r.resource.src=e;const n=Qn(r,s,e);return(l=(a=t==null?void 0:t.data)==null?void 0:a.resourceOptions)!=null&&l.autoLoad||await i.load(),n},async load(e,t){return(await q.ADAPTER.fetch(e)).text()},unload:gr.unload};rt.add(lb);class hb{constructor(){this._bundleIdConnector="-",this._createBundleAssetId=(t,s)=>`${t}${this._bundleIdConnector}${s}`,this._extractAssetIdFromBundle=(t,s)=>s.replace(`${t}${this._bundleIdConnector}`,""),this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(t){if(this._bundleIdConnector=t.connector??this._bundleIdConnector,this._createBundleAssetId=t.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=t.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...t){t.forEach(s=>{this._preferredOrder.push(s),s.priority||(s.priority=Object.keys(s.params))}),this._resolverHash={}}set basePath(t){this._basePath=t}get basePath(){return this._basePath}set rootPath(t){this._rootPath=t}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this._preferredOrder=[],this._resolverHash={},this._assetMap={},this._rootPath=null,this._basePath=null,this._manifest=null}setDefaultSearchParams(t){if(typeof t=="string")this._defaultSearchParams=t;else{const s=t;this._defaultSearchParams=Object.keys(s).map(i=>`${encodeURIComponent(i)}=${encodeURIComponent(s[i])}`).join("&")}}addManifest(t){this._manifest&&console.warn("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=t,t.bundles.forEach(s=>{this.addBundle(s.name,s.assets)})}addBundle(t,s){const i=[];Array.isArray(s)?s.forEach(r=>{if(typeof r.name=="string"){const n=this._createBundleAssetId(t,r.name);i.push(n),this.add([r.name,n],r.srcs)}else{const n=r.name.map(o=>this._createBundleAssetId(t,o));n.forEach(o=>{i.push(o)}),this.add([...r.name,...n],r.srcs)}}):Object.keys(s).forEach(r=>{i.push(this._createBundleAssetId(t,r)),this.add([r,this._createBundleAssetId(t,r)],s[r])}),this._bundles[t]=i}add(t,s,i){const r=as(t);r.forEach(o=>{this._assetMap[o]&&console.warn(`[Resolver] already has key: ${o} overwriting`)}),Array.isArray(s)||(typeof s=="string"?s=jE(s):s=[s]);const n=s.map(o=>{let a=o;if(typeof o=="string"){let l=!1;for(let h=0;h<this._parsers.length;h++){const c=this._parsers[h];if(c.test(o)){a=c.parse(o),l=!0;break}}l||(a={src:o})}return a.format||(a.format=a.src.split(".").pop()),a.alias||(a.alias=r),(this._basePath||this._rootPath)&&(a.src=se.toAbsolute(a.src,this._basePath,this._rootPath)),a.src=this._appendDefaultSearchParams(a.src),a.data=a.data??i,a});r.forEach(o=>{this._assetMap[o]=n})}resolveBundle(t){const s=An(t);t=as(t);const i={};return t.forEach(r=>{const n=this._bundles[r];if(n){const o=this.resolve(n),a={};for(const l in o){const h=o[l];a[this._extractAssetIdFromBundle(r,l)]=h}i[r]=a}}),s?i[t[0]]:i}resolveUrl(t){const s=this.resolve(t);if(typeof t!="string"){const i={};for(const r in s)i[r]=s[r].src;return i}return s.src}resolve(t){const s=An(t);t=as(t);const i={};return t.forEach(r=>{if(!this._resolverHash[r])if(this._assetMap[r]){let n=this._assetMap[r];const o=this._getPreferredOrder(n),a=n[0];o==null||o.priority.forEach(l=>{o.params[l].forEach(h=>{const c=n.filter(u=>u[l]?u[l]===h:!1);c.length&&(n=c)})}),this._resolverHash[r]=n[0]??a}else{let n=r;(this._basePath||this._rootPath)&&(n=se.toAbsolute(n,this._basePath,this._rootPath)),n=this._appendDefaultSearchParams(n),this._resolverHash[r]={src:n}}i[r]=this._resolverHash[r]}),s?i[t[0]]:i}_getPreferredOrder(t){for(let s=0;s<t.length;s++){const i=t[0],r=this._preferredOrder.find(n=>n.params.format.includes(i.format));if(r)return r}return this._preferredOrder[0]}_appendDefaultSearchParams(t){if(!this._defaultSearchParams)return t;const s=/\?/.test(t)?"&":"?";return`${t}${s}${this._defaultSearchParams}`}}class cb{constructor(){this._detections=[],this._initialized=!1,this.resolver=new hb,this.loader=new VE,this.cache=Xi,this._backgroundLoader=new XE(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(t={}){var n,o,a;if(this._initialized){console.warn("[Assets]AssetManager already initialized, did you load before calling this Asset.init()?");return}if(this._initialized=!0,t.defaultSearchParams&&this.resolver.setDefaultSearchParams(t.defaultSearchParams),t.basePath&&(this.resolver.basePath=t.basePath),t.bundleIdentifier&&this.resolver.setBundleIdentifier(t.bundleIdentifier),t.manifest){let l=t.manifest;typeof l=="string"&&(l=await this.load(l)),this.resolver.addManifest(l)}const s=((n=t.texturePreference)==null?void 0:n.resolution)??1,i=typeof s=="number"?[s]:s;let r=[];if((o=t.texturePreference)!=null&&o.format){const l=(a=t.texturePreference)==null?void 0:a.format;r=typeof l=="string"?[l]:l;for(const h of this._detections)await h.test()||(r=await h.remove(r))}else for(const l of this._detections)await l.test()&&(r=await l.add(r));this.resolver.prefer({params:{format:r,resolution:i}})}add(t,s,i){this.resolver.add(t,s,i)}async load(t,s){this._initialized||await this.init();const i=An(t),r=as(t).map(a=>typeof a!="string"?(this.resolver.add(a.src,a),a.src):a),n=this.resolver.resolve(r),o=await this._mapLoadToResolve(n,s);return i?o[r[0]]:o}addBundle(t,s){this.resolver.addBundle(t,s)}async loadBundle(t,s){this._initialized||await this.init();let i=!1;typeof t=="string"&&(i=!0,t=[t]);const r=this.resolver.resolveBundle(t),n={},o=Object.keys(r);let a=0,l=0;const h=()=>{s==null||s(++a/l)},c=o.map(u=>{const d=r[u];return l+=Object.keys(d).length,this._mapLoadToResolve(d,h).then(p=>{n[u]=p})});return await Promise.all(c),i?n[t[0]]:n}async backgroundLoad(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const s=this.resolver.resolve(t);this._backgroundLoader.add(Object.values(s))}async backgroundLoadBundle(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const s=this.resolver.resolveBundle(t);Object.values(s).forEach(i=>{this._backgroundLoader.add(Object.values(i))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(t){if(typeof t=="string")return Xi.get(t);const s={};for(let i=0;i<t.length;i++)s[i]=Xi.get(t[i]);return s}async _mapLoadToResolve(t,s){const i=Object.values(t),r=Object.keys(t);this._backgroundLoader.active=!1;const n=await this.loader.load(i,s);this._backgroundLoader.active=!0;const o={};return i.forEach((a,l)=>{const h=n[a.src],c=[a.src];a.alias&&c.push(...a.alias),o[r[l]]=h,Xi.set(c,h)}),o}async unload(t){this._initialized||await this.init();const s=as(t).map(r=>typeof r!="string"?r.src:r),i=this.resolver.resolve(s);await this._unloadFromResolved(i)}async unloadBundle(t){this._initialized||await this.init(),t=as(t);const s=this.resolver.resolveBundle(t),i=Object.keys(s).map(r=>this._unloadFromResolved(s[r]));await Promise.all(i)}async _unloadFromResolved(t){const s=Object.values(t);s.forEach(i=>{Xi.remove(i.src)}),await this.loader.unload(s)}get detections(){return this._detections}get preferWorkers(){return gr.config.preferWorkers}set preferWorkers(t){gr.config.preferWorkers=t}}const Ki=new cb;rt.handleByList(K.LoadParser,Ki.loader.parsers).handleByList(K.ResolveParser,Ki.resolver.parsers).handleByList(K.CacheParser,Ki.cache.parsers).handleByList(K.DetectionParser,Ki.detections);const ub={extension:K.CacheParser,test:e=>Array.isArray(e)&&e.every(t=>t instanceof J),getCacheableAssets:(e,t)=>{const s={};return e.forEach(i=>{t.forEach((r,n)=>{s[i+(n===0?"":n+1)]=r})}),s}};rt.add(ub);const db={extension:{type:K.DetectionParser,priority:1},test:async()=>{if(!globalThis.createImageBitmap)return!1;const e="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A=",t=await q.ADAPTER.fetch(e).then(s=>s.blob());return createImageBitmap(t).then(()=>!0,()=>!1)},add:async e=>[...e,"avif"],remove:async e=>e.filter(t=>t!=="avif")};rt.add(db);const fb={extension:{type:K.DetectionParser,priority:0},test:async()=>{if(!globalThis.createImageBitmap)return!1;const e="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA=",t=await q.ADAPTER.fetch(e).then(s=>s.blob());return createImageBitmap(t).then(()=>!0,()=>!1)},add:async e=>[...e,"webp"],remove:async e=>e.filter(t=>t!=="webp")};rt.add(fb);const uc=["png","jpg","jpeg"],pb={extension:{type:K.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async e=>[...e,...uc],remove:async e=>e.filter(t=>!uc.includes(t))};rt.add(pb);const mb={extension:K.ResolveParser,test:gr.test,parse:e=>{var t;return{resolution:parseFloat(((t=q.RETINA_PREFIX.exec(e))==null?void 0:t[1])??"1"),format:e.split(".").pop(),src:e}}};rt.add(mb);var pe=(e=>(e[e.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",e[e.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",e[e.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",e[e.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",e[e.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",e[e.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",e[e.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",e[e.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",e[e.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",e[e.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",e[e.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",e[e.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",e[e.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",e[e.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",e[e.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",e[e.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",e[e.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",e[e.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",e[e.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",e))(pe||{});const Cn={[33776]:.5,[33777]:.5,[33778]:1,[33779]:1,[35916]:.5,[35917]:.5,[35918]:1,[35919]:1,[37488]:.5,[37489]:.5,[37490]:1,[37491]:1,[37492]:.5,[37496]:1,[37493]:.5,[37497]:1,[37494]:.5,[37495]:.5,[35840]:.5,[35842]:.5,[35841]:.25,[35843]:.25,[36196]:.5,[35986]:.5,[35986]:1,[34798]:1,[37808]:1};let ss,hi;function dc(){hi={s3tc:ss.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:ss.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:ss.getExtension("WEBGL_compressed_texture_etc"),etc1:ss.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:ss.getExtension("WEBGL_compressed_texture_pvrtc")||ss.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:ss.getExtension("WEBGL_compressed_texture_atc"),astc:ss.getExtension("WEBGL_compressed_texture_astc")}}const gb={extension:{type:K.DetectionParser,priority:2},test:async()=>{const t=q.ADAPTER.createCanvas().getContext("webgl");return t?(ss=t,!0):(console.warn("WebGL not available for compressed textures."),!1)},add:async e=>{hi||dc();const t=[];for(const s in hi)hi[s]&&t.push(s);return[...t,...e]},remove:async e=>(hi||dc(),e.filter(t=>!(t in hi)))};rt.add(gb);class _b extends yr{constructor(t,s={width:1,height:1,autoLoad:!0}){let i,r;typeof t=="string"?(i=t,r=new Uint8Array):(i=null,r=t),super(r,s),this.origin=i,this.buffer=r?new ya(r):null,this.origin&&s.autoLoad!==!1&&this.load(),r!=null&&r.length&&(this.loaded=!0,this.onBlobLoaded(this.buffer.rawBinaryData))}onBlobLoaded(t){}async load(){const i=await(await(await fetch(this.origin)).blob()).arrayBuffer();return this.data=new Uint32Array(i),this.buffer=new ya(i),this.loaded=!0,this.onBlobLoaded(i),this.update(),this}}class zs extends _b{constructor(t,s){super(t,s),this.format=s.format,this.levels=s.levels||1,this._width=s.width,this._height=s.height,this._extension=zs._formatToExtension(this.format),(s.levelBuffers||this.buffer)&&(this._levelBuffers=s.levelBuffers||zs._createLevelBuffers(t instanceof Uint8Array?t:this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height))}upload(t,s,i){const r=t.gl;if(!t.context.extensions[this._extension])throw new Error(`${this._extension} textures are not supported on the current machine`);if(!this._levelBuffers)return!1;for(let o=0,a=this.levels;o<a;o++){const{levelID:l,levelWidth:h,levelHeight:c,levelBuffer:u}=this._levelBuffers[o];r.compressedTexImage2D(r.TEXTURE_2D,l,this.format,h,c,0,u)}return!0}onBlobLoaded(){this._levelBuffers=zs._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)}static _formatToExtension(t){if(t>=33776&&t<=33779)return"s3tc";if(t>=37488&&t<=37497)return"etc";if(t>=35840&&t<=35843)return"pvrtc";if(t>=36196)return"etc1";if(t>=35986&&t<=34798)return"atc";throw new Error("Invalid (compressed) texture format given!")}static _createLevelBuffers(t,s,i,r,n,o,a){const l=new Array(i);let h=t.byteOffset,c=o,u=a,d=c+r-1&~(r-1),p=u+n-1&~(n-1),f=d*p*Cn[s];for(let m=0;m<i;m++)l[m]={levelID:m,levelWidth:i>1?c:d,levelHeight:i>1?u:p,levelBuffer:new Uint8Array(t.buffer,h,f)},h+=f,c=c>>1||1,u=u>>1||1,d=c+r-1&~(r-1),p=u+n-1&~(n-1),f=d*p*Cn[s];return l}}const Lo=4,$r=124,xb=32,fc=20,vb=542327876,Xr={SIZE:1,FLAGS:2,HEIGHT:3,WIDTH:4,MIPMAP_COUNT:7,PIXEL_FORMAT:19},yb={SIZE:0,FLAGS:1,FOURCC:2,RGB_BITCOUNT:3,R_BIT_MASK:4,G_BIT_MASK:5,B_BIT_MASK:6,A_BIT_MASK:7},jr={DXGI_FORMAT:0,RESOURCE_DIMENSION:1,MISC_FLAG:2,ARRAY_SIZE:3,MISC_FLAGS2:4},Eb=1,bb=2,Tb=4,wb=64,Sb=512,Ab=131072,Cb=827611204,Ib=861165636,Rb=894720068,Pb=808540228,Mb=4,Ob={[Cb]:pe.COMPRESSED_RGBA_S3TC_DXT1_EXT,[Ib]:pe.COMPRESSED_RGBA_S3TC_DXT3_EXT,[Rb]:pe.COMPRESSED_RGBA_S3TC_DXT5_EXT},Bb={[70]:pe.COMPRESSED_RGBA_S3TC_DXT1_EXT,[71]:pe.COMPRESSED_RGBA_S3TC_DXT1_EXT,[73]:pe.COMPRESSED_RGBA_S3TC_DXT3_EXT,[74]:pe.COMPRESSED_RGBA_S3TC_DXT3_EXT,[76]:pe.COMPRESSED_RGBA_S3TC_DXT5_EXT,[77]:pe.COMPRESSED_RGBA_S3TC_DXT5_EXT,[72]:pe.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,[75]:pe.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,[78]:pe.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT};function Db(e){const t=new Uint32Array(e);if(t[0]!==vb)throw new Error("Invalid DDS file magic word");const i=new Uint32Array(e,0,$r/Uint32Array.BYTES_PER_ELEMENT),r=i[Xr.HEIGHT],n=i[Xr.WIDTH],o=i[Xr.MIPMAP_COUNT],a=new Uint32Array(e,Xr.PIXEL_FORMAT*Uint32Array.BYTES_PER_ELEMENT,xb/Uint32Array.BYTES_PER_ELEMENT),l=a[Eb];if(l&Tb){const h=a[yb.FOURCC];if(h!==Pb){const g=Ob[h],b=Lo+$r,S=new Uint8Array(e,b);return[new zs(S,{format:g,width:n,height:r,levels:o})]}const c=Lo+$r,u=new Uint32Array(t.buffer,c,fc/Uint32Array.BYTES_PER_ELEMENT),d=u[jr.DXGI_FORMAT],p=u[jr.RESOURCE_DIMENSION],f=u[jr.MISC_FLAG],m=u[jr.ARRAY_SIZE],_=Bb[d];if(_===void 0)throw new Error(`DDSParser cannot parse texture data with DXGI format ${d}`);if(f===Mb)throw new Error("DDSParser does not support cubemap textures");if(p===6)throw new Error("DDSParser does not supported 3D texture data");const v=new Array,T=Lo+$r+fc;if(m===1)v.push(new Uint8Array(e,T));else{const g=Cn[_];let b=0,S=n,A=r;for(let E=0;E<o;E++){const I=Math.max(1,S+3&-4),F=Math.max(1,A+3&-4),L=I*F*g;b+=L,S=S>>>1,A=A>>>1}let y=T;for(let E=0;E<m;E++)v.push(new Uint8Array(e,y,b)),y+=b}return v.map(g=>new zs(g,{format:_,width:n,height:r,levels:o}))}throw l&wb?new Error("DDSParser does not support uncompressed texture data."):l&Sb?new Error("DDSParser does not supported YUV uncompressed texture data."):l&Ab?new Error("DDSParser does not support single-channel (lumninance) texture data!"):l&bb?new Error("DDSParser does not support single-channel (alpha) texture data!"):new Error("DDSParser failed to load a texture file due to an unknown reason!")}const pc=[171,75,84,88,32,49,49,187,13,10,26,10],Fb=67305985,Se={FILE_IDENTIFIER:0,ENDIANNESS:12,GL_TYPE:16,GL_TYPE_SIZE:20,GL_FORMAT:24,GL_INTERNAL_FORMAT:28,GL_BASE_INTERNAL_FORMAT:32,PIXEL_WIDTH:36,PIXEL_HEIGHT:40,PIXEL_DEPTH:44,NUMBER_OF_ARRAY_ELEMENTS:48,NUMBER_OF_FACES:52,NUMBER_OF_MIPMAP_LEVELS:56,BYTES_OF_KEY_VALUE_DATA:60},Da=64,mc={[lt.UNSIGNED_BYTE]:1,[lt.UNSIGNED_SHORT]:2,[lt.INT]:4,[lt.UNSIGNED_INT]:4,[lt.FLOAT]:4,[lt.HALF_FLOAT]:8},Lb={[X.RGBA]:4,[X.RGB]:3,[X.RG]:2,[X.RED]:1,[X.LUMINANCE]:1,[X.LUMINANCE_ALPHA]:2,[X.ALPHA]:1},Nb={[lt.UNSIGNED_SHORT_4_4_4_4]:2,[lt.UNSIGNED_SHORT_5_5_5_1]:2,[lt.UNSIGNED_SHORT_5_6_5]:2};function Ub(e,t,s=!1){const i=new DataView(t);if(!kb(e,i))return null;const r=i.getUint32(Se.ENDIANNESS,!0)===Fb,n=i.getUint32(Se.GL_TYPE,r),o=i.getUint32(Se.GL_FORMAT,r),a=i.getUint32(Se.GL_INTERNAL_FORMAT,r),l=i.getUint32(Se.PIXEL_WIDTH,r),h=i.getUint32(Se.PIXEL_HEIGHT,r)||1,c=i.getUint32(Se.PIXEL_DEPTH,r)||1,u=i.getUint32(Se.NUMBER_OF_ARRAY_ELEMENTS,r)||1,d=i.getUint32(Se.NUMBER_OF_FACES,r),p=i.getUint32(Se.NUMBER_OF_MIPMAP_LEVELS,r),f=i.getUint32(Se.BYTES_OF_KEY_VALUE_DATA,r);if(h===0||c!==1)throw new Error("Only 2D textures are supported");if(d!==1)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(u!==1)throw new Error("WebGL does not support array textures");const m=4,_=4,v=l+3&-4,T=h+3&-4,g=new Array(u);let b=l*h;n===0&&(b=v*T);let S;if(n!==0?mc[n]?S=mc[n]*Lb[o]:S=Nb[n]:S=Cn[a],S===void 0)throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");const A=s?Hb(i,f,r):null;let E=b*S,I=l,F=h,L=v,j=T,D=Da+f;for(let P=0;P<p;P++){const ut=i.getUint32(D,r);let nt=D+4;for(let G=0;G<u;G++){let st=g[G];st||(st=g[G]=new Array(p)),st[P]={levelID:P,levelWidth:p>1||n!==0?I:L,levelHeight:p>1||n!==0?F:j,levelBuffer:new Uint8Array(t,nt,E)},nt+=E}D+=ut+4,D=D%4!==0?D+4-D%4:D,I=I>>1||1,F=F>>1||1,L=I+m-1&~(m-1),j=F+_-1&~(_-1),E=L*j*S}return n!==0?{uncompressed:g.map(P=>{let ut=P[0].levelBuffer,nt=!1;return n===lt.FLOAT?ut=new Float32Array(P[0].levelBuffer.buffer,P[0].levelBuffer.byteOffset,P[0].levelBuffer.byteLength/4):n===lt.UNSIGNED_INT?(nt=!0,ut=new Uint32Array(P[0].levelBuffer.buffer,P[0].levelBuffer.byteOffset,P[0].levelBuffer.byteLength/4)):n===lt.INT&&(nt=!0,ut=new Int32Array(P[0].levelBuffer.buffer,P[0].levelBuffer.byteOffset,P[0].levelBuffer.byteLength/4)),{resource:new yr(ut,{width:P[0].levelWidth,height:P[0].levelHeight}),type:n,format:nt?Gb(o):o}}),kvData:A}:{compressed:g.map(P=>new zs(null,{format:a,width:l,height:h,levels:p,levelBuffers:P})),kvData:A}}function kb(e,t){for(let s=0;s<pc.length;s++)if(t.getUint8(s)!==pc[s])return console.error(`${e} is not a valid *.ktx file!`),!1;return!0}function Gb(e){switch(e){case X.RGBA:return X.RGBA_INTEGER;case X.RGB:return X.RGB_INTEGER;case X.RG:return X.RG_INTEGER;case X.RED:return X.RED_INTEGER;default:return e}}function Hb(e,t,s){const i=new Map;let r=0;for(;r<t;){const n=e.getUint32(Da+r,s),o=Da+r+4,a=3-(n+3)%4;if(n===0||n>t-r){console.error("KTXLoader: keyAndValueByteSize out of bounds");break}let l=0;for(;l<n&&e.getUint8(o+l)!==0;l++);if(l===-1){console.error("KTXLoader: Failed to find null byte terminating kvData key");break}const h=new TextDecoder().decode(new Uint8Array(e.buffer,o,l)),c=new DataView(e.buffer,o+l+1,n-l-1);i.set(h,c),r+=4+n+a}return i}const Wb={extension:{type:K.LoadParser,priority:ts.High},test(e){return Jn(e,".dds")},async load(e,t,s){const r=await(await q.ADAPTER.fetch(e)).arrayBuffer(),o=Db(r).map(a=>{const l=new pt(a,{mipmap:Je.OFF,alphaMode:Ne.NO_PREMULTIPLIED_ALPHA,resolution:As(e),...t.data});return Qn(l,s,e)});return o.length===1?o[0]:o},unload(e){Array.isArray(e)?e.forEach(t=>t.destroy(!0)):e.destroy(!0)}};rt.add(Wb);const $b={extension:{type:K.LoadParser,priority:ts.High},test(e){return Jn(e,".ktx")},async load(e,t,s){const r=await(await q.ADAPTER.fetch(e)).arrayBuffer(),{compressed:n,uncompressed:o,kvData:a}=Ub(e,r),l=n??o,h={mipmap:Je.OFF,alphaMode:Ne.NO_PREMULTIPLIED_ALPHA,resolution:As(e),...t.data},c=l.map(u=>{l===o&&Object.assign(h,{type:u.type,format:u.format});const d=new pt(u,h);return d.ktxKeyValueData=a,Qn(d,s,e)});return c.length===1?c[0]:c},unload(e){Array.isArray(e)?e.forEach(t=>t.destroy(!0)):e.destroy(!0)}};rt.add($b);const Xb={extension:K.ResolveParser,test:e=>{const s=e.split("?")[0].split(".").pop();return["basis","ktx","dds"].includes(s)},parse:e=>{var i,r;if(e.split("?")[0].split(".").pop()==="ktx"){const n=[".s3tc.ktx",".s3tc_sRGB.ktx",".etc.ktx",".etc1.ktx",".pvrt.ktx",".atc.ktx",".astc.ktx"];if(n.some(o=>e.endsWith(o)))return{resolution:parseFloat(((i=q.RETINA_PREFIX.exec(e))==null?void 0:i[1])??"1"),format:n.find(o=>e.endsWith(o)),src:e}}return{resolution:parseFloat(((r=q.RETINA_PREFIX.exec(e))==null?void 0:r[1])??"1"),format:e.split(".").pop(),src:e}}};rt.add(Xb);const gc=new yt,_c=4,Fa=class{constructor(e){this.renderer=e}async image(e,t,s){const i=new Image;return i.src=await this.base64(e,t,s),i}async base64(e,t,s){const i=this.canvas(e);if(i.toDataURL!==void 0)return i.toDataURL(t,s);if(i.convertToBlob!==void 0){const r=await i.convertToBlob({type:t,quality:s});return await new Promise(n=>{const o=new FileReader;o.onload=()=>n(o.result),o.readAsDataURL(r)})}throw new Error("Extract.base64() requires ICanvas.toDataURL or ICanvas.convertToBlob to be implemented")}canvas(e,t){const s=this.renderer;let i,r=!1,n,o=!1;e&&(e instanceof Rs?n=e:(n=this.renderer.generateTexture(e),o=!0)),n?(i=n.baseTexture.resolution,t=t??n.frame,r=!1,s.renderTexture.bind(n)):(i=s.resolution,t||(t=gc,t.width=s.width,t.height=s.height),r=!0,s.renderTexture.bind(null));const a=Math.round(t.width*i),l=Math.round(t.height*i);let h=new jh(a,l,1);const c=new Uint8Array(_c*a*l),u=s.gl;u.readPixels(Math.round(t.x*i),Math.round(t.y*i),a,l,u.RGBA,u.UNSIGNED_BYTE,c);const d=h.context.getImageData(0,0,a,l);if(Fa.arrayPostDivide(c,d.data),h.context.putImageData(d,0,0),r){const p=new jh(h.width,h.height,1);p.context.scale(1,-1),p.context.drawImage(h.canvas,0,-l),h.destroy(),h=p}return o&&n.destroy(!0),h.canvas}pixels(e,t){const s=this.renderer;let i,r,n=!1;e&&(e instanceof Rs?r=e:(r=this.renderer.generateTexture(e),n=!0)),r?(i=r.baseTexture.resolution,t=t??r.frame,s.renderTexture.bind(r)):(i=s.resolution,t||(t=gc,t.width=s.width,t.height=s.height),s.renderTexture.bind(null));const o=Math.round(t.width*i),a=Math.round(t.height*i),l=new Uint8Array(_c*o*a),h=s.gl;return h.readPixels(Math.round(t.x*i),Math.round(t.y*i),o,a,h.RGBA,h.UNSIGNED_BYTE,l),n&&r.destroy(!0),Fa.arrayPostDivide(l,l),l}destroy(){this.renderer=null}static arrayPostDivide(e,t){for(let s=0;s<e.length;s+=4){const i=t[s+3]=e[s+3];i!==0?(t[s]=Math.round(Math.min(e[s]*255/i,255)),t[s+1]=Math.round(Math.min(e[s+1]*255/i,255)),t[s+2]=Math.round(Math.min(e[s+2]*255/i,255))):(t[s]=e[s],t[s+1]=e[s+1],t[s+2]=e[s+2])}}};let nf=Fa;nf.extension={name:"extract",type:K.RendererSystem};rt.add(nf);const In={build(e){const t=e.points;let s,i,r,n,o,a;if(e.type===te.CIRC){const f=e.shape;s=f.x,i=f.y,o=a=f.radius,r=n=0}else if(e.type===te.ELIP){const f=e.shape;s=f.x,i=f.y,o=f.width,a=f.height,r=n=0}else{const f=e.shape,m=f.width/2,_=f.height/2;s=f.x+m,i=f.y+_,o=a=Math.max(0,Math.min(f.radius,Math.min(m,_))),r=m-o,n=_-a}if(!(o>=0&&a>=0&&r>=0&&n>=0)){t.length=0;return}const l=Math.ceil(2.3*Math.sqrt(o+a)),h=l*8+(r?4:0)+(n?4:0);if(t.length=h,h===0)return;if(l===0){t.length=8,t[0]=t[6]=s+r,t[1]=t[3]=i+n,t[2]=t[4]=s-r,t[5]=t[7]=i-n;return}let c=0,u=l*4+(r?2:0)+2,d=u,p=h;{const f=r+o,m=n,_=s+f,v=s-f,T=i+m;if(t[c++]=_,t[c++]=T,t[--u]=T,t[--u]=v,n){const g=i-m;t[d++]=v,t[d++]=g,t[--p]=g,t[--p]=_}}for(let f=1;f<l;f++){const m=Math.PI/2*(f/l),_=r+Math.cos(m)*o,v=n+Math.sin(m)*a,T=s+_,g=s-_,b=i+v,S=i-v;t[c++]=T,t[c++]=b,t[--u]=b,t[--u]=g,t[d++]=g,t[d++]=S,t[--p]=S,t[--p]=T}{const f=r,m=n+a,_=s+f,v=s-f,T=i+m,g=i-m;t[c++]=_,t[c++]=T,t[--p]=g,t[--p]=_,r&&(t[c++]=v,t[c++]=T,t[--p]=g,t[--p]=v)}},triangulate(e,t){const s=e.points,i=t.points,r=t.indices;if(s.length===0)return;let n=i.length/2;const o=n;let a,l;if(e.type!==te.RREC){const c=e.shape;a=c.x,l=c.y}else{const c=e.shape;a=c.x+c.width/2,l=c.y+c.height/2}const h=e.matrix;i.push(e.matrix?h.a*a+h.c*l+h.tx:a,e.matrix?h.b*a+h.d*l+h.ty:l),n++,i.push(s[0],s[1]);for(let c=2;c<s.length;c+=2)i.push(s[c],s[c+1]),r.push(n++,o,n);r.push(o+1,o,n)}};function xc(e,t=!1){const s=e.length;if(s<6)return;let i=0;for(let r=0,n=e[s-2],o=e[s-1];r<s;r+=2){const a=e[r],l=e[r+1];i+=(a-n)*(l+o),n=a,o=l}if(!t&&i>0||t&&i<=0){const r=s/2;for(let n=r+r%2;n<s;n+=2){const o=s-n-2,a=s-n-1,l=n,h=n+1;[e[o],e[l]]=[e[l],e[o]],[e[a],e[h]]=[e[h],e[a]]}}}const of={build(e){e.points=e.shape.points.slice()},triangulate(e,t){let s=e.points;const i=e.holes,r=t.points,n=t.indices;if(s.length>=6){xc(s,!1);const o=[];for(let h=0;h<i.length;h++){const c=i[h];xc(c.points,!0),o.push(s.length/2),s=s.concat(c.points)}const a=vn(s,o,2);if(!a)return;const l=r.length/2;for(let h=0;h<a.length;h+=3)n.push(a[h]+l),n.push(a[h+1]+l),n.push(a[h+2]+l);for(let h=0;h<s.length;h++)r.push(s[h])}}},jb={build(e){const t=e.shape,s=t.x,i=t.y,r=t.width,n=t.height,o=e.points;o.length=0,r>=0&&n>=0&&o.push(s,i,s+r,i,s+r,i+n,s,i+n)},triangulate(e,t){const s=e.points,i=t.points;if(s.length===0)return;const r=i.length/2;i.push(s[0],s[1],s[2],s[3],s[6],s[7],s[4],s[5]),t.indices.push(r,r+1,r+2,r+1,r+2,r+3)}},zb={build(e){In.build(e)},triangulate(e,t){In.triangulate(e,t)}};var xs=(e=>(e.MITER="miter",e.BEVEL="bevel",e.ROUND="round",e))(xs||{}),$s=(e=>(e.BUTT="butt",e.ROUND="round",e.SQUARE="square",e))($s||{});const Ii={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount(e,t=20){if(!this.adaptive||!e||isNaN(e))return t;let s=Math.ceil(e/this.maxLength);return s<this.minSegments?s=this.minSegments:s>this.maxSegments&&(s=this.maxSegments),s}};class vc{static curveTo(t,s,i,r,n,o){const a=o[o.length-2],h=o[o.length-1]-s,c=a-t,u=r-s,d=i-t,p=Math.abs(h*d-c*u);if(p<1e-8||n===0)return(o[o.length-2]!==t||o[o.length-1]!==s)&&o.push(t,s),null;const f=h*h+c*c,m=u*u+d*d,_=h*u+c*d,v=n*Math.sqrt(f)/p,T=n*Math.sqrt(m)/p,g=v*_/f,b=T*_/m,S=v*d+T*c,A=v*u+T*h,y=c*(T+g),E=h*(T+g),I=d*(v+b),F=u*(v+b),L=Math.atan2(E-A,y-S),j=Math.atan2(F-A,I-S);return{cx:S+t,cy:A+s,radius:n,startAngle:L,endAngle:j,anticlockwise:c*u>d*h}}static arc(t,s,i,r,n,o,a,l,h){const c=a-o,u=Ii._segmentsCount(Math.abs(c)*n,Math.ceil(Math.abs(c)/Tn)*40),d=c/(u*2),p=d*2,f=Math.cos(d),m=Math.sin(d),_=u-1,v=_%1/_;for(let T=0;T<=_;++T){const g=T+v*T,b=d+o+p*g,S=Math.cos(b),A=-Math.sin(b);h.push((f*S+m*A)*n+i,(f*-A+m*S)*n+r)}}}class Vb{constructor(){this.reset()}begin(t,s,i){this.reset(),this.style=t,this.start=s,this.attribStart=i}end(t,s){this.attribSize=s-this.attribStart,this.size=t-this.start}reset(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0}}class Tl{static curveLength(t,s,i,r,n,o,a,l){let c=0,u=0,d=0,p=0,f=0,m=0,_=0,v=0,T=0,g=0,b=0,S=t,A=s;for(let y=1;y<=10;++y)u=y/10,d=u*u,p=d*u,f=1-u,m=f*f,_=m*f,v=_*t+3*m*u*i+3*f*d*n+p*a,T=_*s+3*m*u*r+3*f*d*o+p*l,g=S-v,b=A-T,S=v,A=T,c+=Math.sqrt(g*g+b*b);return c}static curveTo(t,s,i,r,n,o,a){const l=a[a.length-2],h=a[a.length-1];a.length-=2;const c=Ii._segmentsCount(Tl.curveLength(l,h,t,s,i,r,n,o));let u=0,d=0,p=0,f=0,m=0;a.push(l,h);for(let _=1,v=0;_<=c;++_)v=_/c,u=1-v,d=u*u,p=d*u,f=v*v,m=f*v,a.push(p*l+3*d*v*t+3*u*f*i+m*n,p*h+3*d*v*s+3*u*f*r+m*o)}}function yc(e,t,s,i,r,n,o,a){const l=e-s*r,h=t-i*r,c=e+s*n,u=t+i*n;let d,p;o?(d=i,p=-s):(d=-i,p=s);const f=l+d,m=h+p,_=c+d,v=u+p;return a.push(f,m),a.push(_,v),2}function Bs(e,t,s,i,r,n,o,a){const l=s-e,h=i-t;let c=Math.atan2(l,h),u=Math.atan2(r-e,n-t);a&&c<u?c+=Math.PI*2:!a&&c>u&&(u+=Math.PI*2);let d=c;const p=u-c,f=Math.abs(p),m=Math.sqrt(l*l+h*h),_=(15*f*Math.sqrt(m)/Math.PI>>0)+1,v=p/_;if(d+=v,a){o.push(e,t),o.push(s,i);for(let T=1,g=d;T<_;T++,g+=v)o.push(e,t),o.push(e+Math.sin(g)*m,t+Math.cos(g)*m);o.push(e,t),o.push(r,n)}else{o.push(s,i),o.push(e,t);for(let T=1,g=d;T<_;T++,g+=v)o.push(e+Math.sin(g)*m,t+Math.cos(g)*m),o.push(e,t);o.push(r,n),o.push(e,t)}return _*2}function Yb(e,t){const s=e.shape;let i=e.points||s.points.slice();const r=t.closePointEps;if(i.length===0)return;const n=e.lineStyle,o=new Tt(i[0],i[1]),a=new Tt(i[i.length-2],i[i.length-1]),l=s.type!==te.POLY||s.closeStroke,h=Math.abs(o.x-a.x)<r&&Math.abs(o.y-a.y)<r;if(l){i=i.slice(),h&&(i.pop(),i.pop(),a.set(i[i.length-2],i[i.length-1]));const G=(o.x+a.x)*.5,st=(a.y+o.y)*.5;i.unshift(G,st),i.push(G,st)}const c=t.points,u=i.length/2;let d=i.length;const p=c.length/2,f=n.width/2,m=f*f,_=n.miterLimit*n.miterLimit;let v=i[0],T=i[1],g=i[2],b=i[3],S=0,A=0,y=-(T-b),E=v-g,I=0,F=0,L=Math.sqrt(y*y+E*E);y/=L,E/=L,y*=f,E*=f;const j=n.alignment,D=(1-j)*2,P=j*2;l||(n.cap===$s.ROUND?d+=Bs(v-y*(D-P)*.5,T-E*(D-P)*.5,v-y*D,T-E*D,v+y*P,T+E*P,c,!0)+2:n.cap===$s.SQUARE&&(d+=yc(v,T,y,E,D,P,!0,c))),c.push(v-y*D,T-E*D),c.push(v+y*P,T+E*P);for(let G=1;G<u-1;++G){v=i[(G-1)*2],T=i[(G-1)*2+1],g=i[G*2],b=i[G*2+1],S=i[(G+1)*2],A=i[(G+1)*2+1],y=-(T-b),E=v-g,L=Math.sqrt(y*y+E*E),y/=L,E/=L,y*=f,E*=f,I=-(b-A),F=g-S,L=Math.sqrt(I*I+F*F),I/=L,F/=L,I*=f,F*=f;const st=g-v,At=T-b,N=g-S,U=A-b,Y=st*N+At*U,it=At*N-U*st,Q=it<0;if(Math.abs(it)<.001*Math.abs(Y)){c.push(g-y*D,b-E*D),c.push(g+y*P,b+E*P),Y>=0&&(n.join===xs.ROUND?d+=Bs(g,b,g-y*D,b-E*D,g-I*D,b-F*D,c,!1)+4:d+=2,c.push(g-I*P,b-F*P),c.push(g+I*D,b+F*D));continue}const dt=(-y+v)*(-E+b)-(-y+g)*(-E+T),_t=(-I+S)*(-F+b)-(-I+g)*(-F+A),ht=(st*_t-N*dt)/it,xt=(U*dt-At*_t)/it,Bt=(ht-g)*(ht-g)+(xt-b)*(xt-b),Rt=g+(ht-g)*D,Pt=b+(xt-b)*D,x=g-(ht-g)*P,w=b-(xt-b)*P,C=Math.min(st*st+At*At,N*N+U*U),M=Q?D:P,B=C+M*M*m;Bt<=B?n.join===xs.BEVEL||Bt/m>_?(Q?(c.push(Rt,Pt),c.push(g+y*P,b+E*P),c.push(Rt,Pt),c.push(g+I*P,b+F*P)):(c.push(g-y*D,b-E*D),c.push(x,w),c.push(g-I*D,b-F*D),c.push(x,w)),d+=2):n.join===xs.ROUND?Q?(c.push(Rt,Pt),c.push(g+y*P,b+E*P),d+=Bs(g,b,g+y*P,b+E*P,g+I*P,b+F*P,c,!0)+4,c.push(Rt,Pt),c.push(g+I*P,b+F*P)):(c.push(g-y*D,b-E*D),c.push(x,w),d+=Bs(g,b,g-y*D,b-E*D,g-I*D,b-F*D,c,!1)+4,c.push(g-I*D,b-F*D),c.push(x,w)):(c.push(Rt,Pt),c.push(x,w)):(c.push(g-y*D,b-E*D),c.push(g+y*P,b+E*P),n.join===xs.ROUND?Q?d+=Bs(g,b,g+y*P,b+E*P,g+I*P,b+F*P,c,!0)+2:d+=Bs(g,b,g-y*D,b-E*D,g-I*D,b-F*D,c,!1)+2:n.join===xs.MITER&&Bt/m<=_&&(Q?(c.push(x,w),c.push(x,w)):(c.push(Rt,Pt),c.push(Rt,Pt)),d+=2),c.push(g-I*D,b-F*D),c.push(g+I*P,b+F*P),d+=2)}v=i[(u-2)*2],T=i[(u-2)*2+1],g=i[(u-1)*2],b=i[(u-1)*2+1],y=-(T-b),E=v-g,L=Math.sqrt(y*y+E*E),y/=L,E/=L,y*=f,E*=f,c.push(g-y*D,b-E*D),c.push(g+y*P,b+E*P),l||(n.cap===$s.ROUND?d+=Bs(g-y*(D-P)*.5,b-E*(D-P)*.5,g-y*D,b-E*D,g+y*P,b+E*P,c,!1)+2:n.cap===$s.SQUARE&&(d+=yc(g,b,y,E,D,P,!1,c)));const ut=t.indices,nt=Ii.epsilon*Ii.epsilon;for(let G=p;G<d+p-2;++G)v=c[G*2],T=c[G*2+1],g=c[(G+1)*2],b=c[(G+1)*2+1],S=c[(G+2)*2],A=c[(G+2)*2+1],!(Math.abs(v*(b-A)+g*(A-T)+S*(T-b))<nt)&&ut.push(G,G+1,G+2)}function Kb(e,t){let s=0;const i=e.shape,r=e.points||i.points,n=i.type!==te.POLY||i.closeStroke;if(r.length===0)return;const o=t.points,a=t.indices,l=r.length/2,h=o.length/2;let c=h;for(o.push(r[0],r[1]),s=1;s<l;s++)o.push(r[s*2],r[s*2+1]),a.push(c,c+1),c++;n&&a.push(c,h)}function Ec(e,t){e.lineStyle.native?Kb(e,t):Yb(e,t)}class wl{static curveLength(t,s,i,r,n,o){const a=t-2*i+n,l=s-2*r+o,h=2*i-2*t,c=2*r-2*s,u=4*(a*a+l*l),d=4*(a*h+l*c),p=h*h+c*c,f=2*Math.sqrt(u+d+p),m=Math.sqrt(u),_=2*u*m,v=2*Math.sqrt(p),T=d/m;return(_*f+m*d*(f-v)+(4*p*u-d*d)*Math.log((2*m+T+f)/(T+v)))/(4*_)}static curveTo(t,s,i,r,n){const o=n[n.length-2],a=n[n.length-1],l=Ii._segmentsCount(wl.curveLength(o,a,t,s,i,r));let h=0,c=0;for(let u=1;u<=l;++u){const d=u/l;h=o+(t-o)*d,c=a+(s-a)*d,n.push(h+(t+(i-t)*d-h)*d,c+(s+(r-s)*d-c)*d)}}}const No={[te.POLY]:of,[te.CIRC]:In,[te.ELIP]:In,[te.RECT]:jb,[te.RREC]:zb},bc=[],zr=[];class Rn{constructor(t,s=null,i=null,r=null){this.points=[],this.holes=[],this.shape=t,this.lineStyle=i,this.fillStyle=s,this.matrix=r,this.type=t.type}clone(){return new Rn(this.shape,this.fillStyle,this.lineStyle,this.matrix)}destroy(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null}}const ni=new Tt,af=class extends cd{constructor(){super(),this.closePointEps=1e-4,this.boundsPadding=0,this.uvsFloat32=null,this.indicesUint16=null,this.batchable=!1,this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.drawCalls=[],this.batchDirty=-1,this.batches=[],this.dirty=0,this.cacheDirty=-1,this.clearDirty=0,this.shapeIndex=0,this._bounds=new wn,this.boundsDirty=-1}get bounds(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds}invalidate(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(let e=0;e<this.drawCalls.length;e++)this.drawCalls[e].texArray.clear(),zr.push(this.drawCalls[e]);this.drawCalls.length=0;for(let e=0;e<this.batches.length;e++){const t=this.batches[e];t.reset(),bc.push(t)}this.batches.length=0}clear(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this}drawShape(e,t=null,s=null,i=null){const r=new Rn(e,t,s,i);return this.graphicsData.push(r),this.dirty++,this}drawHole(e,t=null){if(!this.graphicsData.length)return null;const s=new Rn(e,null,null,t),i=this.graphicsData[this.graphicsData.length-1];return s.lineStyle=i.lineStyle,i.holes.push(s),this.dirty++,this}destroy(){super.destroy();for(let e=0;e<this.graphicsData.length;++e)this.graphicsData[e].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null}containsPoint(e){const t=this.graphicsData;for(let s=0;s<t.length;++s){const i=t[s];if(i.fillStyle.visible&&i.shape&&(i.matrix?i.matrix.applyInverse(e,ni):ni.copyFrom(e),i.shape.contains(ni.x,ni.y))){let r=!1;if(i.holes){for(let n=0;n<i.holes.length;n++)if(i.holes[n].shape.contains(ni.x,ni.y)){r=!0;break}}if(!r)return!0}}return!1}updateBatches(){if(!this.graphicsData.length){this.batchable=!0;return}if(!this.validateBatching())return;this.cacheDirty=this.dirty;const e=this.uvs,t=this.graphicsData;let s=null,i=null;this.batches.length>0&&(s=this.batches[this.batches.length-1],i=s.style);for(let a=this.shapeIndex;a<t.length;a++){this.shapeIndex++;const l=t[a],h=l.fillStyle,c=l.lineStyle;No[l.type].build(l),l.matrix&&this.transformPoints(l.points,l.matrix),(h.visible||c.visible)&&this.processHoles(l.holes);for(let d=0;d<2;d++){const p=d===0?h:c;if(!p.visible)continue;const f=p.texture.baseTexture,m=this.indices.length,_=this.points.length/2;f.wrapMode=Ts.REPEAT,d===0?this.processFill(l):this.processLine(l);const v=this.points.length/2-_;v!==0&&(s&&!this._compareStyles(i,p)&&(s.end(m,_),s=null),s||(s=bc.pop()||new Vb,s.begin(p,m,_),this.batches.push(s),i=p),this.addUvs(this.points,e,p.texture,_,v,p.matrix))}}const r=this.indices.length,n=this.points.length/2;if(s&&s.end(r,n),this.batches.length===0){this.batchable=!0;return}const o=n>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&o===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=o?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}_compareStyles(e,t){return!(!e||!t||e.texture.baseTexture!==t.texture.baseTexture||e.color+e.alpha!==t.color+t.alpha||!!e.native!=!!t.native)}validateBatching(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(let e=0,t=this.graphicsData.length;e<t;e++){const s=this.graphicsData[e],i=s.fillStyle,r=s.lineStyle;if(i&&!i.texture.baseTexture.valid||r&&!r.texture.baseTexture.valid)return!1}return!0}packBatches(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);const e=this.batches;for(let t=0,s=e.length;t<s;t++){const i=e[t];for(let r=0;r<i.size;r++){const n=i.start+r;this.indicesUint16[n]=this.indicesUint16[n]-i.attribStart}}}isBatchable(){if(this.points.length>65535*2)return!1;const e=this.batches;for(let t=0;t<e.length;t++)if(e[t].style.native)return!1;return this.points.length<af.BATCHABLE_SIZE*2}buildDrawCalls(){let e=++pt._globalBatch;for(let c=0;c<this.drawCalls.length;c++)this.drawCalls[c].texArray.clear(),zr.push(this.drawCalls[c]);this.drawCalls.length=0;const t=this.colors,s=this.textureIds;let i=zr.pop();i||(i=new ba,i.texArray=new wa),i.texArray.count=0,i.start=0,i.size=0,i.type=Ve.TRIANGLES;let r=0,n=null,o=0,a=!1,l=Ve.TRIANGLES,h=0;this.drawCalls.push(i);for(let c=0;c<this.batches.length;c++){const u=this.batches[c],d=8,p=u.style,f=p.texture.baseTexture;a!==!!p.native&&(a=!!p.native,l=a?Ve.LINES:Ve.TRIANGLES,n=null,r=d,e++),n!==f&&(n=f,f._batchEnabled!==e&&(r===d&&(e++,r=0,i.size>0&&(i=zr.pop(),i||(i=new ba,i.texArray=new wa),this.drawCalls.push(i)),i.start=h,i.size=0,i.texArray.count=0,i.type=l),f.touched=1,f._batchEnabled=e,f._batchLocation=r,f.wrapMode=Ts.REPEAT,i.texArray.elements[i.texArray.count++]=f,r++)),i.size+=u.size,h+=u.size,o=f._batchLocation,this.addColors(t,p.color,p.alpha,u.attribSize,u.attribStart),this.addTextureIds(s,o,u.attribSize,u.attribStart)}pt._globalBatch=e,this.packAttributes()}packAttributes(){const e=this.points,t=this.uvs,s=this.colors,i=this.textureIds,r=new ArrayBuffer(e.length*3*4),n=new Float32Array(r),o=new Uint32Array(r);let a=0;for(let l=0;l<e.length/2;l++)n[a++]=e[l*2],n[a++]=e[l*2+1],n[a++]=t[l*2],n[a++]=t[l*2+1],o[a++]=s[l],n[a++]=i[l];this._buffer.update(r),this._indexBuffer.update(this.indicesUint16)}processFill(e){e.holes.length?of.triangulate(e,this):No[e.type].triangulate(e,this)}processLine(e){Ec(e,this);for(let t=0;t<e.holes.length;t++)Ec(e.holes[t],this)}processHoles(e){for(let t=0;t<e.length;t++){const s=e[t];No[s.type].build(s),s.matrix&&this.transformPoints(s.points,s.matrix)}}calculateBounds(){const e=this._bounds;e.clear(),e.addVertexData(this.points,0,this.points.length),e.pad(this.boundsPadding,this.boundsPadding)}transformPoints(e,t){for(let s=0;s<e.length/2;s++){const i=e[s*2],r=e[s*2+1];e[s*2]=t.a*i+t.c*r+t.tx,e[s*2+1]=t.b*i+t.d*r+t.ty}}addColors(e,t,s,i,r=0){const n=(t>>16)+(t&65280)+((t&255)<<16),o=gl(n,s);e.length=Math.max(e.length,r+i);for(let a=0;a<i;a++)e[r+a]=o}addTextureIds(e,t,s,i=0){e.length=Math.max(e.length,i+s);for(let r=0;r<s;r++)e[i+r]=t}addUvs(e,t,s,i,r,n=null){let o=0;const a=t.length,l=s.frame;for(;o<r;){let c=e[(i+o)*2],u=e[(i+o)*2+1];if(n){const d=n.a*c+n.c*u+n.tx;u=n.b*c+n.d*u+n.ty,c=d}o++,t.push(c/l.width,u/l.height)}const h=s.baseTexture;(l.width<h.width||l.height<h.height)&&this.adjustUvs(t,s,a,r)}adjustUvs(e,t,s,i){const r=t.baseTexture,n=1e-6,o=s+i*2,a=t.frame,l=a.width/r.width,h=a.height/r.height;let c=a.x/a.width,u=a.y/a.height,d=Math.floor(e[s]+n),p=Math.floor(e[s+1]+n);for(let f=s+2;f<o;f+=2)d=Math.min(d,Math.floor(e[f]+n)),p=Math.min(p,Math.floor(e[f+1]+n));c-=d,u-=p;for(let f=s;f<o;f+=2)e[f]=(e[f]+c)*l,e[f+1]=(e[f+1]+u)*h}};let lf=af;lf.BATCHABLE_SIZE=100;class to{constructor(){this.color=16777215,this.alpha=1,this.texture=J.WHITE,this.matrix=null,this.visible=!1,this.reset()}clone(){const t=new to;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t}reset(){this.color=16777215,this.alpha=1,this.texture=J.WHITE,this.matrix=null,this.visible=!1}destroy(){this.texture=null,this.matrix=null}}class Sl extends to{constructor(){super(...arguments),this.width=0,this.alignment=.5,this.native=!1,this.cap=$s.BUTT,this.join=xs.MITER,this.miterLimit=10}clone(){const t=new Sl;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t.width=this.width,t.alignment=this.alignment,t.native=this.native,t.cap=this.cap,t.join=this.join,t.miterLimit=this.miterLimit,t}reset(){super.reset(),this.color=0,this.alignment=.5,this.width=0,this.native=!1}}const qb=new Float32Array(3),Uo={},on=class extends ce{constructor(e=null){super(),this.shader=null,this.pluginName="batch",this.currentPath=null,this.batches=[],this.batchTint=-1,this.batchDirty=-1,this.vertexData=null,this._fillStyle=new to,this._lineStyle=new Sl,this._matrix=null,this._holeMode=!1,this.state=us.for2d(),this._geometry=e||new lf,this._geometry.refCount++,this._transformID=-1,this.tint=16777215,this.blendMode=ct.NORMAL}get geometry(){return this._geometry}clone(){return this.finishPoly(),new on(this._geometry)}set blendMode(e){this.state.blendMode=e}get blendMode(){return this.state.blendMode}get tint(){return this._tint}set tint(e){this._tint=e}get fill(){return this._fillStyle}get line(){return this._lineStyle}lineStyle(e=null,t=0,s=1,i=.5,r=!1){return typeof e=="number"&&(e={width:e,color:t,alpha:s,alignment:i,native:r}),this.lineTextureStyle(e)}lineTextureStyle(e){e=Object.assign({width:0,texture:J.WHITE,color:e!=null&&e.texture?16777215:0,alpha:1,matrix:null,alignment:.5,native:!1,cap:$s.BUTT,join:xs.MITER,miterLimit:10},e),this.currentPath&&this.startPoly();const t=e.width>0&&e.alpha>0;return t?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._lineStyle,{visible:t},e)):this._lineStyle.reset(),this}startPoly(){if(this.currentPath){const e=this.currentPath.points,t=this.currentPath.points.length;t>2&&(this.drawShape(this.currentPath),this.currentPath=new Ei,this.currentPath.closeStroke=!1,this.currentPath.points.push(e[t-2],e[t-1]))}else this.currentPath=new Ei,this.currentPath.closeStroke=!1}finishPoly(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)}moveTo(e,t){return this.startPoly(),this.currentPath.points[0]=e,this.currentPath.points[1]=t,this}lineTo(e,t){this.currentPath||this.moveTo(0,0);const s=this.currentPath.points,i=s[s.length-2],r=s[s.length-1];return(i!==e||r!==t)&&s.push(e,t),this}_initCurve(e=0,t=0){this.currentPath?this.currentPath.points.length===0&&(this.currentPath.points=[e,t]):this.moveTo(e,t)}quadraticCurveTo(e,t,s,i){this._initCurve();const r=this.currentPath.points;return r.length===0&&this.moveTo(0,0),wl.curveTo(e,t,s,i,r),this}bezierCurveTo(e,t,s,i,r,n){return this._initCurve(),Tl.curveTo(e,t,s,i,r,n,this.currentPath.points),this}arcTo(e,t,s,i,r){this._initCurve(e,t);const n=this.currentPath.points,o=vc.curveTo(e,t,s,i,r,n);if(o){const{cx:a,cy:l,radius:h,startAngle:c,endAngle:u,anticlockwise:d}=o;this.arc(a,l,h,c,u,d)}return this}arc(e,t,s,i,r,n=!1){if(i===r)return this;if(!n&&r<=i?r+=Tn:n&&i<=r&&(i+=Tn),r-i===0)return this;const a=e+Math.cos(i)*s,l=t+Math.sin(i)*s,h=this._geometry.closePointEps;let c=this.currentPath?this.currentPath.points:null;if(c){const u=Math.abs(c[c.length-2]-a),d=Math.abs(c[c.length-1]-l);u<h&&d<h||c.push(a,l)}else this.moveTo(a,l),c=this.currentPath.points;return vc.arc(a,l,e,t,s,i,r,n,c),this}beginFill(e=0,t=1){return this.beginTextureFill({texture:J.WHITE,color:e,alpha:t})}beginTextureFill(e){e=Object.assign({texture:J.WHITE,color:16777215,alpha:1,matrix:null},e),this.currentPath&&this.startPoly();const t=e.alpha>0;return t?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._fillStyle,{visible:t},e)):this._fillStyle.reset(),this}endFill(){return this.finishPoly(),this._fillStyle.reset(),this}drawRect(e,t,s,i){return this.drawShape(new yt(e,t,s,i))}drawRoundedRect(e,t,s,i,r){return this.drawShape(new vl(e,t,s,i,r))}drawCircle(e,t,s){return this.drawShape(new _l(e,t,s))}drawEllipse(e,t,s,i){return this.drawShape(new xl(e,t,s,i))}drawPolygon(...e){let t,s=!0;const i=e[0];i.points?(s=i.closeStroke,t=i.points):Array.isArray(e[0])?t=e[0]:t=e;const r=new Ei(t);return r.closeStroke=s,this.drawShape(r),this}drawShape(e){return this._holeMode?this._geometry.drawHole(e,this._matrix):this._geometry.drawShape(e,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this}clear(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this}isFastRect(){const e=this._geometry.graphicsData;return e.length===1&&e[0].shape.type===te.RECT&&!e[0].matrix&&!e[0].holes.length&&!(e[0].lineStyle.visible&&e[0].lineStyle.width)}_render(e){this.finishPoly();const t=this._geometry;t.updateBatches(),t.batchable?(this.batchDirty!==t.batchDirty&&this._populateBatches(),this._renderBatched(e)):(e.batch.flush(),this._renderDirect(e))}_populateBatches(){const e=this._geometry,t=this.blendMode,s=e.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=e.batchDirty,this.batches.length=s,this.vertexData=new Float32Array(e.points);for(let i=0;i<s;i++){const r=e.batches[i],n=r.style.color,o=new Float32Array(this.vertexData.buffer,r.attribStart*4*2,r.attribSize*2),a=new Float32Array(e.uvsFloat32.buffer,r.attribStart*4*2,r.attribSize*2),l=new Uint16Array(e.indicesUint16.buffer,r.start*2,r.size),h={vertexData:o,blendMode:t,indices:l,uvs:a,_batchRGB:fr(n),_tintRGB:n,_texture:r.style.texture,alpha:r.style.alpha,worldAlpha:1};this.batches[i]=h}}_renderBatched(e){if(this.batches.length){e.batch.setObjectRenderer(e.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(let t=0,s=this.batches.length;t<s;t++){const i=this.batches[t];i.worldAlpha=this.worldAlpha*i.alpha,e.plugins[this.pluginName].render(i)}}}_renderDirect(e){const t=this._resolveDirectShader(e),s=this._geometry,i=this.tint,r=this.worldAlpha,n=t.uniforms,o=s.drawCalls;n.translationMatrix=this.transform.worldTransform,n.tint[0]=(i>>16&255)/255*r,n.tint[1]=(i>>8&255)/255*r,n.tint[2]=(i&255)/255*r,n.tint[3]=r,e.shader.bind(t),e.geometry.bind(s,t),e.state.set(this.state);for(let a=0,l=o.length;a<l;a++)this._renderDrawCallDirect(e,s.drawCalls[a])}_renderDrawCallDirect(e,t){const{texArray:s,type:i,size:r,start:n}=t,o=s.count;for(let a=0;a<o;a++)e.texture.bind(s.elements[a],a);e.geometry.draw(i,r,n)}_resolveDirectShader(e){let t=this.shader;const s=this.pluginName;if(!t){if(!Uo[s]){const{maxTextures:i}=e.plugins[s],r=new Int32Array(i);for(let a=0;a<i;a++)r[a]=a;const n={tint:new Float32Array([1,1,1,1]),translationMatrix:new Nt,default:Le.from({uSamplers:r},!0)},o=e.plugins[s]._shader.program;Uo[s]=new qe(o,n)}t=Uo[s]}return t}_calculateBounds(){this.finishPoly();const e=this._geometry;if(!e.graphicsData.length)return;const{minX:t,minY:s,maxX:i,maxY:r}=e.bounds;this._bounds.addFrame(this.transform,t,s,i,r)}containsPoint(e){return this.worldTransform.applyInverse(e,on._TEMP_POINT),this._geometry.containsPoint(on._TEMP_POINT)}calculateTints(){if(this.batchTint!==this.tint){this.batchTint=this.tint;const e=fr(this.tint,qb);for(let t=0;t<this.batches.length;t++){const s=this.batches[t],i=s._batchRGB,r=e[0]*i[0]*255,n=e[1]*i[1]*255,o=e[2]*i[2]*255,a=(r<<16)+(n<<8)+(o|0);s._tintRGB=(a>>16)+(a&65280)+((a&255)<<16)}}}calculateVertices(){const e=this.transform._worldID;if(this._transformID===e)return;this._transformID=e;const t=this.transform.worldTransform,s=t.a,i=t.b,r=t.c,n=t.d,o=t.tx,a=t.ty,l=this._geometry.points,h=this.vertexData;let c=0;for(let u=0;u<l.length;u+=2){const d=l[u],p=l[u+1];h[c++]=s*d+r*p+o,h[c++]=n*p+i*d+a}}closePath(){const e=this.currentPath;return e&&(e.closeStroke=!0,this.finishPoly()),this}setMatrix(e){return this._matrix=e,this}beginHole(){return this.finishPoly(),this._holeMode=!0,this}endHole(){return this.finishPoly(),this._holeMode=!1,this}destroy(e){this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,super.destroy(e)}};let eo=on;eo.curves=Ii;eo._TEMP_POINT=new Tt;class Zb{constructor(t,s){this.uvBuffer=t,this.uvMatrix=s,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}update(t){if(!t&&this._bufferUpdateId===this.uvBuffer._updateID&&this._textureUpdateId===this.uvMatrix._updateID)return;this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;const s=this.uvBuffer.data;(!this.data||this.data.length!==s.length)&&(this.data=new Float32Array(s.length)),this.uvMatrix.multiplyUvs(s,this.data),this._updateID++}}const ko=new Tt,Tc=new Ei,hf=class extends ce{constructor(e,t,s,i=Ve.TRIANGLES){super(),this.geometry=e,this.shader=t,this.state=s||us.for2d(),this.drawMode=i,this.start=0,this.size=0,this.uvs=null,this.indices=null,this.vertexData=new Float32Array(1),this.vertexDirty=-1,this._transformID=-1,this._roundPixels=q.ROUND_PIXELS,this.batchUvs=null}get geometry(){return this._geometry}set geometry(e){this._geometry!==e&&(this._geometry&&(this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose()),this._geometry=e,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)}get uvBuffer(){return this.geometry.buffers[1]}get verticesBuffer(){return this.geometry.buffers[0]}set material(e){this.shader=e}get material(){return this.shader}set blendMode(e){this.state.blendMode=e}get blendMode(){return this.state.blendMode}set roundPixels(e){this._roundPixels!==e&&(this._transformID=-1),this._roundPixels=e}get roundPixels(){return this._roundPixels}get tint(){return"tint"in this.shader?this.shader.tint:null}set tint(e){this.shader.tint=e}get texture(){return"texture"in this.shader?this.shader.texture:null}set texture(e){this.shader.texture=e}_render(e){const t=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===Ve.TRIANGLES&&t.length<hf.BATCHABLE_SIZE*2?this._renderToBatch(e):this._renderDefault(e)}_renderDefault(e){const t=this.shader;t.alpha=this.worldAlpha,t.update&&t.update(),e.batch.flush(),t.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),e.shader.bind(t),e.state.set(this.state),e.geometry.bind(this.geometry,t),e.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)}_renderToBatch(e){const t=this.geometry,s=this.shader;s.uvMatrix&&(s.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=t.indexBuffer.data,this._tintRGB=s._tintRGB,this._texture=s.texture;const i=this.material.pluginName;e.batch.setObjectRenderer(e.plugins[i]),e.plugins[i].render(this)}calculateVertices(){const t=this.geometry.buffers[0],s=t.data,i=t._updateID;if(i===this.vertexDirty&&this._transformID===this.transform._worldID)return;this._transformID=this.transform._worldID,this.vertexData.length!==s.length&&(this.vertexData=new Float32Array(s.length));const r=this.transform.worldTransform,n=r.a,o=r.b,a=r.c,l=r.d,h=r.tx,c=r.ty,u=this.vertexData;for(let d=0;d<u.length/2;d++){const p=s[d*2],f=s[d*2+1];u[d*2]=n*p+a*f+h,u[d*2+1]=o*p+l*f+c}if(this._roundPixels){const d=q.RESOLUTION;for(let p=0;p<u.length;++p)u[p]=Math.round(u[p]*d)/d}this.vertexDirty=i}calculateUvs(){const e=this.geometry.buffers[1],t=this.shader;t.uvMatrix.isSimple?this.uvs=e.data:(this.batchUvs||(this.batchUvs=new Zb(e,t.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)}_calculateBounds(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)}containsPoint(e){if(!this.getBounds().contains(e.x,e.y))return!1;this.worldTransform.applyInverse(e,ko);const t=this.geometry.getBuffer("aVertexPosition").data,s=Tc.points,i=this.geometry.getIndex().data,r=i.length,n=this.drawMode===4?3:1;for(let o=0;o+2<r;o+=n){const a=i[o]*2,l=i[o+1]*2,h=i[o+2]*2;if(s[0]=t[a],s[1]=t[a+1],s[2]=t[l],s[3]=t[l+1],s[4]=t[h],s[5]=t[h+1],Tc.contains(ko.x,ko.y))return!0}return!1}destroy(e){super.destroy(e),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null}};let La=hf;La.BATCHABLE_SIZE=100;class Jb extends Cs{constructor(t,s,i){super();const r=new jt(t),n=new jt(s,!0),o=new jt(i,!0,!0);this.addAttribute("aVertexPosition",r,2,!1,lt.FLOAT).addAttribute("aTextureCoord",n,2,!1,lt.FLOAT).addIndex(o),this._updateId=-1}get vertexDirtyId(){return this.buffers[0]._updateID}}var Qb=`varying vec2 vTextureCoord;
uniform vec4 uColor;

uniform sampler2D uSampler;

void main(void)
{
    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;
}
`,tT=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTextureMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;
}
`;class wc extends qe{constructor(t,s){const i={uSampler:t,alpha:1,uTextureMatrix:Nt.IDENTITY,uColor:new Float32Array([1,1,1,1])};s=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},s),s.uniforms&&Object.assign(i,s.uniforms),super(s.program||Me.from(tT,Qb),i),this._colorDirty=!1,this.uvMatrix=new Id(t),this.batchable=s.program===void 0,this.pluginName=s.pluginName,this.tint=s.tint,this.alpha=s.alpha}get texture(){return this.uniforms.uSampler}set texture(t){this.uniforms.uSampler!==t&&(!this.uniforms.uSampler.baseTexture.alphaMode!=!t.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=t,this.uvMatrix.texture=t)}set alpha(t){t!==this._alpha&&(this._alpha=t,this._colorDirty=!0)}get alpha(){return this._alpha}set tint(t){t!==this._tint&&(this._tint=t,this._tintRGB=(t>>16)+(t&65280)+((t&255)<<16),this._colorDirty=!0)}get tint(){return this._tint}update(){if(this._colorDirty){this._colorDirty=!1;const t=this.texture.baseTexture;od(this._tint,this._alpha,this.uniforms.uColor,t.alphaMode)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)}}class Sc{constructor(t,s,i){this.geometry=new Cs,this.indexBuffer=null,this.size=i,this.dynamicProperties=[],this.staticProperties=[];for(let r=0;r<t.length;++r){let n=t[r];n={attributeName:n.attributeName,size:n.size,uploadFunction:n.uploadFunction,type:n.type||lt.FLOAT,offset:n.offset},s[r]?this.dynamicProperties.push(n):this.staticProperties.push(n)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}initBuffers(){const t=this.geometry;let s=0;this.indexBuffer=new jt(jv(this.size),!0,!0),t.addIndex(this.indexBuffer),this.dynamicStride=0;for(let o=0;o<this.dynamicProperties.length;++o){const a=this.dynamicProperties[o];a.offset=s,s+=a.size,this.dynamicStride+=a.size}const i=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(i),this.dynamicDataUint32=new Uint32Array(i),this.dynamicBuffer=new jt(this.dynamicData,!1,!1);let r=0;this.staticStride=0;for(let o=0;o<this.staticProperties.length;++o){const a=this.staticProperties[o];a.offset=r,r+=a.size,this.staticStride+=a.size}const n=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(n),this.staticDataUint32=new Uint32Array(n),this.staticBuffer=new jt(this.staticData,!0,!1);for(let o=0;o<this.dynamicProperties.length;++o){const a=this.dynamicProperties[o];t.addAttribute(a.attributeName,this.dynamicBuffer,0,a.type===lt.UNSIGNED_BYTE,a.type,this.dynamicStride*4,a.offset*4)}for(let o=0;o<this.staticProperties.length;++o){const a=this.staticProperties[o];t.addAttribute(a.attributeName,this.staticBuffer,0,a.type===lt.UNSIGNED_BYTE,a.type,this.staticStride*4,a.offset*4)}}uploadDynamic(t,s,i){for(let r=0;r<this.dynamicProperties.length;r++){const n=this.dynamicProperties[r];n.uploadFunction(t,s,i,n.type===lt.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,n.offset)}this.dynamicBuffer._updateID++}uploadStatic(t,s,i){for(let r=0;r<this.staticProperties.length;r++){const n=this.staticProperties[r];n.uploadFunction(t,s,i,n.type===lt.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,n.offset)}this.staticBuffer._updateID++}destroy(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()}}var eT=`varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uSampler;

void main(void){
    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;
    gl_FragColor = color;
}`,sT=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;

attribute vec2 aPositionCoord;
attribute float aRotation;

uniform mat3 translationMatrix;
uniform vec4 uColor;

varying vec2 vTextureCoord;
varying vec4 vColor;

void main(void){
    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);
    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);

    vec2 v = vec2(x, y);
    v = v + aPositionCoord;

    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vColor = aColor * uColor;
}
`;class cf extends Zn{constructor(t){super(t),this.shader=null,this.properties=null,this.tempMatrix=new Nt,this.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:this.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:this.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:this.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:this.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:lt.UNSIGNED_BYTE,uploadFunction:this.uploadTint,offset:0}],this.shader=qe.from(sT,eT,{}),this.state=us.for2d()}render(t){const s=t.children,i=t._maxSize,r=t._batchSize,n=this.renderer;let o=s.length;if(o===0)return;o>i&&!t.autoResize&&(o=i);let a=t._buffers;a||(a=t._buffers=this.generateBuffers(t));const l=s[0]._texture.baseTexture,h=l.alphaMode>0;this.state.blendMode=nd(t.blendMode,h),n.state.set(this.state);const c=n.gl,u=t.worldTransform.copyTo(this.tempMatrix);u.prepend(n.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=u.toArray(!0),this.shader.uniforms.uColor=Xv(t.tintRgb,t.worldAlpha,this.shader.uniforms.uColor,h),this.shader.uniforms.uSampler=l,this.renderer.shader.bind(this.shader);let d=!1;for(let p=0,f=0;p<o;p+=r,f+=1){let m=o-p;m>r&&(m=r),f>=a.length&&a.push(this._generateOneMoreBuffer(t));const _=a[f];_.uploadDynamic(s,p,m);const v=t._bufferUpdateIDs[f]||0;d=d||_._updateID<v,d&&(_._updateID=t._updateID,_.uploadStatic(s,p,m)),n.geometry.bind(_.geometry),c.drawElements(c.TRIANGLES,m*6,c.UNSIGNED_SHORT,0)}}generateBuffers(t){const s=[],i=t._maxSize,r=t._batchSize,n=t._properties;for(let o=0;o<i;o+=r)s.push(new Sc(this.properties,n,r));return s}_generateOneMoreBuffer(t){const s=t._batchSize,i=t._properties;return new Sc(this.properties,i,s)}uploadVertices(t,s,i,r,n,o){let a=0,l=0,h=0,c=0;for(let u=0;u<i;++u){const d=t[s+u],p=d._texture,f=d.scale.x,m=d.scale.y,_=p.trim,v=p.orig;_?(l=_.x-d.anchor.x*v.width,a=l+_.width,c=_.y-d.anchor.y*v.height,h=c+_.height):(a=v.width*(1-d.anchor.x),l=v.width*-d.anchor.x,h=v.height*(1-d.anchor.y),c=v.height*-d.anchor.y),r[o]=l*f,r[o+1]=c*m,r[o+n]=a*f,r[o+n+1]=c*m,r[o+n*2]=a*f,r[o+n*2+1]=h*m,r[o+n*3]=l*f,r[o+n*3+1]=h*m,o+=n*4}}uploadPosition(t,s,i,r,n,o){for(let a=0;a<i;a++){const l=t[s+a].position;r[o]=l.x,r[o+1]=l.y,r[o+n]=l.x,r[o+n+1]=l.y,r[o+n*2]=l.x,r[o+n*2+1]=l.y,r[o+n*3]=l.x,r[o+n*3+1]=l.y,o+=n*4}}uploadRotation(t,s,i,r,n,o){for(let a=0;a<i;a++){const l=t[s+a].rotation;r[o]=l,r[o+n]=l,r[o+n*2]=l,r[o+n*3]=l,o+=n*4}}uploadUvs(t,s,i,r,n,o){for(let a=0;a<i;++a){const l=t[s+a]._texture._uvs;l?(r[o]=l.x0,r[o+1]=l.y0,r[o+n]=l.x1,r[o+n+1]=l.y1,r[o+n*2]=l.x2,r[o+n*2+1]=l.y2,r[o+n*3]=l.x3,r[o+n*3+1]=l.y3,o+=n*4):(r[o]=0,r[o+1]=0,r[o+n]=0,r[o+n+1]=0,r[o+n*2]=0,r[o+n*2+1]=0,r[o+n*3]=0,r[o+n*3+1]=0,o+=n*4)}}uploadTint(t,s,i,r,n,o){for(let a=0;a<i;++a){const l=t[s+a],h=l._texture.baseTexture.alphaMode>0,c=l.alpha,u=c<1&&h?gl(l._tintRGB,c):l._tintRGB+(c*255<<24);r[o]=u,r[o+n]=u,r[o+n*2]=u,r[o+n*3]=u,o+=n*4}}destroy(){super.destroy(),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null}}cf.extension={name:"particle",type:K.RendererPlugin};rt.add(cf);var so=(e=>(e[e.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",e[e.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL",e))(so||{});const Vr={willReadFrequently:!0},et=class{static get experimentalLetterSpacingSupported(){let e=et._experimentalLetterSpacingSupported;if(e!==void 0){const t=q.ADAPTER.getCanvasRenderingContext2D().prototype;e=et._experimentalLetterSpacingSupported="letterSpacing"in t||"textLetterSpacing"in t}return e}constructor(e,t,s,i,r,n,o,a,l){this.text=e,this.style=t,this.width=s,this.height=i,this.lines=r,this.lineWidths=n,this.lineHeight=o,this.maxLineWidth=a,this.fontProperties=l}static measureText(e,t,s,i=et._canvas){s=s??t.wordWrap;const r=t.toFontString(),n=et.measureFont(r);n.fontSize===0&&(n.fontSize=t.fontSize,n.ascent=t.fontSize);const o=i.getContext("2d",Vr);o.font=r;const l=(s?et.wordWrap(e,t,i):e).split(/(?:\r\n|\r|\n)/),h=new Array(l.length);let c=0;for(let f=0;f<l.length;f++){const m=et._measureText(l[f],t.letterSpacing,o);h[f]=m,c=Math.max(c,m)}let u=c+t.strokeThickness;t.dropShadow&&(u+=t.dropShadowDistance);const d=t.lineHeight||n.fontSize+t.strokeThickness;let p=Math.max(d,n.fontSize+t.strokeThickness*2)+(l.length-1)*(d+t.leading);return t.dropShadow&&(p+=t.dropShadowDistance),new et(e,t,u,p,l,h,d+t.leading,c,n)}static _measureText(e,t,s){let i=!1;et.experimentalLetterSpacingSupported&&(et.experimentalLetterSpacing?(s.letterSpacing=`${t}px`,s.textLetterSpacing=`${t}px`,i=!0):(s.letterSpacing="0px",s.textLetterSpacing="0px"));let r=s.measureText(e).width;return r>0&&(i?r-=t:r+=(et.graphemeSegmenter(e).length-1)*t),r}static wordWrap(e,t,s=et._canvas){const i=s.getContext("2d",Vr);let r=0,n="",o="";const a=Object.create(null),{letterSpacing:l,whiteSpace:h}=t,c=et.collapseSpaces(h),u=et.collapseNewlines(h);let d=!c;const p=t.wordWrapWidth+l,f=et.tokenize(e);for(let m=0;m<f.length;m++){let _=f[m];if(et.isNewline(_)){if(!u){o+=et.addLine(n),d=!c,n="",r=0;continue}_=" "}if(c){const T=et.isBreakingSpace(_),g=et.isBreakingSpace(n[n.length-1]);if(T&&g)continue}const v=et.getFromCache(_,l,a,i);if(v>p)if(n!==""&&(o+=et.addLine(n),n="",r=0),et.canBreakWords(_,t.breakWords)){const T=et.wordWrapSplit(_);for(let g=0;g<T.length;g++){let b=T[g],S=b,A=1;for(;T[g+A];){const E=T[g+A];if(!et.canBreakChars(S,E,_,g,t.breakWords))b+=E;else break;S=E,A++}g+=A-1;const y=et.getFromCache(b,l,a,i);y+r>p&&(o+=et.addLine(n),d=!1,n="",r=0),n+=b,r+=y}}else{n.length>0&&(o+=et.addLine(n),n="",r=0);const T=m===f.length-1;o+=et.addLine(_,!T),d=!1,n="",r=0}else v+r>p&&(d=!1,o+=et.addLine(n),n="",r=0),(n.length>0||!et.isBreakingSpace(_)||d)&&(n+=_,r+=v)}return o+=et.addLine(n,!1),o}static addLine(e,t=!0){return e=et.trimRight(e),e=t?`${e}
`:e,e}static getFromCache(e,t,s,i){let r=s[e];return typeof r!="number"&&(r=et._measureText(e,t,i)+t,s[e]=r),r}static collapseSpaces(e){return e==="normal"||e==="pre-line"}static collapseNewlines(e){return e==="normal"}static trimRight(e){if(typeof e!="string")return"";for(let t=e.length-1;t>=0;t--){const s=e[t];if(!et.isBreakingSpace(s))break;e=e.slice(0,-1)}return e}static isNewline(e){return typeof e!="string"?!1:et._newlines.includes(e.charCodeAt(0))}static isBreakingSpace(e,t){return typeof e!="string"?!1:et._breakingSpaces.includes(e.charCodeAt(0))}static tokenize(e){const t=[];let s="";if(typeof e!="string")return t;for(let i=0;i<e.length;i++){const r=e[i],n=e[i+1];if(et.isBreakingSpace(r,n)||et.isNewline(r)){s!==""&&(t.push(s),s=""),t.push(r);continue}s+=r}return s!==""&&t.push(s),t}static canBreakWords(e,t){return t}static canBreakChars(e,t,s,i,r){return!0}static wordWrapSplit(e){return et.graphemeSegmenter(e)}static measureFont(e){if(et._fonts[e])return et._fonts[e];const t={ascent:0,descent:0,fontSize:0},s=et._canvas,i=et._context;i.font=e;const r=et.METRICS_STRING+et.BASELINE_SYMBOL,n=Math.ceil(i.measureText(r).width);let o=Math.ceil(i.measureText(et.BASELINE_SYMBOL).width);const a=Math.ceil(et.HEIGHT_MULTIPLIER*o);if(o=o*et.BASELINE_MULTIPLIER|0,n===0||a===0)return et._fonts[e]=t,t;s.width=n,s.height=a,i.fillStyle="#f00",i.fillRect(0,0,n,a),i.font=e,i.textBaseline="alphabetic",i.fillStyle="#000",i.fillText(r,0,o);const l=i.getImageData(0,0,n,a).data,h=l.length,c=n*4;let u=0,d=0,p=!1;for(u=0;u<o;++u){for(let f=0;f<c;f+=4)if(l[d+f]!==255){p=!0;break}if(!p)d+=c;else break}for(t.ascent=o-u,d=h-c,p=!1,u=a;u>o;--u){for(let f=0;f<c;f+=4)if(l[d+f]!==255){p=!0;break}if(!p)d-=c;else break}return t.descent=u-o,t.fontSize=t.ascent+t.descent,et._fonts[e]=t,t}static clearMetrics(e=""){e?delete et._fonts[e]:et._fonts={}}static get _canvas(){if(!et.__canvas){let e;try{const t=new OffscreenCanvas(0,0),s=t.getContext("2d",Vr);if(s!=null&&s.measureText)return et.__canvas=t,t;e=q.ADAPTER.createCanvas()}catch{e=q.ADAPTER.createCanvas()}e.width=e.height=10,et.__canvas=e}return et.__canvas}static get _context(){return et.__context||(et.__context=et._canvas.getContext("2d",Vr)),et.__context}};let Qt=et;Qt.METRICS_STRING="|ÉqÅ";Qt.BASELINE_SYMBOL="M";Qt.BASELINE_MULTIPLIER=1.4;Qt.HEIGHT_MULTIPLIER=2;Qt.graphemeSegmenter=(()=>{if(typeof(Intl==null?void 0:Intl.Segmenter)=="function"){const e=new Intl.Segmenter;return t=>[...e.segment(t)].map(s=>s.segment)}return e=>[...e]})();Qt.experimentalLetterSpacing=!1;Qt._fonts={};Qt._newlines=[10,13];Qt._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];const iT=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],qi=class{constructor(e){this.styleID=0,this.reset(),Ho(this,e,e)}clone(){const e={};return Ho(e,this,qi.defaultStyle),new qi(e)}reset(){Ho(this,qi.defaultStyle,qi.defaultStyle)}get align(){return this._align}set align(e){this._align!==e&&(this._align=e,this.styleID++)}get breakWords(){return this._breakWords}set breakWords(e){this._breakWords!==e&&(this._breakWords=e,this.styleID++)}get dropShadow(){return this._dropShadow}set dropShadow(e){this._dropShadow!==e&&(this._dropShadow=e,this.styleID++)}get dropShadowAlpha(){return this._dropShadowAlpha}set dropShadowAlpha(e){this._dropShadowAlpha!==e&&(this._dropShadowAlpha=e,this.styleID++)}get dropShadowAngle(){return this._dropShadowAngle}set dropShadowAngle(e){this._dropShadowAngle!==e&&(this._dropShadowAngle=e,this.styleID++)}get dropShadowBlur(){return this._dropShadowBlur}set dropShadowBlur(e){this._dropShadowBlur!==e&&(this._dropShadowBlur=e,this.styleID++)}get dropShadowColor(){return this._dropShadowColor}set dropShadowColor(e){const t=Go(e);this._dropShadowColor!==t&&(this._dropShadowColor=t,this.styleID++)}get dropShadowDistance(){return this._dropShadowDistance}set dropShadowDistance(e){this._dropShadowDistance!==e&&(this._dropShadowDistance=e,this.styleID++)}get fill(){return this._fill}set fill(e){const t=Go(e);this._fill!==t&&(this._fill=t,this.styleID++)}get fillGradientType(){return this._fillGradientType}set fillGradientType(e){this._fillGradientType!==e&&(this._fillGradientType=e,this.styleID++)}get fillGradientStops(){return this._fillGradientStops}set fillGradientStops(e){rT(this._fillGradientStops,e)||(this._fillGradientStops=e,this.styleID++)}get fontFamily(){return this._fontFamily}set fontFamily(e){this.fontFamily!==e&&(this._fontFamily=e,this.styleID++)}get fontSize(){return this._fontSize}set fontSize(e){this._fontSize!==e&&(this._fontSize=e,this.styleID++)}get fontStyle(){return this._fontStyle}set fontStyle(e){this._fontStyle!==e&&(this._fontStyle=e,this.styleID++)}get fontVariant(){return this._fontVariant}set fontVariant(e){this._fontVariant!==e&&(this._fontVariant=e,this.styleID++)}get fontWeight(){return this._fontWeight}set fontWeight(e){this._fontWeight!==e&&(this._fontWeight=e,this.styleID++)}get letterSpacing(){return this._letterSpacing}set letterSpacing(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.styleID++)}get lineHeight(){return this._lineHeight}set lineHeight(e){this._lineHeight!==e&&(this._lineHeight=e,this.styleID++)}get leading(){return this._leading}set leading(e){this._leading!==e&&(this._leading=e,this.styleID++)}get lineJoin(){return this._lineJoin}set lineJoin(e){this._lineJoin!==e&&(this._lineJoin=e,this.styleID++)}get miterLimit(){return this._miterLimit}set miterLimit(e){this._miterLimit!==e&&(this._miterLimit=e,this.styleID++)}get padding(){return this._padding}set padding(e){this._padding!==e&&(this._padding=e,this.styleID++)}get stroke(){return this._stroke}set stroke(e){const t=Go(e);this._stroke!==t&&(this._stroke=t,this.styleID++)}get strokeThickness(){return this._strokeThickness}set strokeThickness(e){this._strokeThickness!==e&&(this._strokeThickness=e,this.styleID++)}get textBaseline(){return this._textBaseline}set textBaseline(e){this._textBaseline!==e&&(this._textBaseline=e,this.styleID++)}get trim(){return this._trim}set trim(e){this._trim!==e&&(this._trim=e,this.styleID++)}get whiteSpace(){return this._whiteSpace}set whiteSpace(e){this._whiteSpace!==e&&(this._whiteSpace=e,this.styleID++)}get wordWrap(){return this._wordWrap}set wordWrap(e){this._wordWrap!==e&&(this._wordWrap=e,this.styleID++)}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(e){this._wordWrapWidth!==e&&(this._wordWrapWidth=e,this.styleID++)}toFontString(){const e=typeof this.fontSize=="number"?`${this.fontSize}px`:this.fontSize;let t=this.fontFamily;Array.isArray(this.fontFamily)||(t=this.fontFamily.split(","));for(let s=t.length-1;s>=0;s--){let i=t[s].trim();!/([\"\'])[^\'\"]+\1/.test(i)&&!iT.includes(i)&&(i=`"${i}"`),t[s]=i}return`${this.fontStyle} ${this.fontVariant} ${this.fontWeight} ${e} ${t.join(",")}`}};let Zs=qi;Zs.defaultStyle={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:so.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};function Ac(e){return typeof e=="number"?id(e):(typeof e=="string"&&e.startsWith("0x")&&(e=e.replace("0x","#")),e)}function Go(e){if(Array.isArray(e)){for(let t=0;t<e.length;++t)e[t]=Ac(e[t]);return e}else return Ac(e)}function rT(e,t){if(!Array.isArray(e)||!Array.isArray(t)||e.length!==t.length)return!1;for(let s=0;s<e.length;++s)if(e[s]!==t[s])return!1;return!0}function Ho(e,t,s){for(const i in s)Array.isArray(t[i])?e[i]=t[i].slice():e[i]=t[i]}const nT={texture:!0,children:!1,baseTexture:!0},Na=class extends Fi{constructor(e,t,s){let i=!1;s||(s=q.ADAPTER.createCanvas(),i=!0),s.width=3,s.height=3;const r=J.from(s);r.orig=new yt,r.trim=new yt,super(r),this._ownCanvas=i,this.canvas=s,this.context=s.getContext("2d",{willReadFrequently:!0}),this._resolution=Na.defaultResolution??q.RESOLUTION,this._autoResolution=Na.defaultAutoResolution,this._text=null,this._style=null,this._styleListener=null,this._font="",this.text=e,this.style=t,this.localStyleID=-1}static get experimentalLetterSpacing(){return Qt.experimentalLetterSpacing}static set experimentalLetterSpacing(e){Ct("7.1.0","Text.experimentalLetterSpacing is deprecated, use TextMetrics.experimentalLetterSpacing"),Qt.experimentalLetterSpacing=e}updateText(e){const t=this._style;if(this.localStyleID!==t.styleID&&(this.dirty=!0,this.localStyleID=t.styleID),!this.dirty&&e)return;this._font=this._style.toFontString();const s=this.context,i=Qt.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),r=i.width,n=i.height,o=i.lines,a=i.lineHeight,l=i.lineWidths,h=i.maxLineWidth,c=i.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,r)+t.padding*2)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,n)+t.padding*2)*this._resolution),s.scale(this._resolution,this._resolution),s.clearRect(0,0,this.canvas.width,this.canvas.height),s.font=this._font,s.lineWidth=t.strokeThickness,s.textBaseline=t.textBaseline,s.lineJoin=t.lineJoin,s.miterLimit=t.miterLimit;let u,d;const p=t.dropShadow?2:1;for(let f=0;f<p;++f){const m=t.dropShadow&&f===0,_=m?Math.ceil(Math.max(1,n)+t.padding*2):0,v=_*this._resolution;if(m){s.fillStyle="black",s.strokeStyle="black";const g=t.dropShadowColor,b=fr(typeof g=="number"?g:ml(g)),S=t.dropShadowBlur*this._resolution,A=t.dropShadowDistance*this._resolution;s.shadowColor=`rgba(${b[0]*255},${b[1]*255},${b[2]*255},${t.dropShadowAlpha})`,s.shadowBlur=S,s.shadowOffsetX=Math.cos(t.dropShadowAngle)*A,s.shadowOffsetY=Math.sin(t.dropShadowAngle)*A+v}else s.fillStyle=this._generateFillStyle(t,o,i),s.strokeStyle=t.stroke,s.shadowColor="black",s.shadowBlur=0,s.shadowOffsetX=0,s.shadowOffsetY=0;let T=(a-c.fontSize)/2;a-c.fontSize<0&&(T=0);for(let g=0;g<o.length;g++)u=t.strokeThickness/2,d=t.strokeThickness/2+g*a+c.ascent+T,t.align==="right"?u+=h-l[g]:t.align==="center"&&(u+=(h-l[g])/2),t.stroke&&t.strokeThickness&&this.drawLetterSpacing(o[g],u+t.padding,d+t.padding-_,!0),t.fill&&this.drawLetterSpacing(o[g],u+t.padding,d+t.padding-_)}this.updateTexture()}drawLetterSpacing(e,t,s,i=!1){const n=this._style.letterSpacing;let o=!1;if(Qt.experimentalLetterSpacingSupported&&(Qt.experimentalLetterSpacing?(this.context.letterSpacing=`${n}px`,this.context.textLetterSpacing=`${n}px`,o=!0):(this.context.letterSpacing="0px",this.context.textLetterSpacing="0px")),n===0||o){i?this.context.strokeText(e,t,s):this.context.fillText(e,t,s);return}let a=t;const l=Qt.graphemeSegmenter(e);let h=this.context.measureText(e).width,c=0;for(let u=0;u<l.length;++u){const d=l[u];i?this.context.strokeText(d,a,s):this.context.fillText(d,a,s);let p="";for(let f=u+1;f<l.length;++f)p+=l[f];c=this.context.measureText(p).width,a+=h-c+n,h=c}}updateTexture(){const e=this.canvas;if(this._style.trim){const n=Yv(e);n.data&&(e.width=n.width,e.height=n.height,this.context.putImageData(n.data,0,0))}const t=this._texture,s=this._style,i=s.trim?0:s.padding,r=t.baseTexture;t.trim.width=t._frame.width=e.width/this._resolution,t.trim.height=t._frame.height=e.height/this._resolution,t.trim.x=-i,t.trim.y=-i,t.orig.width=t._frame.width-i*2,t.orig.height=t._frame.height-i*2,this._onTextureUpdate(),r.setRealSize(e.width,e.height,this._resolution),t.updateUvs(),this.dirty=!1}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._render(e)}updateTransform(){this.updateText(!0),super.updateTransform()}getBounds(e,t){return this.updateText(!0),this._textureID===-1&&(e=!1),super.getBounds(e,t)}getLocalBounds(e){return this.updateText(!0),super.getLocalBounds.call(this,e)}_calculateBounds(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_generateFillStyle(e,t,s){const i=e.fill;if(Array.isArray(i)){if(i.length===1)return i[0]}else return i;let r;const n=e.dropShadow?e.dropShadowDistance:0,o=e.padding||0,a=this.canvas.width/this._resolution-n-o*2,l=this.canvas.height/this._resolution-n-o*2,h=i.slice(),c=e.fillGradientStops.slice();if(!c.length){const u=h.length+1;for(let d=1;d<u;++d)c.push(d/u)}if(h.unshift(i[0]),c.unshift(0),h.push(i[i.length-1]),c.push(1),e.fillGradientType===so.LINEAR_VERTICAL){r=this.context.createLinearGradient(a/2,o,a/2,l+o);const u=s.fontProperties.fontSize+e.strokeThickness;for(let d=0;d<t.length;d++){const p=s.lineHeight*(d-1)+u,f=s.lineHeight*d;let m=f;d>0&&p>f&&(m=(f+p)/2);const _=f+u,v=s.lineHeight*(d+1);let T=_;d+1<t.length&&v<_&&(T=(_+v)/2);const g=(T-m)/l;for(let b=0;b<h.length;b++){let S=0;typeof c[b]=="number"?S=c[b]:S=b/h.length;let A=Math.min(1,Math.max(0,m/l+S*g));A=Number(A.toFixed(5)),r.addColorStop(A,h[b])}}}else{r=this.context.createLinearGradient(o,l/2,a+o,l/2);const u=h.length+1;let d=1;for(let p=0;p<h.length;p++){let f;typeof c[p]=="number"?f=c[p]:f=d/u,r.addColorStop(f,h[p]),d++}}return r}destroy(e){typeof e=="boolean"&&(e={children:e}),e=Object.assign({},nT,e),super.destroy(e),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width}set width(e){this.updateText(!0);const t=di(this.scale.x)||1;this.scale.x=t*e/this._texture.orig.width,this._width=e}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height}set height(e){this.updateText(!0);const t=di(this.scale.y)||1;this.scale.y=t*e/this._texture.orig.height,this._height=e}get style(){return this._style}set style(e){e=e||{},e instanceof Zs?this._style=e:this._style=new Zs(e),this.localStyleID=-1,this.dirty=!0}get text(){return this._text}set text(e){e=String(e??""),this._text!==e&&(this._text=e,this.dirty=!0)}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}};let Al=Na;Al.defaultAutoResolution=!0;class oT{constructor(t){this.maxItemsPerFrame=t,this.itemsLeft=0}beginFrame(){this.itemsLeft=this.maxItemsPerFrame}allowedToUpload(){return this.itemsLeft-- >0}}function aT(e,t){var i;let s=!1;if((i=e==null?void 0:e._textures)!=null&&i.length){for(let r=0;r<e._textures.length;r++)if(e._textures[r]instanceof J){const n=e._textures[r].baseTexture;t.includes(n)||(t.push(n),s=!0)}}return s}function lT(e,t){if(e.baseTexture instanceof pt){const s=e.baseTexture;return t.includes(s)||t.push(s),!0}return!1}function hT(e,t){if(e._texture&&e._texture instanceof J){const s=e._texture.baseTexture;return t.includes(s)||t.push(s),!0}return!1}function cT(e,t){return t instanceof Al?(t.updateText(!0),!0):!1}function uT(e,t){if(t instanceof Zs){const s=t.toFontString();return Qt.measureFont(s),!0}return!1}function dT(e,t){if(e instanceof Al){t.includes(e.style)||t.push(e.style),t.includes(e)||t.push(e);const s=e._texture.baseTexture;return t.includes(s)||t.push(s),!0}return!1}function fT(e,t){return e instanceof Zs?(t.includes(e)||t.push(e),!0):!1}const uf=class{constructor(e){this.limiter=new oT(uf.uploadsPerFrame),this.renderer=e,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=()=>{this.queue&&this.prepareItems()},this.registerFindHook(dT),this.registerFindHook(fT),this.registerFindHook(aT),this.registerFindHook(lT),this.registerFindHook(hT),this.registerUploadHook(cT),this.registerUploadHook(uT)}upload(e){return new Promise(t=>{e&&this.add(e),this.queue.length?(this.completes.push(t),this.ticking||(this.ticking=!0,Zt.system.addOnce(this.tick,this,qs.UTILITY))):t()})}tick(){setTimeout(this.delayedTick,0)}prepareItems(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){const e=this.queue[0];let t=!1;if(e&&!e._destroyed){for(let s=0,i=this.uploadHooks.length;s<i;s++)if(this.uploadHooks[s](this.uploadHookHelper,e)){this.queue.shift(),t=!0;break}}t||this.queue.shift()}if(this.queue.length)Zt.system.addOnce(this.tick,this,qs.UTILITY);else{this.ticking=!1;const e=this.completes.slice(0);this.completes.length=0;for(let t=0,s=e.length;t<s;t++)e[t]()}}registerFindHook(e){return e&&this.addHooks.push(e),this}registerUploadHook(e){return e&&this.uploadHooks.push(e),this}add(e){for(let t=0,s=this.addHooks.length;t<s&&!this.addHooks[t](e,this.queue);t++);if(e instanceof ce)for(let t=e.children.length-1;t>=0;t--)this.add(e.children[t]);return this}destroy(){this.ticking&&Zt.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null}};let Pn=uf;Pn.uploadsPerFrame=4;Object.defineProperties(q,{UPLOADS_PER_FRAME:{get(){return Pn.uploadsPerFrame},set(e){Ct("7.1.0","settings.UPLOADS_PER_FRAME is deprecated, use prepare.BasePrepare.uploadsPerFrame"),Pn.uploadsPerFrame=e}}});function df(e,t){return t instanceof pt?(t._glTextures[e.CONTEXT_UID]||e.texture.bind(t),!0):!1}function pT(e,t){if(!(t instanceof eo))return!1;const{geometry:s}=t;t.finishPoly(),s.updateBatches();const{batches:i}=s;for(let r=0;r<i.length;r++){const{texture:n}=i[r].style;n&&df(e,n.baseTexture)}return s.batchable||e.geometry.bind(s,t._resolveDirectShader(e)),!0}function mT(e,t){return e instanceof eo?(t.push(e),!0):!1}class ff extends Pn{constructor(t){super(t),this.uploadHookHelper=this.renderer,this.registerFindHook(mT),this.registerUploadHook(df),this.registerUploadHook(pT)}}ff.extension={name:"prepare",type:K.RendererSystem};rt.add(ff);class Mn extends Fi{constructor(t,s=!0){super(t[0]instanceof J?t[0]:t[0].texture),this._textures=null,this._durations=null,this._autoUpdate=s,this._isConnectedToTicker=!1,this.animationSpeed=1,this.loop=!0,this.updateAnchor=!1,this.onComplete=null,this.onFrameChange=null,this.onLoop=null,this._currentTime=0,this._playing=!1,this._previousFrame=null,this.textures=t}stop(){this._playing&&(this._playing=!1,this._autoUpdate&&this._isConnectedToTicker&&(Zt.shared.remove(this.update,this),this._isConnectedToTicker=!1))}play(){this._playing||(this._playing=!0,this._autoUpdate&&!this._isConnectedToTicker&&(Zt.shared.add(this.update,this,qs.HIGH),this._isConnectedToTicker=!0))}gotoAndStop(t){this.stop(),this.currentFrame=t}gotoAndPlay(t){this.currentFrame=t,this.play()}update(t){if(!this._playing)return;const s=this.animationSpeed*t,i=this.currentFrame;if(this._durations!==null){let r=this._currentTime%1*this._durations[this.currentFrame];for(r+=s/60*1e3;r<0;)this._currentTime--,r+=this._durations[this.currentFrame];const n=Math.sign(this.animationSpeed*t);for(this._currentTime=Math.floor(this._currentTime);r>=this._durations[this.currentFrame];)r-=this._durations[this.currentFrame]*n,this._currentTime+=n;this._currentTime+=r/this._durations[this.currentFrame]}else this._currentTime+=s;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):i!==this.currentFrame&&(this.loop&&this.onLoop&&(this.animationSpeed>0&&this.currentFrame<i||this.animationSpeed<0&&this.currentFrame>i)&&this.onLoop(),this.updateTexture())}updateTexture(){const t=this.currentFrame;this._previousFrame!==t&&(this._previousFrame=t,this._texture=this._textures[t],this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this.uvs=this._texture._uvs.uvsFloat32,this.updateAnchor&&this._anchor.copyFrom(this._texture.defaultAnchor),this.onFrameChange&&this.onFrameChange(this.currentFrame))}destroy(t){this.stop(),super.destroy(t),this.onComplete=null,this.onFrameChange=null,this.onLoop=null}static fromFrames(t){const s=[];for(let i=0;i<t.length;++i)s.push(J.from(t[i]));return new Mn(s)}static fromImages(t){const s=[];for(let i=0;i<t.length;++i)s.push(J.from(t[i]));return new Mn(s)}get totalFrames(){return this._textures.length}get textures(){return this._textures}set textures(t){if(t[0]instanceof J)this._textures=t,this._durations=null;else{this._textures=[],this._durations=[];for(let s=0;s<t.length;s++)this._textures.push(t[s].texture),this._durations.push(t[s].time)}this._previousFrame=null,this.gotoAndStop(0),this.updateTexture()}get currentFrame(){let t=Math.floor(this._currentTime)%this._textures.length;return t<0&&(t+=this._textures.length),t}set currentFrame(t){if(t<0||t>this.totalFrames-1)throw new Error(`[AnimatedSprite]: Invalid frame index value ${t}, expected to be between 0 and totalFrames ${this.totalFrames}.`);const s=this.currentFrame;this._currentTime=t,s!==this.currentFrame&&this.updateTexture()}get playing(){return this._playing}get autoUpdate(){return this._autoUpdate}set autoUpdate(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(Zt.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._playing&&(Zt.shared.add(this.update,this),this._isConnectedToTicker=!0))}}new Tt;var gT=`#version 300 es
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

in vec2 vTextureCoord;

out vec4 fragmentColor;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0

    fragmentColor = texSample * uColor;
}
`,_T=`#version 300 es
#define SHADER_NAME Tiling-Sprite-300

precision lowp float;

in vec2 aVertexPosition;
in vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

out vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,xT=`#version 100
#ifdef GL_EXT_shader_texture_lod
    #extension GL_EXT_shader_texture_lod : enable
#endif
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    #ifdef GL_EXT_shader_texture_lod
        vec4 texSample = unclamped == coord
            ? texture2D(uSampler, coord) 
            : texture2DLodEXT(uSampler, coord, 0);
    #else
        vec4 texSample = texture2D(uSampler, coord);
    #endif

    gl_FragColor = texSample * uColor;
}
`,Cc=`#version 100
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,vT=`#version 100
#define SHADER_NAME Tiling-Sprite-Simple-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;

void main(void)
{
    vec4 texSample = texture2D(uSampler, vTextureCoord);
    gl_FragColor = texSample * uColor;
}
`;const Yr=new Nt;class pf extends Zn{constructor(t){super(t),t.runners.contextChange.add(this),this.quad=new wd,this.state=us.for2d()}contextChange(){const t=this.renderer,s={globals:t.globalUniforms};this.simpleShader=qe.from(Cc,vT,s),this.shader=t.context.webGLVersion>1?qe.from(_T,gT,s):qe.from(Cc,xT,s)}render(t){const s=this.renderer,i=this.quad;let r=i.vertices;r[0]=r[6]=t._width*-t.anchor.x,r[1]=r[3]=t._height*-t.anchor.y,r[2]=r[4]=t._width*(1-t.anchor.x),r[5]=r[7]=t._height*(1-t.anchor.y);const n=t.uvRespectAnchor?t.anchor.x:0,o=t.uvRespectAnchor?t.anchor.y:0;r=i.uvs,r[0]=r[6]=-n,r[1]=r[3]=-o,r[2]=r[4]=1-n,r[5]=r[7]=1-o,i.invalidate();const a=t._texture,l=a.baseTexture,h=l.alphaMode>0,c=t.tileTransform.localTransform,u=t.uvMatrix;let d=l.isPowerOfTwo&&a.frame.width===l.width&&a.frame.height===l.height;d&&(l._glTextures[s.CONTEXT_UID]?d=l.wrapMode!==Ts.CLAMP:l.wrapMode===Ts.CLAMP&&(l.wrapMode=Ts.REPEAT));const p=d?this.simpleShader:this.shader,f=a.width,m=a.height,_=t._width,v=t._height;Yr.set(c.a*f/_,c.b*f/v,c.c*m/_,c.d*m/v,c.tx/_,c.ty/v),Yr.invert(),d?Yr.prepend(u.mapCoord):(p.uniforms.uMapCoord=u.mapCoord.toArray(!0),p.uniforms.uClampFrame=u.uClampFrame,p.uniforms.uClampOffset=u.uClampOffset),p.uniforms.uTransform=Yr.toArray(!0),p.uniforms.uColor=od(t.tint,t.worldAlpha,p.uniforms.uColor,h),p.uniforms.translationMatrix=t.transform.worldTransform.toArray(!0),p.uniforms.uSampler=a,s.shader.bind(p),s.geometry.bind(i),this.state.blendMode=nd(t.blendMode,h),s.state.set(this.state),s.geometry.draw(this.renderer.gl.TRIANGLES,6,0)}}pf.extension={name:"tilingSprite",type:K.RendererPlugin};rt.add(pf);const Zi=class{constructor(e,t,s=null){this.linkedSheets=[],this._texture=e instanceof J?e:null,this.baseTexture=e instanceof pt?e:this._texture.baseTexture,this.textures={},this.animations={},this.data=t;const i=this.baseTexture.resource;this.resolution=this._updateResolution(s||(i?i.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}_updateResolution(e=null){const{scale:t}=this.data.meta;let s=As(e,null);return s===null&&(s=parseFloat(t??"1")),s!==1&&this.baseTexture.setResolution(s),s}parse(){return new Promise(e=>{this._callback=e,this._batchIndex=0,this._frameKeys.length<=Zi.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(e){let t=e;const s=Zi.BATCH_SIZE;for(;t-e<s&&t<this._frameKeys.length;){const i=this._frameKeys[t],r=this._frames[i],n=r.frame;if(n){let o=null,a=null;const l=r.trimmed!==!1&&r.sourceSize?r.sourceSize:r.frame,h=new yt(0,0,Math.floor(l.w)/this.resolution,Math.floor(l.h)/this.resolution);r.rotated?o=new yt(Math.floor(n.x)/this.resolution,Math.floor(n.y)/this.resolution,Math.floor(n.h)/this.resolution,Math.floor(n.w)/this.resolution):o=new yt(Math.floor(n.x)/this.resolution,Math.floor(n.y)/this.resolution,Math.floor(n.w)/this.resolution,Math.floor(n.h)/this.resolution),r.trimmed!==!1&&r.spriteSourceSize&&(a=new yt(Math.floor(r.spriteSourceSize.x)/this.resolution,Math.floor(r.spriteSourceSize.y)/this.resolution,Math.floor(n.w)/this.resolution,Math.floor(n.h)/this.resolution)),this.textures[i]=new J(this.baseTexture,o,h,a,r.rotated?2:0,r.anchor),J.addToCache(this.textures[i],i)}t++}}_processAnimations(){const e=this.data.animations||{};for(const t in e){this.animations[t]=[];for(let s=0;s<e[t].length;s++){const i=e[t][s];this.animations[t].push(this.textures[i])}}}_parseComplete(){const e=this._callback;this._callback=null,this._batchIndex=0,e.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*Zi.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*Zi.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(e=!1){var t;for(const s in this.textures)this.textures[s].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,e&&((t=this._texture)==null||t.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null,this.linkedSheets=[]}};let Ua=Zi;Ua.BATCH_SIZE=1e3;const yT=["jpg","png","jpeg","avif","webp"];function mf(e,t,s){const i={};if(e.forEach(r=>{i[r]=t}),Object.keys(t.textures).forEach(r=>{i[r]=t.textures[r]}),!s){const r=se.dirname(e[0]);t.linkedSheets.forEach((n,o)=>{const a=mf([`${r}/${t.data.meta.related_multi_packs[o]}`],n,!0);Object.assign(i,a)})}return i}const ET={extension:K.Asset,cache:{test:e=>e instanceof Ua,getCacheableAssets:(e,t)=>mf(e,t,!1)},resolver:{test:e=>{const s=e.split("?")[0].split("."),i=s.pop(),r=s.pop();return i==="json"&&yT.includes(r)},parse:e=>{var s;const t=e.split(".");return{resolution:parseFloat(((s=q.RETINA_PREFIX.exec(e))==null?void 0:s[1])??"1"),format:t[t.length-2],src:e}}},loader:{extension:{type:K.LoadParser,priority:ts.Normal},async testParse(e,t){return se.extname(t.src).toLowerCase()===".json"&&!!e.frames},async parse(e,t,s){var h,c;let i=se.dirname(t.src);i&&i.lastIndexOf("/")!==i.length-1&&(i+="/");const r=i+e.meta.image,o=(await s.load([r]))[r],a=new Ua(o.baseTexture,e,t.src);await a.parse();const l=(h=e==null?void 0:e.meta)==null?void 0:h.related_multi_packs;if(Array.isArray(l)){const u=[];for(const p of l){if(typeof p!="string")continue;const f=i+p;(c=t.data)!=null&&c.ignoreMultiPack||u.push(s.load({src:f,data:{ignoreMultiPack:!0}}))}const d=await Promise.all(u);a.linkedSheets=d,d.forEach(p=>{p.linkedSheets=[a].concat(a.linkedSheets.filter(f=>f!==p))})}return a},unload(e){e.destroy(!0)}}};rt.add(ET);class On{constructor(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]}}class an{static test(t){return typeof t=="string"&&t.startsWith("info face=")}static parse(t){const s=t.match(/^[a-z]+\s+.+$/gm),i={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const n in s){const o=s[n].match(/^[a-z]+/gm)[0],a=s[n].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),l={};for(const h in a){const c=a[h].split("="),u=c[0],d=c[1].replace(/"/gm,""),p=parseFloat(d),f=isNaN(p)?d:p;l[u]=f}i[o].push(l)}const r=new On;return i.info.forEach(n=>r.info.push({face:n.face,size:parseInt(n.size,10)})),i.common.forEach(n=>r.common.push({lineHeight:parseInt(n.lineHeight,10)})),i.page.forEach(n=>r.page.push({id:parseInt(n.id,10),file:n.file})),i.char.forEach(n=>r.char.push({id:parseInt(n.id,10),page:parseInt(n.page,10),x:parseInt(n.x,10),y:parseInt(n.y,10),width:parseInt(n.width,10),height:parseInt(n.height,10),xoffset:parseInt(n.xoffset,10),yoffset:parseInt(n.yoffset,10),xadvance:parseInt(n.xadvance,10)})),i.kerning.forEach(n=>r.kerning.push({first:parseInt(n.first,10),second:parseInt(n.second,10),amount:parseInt(n.amount,10)})),i.distanceField.forEach(n=>r.distanceField.push({distanceRange:parseInt(n.distanceRange,10),fieldType:n.fieldType})),r}}class ka{static test(t){const s=t;return"getElementsByTagName"in s&&s.getElementsByTagName("page").length&&s.getElementsByTagName("info")[0].getAttribute("face")!==null}static parse(t){const s=new On,i=t.getElementsByTagName("info"),r=t.getElementsByTagName("common"),n=t.getElementsByTagName("page"),o=t.getElementsByTagName("char"),a=t.getElementsByTagName("kerning"),l=t.getElementsByTagName("distanceField");for(let h=0;h<i.length;h++)s.info.push({face:i[h].getAttribute("face"),size:parseInt(i[h].getAttribute("size"),10)});for(let h=0;h<r.length;h++)s.common.push({lineHeight:parseInt(r[h].getAttribute("lineHeight"),10)});for(let h=0;h<n.length;h++)s.page.push({id:parseInt(n[h].getAttribute("id"),10)||0,file:n[h].getAttribute("file")});for(let h=0;h<o.length;h++){const c=o[h];s.char.push({id:parseInt(c.getAttribute("id"),10),page:parseInt(c.getAttribute("page"),10)||0,x:parseInt(c.getAttribute("x"),10),y:parseInt(c.getAttribute("y"),10),width:parseInt(c.getAttribute("width"),10),height:parseInt(c.getAttribute("height"),10),xoffset:parseInt(c.getAttribute("xoffset"),10),yoffset:parseInt(c.getAttribute("yoffset"),10),xadvance:parseInt(c.getAttribute("xadvance"),10)})}for(let h=0;h<a.length;h++)s.kerning.push({first:parseInt(a[h].getAttribute("first"),10),second:parseInt(a[h].getAttribute("second"),10),amount:parseInt(a[h].getAttribute("amount"),10)});for(let h=0;h<l.length;h++)s.distanceField.push({fieldType:l[h].getAttribute("fieldType"),distanceRange:parseInt(l[h].getAttribute("distanceRange"),10)});return s}}class Ga{static test(t){return typeof t=="string"&&t.includes("<font>")?ka.test(q.ADAPTER.parseXML(t)):!1}static parse(t){return ka.parse(q.ADAPTER.parseXML(t))}}const Wo=[an,ka,Ga];function bT(e){for(let t=0;t<Wo.length;t++)if(Wo[t].test(e))return Wo[t];return null}function TT(e,t,s,i,r,n){const o=s.fill;if(Array.isArray(o)){if(o.length===1)return o[0]}else return o;let a;const l=s.dropShadow?s.dropShadowDistance:0,h=s.padding||0,c=e.width/i-l-h*2,u=e.height/i-l-h*2,d=o.slice(),p=s.fillGradientStops.slice();if(!p.length){const f=d.length+1;for(let m=1;m<f;++m)p.push(m/f)}if(d.unshift(o[0]),p.unshift(0),d.push(o[o.length-1]),p.push(1),s.fillGradientType===so.LINEAR_VERTICAL){a=t.createLinearGradient(c/2,h,c/2,u+h);let f=0;const _=(n.fontProperties.fontSize+s.strokeThickness)/u;for(let v=0;v<r.length;v++){const T=n.lineHeight*v;for(let g=0;g<d.length;g++){let b=0;typeof p[g]=="number"?b=p[g]:b=g/d.length;const S=T/u+b*_;let A=Math.max(f,S);A=Math.min(A,1),a.addColorStop(A,d[g]),f=A}}}else{a=t.createLinearGradient(h,u/2,c+h,u/2);const f=d.length+1;let m=1;for(let _=0;_<d.length;_++){let v;typeof p[_]=="number"?v=p[_]:v=m/f,a.addColorStop(v,d[_]),m++}}return a}function wT(e,t,s,i,r,n,o){const a=s.text,l=s.fontProperties;t.translate(i,r),t.scale(n,n);const h=o.strokeThickness/2,c=-(o.strokeThickness/2);if(t.font=o.toFontString(),t.lineWidth=o.strokeThickness,t.textBaseline=o.textBaseline,t.lineJoin=o.lineJoin,t.miterLimit=o.miterLimit,t.fillStyle=TT(e,t,o,n,[a],s),t.strokeStyle=o.stroke,o.dropShadow){const u=o.dropShadowColor,d=fr(typeof u=="number"?u:ml(u)),p=o.dropShadowBlur*n,f=o.dropShadowDistance*n;t.shadowColor=`rgba(${d[0]*255},${d[1]*255},${d[2]*255},${o.dropShadowAlpha})`,t.shadowBlur=p,t.shadowOffsetX=Math.cos(o.dropShadowAngle)*f,t.shadowOffsetY=Math.sin(o.dropShadowAngle)*f}else t.shadowColor="black",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0;o.stroke&&o.strokeThickness&&t.strokeText(a,h,c+s.lineHeight-l.descent),o.fill&&t.fillText(a,h,c+s.lineHeight-l.descent),t.setTransform(1,0,0,1,0,0),t.fillStyle="rgba(0, 0, 0, 0)"}function ln(e){return e.codePointAt?e.codePointAt(0):e.charCodeAt(0)}function gf(e){return Array.from?Array.from(e):e.split("")}function ST(e){typeof e=="string"&&(e=[e]);const t=[];for(let s=0,i=e.length;s<i;s++){const r=e[s];if(Array.isArray(r)){if(r.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${r.length}.`);const n=r[0].charCodeAt(0),o=r[1].charCodeAt(0);if(o<n)throw new Error("[BitmapFont]: Invalid character range.");for(let a=n,l=o;a<=l;a++)t.push(String.fromCharCode(a))}else t.push(...gf(r))}if(t.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return t}const Ie=class{constructor(e,t,s){var h;const[i]=e.info,[r]=e.common,[n]=e.page,[o]=e.distanceField,a=As(n.file),l={};this._ownsTextures=s,this.font=i.face,this.size=i.size,this.lineHeight=r.lineHeight/a,this.chars={},this.pageTextures=l;for(let c=0;c<e.page.length;c++){const{id:u,file:d}=e.page[c];l[u]=t instanceof Array?t[c]:t[d],o!=null&&o.fieldType&&o.fieldType!=="none"&&(l[u].baseTexture.alphaMode=Ne.NO_PREMULTIPLIED_ALPHA,l[u].baseTexture.mipmap=Je.OFF)}for(let c=0;c<e.char.length;c++){const{id:u,page:d}=e.char[c];let{x:p,y:f,width:m,height:_,xoffset:v,yoffset:T,xadvance:g}=e.char[c];p/=a,f/=a,m/=a,_/=a,v/=a,T/=a,g/=a;const b=new yt(p+l[d].frame.x/a,f+l[d].frame.y/a,m,_);this.chars[u]={xOffset:v,yOffset:T,xAdvance:g,kerning:{},texture:new J(l[d].baseTexture,b),page:d}}for(let c=0;c<e.kerning.length;c++){let{first:u,second:d,amount:p}=e.kerning[c];u/=a,d/=a,p/=a,this.chars[d]&&(this.chars[d].kerning[u]=p)}this.distanceFieldRange=o==null?void 0:o.distanceRange,this.distanceFieldType=((h=o==null?void 0:o.fieldType)==null?void 0:h.toLowerCase())??"none"}destroy(){for(const e in this.chars)this.chars[e].texture.destroy(),this.chars[e].texture=null;for(const e in this.pageTextures)this._ownsTextures&&this.pageTextures[e].destroy(!0),this.pageTextures[e]=null;this.chars=null,this.pageTextures=null}static install(e,t,s){let i;if(e instanceof On)i=e;else{const n=bT(e);if(!n)throw new Error("Unrecognized data format for font.");i=n.parse(e)}t instanceof J&&(t=[t]);const r=new Ie(i,t,s);return Ie.available[r.font]=r,r}static uninstall(e){const t=Ie.available[e];if(!t)throw new Error(`No font found named '${e}'`);t.destroy(),delete Ie.available[e]}static from(e,t,s){if(!e)throw new Error("[BitmapFont] Property `name` is required.");const{chars:i,padding:r,resolution:n,textureWidth:o,textureHeight:a,...l}=Object.assign({},Ie.defaultOptions,s),h=ST(i),c=t instanceof Zs?t:new Zs(t),u=o,d=new On;d.info[0]={face:c.fontFamily,size:c.fontSize},d.common[0]={lineHeight:c.fontSize};let p=0,f=0,m,_,v,T=0;const g=[];for(let S=0;S<h.length;S++){m||(m=q.ADAPTER.createCanvas(),m.width=o,m.height=a,_=m.getContext("2d"),v=new pt(m,{resolution:n,...l}),g.push(new J(v)),d.page.push({id:g.length-1,file:""}));const A=h[S],y=Qt.measureText(A,c,!1,m),E=y.width,I=Math.ceil(y.height),F=Math.ceil((c.fontStyle==="italic"?2:1)*E);if(f>=a-I*n){if(f===0)throw new Error(`[BitmapFont] textureHeight ${a}px is too small (fontFamily: '${c.fontFamily}', fontSize: ${c.fontSize}px, char: '${A}')`);--S,m=null,_=null,v=null,f=0,p=0,T=0;continue}if(T=Math.max(I+y.fontProperties.descent,T),F*n+p>=u){if(p===0)throw new Error(`[BitmapFont] textureWidth ${o}px is too small (fontFamily: '${c.fontFamily}', fontSize: ${c.fontSize}px, char: '${A}')`);--S,f+=T*n,f=Math.ceil(f),p=0,T=0;continue}wT(m,_,y,p,f,n,c);const L=ln(y.text);d.char.push({id:L,page:g.length-1,x:p/n,y:f/n,width:F,height:I,xoffset:0,yoffset:0,xadvance:Math.ceil(E-(c.dropShadow?c.dropShadowDistance:0)-(c.stroke?c.strokeThickness:0))}),p+=(F+2*r)*n,p=Math.ceil(p)}for(let S=0,A=h.length;S<A;S++){const y=h[S];for(let E=0;E<A;E++){const I=h[E],F=_.measureText(y).width,L=_.measureText(I).width,D=_.measureText(y+I).width-(F+L);D&&d.kerning.push({first:ln(y),second:ln(I),amount:D})}}const b=new Ie(d,g,!0);return Ie.available[e]!==void 0&&Ie.uninstall(e),Ie.available[e]=b,b}};let he=Ie;he.ALPHA=[["a","z"],["A","Z"]," "];he.NUMERIC=[["0","9"]];he.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "];he.ASCII=[[" ","~"]];he.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:Ie.ALPHANUMERIC};he.available={};var AT=`// Pixi texture info\r
varying vec2 vTextureCoord;\r
uniform sampler2D uSampler;\r
\r
// Tint\r
uniform vec4 uColor;\r
\r
// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r
uniform float uFWidth;\r
\r
void main(void) {\r
\r
  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r
  vec4 texColor = texture2D(uSampler, vTextureCoord);\r
\r
  // MSDF\r
  float median = texColor.r + texColor.g + texColor.b -\r
                  min(texColor.r, min(texColor.g, texColor.b)) -\r
                  max(texColor.r, max(texColor.g, texColor.b));\r
  // SDF\r
  median = min(median, texColor.a);\r
\r
  float screenPxDistance = uFWidth * (median - 0.5);\r
  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r
  if (median < 0.01) {\r
    alpha = 0.0;\r
  } else if (median > 0.99) {\r
    alpha = 1.0;\r
  }\r
\r
  // NPM Textures, NPM outputs\r
  gl_FragColor = vec4(uColor.rgb, uColor.a * alpha);\r
\r
}\r
`,CT=`// Mesh material default fragment\r
attribute vec2 aVertexPosition;\r
attribute vec2 aTextureCoord;\r
\r
uniform mat3 projectionMatrix;\r
uniform mat3 translationMatrix;\r
uniform mat3 uTextureMatrix;\r
\r
varying vec2 vTextureCoord;\r
\r
void main(void)\r
{\r
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r
\r
    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r
}\r
`;const Ic=[],Rc=[],Pc=[],_f=class extends ce{constructor(e,t={}){super(),this._tint=16777215;const{align:s,tint:i,maxWidth:r,letterSpacing:n,fontName:o,fontSize:a}=Object.assign({},_f.styleDefaults,t);if(!he.available[o])throw new Error(`Missing BitmapFont "${o}"`);this._activePagesMeshData=[],this._textWidth=0,this._textHeight=0,this._align=s,this._tint=i,this._font=void 0,this._fontName=o,this._fontSize=a,this.text=e,this._maxWidth=r,this._maxLineHeight=0,this._letterSpacing=n,this._anchor=new vs(()=>{this.dirty=!0},this,0,0),this._roundPixels=q.ROUND_PIXELS,this.dirty=!0,this._resolution=q.RESOLUTION,this._autoResolution=!0,this._textureCache={}}updateText(){var F;const e=he.available[this._fontName],t=this.fontSize,s=t/e.size,i=new Tt,r=[],n=[],o=[],a=this._text.replace(/(?:\r\n|\r)/g,`
`)||" ",l=gf(a),h=this._maxWidth*e.size/t,c=e.distanceFieldType==="none"?Ic:Rc;let u=null,d=0,p=0,f=0,m=-1,_=0,v=0,T=0,g=0;for(let L=0;L<l.length;L++){const j=l[L],D=ln(j);if(/(?:\s)/.test(j)&&(m=L,_=d,g++),j==="\r"||j===`
`){n.push(d),o.push(-1),p=Math.max(p,d),++f,++v,i.x=0,i.y+=e.lineHeight,u=null,g=0;continue}const P=e.chars[D];if(!P)continue;u&&P.kerning[u]&&(i.x+=P.kerning[u]);const ut=Pc.pop()||{texture:J.EMPTY,line:0,charCode:0,prevSpaces:0,position:new Tt};ut.texture=P.texture,ut.line=f,ut.charCode=D,ut.position.x=i.x+P.xOffset+this._letterSpacing/2,ut.position.y=i.y+P.yOffset,ut.prevSpaces=g,r.push(ut),d=ut.position.x+Math.max(P.xAdvance-P.xOffset,P.texture.orig.width),i.x+=P.xAdvance+this._letterSpacing,T=Math.max(T,P.yOffset+P.texture.height),u=D,m!==-1&&h>0&&i.x>h&&(++v,yi(r,1+m-v,1+L-m),L=m,m=-1,n.push(_),o.push(r.length>0?r[r.length-1].prevSpaces:0),p=Math.max(p,_),f++,i.x=0,i.y+=e.lineHeight,u=null,g=0)}const b=l[l.length-1];b!=="\r"&&b!==`
`&&(/(?:\s)/.test(b)&&(d=_),n.push(d),p=Math.max(p,d),o.push(-1));const S=[];for(let L=0;L<=f;L++){let j=0;this._align==="right"?j=p-n[L]:this._align==="center"?j=(p-n[L])/2:this._align==="justify"&&(j=o[L]<0?0:(p-n[L])/o[L]),S.push(j)}const A=r.length,y={},E=[],I=this._activePagesMeshData;c.push(...I);for(let L=0;L<A;L++){const j=r[L].texture,D=j.baseTexture.uid;if(!y[D]){let P=c.pop();if(!P){const nt=new Jb;let G,st;e.distanceFieldType==="none"?(G=new wc(J.EMPTY),st=ct.NORMAL):(G=new wc(J.EMPTY,{program:Me.from(CT,AT),uniforms:{uFWidth:0}}),st=ct.NORMAL_NPM);const At=new La(nt,G);At.blendMode=st,P={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:At,vertices:null,uvs:null,indices:null}}P.index=0,P.indexCount=0,P.vertexCount=0,P.uvsCount=0,P.total=0;const{_textureCache:ut}=this;ut[D]=ut[D]||new J(j.baseTexture),P.mesh.texture=ut[D],P.mesh.tint=this._tint,E.push(P),y[D]=P}y[D].total++}for(let L=0;L<I.length;L++)E.includes(I[L])||this.removeChild(I[L].mesh);for(let L=0;L<E.length;L++)E[L].mesh.parent!==this&&this.addChild(E[L].mesh);this._activePagesMeshData=E;for(const L in y){const j=y[L],D=j.total;if(!(((F=j.indices)==null?void 0:F.length)>6*D)||j.vertices.length<La.BATCHABLE_SIZE*2)j.vertices=new Float32Array(4*2*D),j.uvs=new Float32Array(4*2*D),j.indices=new Uint16Array(6*D);else{const P=j.total,ut=j.vertices;for(let nt=P*4*2;nt<ut.length;nt++)ut[nt]=0}j.mesh.size=6*D}for(let L=0;L<A;L++){const j=r[L];let D=j.position.x+S[j.line]*(this._align==="justify"?j.prevSpaces:1);this._roundPixels&&(D=Math.round(D));const P=D*s,ut=j.position.y*s,nt=j.texture,G=y[nt.baseTexture.uid],st=nt.frame,At=nt._uvs,N=G.index++;G.indices[N*6+0]=0+N*4,G.indices[N*6+1]=1+N*4,G.indices[N*6+2]=2+N*4,G.indices[N*6+3]=0+N*4,G.indices[N*6+4]=2+N*4,G.indices[N*6+5]=3+N*4,G.vertices[N*8+0]=P,G.vertices[N*8+1]=ut,G.vertices[N*8+2]=P+st.width*s,G.vertices[N*8+3]=ut,G.vertices[N*8+4]=P+st.width*s,G.vertices[N*8+5]=ut+st.height*s,G.vertices[N*8+6]=P,G.vertices[N*8+7]=ut+st.height*s,G.uvs[N*8+0]=At.x0,G.uvs[N*8+1]=At.y0,G.uvs[N*8+2]=At.x1,G.uvs[N*8+3]=At.y1,G.uvs[N*8+4]=At.x2,G.uvs[N*8+5]=At.y2,G.uvs[N*8+6]=At.x3,G.uvs[N*8+7]=At.y3}this._textWidth=p*s,this._textHeight=(i.y+e.lineHeight)*s;for(const L in y){const j=y[L];if(this.anchor.x!==0||this.anchor.y!==0){let nt=0;const G=this._textWidth*this.anchor.x,st=this._textHeight*this.anchor.y;for(let At=0;At<j.total;At++)j.vertices[nt++]-=G,j.vertices[nt++]-=st,j.vertices[nt++]-=G,j.vertices[nt++]-=st,j.vertices[nt++]-=G,j.vertices[nt++]-=st,j.vertices[nt++]-=G,j.vertices[nt++]-=st}this._maxLineHeight=T*s;const D=j.mesh.geometry.getBuffer("aVertexPosition"),P=j.mesh.geometry.getBuffer("aTextureCoord"),ut=j.mesh.geometry.getIndex();D.data=j.vertices,P.data=j.uvs,ut.data=j.indices,D.update(),P.update(),ut.update()}for(let L=0;L<r.length;L++)Pc.push(r[L]);this._font=e,this.dirty=!1}updateTransform(){this.validate(),this.containerUpdateTransform()}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0);const{distanceFieldRange:t,distanceFieldType:s,size:i}=he.available[this._fontName];if(s!=="none"){const{a:r,b:n,c:o,d:a}=this.worldTransform,l=Math.sqrt(r*r+n*n),h=Math.sqrt(o*o+a*a),c=(Math.abs(l)+Math.abs(h))/2,u=this.fontSize/i,d=e._view.resolution;for(const p of this._activePagesMeshData)p.mesh.shader.uniforms.uFWidth=c*t*u*d}super._render(e)}getLocalBounds(){return this.validate(),super.getLocalBounds()}validate(){const e=he.available[this._fontName];if(!e)throw new Error(`Missing BitmapFont "${this._fontName}"`);this._font!==e&&(this.dirty=!0),this.dirty&&this.updateText()}get tint(){return this._tint}set tint(e){if(this._tint!==e){this._tint=e;for(let t=0;t<this._activePagesMeshData.length;t++)this._activePagesMeshData[t].mesh.tint=e}}get align(){return this._align}set align(e){this._align!==e&&(this._align=e,this.dirty=!0)}get fontName(){return this._fontName}set fontName(e){if(!he.available[e])throw new Error(`Missing BitmapFont "${e}"`);this._fontName!==e&&(this._fontName=e,this.dirty=!0)}get fontSize(){return this._fontSize??he.available[this._fontName].size}set fontSize(e){this._fontSize!==e&&(this._fontSize=e,this.dirty=!0)}get anchor(){return this._anchor}set anchor(e){typeof e=="number"?this._anchor.set(e):this._anchor.copyFrom(e)}get text(){return this._text}set text(e){e=String(e??""),this._text!==e&&(this._text=e,this.dirty=!0)}get maxWidth(){return this._maxWidth}set maxWidth(e){this._maxWidth!==e&&(this._maxWidth=e,this.dirty=!0)}get maxLineHeight(){return this.validate(),this._maxLineHeight}get textWidth(){return this.validate(),this._textWidth}get letterSpacing(){return this._letterSpacing}set letterSpacing(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.dirty=!0)}get roundPixels(){return this._roundPixels}set roundPixels(e){e!==this._roundPixels&&(this._roundPixels=e,this.dirty=!0)}get textHeight(){return this.validate(),this._textHeight}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}destroy(e){const{_textureCache:t}=this,i=he.available[this._fontName].distanceFieldType==="none"?Ic:Rc;i.push(...this._activePagesMeshData);for(const r of this._activePagesMeshData)this.removeChild(r.mesh);this._activePagesMeshData=[],i.filter(r=>t[r.mesh.texture.baseTexture.uid]).forEach(r=>{r.mesh.texture=J.EMPTY});for(const r in t)t[r].destroy(),delete t[r];this._font=null,this._textureCache=null,super.destroy(e)}};let IT=_f;IT.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0};const RT=[".xml",".fnt"],PT={extension:{type:K.LoadParser,priority:ts.Normal},test(e){return RT.includes(se.extname(e).toLowerCase())},async testParse(e){return an.test(e)||Ga.test(e)},async parse(e,t,s){const i=an.test(e)?an.parse(e):Ga.parse(e),{src:r}=t,{page:n}=i,o=[];for(let h=0;h<n.length;++h){const c=n[h].file,u=se.join(se.dirname(r),c);o.push(u)}const a=await s.load(o),l=o.map(h=>a[h]);return he.install(i,l,!0)},async load(e,t){return(await q.ADAPTER.fetch(e)).text()},unload(e){e.destroy()}};rt.add(PT);let Mc=0,Oc=0,$o=0,Xo=0,jo=0;const Bc=5,Cl=(e,t)=>(e&&t&&(Mc=e.maxX,Oc=e.maxY,$o=t.width,Xo=t.height,$o>Xo?jo=Xo*((100-Bc)/100)/(Oc+1):jo=$o*((100-Bc)/100)/(Mc+1)),jo),xf=Cl(),MT=33*xf,OT=18*xf,BT={powerPreference:"high-performance",width:MT,height:OT,autoDensity:!0,preserveDrawingBuffer:!0,antialias:!0},DT=8,FT=100,Js=80,LT="/things/game_sprites.json",NT=()=>(q.RENDER_OPTIONS.hello=!1,ve.defaultMode=Vn.AUTO,me.defaultBatchSize=Math.min(me.defaultBatchSize,16),new bl(BT));let Kr;const UT=new Uint8Array(16);function kT(){if(!Kr&&(Kr=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Kr))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Kr(UT)}const Jt=[];for(let e=0;e<256;++e)Jt.push((e+256).toString(16).slice(1));function GT(e,t=0){return(Jt[e[t+0]]+Jt[e[t+1]]+Jt[e[t+2]]+Jt[e[t+3]]+"-"+Jt[e[t+4]]+Jt[e[t+5]]+"-"+Jt[e[t+6]]+Jt[e[t+7]]+"-"+Jt[e[t+8]]+Jt[e[t+9]]+"-"+Jt[e[t+10]]+Jt[e[t+11]]+Jt[e[t+12]]+Jt[e[t+13]]+Jt[e[t+14]]+Jt[e[t+15]]).toLowerCase()}const HT=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Dc={randomUUID:HT};function WT(e,t,s){if(Dc.randomUUID&&!t&&!e)return Dc.randomUUID();e=e||{};const i=e.random||(e.rng||kT)();if(i[6]=i[6]&15|64,i[8]=i[8]&63|128,t){s=s||0;for(let r=0;r<16;++r)t[s+r]=i[r];return t}return GT(i)}const Qs=()=>WT();globalThis&&globalThis.__spreadArray;var $T=function(e){return e._tag==="Some"},XT={_tag:"None"},jT=function(e){return{_tag:"Some",value:e}},Mt=XT,qt=jT,je=$T,bt=function(e){return e._tag==="None"};class zT{constructor(){$(this,"_containerPackages",[]);$(this,"_emptyContainerPackages",[])}get _nonEmptySize(){return this._containerPackages.length}_removeContainerPackage(t){const s=this._containerPackages.findIndex(i=>i.id===t);if(s===-1){if(this._emptyContainerPackages.findIndex(r=>r.id===t)===-1)throw new Error(`containerPackage ${t} does not exist.`);this._emptyContainerPackages.splice(s,1);return}this._containerPackages.splice(s,1)}hasContainerById(t){return this._containerPackages.concat(this._emptyContainerPackages).findIndex(s=>s.id===t)!==-1}hasContainerByName(t){return this._containerPackages.concat(this._emptyContainerPackages).findIndex(s=>s.name===t)!==-1}hasAnyContainer(){return this._containerPackages.concat(this._emptyContainerPackages).length!==0}getNonEmptyContainerByIndex(t){const s=this._nonEmptySize;if(t<0||t>=s)throw new Error(`Index ${t} out of range`);const i=this._containerPackages[t];if(!i)throw new Error(`Container package ${t} not a valid container package`);return this._removeContainerPackage(i.id),i.container}getEmptyContainer(){const t=this._emptyContainerPackages.length;if(t===0)return Mt;const s=this._emptyContainerPackages[t-1];return this._removeContainerPackage(s.id),qt(s.container)}getContainerByName(t){let s=this._containerPackages.find(i=>i.name===t);if(!s){const i=this._emptyContainerPackages.find(r=>r.name===t);if(!i)throw new Error(`Invalid container ${t} not found`);s=i}return this._removeContainerPackage(s.id),s.container}addContainer(t,s,i){const n={id:Qs(),name:s,container:t};t.children.length===0&&this._emptyContainerPackages.splice(Number(i),0,n),this._containerPackages.splice(Number(i),0,n)}}const VT=()=>new zT;class Ti{constructor(t){$(this,"compare");this.compare=t||Ti.defaultCompareFunction}static defaultCompareFunction(t,s){return t===s?0:t<s?-1:1}equal(t,s){return this.compare(t,s)===0}lessThan(t,s){return this.compare(t,s)<0}greaterThan(t,s){return this.compare(t,s)>0}lessThanOrEqual(t,s){return this.lessThan(t,s)||this.equal(t,s)}greaterThanOrEqual(t,s){return this.greaterThan(t,s)||this.equal(t,s)}reverse(){const t=this.compare;this.compare=(s,i)=>t(i,s)}}class Il{constructor(t){$(this,"compare");$(this,"heapContainer");if(new.target===Il)throw new TypeError("Cannot construct Heap instance directly");this.heapContainer=[],this.compare=new Ti(t)}getLeftChildIndex(t){return 2*t+1}getRightChildIndex(t){return 2*t+2}getParentIndex(t){return Math.floor((t-1)/2)}hasParent(t){return this.getParentIndex(t)>=0}hasLeftChild(t){return this.getLeftChildIndex(t)<this.heapContainer.length}hasRightChild(t){return this.getRightChildIndex(t)<this.heapContainer.length}leftChild(t){return this.heapContainer[this.getLeftChildIndex(t)]}rightChild(t){return this.heapContainer[this.getRightChildIndex(t)]}parent(t){return this.heapContainer[this.getParentIndex(t)]}swap(t,s){const i=this.heapContainer[s];this.heapContainer[s]=this.heapContainer[t],this.heapContainer[t]=i}peek(){return this.heapContainer.length===0?null:this.heapContainer[0]}poll(){if(this.heapContainer.length===0)return null;if(this.heapContainer.length===1)return this.heapContainer.pop();const t=this.heapContainer[0];return this.heapContainer[0]=this.heapContainer.pop(),this.heapifyDown(),t}add(t){return this.heapContainer.push(t),this.heapifyUp(),this}remove(t,s=this.compare){const i=this.find(t,s).length;for(let r=0;r<i;r+=1){const n=Number(this.find(t,s).pop());if(n===this.heapContainer.length-1)this.heapContainer.pop();else{this.heapContainer[n]=this.heapContainer.pop();const o=this.parent(n);this.hasLeftChild(n)&&(!o||this.pairIsInCorrectOrder(o,this.heapContainer[n]))?this.heapifyDown(n):this.heapifyUp(n)}}return this}find(t,s=this.compare){const i=[];for(let r=0;r<this.heapContainer.length;r+=1)s.equal(t,this.heapContainer[r])&&i.push(r);return i}isEmpty(){return!this.heapContainer.length}toString(){return this.heapContainer.toString()}heapifyUp(t){let s=t||this.heapContainer.length-1;for(;this.hasParent(s)&&!this.pairIsInCorrectOrder(this.parent(s),this.heapContainer[s]);)this.swap(s,this.getParentIndex(s)),s=this.getParentIndex(s)}heapifyDown(t=0){let s=t,i=null;for(;this.hasLeftChild(s)&&(this.hasRightChild(s)&&this.pairIsInCorrectOrder(this.rightChild(s),this.leftChild(s))?i=this.getRightChildIndex(s):i=this.getLeftChildIndex(s),!this.pairIsInCorrectOrder(this.heapContainer[s],this.heapContainer[i]));)this.swap(s,i),s=i}pairIsInCorrectOrder(t,s){throw new Error(`
      You have to implement heap pair comparision method
      for ${t} and ${s} values.
    `)}clear(){this.heapContainer.length=0}heapSize(){return this.heapContainer.length}}class YT extends Il{pairIsInCorrectOrder(t,s){return this.compare.lessThanOrEqual(t,s)}}class vf extends YT{constructor(){super();$(this,"priorities");this.priorities=new Map,this.compare=new Ti(this.comparePriority.bind(this))}add(s,i=0){return this.priorities.set(s,i),super.add(s),this}remove(s,i){return super.remove(s,i),this.priorities.delete(s),this}changePriority(s,i){return this.remove(s,new Ti(this.compareValue)),this.add(s,i),this}findByValue(s){return this.find(s,new Ti(this.compareValue))}hasValue(s){return this.findByValue(s).length>0}comparePriority(s,i){return this.priorities.get(s)===this.priorities.get(i)?0:Number(this.priorities.get(s))<Number(this.priorities.get(i))?-1:1}compareValue(s,i){return s===i?0:s<i?-1:1}size(){return this.heapSize()}}const KT=(e,t,...s)=>{let i;return()=>{clearTimeout(i),i=setTimeout(()=>{e(s)},t)}};var Bn={},qT={get exports(){return Bn},set exports(e){Bn=e}};(function(e){(function(t,s,i){if(!t)return;for(var r={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},n={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},o={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},a={option:"alt",command:"meta",return:"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},l,h=1;h<20;++h)r[111+h]="f"+h;for(h=0;h<=9;++h)r[h+96]=h.toString();function c(y,E,I){if(y.addEventListener){y.addEventListener(E,I,!1);return}y.attachEvent("on"+E,I)}function u(y){if(y.type=="keypress"){var E=String.fromCharCode(y.which);return y.shiftKey||(E=E.toLowerCase()),E}return r[y.which]?r[y.which]:n[y.which]?n[y.which]:String.fromCharCode(y.which).toLowerCase()}function d(y,E){return y.sort().join(",")===E.sort().join(",")}function p(y){var E=[];return y.shiftKey&&E.push("shift"),y.altKey&&E.push("alt"),y.ctrlKey&&E.push("ctrl"),y.metaKey&&E.push("meta"),E}function f(y){if(y.preventDefault){y.preventDefault();return}y.returnValue=!1}function m(y){if(y.stopPropagation){y.stopPropagation();return}y.cancelBubble=!0}function _(y){return y=="shift"||y=="ctrl"||y=="alt"||y=="meta"}function v(){if(!l){l={};for(var y in r)y>95&&y<112||r.hasOwnProperty(y)&&(l[r[y]]=y)}return l}function T(y,E,I){return I||(I=v()[y]?"keydown":"keypress"),I=="keypress"&&E.length&&(I="keydown"),I}function g(y){return y==="+"?["+"]:(y=y.replace(/\+{2}/g,"+plus"),y.split("+"))}function b(y,E){var I,F,L,j=[];for(I=g(y),L=0;L<I.length;++L)F=I[L],a[F]&&(F=a[F]),E&&E!="keypress"&&o[F]&&(F=o[F],j.push("shift")),_(F)&&j.push(F);return E=T(F,j,E),{key:F,modifiers:j,action:E}}function S(y,E){return y===null||y===s?!1:y===E?!0:S(y.parentNode,E)}function A(y){var E=this;if(y=y||s,!(E instanceof A))return new A(y);E.target=y,E._callbacks={},E._directMap={};var I={},F,L=!1,j=!1,D=!1;function P(U){U=U||{};var Y=!1,it;for(it in I){if(U[it]){Y=!0;continue}I[it]=0}Y||(D=!1)}function ut(U,Y,it,Q,dt,_t){var ht,xt,Bt=[],Rt=it.type;if(!E._callbacks[U])return[];for(Rt=="keyup"&&_(U)&&(Y=[U]),ht=0;ht<E._callbacks[U].length;++ht)if(xt=E._callbacks[U][ht],!(!Q&&xt.seq&&I[xt.seq]!=xt.level)&&Rt==xt.action&&(Rt=="keypress"&&!it.metaKey&&!it.ctrlKey||d(Y,xt.modifiers))){var Pt=!Q&&xt.combo==dt,x=Q&&xt.seq==Q&&xt.level==_t;(Pt||x)&&E._callbacks[U].splice(ht,1),Bt.push(xt)}return Bt}function nt(U,Y,it,Q){E.stopCallback(Y,Y.target||Y.srcElement,it,Q)||U(Y,it)===!1&&(f(Y),m(Y))}E._handleKey=function(U,Y,it){var Q=ut(U,Y,it),dt,_t={},ht=0,xt=!1;for(dt=0;dt<Q.length;++dt)Q[dt].seq&&(ht=Math.max(ht,Q[dt].level));for(dt=0;dt<Q.length;++dt){if(Q[dt].seq){if(Q[dt].level!=ht)continue;xt=!0,_t[Q[dt].seq]=1,nt(Q[dt].callback,it,Q[dt].combo,Q[dt].seq);continue}xt||nt(Q[dt].callback,it,Q[dt].combo)}var Bt=it.type=="keypress"&&j;it.type==D&&!_(U)&&!Bt&&P(_t),j=xt&&it.type=="keydown"};function G(U){typeof U.which!="number"&&(U.which=U.keyCode);var Y=u(U);if(Y){if(U.type=="keyup"&&L===Y){L=!1;return}E.handleKey(Y,p(U),U)}}function st(){clearTimeout(F),F=setTimeout(P,1e3)}function At(U,Y,it,Q){I[U]=0;function dt(Rt){return function(){D=Rt,++I[U],st()}}function _t(Rt){nt(it,Rt,U),Q!=="keyup"&&(L=u(Rt)),setTimeout(P,10)}for(var ht=0;ht<Y.length;++ht){var xt=ht+1===Y.length,Bt=xt?_t:dt(Q||b(Y[ht+1]).action);N(Y[ht],Bt,Q,U,ht)}}function N(U,Y,it,Q,dt){E._directMap[U+":"+it]=Y,U=U.replace(/\s+/g," ");var _t=U.split(" "),ht;if(_t.length>1){At(U,_t,Y,it);return}ht=b(U,it),E._callbacks[ht.key]=E._callbacks[ht.key]||[],ut(ht.key,ht.modifiers,{type:ht.action},Q,U,dt),E._callbacks[ht.key][Q?"unshift":"push"]({callback:Y,modifiers:ht.modifiers,action:ht.action,seq:Q,level:dt,combo:U})}E._bindMultiple=function(U,Y,it){for(var Q=0;Q<U.length;++Q)N(U[Q],Y,it)},c(y,"keypress",G),c(y,"keydown",G),c(y,"keyup",G)}A.prototype.bind=function(y,E,I){var F=this;return y=y instanceof Array?y:[y],F._bindMultiple.call(F,y,E,I),F},A.prototype.unbind=function(y,E){var I=this;return I.bind.call(I,y,function(){},E)},A.prototype.trigger=function(y,E){var I=this;return I._directMap[y+":"+E]&&I._directMap[y+":"+E]({},y),I},A.prototype.reset=function(){var y=this;return y._callbacks={},y._directMap={},y},A.prototype.stopCallback=function(y,E){var I=this;if((" "+E.className+" ").indexOf(" mousetrap ")>-1||S(E,I.target))return!1;if("composedPath"in y&&typeof y.composedPath=="function"){var F=y.composedPath()[0];F!==y.target&&(E=F)}return E.tagName=="INPUT"||E.tagName=="SELECT"||E.tagName=="TEXTAREA"||E.isContentEditable},A.prototype.handleKey=function(){var y=this;return y._handleKey.apply(y,arguments)},A.addKeycodes=function(y){for(var E in y)y.hasOwnProperty(E)&&(r[E]=y[E]);l=null},A.init=function(){var y=A(s);for(var E in y)E.charAt(0)!=="_"&&(A[E]=function(I){return function(){return y[I].apply(y,arguments)}}(E))},A.init(),t.Mousetrap=A,e.exports&&(e.exports=A),typeof i=="function"&&i.amd&&i(function(){return A})})(typeof window<"u"?window:null,typeof window<"u"?document:null)})(qT);class yf{constructor(){$(this,"_changed",!1);$(this,"_observers");this._observers=new Array}addObserver(t){if(!t)throw new Error(`observer is ${typeof t}`);this._observers.includes(t)||this._observers.push(t)}clearChanged(){this._changed=!1}countObservers(){return this._observers.length}deleteObserver(t){const s=this._observers.findIndex(i=>i.observeId===t.observeId);s!==-1&&this._observers.splice(s,1)}deleteObservers(){for(;this._observers.length;)this._observers.pop();this._observers.length=0}hasChanged(){return this._changed}async notifyObservers(...t){let s=[];this.hasChanged()&&(s=this._observers.slice(),this.clearChanged());const i=[];for(let r=s.length-1;r>=0;r--)i.push(s[r].update(this,...t));await Promise.allSettled(i)}setChanged(){this._changed=!0}}var is=(e=>(e.UP="up",e.DOWN="down",e.LEFT="left",e.RIGHT="right",e.ESC="esc",e))(is||{});const Ha=[{command:{value:"up"},priority:1},{command:{value:"down"},priority:1},{command:{value:"left"},priority:1},{command:{value:"right"},priority:1}],ZT=()=>{const e=new Map;for(const t of Ha)e.set(t.command,t.priority);return e};class JT{constructor(){$(this,"_commandPackages",new vf);$(this,"_commandPrioritiesMap",ZT());$(this,"_dispatchNotifier",new yf);$(this,"_commandWatchServiceStarted",!1)}_judgementCommandPriority(t){const s=this._commandPrioritiesMap.get(t);if(typeof s>"u"||s===void 0)throw new Error(`this command ${t} is not have any priority defined`);return s===0?s:Date.now()}get _size(){return this._commandPackages.size()}addCommand(t){this._size<DT&&KT(()=>{const s=this._judgementCommandPriority(t);this._commandPackages.add({command:t,priority:s},s),this._dispatchNotifier.setChanged(),this._dispatchNotifier.notifyObservers().then()},FT)()}connectDispatchListener(t){this._dispatchNotifier.addObserver(t)}clearCommand(){this._commandPackages.clear()}nextCommand(){const t=this._commandPackages.poll();return t?qt(t.command):Mt}initCommandWatchService(){if(!this._commandWatchServiceStarted){for(const s of Ha)Bn.bind(s.command.value,()=>this.addCommand(s.command));const t=["w","s","a","d"];for(let s=0;s<4;s++)Bn.bind(t[s],()=>this.addCommand(Ha[s].command));this._commandWatchServiceStarted=!0}}}const QT=()=>new JT;class tw{constructor(){$(this,"_spritePackages",new Map)}_hasThisSprite(t){return this._spritePackages.has(t)}_removeSpritePackage(t,s){const i=this._spritePackages.get(t);if(!i)return;const r=i.findIndex(n=>n.id===s);if(!r)throw new Error(`sprite ${s} not found`);this._spritePackages.get(t).splice(r,1)}_removeSpritePackages(t,s){return this._spritePackages.get(t)?this._spritePackages.get(t).splice(0,s):null}addSpriteByName(t,s){const r={id:Qs(),sprite:s};if(!this._hasThisSprite(t)){this._spritePackages.set(t,[r]);return}this._spritePackages.get(t).push(r)}addSpritesByName(t,s){const i=(r=>{const n=[];for(const o of r){const l={id:Qs(),sprite:o};n.push(l)}return n})(s);if(!this._hasThisSprite(t)){this._spritePackages.set(t,i);return}this._spritePackages.get(t).push(...i)}getSpriteAmountByName(t){return this._hasThisSprite(t)?this._spritePackages.get(t).length:0}getSpriteByName(t){if(!this._hasThisSprite(t))return Mt;const s=this._spritePackages.get(t)[0];if(!s)throw new Error(`sprite ${t} not found`);return this._removeSpritePackage(t,s.id),qt(s.sprite)}getSpritesByName(t,s){if(!this._hasThisSprite(t))return Mt;const i=this.getSpriteAmountByName(t);if(i<s)throw new Error(`sprites amount in store ${i} < ${s}`);const r=this._removeSpritePackages(t,s);if(!r)throw new Error(`sprites ${t} can not be removed`);const n=[];for(const o of r)n.push(o.sprite);return qt(n)}}const ew=()=>new tw;class sw{constructor(){$(this,"_resourcesSheet");$(this,"_loadingProgress",0)}async _prepareLoadedResources(t){const s=await Ki.load(t.trim());if(!s)throw new Error("Could not get game resources!");this._resourcesSheet=s}async loadResources(t){this._resourcesSheet||await this._prepareLoadedResources(t)}getLoadingProgress(){return this._loadingProgress}getAnimationTextures(t,s){const i=this._resourcesSheet.animations[`${t}/${s}`];if(!i)throw new Error(`Could not found the resource of ${t}/${s} !`);return i}}const iw=()=>new sw;class rw{constructor(){$(this,"_dispatchServer");$(this,"_ruleController");$(this,"_mapController")}getDispatchServer(){return this._dispatchServer}setDispatchServer(t){this._dispatchServer=t}initDispatchServer(){this._dispatchServer.enableService()}disposeDispatchServer(){this._dispatchServer.disableService()}getRuleController(){return this._ruleController}getMapController(){return this._mapController}setRuleController(t){this._ruleController=t}setMapController(t){this._mapController=t}changeMapSize(t){this._mapController.changeMapSize(t)}}const nw=()=>new rw;class ow{constructor(){$(this,"_gameApp");$(this,"_edge");$(this,"_screenHeight");$(this,"_screenWidth")}getAppEdge(){return this._edge}getScreenSize(){return{width:this._screenWidth,height:this._screenHeight}}setAppSize(t,s){this._edge.maxX=t-1,this._edge.maxY=s-1,this._screenHeight=innerHeight,this._screenWidth=innerWidth;const i=Cl(this._edge,this.getScreenSize());this._gameApp.renderer.resize(t*i,s*i)}bindAppToScreenService(t){this._gameApp=t,this._edge={maxX:this._gameApp.screen.x,maxY:this._gameApp.screen.y}}}const aw=()=>new ow;class lw{constructor(){$(this,"_scanner")}getScanner(){return this._scanner}setScanner(t){this._scanner=t}}const hw=()=>new lw;class cw{constructor(){$(this,"_stageBuilder");$(this,"_containerBuilder");$(this,"_spriteBuilder")}getContainerBuilder(){return this._containerBuilder}getSpriteBuilder(){return this._spriteBuilder}getStageBuilder(){return this._stageBuilder}setContainerBuilder(t){this._containerBuilder=t}setSpriteBuilder(t){this._spriteBuilder=t}setStageBuilder(t){this._stageBuilder=t}}const uw=()=>new cw,dw=()=>{const e=VT(),t=QT(),s=ew(),i=iw(),r=nw(),n=aw(),o=hw(),a=uw();return{containerService:e,commandService:t,spriteService:s,textureService:i,controllerService:r,screenService:n,scannerService:o,builderService:a}},fw=e=>({getContainerByName:t=>e.getContainerByName(t),getNonEmptyContainerByIndex:t=>e.getNonEmptyContainerByIndex(t),getEmptyContainer:()=>e.getEmptyContainer(),addContainer:(t,s,i)=>e.addContainer(t,s,i),hasContainerById:t=>e.hasContainerById(t),hasContainerByName:t=>e.hasContainerByName(t),hasAnyContainer:()=>e.hasAnyContainer()}),pw=e=>({getSpriteByName:t=>e.getSpriteByName(t),getSpritesByName:(t,s)=>e.getSpritesByName(t,s),getSpriteAmountByName:t=>e.getSpriteAmountByName(t),addSpriteByName:(t,s)=>e.addSpriteByName(t,s),addSpritesByName:(t,s)=>e.addSpritesByName(t,s)}),mw=e=>({loadResources:t=>e.loadResources(t),getAnimationTextures:(t,s)=>e.getAnimationTextures(t,s),getLoadingProgress:()=>e.getLoadingProgress()}),gw=e=>({setDispatchServer:t=>e.setDispatchServer(t),getDispatchServer:()=>e.getDispatchServer(),initDispatchServer:()=>e.initDispatchServer(),disposeDispatchServer:()=>e.disposeDispatchServer(),setRuleController:t=>e.setRuleController(t),setMapController:t=>e.setMapController(t),getRuleController:()=>e.getRuleController(),getMapController:()=>e.getMapController(),changeMapSize:t=>e.changeMapSize(t)}),_w=e=>({nextCommand:()=>e.nextCommand(),addCommand:t=>e.addCommand(t),clearCommand:()=>e.clearCommand(),initCommandWatchService:()=>e.initCommandWatchService(),connectDispatchListener:t=>e.connectDispatchListener(t)}),xw=e=>({setAppSize:(t,s)=>e.setAppSize(t,s),getAppEdge:()=>e.getAppEdge(),bindAppToScreenService:t=>e.bindAppToScreenService(t),getScreenSize:()=>e.getScreenSize()}),vw=e=>({setScanner:t=>e.setScanner(t),getScanner:()=>e.getScanner()}),yw=e=>({setStageBuilder:t=>e.setStageBuilder(t),setContainerBuilder:t=>e.setContainerBuilder(t),setSpriteBuilder:t=>e.setSpriteBuilder(t),getStageBuilder:()=>e.getStageBuilder(),getContainerBuilder:()=>e.getContainerBuilder(),getSpriteBuilder:()=>e.getSpriteBuilder()}),Ew=()=>{const e=dw(),t=fw(e.containerService),s=pw(e.spriteService),i=mw(e.textureService),r=gw(e.controllerService),n=_w(e.commandService),o=xw(e.screenService),a=vw(e.scannerService),l=yw(e.builderService);return{...t,...n,...s,...i,...r,...o,...a,...l}};class Ef{constructor(){$(this,"_stage");$(this,"_container")}}class bw extends Ef{setArgs(t,s){this._stage=t,this._container=s}async execute(){return await new Promise(t=>{this._stage.removeChild(this._container),t()})}}class Tw extends Ef{constructor(){super(...arguments);$(this,"_mountAtIndex")}setArgs(s,i,r){this._stage=s,this._container=i,this._mountAtIndex=r}async execute(){await new Promise(s=>{this._stage.addChildAt(this._container,this._mountAtIndex),s()})}}class ww{constructor(t){$(this,"_stage");$(this,"_containerBuilder");this._stage=t,this._stage.sortableChildren=!0,this._containerBuilder=V.getContainerBuilder()}async addGameScene(t){V.setAppSize(t.sceneWidth,t.sceneHeight),V.changeMapSize(V.getAppEdge());const s=await this._containerBuilder.createGameScene(t),i=new Tw;i.setArgs(this._stage,s,0),await i.execute()}async removeScene(){const t=this._containerBuilder.gameScene,s=new bw;s.setArgs(this._stage,t),await s.execute()}}const Sw=e=>new ww(e);class bf{}class Aw extends bf{constructor(){super(...arguments);$(this,"_things");$(this,"_container")}setArgs(s,i){this._things=i,this._container=s}async execute(){return await new Promise(s=>{this._container.addChild(...this._things),s(this._container)})}}class Cw extends bf{constructor(){super(...arguments);$(this,"_container");$(this,"_target")}setArgs(s,i){this._container=i,this._target=s}async execute(){return await new Promise(s=>{const i=this._container.getChildIndex(this._target),r=this._container.removeChildAt(i);s(r)})}}class Iw{constructor(){$(this,"_spriteController");$(this,"gameScene",new ce);this._spriteController=V.getSpriteBuilder()}async createEmptyScene(){const t=V.getEmptyContainer();return bt(t)?new ce:t.value}async createGameScene(t){const s=await this.createEmptyScene(),i=await this._spriteController.getThings(t.thingsMap);await this._spriteController.connectThingsToThingController(i),V.getScanner().findRulesFromMap(V.getAppEdge());const r=new Aw;return r.setArgs(s,i),await r.execute(),this.gameScene=s,s}async removeThingFromGameScene(t){const s=new Cw;s.setArgs(t,this.gameScene),await s.execute()}}const Rw=()=>new Iw;var O=(e=>(e[e.TOP=0]="TOP",e[e.DOWN=1]="DOWN",e[e.RIGHT=2]="RIGHT",e[e.LEFT=3]="LEFT",e[e.UNDEFINED=4]="UNDEFINED",e))(O||{}),Et=(e=>(e.AUTO="Text_AUTO",e.RIGHT="Text_RIGHT",e.UP="Text_UP",e.LEFT="Text_LEFT",e.DOWN="Text_DOWN",e.RED="Text_RED",e.BLUE="Text_BLUE",e.ORANGE="Text_ORANGE",e.YELLOW="Text_YELLOW",e.LIME="Text_LIME",e.GREEN="Text_GREEN",e.CYAN="Text_CYAN",e.PURPLE="Text_PURPLE",e.PINK="Text_PINK",e.ROSY="Text_ROSY",e.GREY="Text_GREY",e.BLACK="Text_BLACK",e.SILVER="Text_SILVER",e.WHITE="Text_WHITE",e.BROWN="Text_BROWN",e.BEST="Text_BEST",e.SAD="Text_SAD",e.WONDER="Text_WONDER",e.PARTY="Text_PARTY",e.BROKEN="Text_BROKEN",e.CHILL="Text_CHILL",e.DEFEAT="Text_DEFEAT",e.BACK="Text_BACK",e.FALLDOWN="Text_FALLDOWN",e.FALLRIGHT="Text_FALLRIGHT",e.FALLUP="Text_FALLUP",e.FALLLEFT="Text_FALLLEFT",e.NUDGEDOWN="Text_NUDGEDOWN",e.NUDGERIGHT="Text_NUDGERIGHT",e.NUDGEUP="Text_NUDGEUP",e.NUDGELEFT="Text_NUDGELEFT",e.TURNCLOCKWISE="Text_TURNCLOCKWISE",e.TURNCOUNTERCLOCKWISE="Text_TURNCOUNTERCLOCKWISE",e.FLOAT="Text_FLOAT",e.PHANTOM="Text_PHANTOM",e.HIDE="Text_HIDE",e.HOT="Text_HOT",e.MELT="Text_MELT",e.MORE="Text_MORE",e.MOVE="Text_MOVE",e.OPEN="Text_OPEN",e.SHUT="Text_SHUT",e.POWER="Text_POWER",e.PULL="Text_PULL",e.PUSH="Text_PUSH",e.SAFE="Text_SAFE",e.SHIFT="Text_SHIFT",e.SINK="Text_SINK",e.SLEEP="Text_SLEEP",e.STILL="Text_STILL",e.LOCKEDDOWN="Text_LOCKEDDOWN",e.LOCKEDRIGHT="Text_LOCKEDRIGHT",e.LOCKEDLEFT="Text_LOCKEDLEFT",e.LOCKEDUP="Text_LOCKEDUP",e.STOP="Text_STOP",e.SWAP="Text_SWAP",e.TELE="Text_TELE",e.WEAK="Text_WEAK",e.WIN="Text_WIN",e.WORD="Text_WORD",e.YOU="Text_YOU",e.YOU2="Text_YOU2",e.BONUS="Text_BONUS",e.END="Text_END",e.DONE="Text_DONE",e.REVERT="Text_REVERT",e.SELECT="Text_SELECT",e))(Et||{});const io=e=>e===O.UNDEFINED?e:e%2?e-1:e+1,Pw=async(e,t,s)=>{switch(s){case O.DOWN:if(e.atTopEdge())return!1;break;case O.TOP:if(e.atBottomEdge())return!1;break;case O.RIGHT:if(e.atLeftEdge())return!1;break;case O.LEFT:if(e.atRightEdge())return!1;break}return await t.canIEncounter(e,io(s))};class ds{constructor(t){$(this,"_id");$(this,"_subject");$(this,"_priority");this._id=Qs(),this._subject=t}setPriority(t){this._priority=t}getPriority(){return this._priority}}class Rl extends ds{async perform(){}async unperform(){}}var Tf=(e=>(e.ALGAE="ALGAE",e.ARROW="ARROW",e.BABA="BABA",e.BANANA="BANANA",e.BAT="BAT",e.BEE="BEE",e.BELT="BELT",e.BIRD="BIRD",e.BLOB="BLOB",e.BOAT="BOAT",e.BOG="BOG",e.BOLT="BOLT",e.BOOK="BOOK",e.BOX="BOX",e.BRICK="BRICK",e.BUBBLE="BUBBLE",e.BUCKET="BUCKET",e.BURGER="BURGER",e.BUG="BUG",e.CAKE="CAKE",e.CART="CART",e.CASH="CASH",e.CIRCLE="CIRCLE",e.CLIFF="CLIFF",e.CLOUD="CLOUD",e.COG="COG",e.CRAB="CRAB",e.CRYSTAL="CRYSTAL",e.CUP="CUP",e.DOOR="DOOR",e.DOT="DOT",e.DRINK="DRINK",e.DRUM="DRUM",e.DUST="DUST",e.EAR="EAR",e.EYE="EYE",e.FENCE="FENCE",e.FIRE="FIRE",e.FISH="FISH",e.FLAG="FLAG",e.FLOWER="FLOWER",e.FOFO="FOFO",e.FOLIAGE="FOLIAGE",e.FOOT="FOOT",e.FORT="FORT",e.FRUIT="FRUIT",e.FUNGI="FUNGI",e.FUNGUS="FUNGUS",e.GATE="GATE",e.GEM="GEM",e.GHOST="GHOST",e.GRASS="GRASS",e.GUITAR="GUITAR",e.HAND="HAND",e.HEDGE="HEDGE",e.HIHAT="HIHAT",e.HOUSE="HOUSE",e.HUSK="HUSK",e.HUSKS="HUSKS",e.ICE="ICE",e.IT="IT",e.JELLY="JELLY",e.JIJI="JIJI",e.KEKE="KEKE",e.KEY="KEY",e.LADDER="LADDER",e.LAMP="LAMP",e.LAVA="LAVA",e.LEAF="LEAF",e.LIFT="LIFT",e.LINE="LINE",e.LIZARD="LIZARD",e.LOVE="LOVE",e.ME="ME",e.MONITOR="MONITOR",e.MOON="MOON",e.NOSE="NOSE",e.ORB="ORB",e.PANTS="PANTS",e.PIANO="PIANO",e.PILLAR="PILLAR",e.PIPE="PIPE",e.PIXEL="PIXEL",e.PLANE="PLANE",e.PLANET="PLANET",e.PUMPKIN="PUMPKIN",e.REED="REED",e.RING="RING",e.ROAD="ROAD",e.ROBOT="ROBOT",e.ROCK="ROCK",e.ROCKET="ROCKET",e.ROSE="ROSE",e.RUBBLE="RUBBLE",e.SAX="SAX",e.SEED="SEED",e.SHELL="SHELL",e.SHIRT="SHIRT",e.SHOVEL="SHOVEL",e.SIGN="SIGN",e.SKULL="SKULL",e.SPIKE="SPIKE",e.SPROUT="SPROUT",e.SQUARE="SQUARE",e.STAR="STAR",e.STATUE="STATUE",e.STICK="STICK",e.STUMP="STUMP",e.SUN="SUN",e.TILE="TILE",e.TOWER="TOWER",e.TRACK="TRACK",e.TRAIN="TRAIN",e.TREE="TREE",e.TREES="TREES",e.TRIANGLE="TRIANGLE",e.TURNIP="TURNIP",e.UFO="UFO",e.VINE="VINE",e.WALL="WALL",e.WATER="WATER",e.WIND="WIND",e.WORM="WORM",e))(Tf||{}),Gt=(e=>(e.CHARACTERS="characters",e.NOUNS="nouns",e.OPERATORS="operators",e.PROPERTIES="properties",e))(Gt||{}),Pl=(e=>(e.ALGAE="Text_ALGAE",e.ARROW="Text_ARROW",e.BABA="Text_BABA",e.BANANA="Text_BANANA",e.BAT="Text_BAT",e.BEE="Text_BEE",e.BELT="Text_BELT",e.BIRD="Text_BIRD",e.BLOB="Text_BLOB",e.BOAT="Text_BOAT",e.BOG="Text_BOG",e.BOLT="Text_BOLT",e.BOOK="Text_BOOK",e.BOX="Text_BOX",e.BRICK="Text_BRICK",e.BUBBLE="Text_BUBBLE",e.BUCKET="Text_BUCKET",e.BURGER="Text_BURGER",e.BUG="Text_BUG",e.CAKE="Text_CAKE",e.CART="Text_CART",e.CASH="Text_CASH",e.CIRCLE="Text_CIRCLE",e.CLIFF="Text_CLIFF",e.CLOUD="Text_CLOUD",e.COG="Text_COG",e.CRAB="Text_CRAB",e.CRYSTAL="Text_CRYSTAL",e.CUP="Text_CUP",e.DOOR="Text_DOOR",e.DOT="Text_DOT",e.DRINK="Text_DRINK",e.DRUM="Text_DRUM",e.DUST="Text_DUST",e.EAR="Text_EAR",e.EYE="Text_EYE",e.FENCE="Text_FENCE",e.FIRE="Text_FIRE",e.FISH="Text_FISH",e.FLAG="Text_FLAG",e.FLOWER="Text_FLOWER",e.FOFO="Text_FOFO",e.FOLIAGE="Text_FOLIAGE",e.FOOT="Text_FOOT",e.FORT="Text_FORT",e.FRUIT="Text_FRUIT",e.FUNGI="Text_FUNGI",e.FUNGUS="Text_FUNGUS",e.GATE="Text_GATE",e.GEM="Text_GEM",e.GHOST="Text_GHOST",e.GRASS="Text_GRASS",e.GUITAR="Text_GUITAR",e.HAND="Text_HAND",e.HEDGE="Text_HEDGE",e.HIHAT="Text_HIHAT",e.HOUSE="Text_HOUSE",e.HUSK="Text_HUSK",e.HUSKS="Text_HUSKS",e.ICE="Text_ICE",e.IT="Text_IT",e.JELLY="Text_JELLY",e.JIJI="Text_JIJI",e.KEKE="Text_KEKE",e.KEY="Text_KEY",e.LADDER="Text_LADDER",e.LAMP="Text_LAMP",e.LAVA="Text_LAVA",e.LEAF="Text_LEAF",e.LIFT="Text_LIFT",e.LINE="Text_LINE",e.LIZARD="Text_LIZARD",e.LOVE="Text_LOVE",e.ME="Text_ME",e.MONITOR="Text_MONITOR",e.MOON="Text_MOON",e.NOSE="Text_NOSE",e.ORB="Text_ORB",e.PANTS="Text_PANTS",e.PIANO="Text_PIANO",e.PILLAR="Text_PILLAR",e.PIPE="Text_PIPE",e.PIXEL="Text_PIXEL",e.PLANE="Text_PLANE",e.PLANET="Text_PLANET",e.PUMPKIN="Text_PUMPKIN",e.REED="Text_REED",e.RING="Text_RING",e.ROAD="Text_ROAD",e.ROBOT="Text_ROBOT",e.ROCK="Text_ROCK",e.ROCKET="Text_ROCKET",e.ROSE="Text_ROSE",e.RUBBLE="Text_RUBBLE",e.SAX="Text_SAX",e.SEED="Text_SEED",e.SHELL="Text_SHELL",e.SHIRT="Text_SHIRT",e.SHOVEL="Text_SHOVEL",e.SIGN="Text_SIGN",e.SKULL="Text_SKULL",e.SPIKE="Text_SPIKE",e.SPROUT="Text_SPROUT",e.SQUARE="Text_SQUARE",e.STAR="Text_STAR",e.STATUE="Text_STATUE",e.STICK="Text_STICK",e.STUMP="Text_STUMP",e.SUN="Text_SUN",e.TILE="Text_TILE",e.TOWER="Text_TOWER",e.TRACK="Text_TRACK",e.TRAIN="Text_TRAIN",e.TREE="Text_TREE",e.TREES="Text_TREES",e.TRIANGLE="Text_TRIANGLE",e.TURNIP="Text_TURNIP",e.UFO="Text_UFO",e.VINE="Text_VINE",e.WALL="Text_WALL",e.WATER="Text_WATER",e.WIND="Text_WIND",e.WORM="Text_WORM",e))(Pl||{}),Ot=(e=>(e.IS="Text_IS",e.HAS="Text_HAS",e.MAKE="Text_MAKE",e.AND="Text_AND",e.NOT="Text_NOT",e.ON="Text_ON",e.NEAR="Text_NEAR",e.FACING="Text_FACING",e.LONELY="Text_LONELY",e.FEAR="Text_FEAR",e.EAT="Text_EAT",e.FOLLOW="Text_FOLLOW",e.MIMIC="Text_MIMIC",e.IDLE="Text_IDLE",e.POWERED="Text_POWERED",e.WITHOUT="Text_WITHOUT",e.ABOVE="Text_ABOVE",e.BELOW="Text_BELOW",e.FEELING="Text_FEELING",e.PLAY="Text_PLAY",e.OFTEN="Text_OFTEN",e.SELDOM="Text_SELDOM",e.NEVER="Text_NEVER",e))(Ot||{});const wf=e=>e.substring(5),Mw=e=>Object.values(Tf).includes(e),Sf=e=>Object.values(Pl).includes(e),Ow=e=>Object.values(Ot).includes(e),Bw=e=>Object.values(Et).includes(e),Dw=e=>{if(Mw(e))return Gt.CHARACTERS;if(Sf(e))return Gt.NOUNS;if(Ow(e))return Gt.OPERATORS;if(Bw(e))return Gt.PROPERTIES;throw new Error(`ThingType ${e} does not exist in all Species`)},Ri=async e=>{await new Promise(t=>setTimeout(()=>t(),e))};class Fw extends ds{constructor(s){super(s);$(this,"_originalName");$(this,"_originalTexture");$(this,"_thingTypes");this._originalName=this._subject.name,this._originalTexture=this._subject.texture,this._thingTypes=Mt}addTransformName(s){je(this._thingTypes)?this._thingTypes.value.push(s):this._thingTypes=qt([s])}async perform(){if(bt(this._thingTypes)||this._thingTypes.value.length>1)return;await Ri(Js);const s=wf(this._thingTypes.value[0]);this._subject.name=s;const i=Dw(s);this._subject.textures=V.getAnimationTextures(i,this._subject.name)}async unperform(){await Ri(Js),this._subject.texture=this._originalTexture,this._subject.name=this._originalName}}var be=(e=>(e.UP="up",e.DOWN="down",e.RIGHT="right",e.LEFT="left",e.APPEAR="appear",e.DISAPPEAR="disappear",e))(be||{});class Lw{constructor(){$(this,"_gameMap");$(this,"maxX");$(this,"maxY");this.maxX=0,this.maxY=0,this._gameMap=new Array(this.maxX+1);for(let t=0;t<=this.maxX;t++)this._gameMap[t]=new Array(this.maxY+1);this._resetMap()}_resetMap(){for(let t=0;t<=this.maxX;t++)for(let s=0;s<=this.maxY;s++)this._gameMap[t][s]=Mt}_placeToPosition(t,s,i){if(t<0||t>this.maxX||s<0||s>this.maxY)throw new Error(`Map system error, pos @ x:${t} y:${s} is out of range!`);if(bt(this._gameMap[t][s]))this._gameMap[t][s]=qt([i]);else if(je(this._gameMap[t][s]))this._gameMap[t][s].value.push(i);else throw new Error(`Map system error, pos @ x:${t} y:${s} is invalid type!`)}_removeFromPosition(t,s,i){if(t<0||t>this.maxX||s<0||s>this.maxY)throw new Error(`Map system error, pos @ x:${t} y:${s} is out of range!`);if(je(this._gameMap[t][s])){const r=this._gameMap[t][s].value.findIndex(n=>n.id===i.id);if(r===-1)throw new Error(`Thing ${i.id} name = ${i.name} is not in the pos @ x:${t} y:${s}, can't be removed!`);this._gameMap[t][s].value.splice(r,1)}else throw new Error(`Map system error, pos @ x:${t} y:${s} is invalid type!`)}async canIEncounter(t,s){const i=t.blockX,r=t.blockY;switch(s){case O.UNDEFINED:return!1;case O.LEFT:return t.atLeftEdge()?!1:bt(this._gameMap[i-1][r])?!0:(await Promise.all(this._gameMap[i-1][r].value.map(n=>n.handleEncounter(t,O.RIGHT)))).reduce((n,o)=>n&&o,!0);case O.RIGHT:return t.atRightEdge()?!1:bt(this._gameMap[i+1][r])?!0:(await Promise.all(this._gameMap[i+1][r].value.map(n=>n.handleEncounter(t,O.LEFT)))).reduce((n,o)=>n&&o,!0);case O.TOP:return t.atTopEdge()?!1:bt(this._gameMap[i][r-1])?!0:(await Promise.all(this._gameMap[i][r-1].value.map(n=>n.handleEncounter(t,O.DOWN)))).reduce((n,o)=>n&&o,!0);case O.DOWN:return t.atBottomEdge()?!1:bt(this._gameMap[i][r+1])?!0:(await Promise.all(this._gameMap[i][r+1].value.map(n=>n.handleEncounter(t,O.TOP)))).reduce((n,o)=>n&&o,!0)}}async notifyBeside(t,s){const i=t.blockX,r=t.blockY;await Promise.allSettled(s.map(n=>{switch(n){case O.UNDEFINED:return Promise.resolve();case O.LEFT:return t.atLeftEdge()||bt(this._gameMap[i-1][r])?Promise.resolve():Promise.allSettled(this._gameMap[i-1][r].value.map(o=>o.handleBeside(t,O.RIGHT)));case O.RIGHT:return t.atRightEdge()||bt(this._gameMap[i+1][r])?Promise.resolve():Promise.allSettled(this._gameMap[i+1][r].value.map(o=>o.handleBeside(t,O.LEFT)));case O.TOP:return t.atTopEdge()||bt(this._gameMap[i][r-1])?Promise.resolve():Promise.allSettled(this._gameMap[i][r-1].value.map(o=>o.handleBeside(t,O.DOWN)));case O.DOWN:return t.atBottomEdge()||bt(this._gameMap[i][r+1])?Promise.resolve():Promise.allSettled(this._gameMap[i][r+1].value.map(o=>o.handleBeside(t,O.TOP)))}}))}async notifyLeave(t,s){const i=t.blockX,r=t.blockY;await Promise.allSettled(s.map(n=>{switch(n){case O.UNDEFINED:return Promise.resolve();case O.LEFT:return t.atLeftEdge()||bt(this._gameMap[i-1][r])?Promise.resolve():Promise.allSettled(this._gameMap[i-1][r].value.map(o=>o.handleLeave(t,O.RIGHT)));case O.RIGHT:return t.atRightEdge()||bt(this._gameMap[i+1][r])?Promise.resolve():Promise.allSettled(this._gameMap[i+1][r].value.map(o=>o.handleLeave(t,O.LEFT)));case O.TOP:return t.atTopEdge()||bt(this._gameMap[i][r-1])?Promise.resolve():Promise.allSettled(this._gameMap[i][r-1].value.map(o=>o.handleLeave(t,O.DOWN)));case O.DOWN:return t.atBottomEdge()||bt(this._gameMap[i][r+1])?Promise.resolve():Promise.allSettled(this._gameMap[i][r+1].value.map(o=>o.handleLeave(t,O.TOP)))}}))}async update(t,s){const i=t.blockX,r=t.blockY;switch(s){case"appear":this._placeToPosition(i,r,t);break;case"disappear":this._removeFromPosition(i,r,t);break;case"up":this._removeFromPosition(i,r+1,t),this._placeToPosition(i,r,t);break;case"down":this._removeFromPosition(i,r-1,t),this._placeToPosition(i,r,t);break;case"left":this._removeFromPosition(i+1,r,t),this._placeToPosition(i,r,t);break;case"right":this._removeFromPosition(i-1,r,t),this._placeToPosition(i,r,t);break}}async appendTransformInstructions(t){for(let s=0;s<=this.maxX;s++)for(let i=0;i<=this.maxY;i++){const r=this._gameMap[s][i];if(!bt(r))for(const n of r.value){const o=t.get(n.name);if(!o||o.length===0)continue;const a=new Fw(n);for(const l of o)a.addTransformName(l.feature);a.setPriority(9999999990002),n.thingController.addNewInstruction(a),n.thingController.pushInstructions()}}}async processMoveInstructions(t){for(let s=0;s<=this.maxX;s++)for(let i=0;i<=this.maxY;i++){const r=this._gameMap[s][i];if(!bt(r))for(const n of r.value){const o=t.get(n.name);if(o&&o.length!==0){for(const a of o)if(a.feature===Et.MOVE){const l=h=>{let c;switch(h.towards){case O.TOP:c=new Af(h);break;case O.DOWN:c=new Cf(h);break;case O.RIGHT:c=new Rf(h);break;case O.LEFT:c=new If(h);break;default:c=new Rl(h)}c.setPriority(9999999990001),h.thingController.addNewInstruction(c),h.thingController.pushInstructions()};await this.canIEncounter(n,n.towards)?await l(n):await this.canIEncounter(n,io(n.towards))&&(await n.reverseTowards(),await l(n))}}}}}async checkYouExistsInMap(t){for(let s=0;s<=this.maxX;s++)for(let i=0;i<=this.maxY;i++){const r=this._gameMap[s][i];if(!bt(r)){for(const n of r.value)if(t.includes(n.name))return!0}}return!1}clean(){this._resetMap()}whoAreThere(t,s){if(t<0||t>this.maxX||s<0||s>this.maxY)throw new Error(`Map system error, pos @ x:${t} y:${s} is out of range!`);return this._gameMap[t][s]}whoNearMe(t){const s=t.blockX,i=t.blockY,r=t.atTopEdge()?Mt:this._gameMap[s][i-1],n=t.atBottomEdge()?Mt:this._gameMap[s][i+1],o=t.atLeftEdge()?Mt:this._gameMap[s-1][i],a=t.atRightEdge()?Mt:this._gameMap[s+1][i];return{up:r,down:n,left:o,right:a}}changeMapSize(t){this.maxX=t.maxX,this.maxY=t.maxY,this._gameMap=new Array(this.maxX+1);for(let s=0;s<=this.maxX;s++)this._gameMap[s]=new Array(this.maxY+1);this.clean()}}const Nw=()=>new Lw;class Af extends ds{async perform(){await V.getMapController().notifyLeave(this._subject,[O.LEFT,O.RIGHT,O.DOWN]),await this._subject.moveUp(),await V.getMapController().update(this._subject,be.UP),await V.getMapController().notifyBeside(this._subject,[O.LEFT,O.RIGHT,O.TOP])}async unperform(){await V.getMapController().notifyLeave(this._subject,[O.TOP,O.LEFT,O.RIGHT]),await V.getMapController().update(this._subject,be.DOWN),await this._subject.moveDown(),await V.getMapController().notifyBeside(this._subject,[O.LEFT,O.RIGHT,O.DOWN])}}class Cf extends ds{async perform(){await V.getMapController().notifyLeave(this._subject,[O.TOP,O.RIGHT,O.LEFT]),await this._subject.moveDown(),await V.getMapController().update(this._subject,be.DOWN),await V.getMapController().notifyBeside(this._subject,[O.DOWN,O.RIGHT,O.LEFT])}async unperform(){await V.getMapController().notifyLeave(this._subject,[O.TOP,O.RIGHT,O.LEFT]),await V.getMapController().update(this._subject,be.UP),await this._subject.moveUp(),await V.getMapController().notifyBeside(this._subject,[O.DOWN,O.RIGHT,O.LEFT])}}class If extends ds{async perform(){await V.getMapController().notifyLeave(this._subject,[O.TOP,O.DOWN,O.RIGHT]),await this._subject.moveLeft(),await V.getMapController().update(this._subject,be.LEFT),await V.getMapController().notifyBeside(this._subject,[O.TOP,O.DOWN,O.LEFT])}async unperform(){await V.getMapController().notifyLeave(this._subject,[O.TOP,O.DOWN,O.LEFT]),await V.getMapController().update(this._subject,be.RIGHT),await this._subject.moveRight(),await V.getMapController().notifyBeside(this._subject,[O.TOP,O.DOWN,O.RIGHT])}}class Rf extends ds{async perform(){await V.getMapController().notifyLeave(this._subject,[O.TOP,O.DOWN,O.LEFT]),await this._subject.moveRight(),await V.getMapController().update(this._subject,be.RIGHT),await V.getMapController().notifyBeside(this._subject,[O.TOP,O.DOWN,O.RIGHT])}async unperform(){await V.getMapController().notifyLeave(this._subject,[O.TOP,O.DOWN,O.RIGHT]),await V.getMapController().update(this._subject,be.LEFT),await this._subject.moveLeft(),await V.getMapController().notifyBeside(this._subject,[O.TOP,O.DOWN,O.LEFT])}}const ys={MoveUpInstruction:Af,MoveDownInstruction:Cf,MoveLeftInstruction:If,MoveRightInstruction:Rf},Uw=(e,t,s)=>{let i;switch(t){case O.TOP:i=new ys.MoveDownInstruction(e);break;case O.DOWN:i=new ys.MoveUpInstruction(e);break;case O.LEFT:i=new ys.MoveRightInstruction(e);break;case O.RIGHT:i=new ys.MoveLeftInstruction(e);break;default:i=new Rl(e);break}s.addNewInstruction(i),s.pushInstructions()};function Pf(e,t){return function(){return e.apply(t,arguments)}}const{toString:Mf}=Object.prototype,{getPrototypeOf:Ml}=Object,Ol=(e=>t=>{const s=Mf.call(t);return e[s]||(e[s]=s.slice(8,-1).toLowerCase())})(Object.create(null)),fs=e=>(e=e.toLowerCase(),t=>Ol(t)===e),ro=e=>t=>typeof t===e,{isArray:Li}=Array,_r=ro("undefined");function kw(e){return e!==null&&!_r(e)&&e.constructor!==null&&!_r(e.constructor)&&ti(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const Of=fs("ArrayBuffer");function Gw(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&Of(e.buffer),t}const Hw=ro("string"),ti=ro("function"),Bf=ro("number"),Bl=e=>e!==null&&typeof e=="object",Ww=e=>e===!0||e===!1,hn=e=>{if(Ol(e)!=="object")return!1;const t=Ml(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},$w=fs("Date"),Xw=fs("File"),jw=fs("Blob"),zw=fs("FileList"),Vw=e=>Bl(e)&&ti(e.pipe),Yw=e=>{const t="[object FormData]";return e&&(typeof FormData=="function"&&e instanceof FormData||Mf.call(e)===t||ti(e.toString)&&e.toString()===t)},Kw=fs("URLSearchParams"),qw=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function br(e,t,{allOwnKeys:s=!1}={}){if(e===null||typeof e>"u")return;let i,r;if(typeof e!="object"&&(e=[e]),Li(e))for(i=0,r=e.length;i<r;i++)t.call(null,e[i],i,e);else{const n=s?Object.getOwnPropertyNames(e):Object.keys(e),o=n.length;let a;for(i=0;i<o;i++)a=n[i],t.call(null,e[a],a,e)}}function Df(e,t){t=t.toLowerCase();const s=Object.keys(e);let i=s.length,r;for(;i-- >0;)if(r=s[i],t===r.toLowerCase())return r;return null}const Ff=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),Lf=e=>!_r(e)&&e!==Ff;function Wa(){const{caseless:e}=Lf(this)&&this||{},t={},s=(i,r)=>{const n=e&&Df(t,r)||r;hn(t[n])&&hn(i)?t[n]=Wa(t[n],i):hn(i)?t[n]=Wa({},i):Li(i)?t[n]=i.slice():t[n]=i};for(let i=0,r=arguments.length;i<r;i++)arguments[i]&&br(arguments[i],s);return t}const Zw=(e,t,s,{allOwnKeys:i}={})=>(br(t,(r,n)=>{s&&ti(r)?e[n]=Pf(r,s):e[n]=r},{allOwnKeys:i}),e),Jw=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),Qw=(e,t,s,i)=>{e.prototype=Object.create(t.prototype,i),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),s&&Object.assign(e.prototype,s)},tS=(e,t,s,i)=>{let r,n,o;const a={};if(t=t||{},e==null)return t;do{for(r=Object.getOwnPropertyNames(e),n=r.length;n-- >0;)o=r[n],(!i||i(o,e,t))&&!a[o]&&(t[o]=e[o],a[o]=!0);e=s!==!1&&Ml(e)}while(e&&(!s||s(e,t))&&e!==Object.prototype);return t},eS=(e,t,s)=>{e=String(e),(s===void 0||s>e.length)&&(s=e.length),s-=t.length;const i=e.indexOf(t,s);return i!==-1&&i===s},sS=e=>{if(!e)return null;if(Li(e))return e;let t=e.length;if(!Bf(t))return null;const s=new Array(t);for(;t-- >0;)s[t]=e[t];return s},iS=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&Ml(Uint8Array)),rS=(e,t)=>{const i=(e&&e[Symbol.iterator]).call(e);let r;for(;(r=i.next())&&!r.done;){const n=r.value;t.call(e,n[0],n[1])}},nS=(e,t)=>{let s;const i=[];for(;(s=e.exec(t))!==null;)i.push(s);return i},oS=fs("HTMLFormElement"),aS=e=>e.toLowerCase().replace(/[_-\s]([a-z\d])(\w*)/g,function(s,i,r){return i.toUpperCase()+r}),Fc=(({hasOwnProperty:e})=>(t,s)=>e.call(t,s))(Object.prototype),lS=fs("RegExp"),Nf=(e,t)=>{const s=Object.getOwnPropertyDescriptors(e),i={};br(s,(r,n)=>{t(r,n,e)!==!1&&(i[n]=r)}),Object.defineProperties(e,i)},hS=e=>{Nf(e,(t,s)=>{if(ti(e)&&["arguments","caller","callee"].indexOf(s)!==-1)return!1;const i=e[s];if(ti(i)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+s+"'")})}})},cS=(e,t)=>{const s={},i=r=>{r.forEach(n=>{s[n]=!0})};return Li(e)?i(e):i(String(e).split(t)),s},uS=()=>{},dS=(e,t)=>(e=+e,Number.isFinite(e)?e:t),fS=e=>{const t=new Array(10),s=(i,r)=>{if(Bl(i)){if(t.indexOf(i)>=0)return;if(!("toJSON"in i)){t[r]=i;const n=Li(i)?[]:{};return br(i,(o,a)=>{const l=s(o,r+1);!_r(l)&&(n[a]=l)}),t[r]=void 0,n}}return i};return s(e,0)},R={isArray:Li,isArrayBuffer:Of,isBuffer:kw,isFormData:Yw,isArrayBufferView:Gw,isString:Hw,isNumber:Bf,isBoolean:Ww,isObject:Bl,isPlainObject:hn,isUndefined:_r,isDate:$w,isFile:Xw,isBlob:jw,isRegExp:lS,isFunction:ti,isStream:Vw,isURLSearchParams:Kw,isTypedArray:iS,isFileList:zw,forEach:br,merge:Wa,extend:Zw,trim:qw,stripBOM:Jw,inherits:Qw,toFlatObject:tS,kindOf:Ol,kindOfTest:fs,endsWith:eS,toArray:sS,forEachEntry:rS,matchAll:nS,isHTMLForm:oS,hasOwnProperty:Fc,hasOwnProp:Fc,reduceDescriptors:Nf,freezeMethods:hS,toObjectSet:cS,toCamelCase:aS,noop:uS,toFiniteNumber:dS,findKey:Df,global:Ff,isContextDefined:Lf,toJSONObject:fS};function St(e,t,s,i,r){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),s&&(this.config=s),i&&(this.request=i),r&&(this.response=r)}R.inherits(St,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:R.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const Uf=St.prototype,kf={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{kf[e]={value:e}});Object.defineProperties(St,kf);Object.defineProperty(Uf,"isAxiosError",{value:!0});St.from=(e,t,s,i,r,n)=>{const o=Object.create(Uf);return R.toFlatObject(e,o,function(l){return l!==Error.prototype},a=>a!=="isAxiosError"),St.call(o,e.message,t,s,i,r),o.cause=e,o.name=e.name,n&&Object.assign(o,n),o};var pS=typeof self=="object"?self.FormData:window.FormData;const mS=pS;function $a(e){return R.isPlainObject(e)||R.isArray(e)}function Gf(e){return R.endsWith(e,"[]")?e.slice(0,-2):e}function Lc(e,t,s){return e?e.concat(t).map(function(r,n){return r=Gf(r),!s&&n?"["+r+"]":r}).join(s?".":""):t}function gS(e){return R.isArray(e)&&!e.some($a)}const _S=R.toFlatObject(R,{},null,function(t){return/^is[A-Z]/.test(t)});function xS(e){return e&&R.isFunction(e.append)&&e[Symbol.toStringTag]==="FormData"&&e[Symbol.iterator]}function no(e,t,s){if(!R.isObject(e))throw new TypeError("target must be an object");t=t||new(mS||FormData),s=R.toFlatObject(s,{metaTokens:!0,dots:!1,indexes:!1},!1,function(m,_){return!R.isUndefined(_[m])});const i=s.metaTokens,r=s.visitor||c,n=s.dots,o=s.indexes,l=(s.Blob||typeof Blob<"u"&&Blob)&&xS(t);if(!R.isFunction(r))throw new TypeError("visitor must be a function");function h(f){if(f===null)return"";if(R.isDate(f))return f.toISOString();if(!l&&R.isBlob(f))throw new St("Blob is not supported. Use a Buffer instead.");return R.isArrayBuffer(f)||R.isTypedArray(f)?l&&typeof Blob=="function"?new Blob([f]):Buffer.from(f):f}function c(f,m,_){let v=f;if(f&&!_&&typeof f=="object"){if(R.endsWith(m,"{}"))m=i?m:m.slice(0,-2),f=JSON.stringify(f);else if(R.isArray(f)&&gS(f)||R.isFileList(f)||R.endsWith(m,"[]")&&(v=R.toArray(f)))return m=Gf(m),v.forEach(function(g,b){!(R.isUndefined(g)||g===null)&&t.append(o===!0?Lc([m],b,n):o===null?m:m+"[]",h(g))}),!1}return $a(f)?!0:(t.append(Lc(_,m,n),h(f)),!1)}const u=[],d=Object.assign(_S,{defaultVisitor:c,convertValue:h,isVisitable:$a});function p(f,m){if(!R.isUndefined(f)){if(u.indexOf(f)!==-1)throw Error("Circular reference detected in "+m.join("."));u.push(f),R.forEach(f,function(v,T){(!(R.isUndefined(v)||v===null)&&r.call(t,v,R.isString(T)?T.trim():T,m,d))===!0&&p(v,m?m.concat(T):[T])}),u.pop()}}if(!R.isObject(e))throw new TypeError("data must be an object");return p(e),t}function Nc(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(i){return t[i]})}function Dl(e,t){this._pairs=[],e&&no(e,this,t)}const Hf=Dl.prototype;Hf.append=function(t,s){this._pairs.push([t,s])};Hf.toString=function(t){const s=t?function(i){return t.call(this,i,Nc)}:Nc;return this._pairs.map(function(r){return s(r[0])+"="+s(r[1])},"").join("&")};function vS(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Wf(e,t,s){if(!t)return e;const i=s&&s.encode||vS,r=s&&s.serialize;let n;if(r?n=r(t,s):n=R.isURLSearchParams(t)?t.toString():new Dl(t,s).toString(i),n){const o=e.indexOf("#");o!==-1&&(e=e.slice(0,o)),e+=(e.indexOf("?")===-1?"?":"&")+n}return e}class yS{constructor(){this.handlers=[]}use(t,s,i){return this.handlers.push({fulfilled:t,rejected:s,synchronous:i?i.synchronous:!1,runWhen:i?i.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){R.forEach(this.handlers,function(i){i!==null&&t(i)})}}const Uc=yS,$f={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},ES=typeof URLSearchParams<"u"?URLSearchParams:Dl,bS=FormData,TS=(()=>{let e;return typeof navigator<"u"&&((e=navigator.product)==="ReactNative"||e==="NativeScript"||e==="NS")?!1:typeof window<"u"&&typeof document<"u"})(),wS=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),Ye={isBrowser:!0,classes:{URLSearchParams:ES,FormData:bS,Blob},isStandardBrowserEnv:TS,isStandardBrowserWebWorkerEnv:wS,protocols:["http","https","file","blob","url","data"]};function SS(e,t){return no(e,new Ye.classes.URLSearchParams,Object.assign({visitor:function(s,i,r,n){return Ye.isNode&&R.isBuffer(s)?(this.append(i,s.toString("base64")),!1):n.defaultVisitor.apply(this,arguments)}},t))}function AS(e){return R.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function CS(e){const t={},s=Object.keys(e);let i;const r=s.length;let n;for(i=0;i<r;i++)n=s[i],t[n]=e[n];return t}function Xf(e){function t(s,i,r,n){let o=s[n++];const a=Number.isFinite(+o),l=n>=s.length;return o=!o&&R.isArray(r)?r.length:o,l?(R.hasOwnProp(r,o)?r[o]=[r[o],i]:r[o]=i,!a):((!r[o]||!R.isObject(r[o]))&&(r[o]=[]),t(s,i,r[o],n)&&R.isArray(r[o])&&(r[o]=CS(r[o])),!a)}if(R.isFormData(e)&&R.isFunction(e.entries)){const s={};return R.forEachEntry(e,(i,r)=>{t(AS(i),r,s,0)}),s}return null}const IS={"Content-Type":void 0};function RS(e,t,s){if(R.isString(e))try{return(t||JSON.parse)(e),R.trim(e)}catch(i){if(i.name!=="SyntaxError")throw i}return(s||JSON.stringify)(e)}const oo={transitional:$f,adapter:["xhr","http"],transformRequest:[function(t,s){const i=s.getContentType()||"",r=i.indexOf("application/json")>-1,n=R.isObject(t);if(n&&R.isHTMLForm(t)&&(t=new FormData(t)),R.isFormData(t))return r&&r?JSON.stringify(Xf(t)):t;if(R.isArrayBuffer(t)||R.isBuffer(t)||R.isStream(t)||R.isFile(t)||R.isBlob(t))return t;if(R.isArrayBufferView(t))return t.buffer;if(R.isURLSearchParams(t))return s.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let a;if(n){if(i.indexOf("application/x-www-form-urlencoded")>-1)return SS(t,this.formSerializer).toString();if((a=R.isFileList(t))||i.indexOf("multipart/form-data")>-1){const l=this.env&&this.env.FormData;return no(a?{"files[]":t}:t,l&&new l,this.formSerializer)}}return n||r?(s.setContentType("application/json",!1),RS(t)):t}],transformResponse:[function(t){const s=this.transitional||oo.transitional,i=s&&s.forcedJSONParsing,r=this.responseType==="json";if(t&&R.isString(t)&&(i&&!this.responseType||r)){const o=!(s&&s.silentJSONParsing)&&r;try{return JSON.parse(t)}catch(a){if(o)throw a.name==="SyntaxError"?St.from(a,St.ERR_BAD_RESPONSE,this,null,this.response):a}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Ye.classes.FormData,Blob:Ye.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};R.forEach(["delete","get","head"],function(t){oo.headers[t]={}});R.forEach(["post","put","patch"],function(t){oo.headers[t]=R.merge(IS)});const Fl=oo,PS=R.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),MS=e=>{const t={};let s,i,r;return e&&e.split(`
`).forEach(function(o){r=o.indexOf(":"),s=o.substring(0,r).trim().toLowerCase(),i=o.substring(r+1).trim(),!(!s||t[s]&&PS[s])&&(s==="set-cookie"?t[s]?t[s].push(i):t[s]=[i]:t[s]=t[s]?t[s]+", "+i:i)}),t},kc=Symbol("internals");function ji(e){return e&&String(e).trim().toLowerCase()}function cn(e){return e===!1||e==null?e:R.isArray(e)?e.map(cn):String(e)}function OS(e){const t=Object.create(null),s=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let i;for(;i=s.exec(e);)t[i[1]]=i[2];return t}function BS(e){return/^[-_a-zA-Z]+$/.test(e.trim())}function Gc(e,t,s,i){if(R.isFunction(i))return i.call(this,t,s);if(R.isString(t)){if(R.isString(i))return t.indexOf(i)!==-1;if(R.isRegExp(i))return i.test(t)}}function DS(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,s,i)=>s.toUpperCase()+i)}function FS(e,t){const s=R.toCamelCase(" "+t);["get","set","has"].forEach(i=>{Object.defineProperty(e,i+s,{value:function(r,n,o){return this[i].call(this,t,r,n,o)},configurable:!0})})}class ao{constructor(t){t&&this.set(t)}set(t,s,i){const r=this;function n(a,l,h){const c=ji(l);if(!c)throw new Error("header name must be a non-empty string");const u=R.findKey(r,c);(!u||r[u]===void 0||h===!0||h===void 0&&r[u]!==!1)&&(r[u||l]=cn(a))}const o=(a,l)=>R.forEach(a,(h,c)=>n(h,c,l));return R.isPlainObject(t)||t instanceof this.constructor?o(t,s):R.isString(t)&&(t=t.trim())&&!BS(t)?o(MS(t),s):t!=null&&n(s,t,i),this}get(t,s){if(t=ji(t),t){const i=R.findKey(this,t);if(i){const r=this[i];if(!s)return r;if(s===!0)return OS(r);if(R.isFunction(s))return s.call(this,r,i);if(R.isRegExp(s))return s.exec(r);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,s){if(t=ji(t),t){const i=R.findKey(this,t);return!!(i&&(!s||Gc(this,this[i],i,s)))}return!1}delete(t,s){const i=this;let r=!1;function n(o){if(o=ji(o),o){const a=R.findKey(i,o);a&&(!s||Gc(i,i[a],a,s))&&(delete i[a],r=!0)}}return R.isArray(t)?t.forEach(n):n(t),r}clear(){return Object.keys(this).forEach(this.delete.bind(this))}normalize(t){const s=this,i={};return R.forEach(this,(r,n)=>{const o=R.findKey(i,n);if(o){s[o]=cn(r),delete s[n];return}const a=t?DS(n):String(n).trim();a!==n&&delete s[n],s[a]=cn(r),i[a]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const s=Object.create(null);return R.forEach(this,(i,r)=>{i!=null&&i!==!1&&(s[r]=t&&R.isArray(i)?i.join(", "):i)}),s}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,s])=>t+": "+s).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...s){const i=new this(t);return s.forEach(r=>i.set(r)),i}static accessor(t){const i=(this[kc]=this[kc]={accessors:{}}).accessors,r=this.prototype;function n(o){const a=ji(o);i[a]||(FS(r,o),i[a]=!0)}return R.isArray(t)?t.forEach(n):n(t),this}}ao.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent"]);R.freezeMethods(ao.prototype);R.freezeMethods(ao);const ls=ao;function zo(e,t){const s=this||Fl,i=t||s,r=ls.from(i.headers);let n=i.data;return R.forEach(e,function(a){n=a.call(s,n,r.normalize(),t?t.status:void 0)}),r.normalize(),n}function jf(e){return!!(e&&e.__CANCEL__)}function Tr(e,t,s){St.call(this,e??"canceled",St.ERR_CANCELED,t,s),this.name="CanceledError"}R.inherits(Tr,St,{__CANCEL__:!0});const LS=null;function NS(e,t,s){const i=s.config.validateStatus;!s.status||!i||i(s.status)?e(s):t(new St("Request failed with status code "+s.status,[St.ERR_BAD_REQUEST,St.ERR_BAD_RESPONSE][Math.floor(s.status/100)-4],s.config,s.request,s))}const US=Ye.isStandardBrowserEnv?function(){return{write:function(s,i,r,n,o,a){const l=[];l.push(s+"="+encodeURIComponent(i)),R.isNumber(r)&&l.push("expires="+new Date(r).toGMTString()),R.isString(n)&&l.push("path="+n),R.isString(o)&&l.push("domain="+o),a===!0&&l.push("secure"),document.cookie=l.join("; ")},read:function(s){const i=document.cookie.match(new RegExp("(^|;\\s*)("+s+")=([^;]*)"));return i?decodeURIComponent(i[3]):null},remove:function(s){this.write(s,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}();function kS(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function GS(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}function zf(e,t){return e&&!kS(t)?GS(e,t):t}const HS=Ye.isStandardBrowserEnv?function(){const t=/(msie|trident)/i.test(navigator.userAgent),s=document.createElement("a");let i;function r(n){let o=n;return t&&(s.setAttribute("href",o),o=s.href),s.setAttribute("href",o),{href:s.href,protocol:s.protocol?s.protocol.replace(/:$/,""):"",host:s.host,search:s.search?s.search.replace(/^\?/,""):"",hash:s.hash?s.hash.replace(/^#/,""):"",hostname:s.hostname,port:s.port,pathname:s.pathname.charAt(0)==="/"?s.pathname:"/"+s.pathname}}return i=r(window.location.href),function(o){const a=R.isString(o)?r(o):o;return a.protocol===i.protocol&&a.host===i.host}}():function(){return function(){return!0}}();function WS(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function $S(e,t){e=e||10;const s=new Array(e),i=new Array(e);let r=0,n=0,o;return t=t!==void 0?t:1e3,function(l){const h=Date.now(),c=i[n];o||(o=h),s[r]=l,i[r]=h;let u=n,d=0;for(;u!==r;)d+=s[u++],u=u%e;if(r=(r+1)%e,r===n&&(n=(n+1)%e),h-o<t)return;const p=c&&h-c;return p?Math.round(d*1e3/p):void 0}}function Hc(e,t){let s=0;const i=$S(50,250);return r=>{const n=r.loaded,o=r.lengthComputable?r.total:void 0,a=n-s,l=i(a),h=n<=o;s=n;const c={loaded:n,total:o,progress:o?n/o:void 0,bytes:a,rate:l||void 0,estimated:l&&o&&h?(o-n)/l:void 0,event:r};c[t?"download":"upload"]=!0,e(c)}}const XS=typeof XMLHttpRequest<"u",jS=XS&&function(e){return new Promise(function(s,i){let r=e.data;const n=ls.from(e.headers).normalize(),o=e.responseType;let a;function l(){e.cancelToken&&e.cancelToken.unsubscribe(a),e.signal&&e.signal.removeEventListener("abort",a)}R.isFormData(r)&&(Ye.isStandardBrowserEnv||Ye.isStandardBrowserWebWorkerEnv)&&n.setContentType(!1);let h=new XMLHttpRequest;if(e.auth){const p=e.auth.username||"",f=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";n.set("Authorization","Basic "+btoa(p+":"+f))}const c=zf(e.baseURL,e.url);h.open(e.method.toUpperCase(),Wf(c,e.params,e.paramsSerializer),!0),h.timeout=e.timeout;function u(){if(!h)return;const p=ls.from("getAllResponseHeaders"in h&&h.getAllResponseHeaders()),m={data:!o||o==="text"||o==="json"?h.responseText:h.response,status:h.status,statusText:h.statusText,headers:p,config:e,request:h};NS(function(v){s(v),l()},function(v){i(v),l()},m),h=null}if("onloadend"in h?h.onloadend=u:h.onreadystatechange=function(){!h||h.readyState!==4||h.status===0&&!(h.responseURL&&h.responseURL.indexOf("file:")===0)||setTimeout(u)},h.onabort=function(){h&&(i(new St("Request aborted",St.ECONNABORTED,e,h)),h=null)},h.onerror=function(){i(new St("Network Error",St.ERR_NETWORK,e,h)),h=null},h.ontimeout=function(){let f=e.timeout?"timeout of "+e.timeout+"ms exceeded":"timeout exceeded";const m=e.transitional||$f;e.timeoutErrorMessage&&(f=e.timeoutErrorMessage),i(new St(f,m.clarifyTimeoutError?St.ETIMEDOUT:St.ECONNABORTED,e,h)),h=null},Ye.isStandardBrowserEnv){const p=(e.withCredentials||HS(c))&&e.xsrfCookieName&&US.read(e.xsrfCookieName);p&&n.set(e.xsrfHeaderName,p)}r===void 0&&n.setContentType(null),"setRequestHeader"in h&&R.forEach(n.toJSON(),function(f,m){h.setRequestHeader(m,f)}),R.isUndefined(e.withCredentials)||(h.withCredentials=!!e.withCredentials),o&&o!=="json"&&(h.responseType=e.responseType),typeof e.onDownloadProgress=="function"&&h.addEventListener("progress",Hc(e.onDownloadProgress,!0)),typeof e.onUploadProgress=="function"&&h.upload&&h.upload.addEventListener("progress",Hc(e.onUploadProgress)),(e.cancelToken||e.signal)&&(a=p=>{h&&(i(!p||p.type?new Tr(null,e,h):p),h.abort(),h=null)},e.cancelToken&&e.cancelToken.subscribe(a),e.signal&&(e.signal.aborted?a():e.signal.addEventListener("abort",a)));const d=WS(c);if(d&&Ye.protocols.indexOf(d)===-1){i(new St("Unsupported protocol "+d+":",St.ERR_BAD_REQUEST,e));return}h.send(r||null)})},un={http:LS,xhr:jS};R.forEach(un,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const zS={getAdapter:e=>{e=R.isArray(e)?e:[e];const{length:t}=e;let s,i;for(let r=0;r<t&&(s=e[r],!(i=R.isString(s)?un[s.toLowerCase()]:s));r++);if(!i)throw i===!1?new St(`Adapter ${s} is not supported by the environment`,"ERR_NOT_SUPPORT"):new Error(R.hasOwnProp(un,s)?`Adapter '${s}' is not available in the build`:`Unknown adapter '${s}'`);if(!R.isFunction(i))throw new TypeError("adapter is not a function");return i},adapters:un};function Vo(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Tr(null,e)}function Wc(e){return Vo(e),e.headers=ls.from(e.headers),e.data=zo.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),zS.getAdapter(e.adapter||Fl.adapter)(e).then(function(i){return Vo(e),i.data=zo.call(e,e.transformResponse,i),i.headers=ls.from(i.headers),i},function(i){return jf(i)||(Vo(e),i&&i.response&&(i.response.data=zo.call(e,e.transformResponse,i.response),i.response.headers=ls.from(i.response.headers))),Promise.reject(i)})}const $c=e=>e instanceof ls?e.toJSON():e;function Pi(e,t){t=t||{};const s={};function i(h,c,u){return R.isPlainObject(h)&&R.isPlainObject(c)?R.merge.call({caseless:u},h,c):R.isPlainObject(c)?R.merge({},c):R.isArray(c)?c.slice():c}function r(h,c,u){if(R.isUndefined(c)){if(!R.isUndefined(h))return i(void 0,h,u)}else return i(h,c,u)}function n(h,c){if(!R.isUndefined(c))return i(void 0,c)}function o(h,c){if(R.isUndefined(c)){if(!R.isUndefined(h))return i(void 0,h)}else return i(void 0,c)}function a(h,c,u){if(u in t)return i(h,c);if(u in e)return i(void 0,h)}const l={url:n,method:n,data:n,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:a,headers:(h,c)=>r($c(h),$c(c),!0)};return R.forEach(Object.keys(e).concat(Object.keys(t)),function(c){const u=l[c]||r,d=u(e[c],t[c],c);R.isUndefined(d)&&u!==a||(s[c]=d)}),s}const Vf="1.2.2",Ll={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{Ll[e]=function(i){return typeof i===e||"a"+(t<1?"n ":" ")+e}});const Xc={};Ll.transitional=function(t,s,i){function r(n,o){return"[Axios v"+Vf+"] Transitional option '"+n+"'"+o+(i?". "+i:"")}return(n,o,a)=>{if(t===!1)throw new St(r(o," has been removed"+(s?" in "+s:"")),St.ERR_DEPRECATED);return s&&!Xc[o]&&(Xc[o]=!0,console.warn(r(o," has been deprecated since v"+s+" and will be removed in the near future"))),t?t(n,o,a):!0}};function VS(e,t,s){if(typeof e!="object")throw new St("options must be an object",St.ERR_BAD_OPTION_VALUE);const i=Object.keys(e);let r=i.length;for(;r-- >0;){const n=i[r],o=t[n];if(o){const a=e[n],l=a===void 0||o(a,n,e);if(l!==!0)throw new St("option "+n+" must be "+l,St.ERR_BAD_OPTION_VALUE);continue}if(s!==!0)throw new St("Unknown option "+n,St.ERR_BAD_OPTION)}}const Xa={assertOptions:VS,validators:Ll},gs=Xa.validators;class Dn{constructor(t){this.defaults=t,this.interceptors={request:new Uc,response:new Uc}}request(t,s){typeof t=="string"?(s=s||{},s.url=t):s=t||{},s=Pi(this.defaults,s);const{transitional:i,paramsSerializer:r,headers:n}=s;i!==void 0&&Xa.assertOptions(i,{silentJSONParsing:gs.transitional(gs.boolean),forcedJSONParsing:gs.transitional(gs.boolean),clarifyTimeoutError:gs.transitional(gs.boolean)},!1),r!==void 0&&Xa.assertOptions(r,{encode:gs.function,serialize:gs.function},!0),s.method=(s.method||this.defaults.method||"get").toLowerCase();let o;o=n&&R.merge(n.common,n[s.method]),o&&R.forEach(["delete","get","head","post","put","patch","common"],f=>{delete n[f]}),s.headers=ls.concat(o,n);const a=[];let l=!0;this.interceptors.request.forEach(function(m){typeof m.runWhen=="function"&&m.runWhen(s)===!1||(l=l&&m.synchronous,a.unshift(m.fulfilled,m.rejected))});const h=[];this.interceptors.response.forEach(function(m){h.push(m.fulfilled,m.rejected)});let c,u=0,d;if(!l){const f=[Wc.bind(this),void 0];for(f.unshift.apply(f,a),f.push.apply(f,h),d=f.length,c=Promise.resolve(s);u<d;)c=c.then(f[u++],f[u++]);return c}d=a.length;let p=s;for(u=0;u<d;){const f=a[u++],m=a[u++];try{p=f(p)}catch(_){m.call(this,_);break}}try{c=Wc.call(this,p)}catch(f){return Promise.reject(f)}for(u=0,d=h.length;u<d;)c=c.then(h[u++],h[u++]);return c}getUri(t){t=Pi(this.defaults,t);const s=zf(t.baseURL,t.url);return Wf(s,t.params,t.paramsSerializer)}}R.forEach(["delete","get","head","options"],function(t){Dn.prototype[t]=function(s,i){return this.request(Pi(i||{},{method:t,url:s,data:(i||{}).data}))}});R.forEach(["post","put","patch"],function(t){function s(i){return function(n,o,a){return this.request(Pi(a||{},{method:t,headers:i?{"Content-Type":"multipart/form-data"}:{},url:n,data:o}))}}Dn.prototype[t]=s(),Dn.prototype[t+"Form"]=s(!0)});const dn=Dn;class Nl{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let s;this.promise=new Promise(function(n){s=n});const i=this;this.promise.then(r=>{if(!i._listeners)return;let n=i._listeners.length;for(;n-- >0;)i._listeners[n](r);i._listeners=null}),this.promise.then=r=>{let n;const o=new Promise(a=>{i.subscribe(a),n=a}).then(r);return o.cancel=function(){i.unsubscribe(n)},o},t(function(n,o,a){i.reason||(i.reason=new Tr(n,o,a),s(i.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const s=this._listeners.indexOf(t);s!==-1&&this._listeners.splice(s,1)}static source(){let t;return{token:new Nl(function(r){t=r}),cancel:t}}}const YS=Nl;function KS(e){return function(s){return e.apply(null,s)}}function qS(e){return R.isObject(e)&&e.isAxiosError===!0}const ja={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(ja).forEach(([e,t])=>{ja[t]=e});const ZS=ja;function Yf(e){const t=new dn(e),s=Pf(dn.prototype.request,t);return R.extend(s,dn.prototype,t,{allOwnKeys:!0}),R.extend(s,t,null,{allOwnKeys:!0}),s.create=function(r){return Yf(Pi(e,r))},s}const Kt=Yf(Fl);Kt.Axios=dn;Kt.CanceledError=Tr;Kt.CancelToken=YS;Kt.isCancel=jf;Kt.VERSION=Vf;Kt.toFormData=no;Kt.AxiosError=St;Kt.Cancel=Kt.CanceledError;Kt.all=function(t){return Promise.all(t)};Kt.spread=KS;Kt.isAxiosError=qS;Kt.mergeConfig=Pi;Kt.AxiosHeaders=ls;Kt.formToJSON=e=>Xf(R.isHTMLForm(e)?new FormData(e):e);Kt.HttpStatusCode=ZS;Kt.default=Kt;const Kf=Kt;Kf.defaults.baseURL="/sceneSetups/";const JS=e=>{const t=e.sceneWidth,s=e.sceneHeight,i=new Map;for(const r of e.thingsMap){const n={species:r.species,name:r.name},o=new Array;for(const a of r.thingSetup){const l={defaultBlockX:a.defaultBlockX,defaultBlockY:a.defaultBlockY,textureName:a.textureName,defaultTowards:a.defaultTowards};o.push(l)}i.set(n,o)}return{id:e.id,name:e.name,sceneWidth:t,sceneHeight:s,thingsMap:i}},QS=async e=>{try{const{data:t}=await Kf.get(e);return t}catch(t){throw new Error("Error occurred while loading JSON from local"+t)}},tA=async e=>JS(await QS(e));class Ul extends yf{constructor(){super();$(this,"_runningCommand",!1);$(this,"_isActive",!1);$(this,"_pendingInstructions");$(this,"_needScanRule",!1);$(this,"_existYou",!0);$(this,"commandListener");this._pendingInstructions=new vf,this.commandListener={observeId:Qs(),update:async()=>{await this._run()}}}_setRunning(){this._runningCommand=!0}_setNotRunning(){this._runningCommand=!1}enableService(){this._isActive=!0}disableService(){this._isActive=!1}static _judgementInstructionPriority(s){const i=s.getPriority();return i||Date.now()}addInstructions(s){for(const i of s){const r=Ul._judgementInstructionPriority(i);this._pendingInstructions.add(i,r)}}_nextInstruction(){const s=this._pendingInstructions.poll();return s?qt(s):Mt}needScanRule(){this._needScanRule=!0}async _executeInstructions(){let s=this._nextInstruction();for(;je(s);)await s.value.perform(),s=this._nextInstruction()}async _run(){const s=V.nextCommand();if(!this._isActive||this._runningCommand||bt(s))return;this._setRunning(),this.setChanged(),await this.notifyObservers(s.value),await this._executeInstructions(),this._needScanRule&&(V.getRuleController().refreshAll(),V.getScanner().findRulesFromMap(V.getAppEdge()),await V.getRuleController().processImmediateChanges(),this._needScanRule=!1),await this._executeInstructions();const i=await V.getRuleController().checkYouExistsInLevel();i!==this._existYou&&(this._existYou=i,setTimeout(()=>{Zf(this._existYou)},2e3)),this._setNotRunning()}}const eA=()=>new Ul;class sA{constructor(t){$(this,"_features");$(this,"_patterns");$(this,"_mapController");this._features=new Map,this._patterns=new Map,this._mapController=t,this._giveDefaultRules()}refreshAll(){this._features.clear(),this._giveDefaultRules()}_giveDefaultRules(){const t={_is:[{feature:Et.PUSH,on:[],near:[],facing:[]}],_has:[],_make:[]},s=[...Object.values(Pl),...Object.values(Et),...Object.values(Ot)];for(const i of s)this._features.set(i,t)}async processImmediateChanges(){const t=new Map;this._features.forEach((i,r)=>{const n=i._is.filter(o=>Sf(o.feature));t.set(r,n)}),await this._mapController.appendTransformInstructions(t);const s=new Map;this._features.forEach((i,r)=>{const n=i._is.filter(o=>{switch(o.feature){case Et.MOVE:case Et.TELE:return!0;default:return!1}});s.set(r,n)}),await this._mapController.processMoveInstructions(s)}async checkYouExistsInLevel(){const t=[];return this._features.forEach((s,i)=>{for(const r of s._is)if(r.feature===Et.YOU){t.push(i);break}}),t.length===0?!1:await this._mapController.checkYouExistsInMap(t)}$is(t,s){const i=t.name,r=this._features.get(i);if(!r)return!1;const n=Boolean(r._is.find(o=>o.feature===s));return Boolean(r&&n)}$has(t,s){const i=t.name,r=this._features.get(i);if(!r)return!1;const n=Boolean(r._has.find(o=>o.feature===s));return Boolean(r&&n)}$make(t,s){const i=t.name,r=this._features.get(i);if(!r)return!1;const n=Boolean(r._make.find(o=>o.feature===s));return Boolean(r&&n)}getFeaturesOfThing(t,s){if(t.species!==Gt.CHARACTERS)throw new Error('[MY FAULT] Feature "getFeaturesOfThings" for Text-type things are not implemented yet');const i=t.name;if(!this._features.has(i))return Mt;const r=this._features.get(i);if(!r)throw new Error(`Thing ${i} in featureList has unexpected undefined value`);switch(s){case Ot.IS:return qt(r._is);case Ot.HAS:return qt(r._has);case Ot.MAKE:return qt(r._make);default:throw new Error(`operator ${s} should be a verb (OperatorType.IS, OperatorType.HAS, OperatorType.MAKE) instead of an adjective`)}}addFeature(t,s,i){if(!this._features.has(t)){const r={_is:[],_has:[],_make:[]};this._features.set(t,r)}switch(s){case Ot.IS:this._features.get(t)._is.push(i);break;case Ot.HAS:this._features.get(t)._has.push(i);break;case Ot.MAKE:this._features.get(t)._make.push(i);break;default:throw new Error(`operator ${s} should be a verb (OperatorType.IS, OperatorType.HAS, OperatorType.MAKE) instead of an adjective`)}}removeFeature(t,s,i){if(!this._features.has(t))throw new Error(`thingType ${t} not been recorded yet`);let r=-1;switch(s){case Ot.IS:if(r=this._features.get(t)._is.indexOf(i),r===-1)throw new Error(`thingType ${t} does not contain feature ${i}`);this._features.get(t)._is.splice(r,1);break;case Ot.HAS:if(r=this._features.get(t)._has.indexOf(i),r===-1)throw new Error(`thingType ${t} does not contain feature ${i}`);this._features.get(t)._has.splice(r,1);break;case Ot.MAKE:if(r=this._features.get(t)._make.indexOf(i),r===-1)throw new Error(`thingType ${t} does not contain feature ${i}`);this._features.get(t)._make.splice(r,1);break;default:throw new Error(`operator ${s} should be a verb (OperatorType.IS, OperatorType.HAS, OperatorType.MAKE) instead of an adjective`)}}}const iA=e=>new sA(e);class rA{constructor(t,s){$(this,"_ruleController");$(this,"_mapController");this._ruleController=t,this._mapController=s}scanRule(t,s,i,r,n){if(n===O.LEFT||n===O.TOP)throw new Error(`scan direction ${n} should be Direction.RIGHT or Direction.DOWN`);const o=[Ot.IS,Ot.HAS,Ot.MAKE],a=[Ot.ON,Ot.NEAR,Ot.FACING];let l=t,h=s,c=!1;const u={primaryCharacters:Mt,conditionSettings:Mt,effectRules:Mt};for(;;){if(l>=i||h>=r)return Mt;const T=this._mapController.whoAreThere(l,h);if(bt(T))return Mt;if(c){let g=!1;for(const b of T.value)if(b.name===Ot.AND){g=!0;break}if(!g)break}else{let g=!1;for(const b of T.value)if(b.species===Gt.NOUNS)if(bt(u.primaryCharacters)&&(u.primaryCharacters=qt([])),je(u.primaryCharacters)){const A=b.name;u.primaryCharacters.value.push(A),g=!0}else throw new Error("unexpected error cause by rulePattern.primaryCharacters is not a some value");if(!g)return Mt}c=!c,n===O.RIGHT&&l++,n===O.DOWN&&h++}c=!1;let d=!1,p=!0,f=Mt;for(;;){if(l>=i||h>=r)return Mt;const T=this._mapController.whoAreThere(l,h);if(bt(T))return Mt;const g=(b,S)=>{if(!a.includes(S))throw new Error(`currentAdj ${S} was passed in as unacceptable OperatorType`);const A=b.name;if(bt(u.conditionSettings)&&(u.conditionSettings=qt(new Map)),je(u.conditionSettings))if(u.conditionSettings.value.has(S)){const y=u.conditionSettings.value.get(S);y&&(y.push(A),u.conditionSettings.value.set(S,y))}else u.conditionSettings.value.set(S,[A]);else throw new Error("unexpected error cause by rulePattern.conditionSettings is not a some value")};if(p&&d)for(const b of T.value){const S=b.species;if(S===Gt.NOUNS){if(bt(f))throw new Error(`adjective ${f} should not be none`);if(!a.includes(f.value))throw new Error(`currentAdj ${f} should be an adjective operator`);g(b,f.value),d=!1,p=!1,c=!0}if(S===Gt.OPERATORS){const A=b.name;if(a.includes(A))f=qt(A),d=!0,p=!1,c=!1;else return Mt}}else if(p){let b=!1,S=!1;for(const A of T.value)if(A.species===Gt.OPERATORS){const E=A.name;if(E===Ot.AND)return Mt;if(a.includes(E))f=qt(E),b=!0;else if(o.includes(E)){S=!0;break}}if(S)break;if(!b)return Mt;p=!1,d=!0}else if(d)for(const b of T.value){if(b.species===Gt.NOUNS){if(bt(f))throw new Error(`adjective ${f} should not be none`);if(!a.includes(f.value))throw new Error(`currentAdj ${f} should be an adjective operator`);g(b,f.value)}else return Mt;c=!0,d=!1}else if(c){let b=!1;for(const S of T.value)if(S.species===Gt.OPERATORS){const y=S.name;if(y!==Ot.AND)return Mt;if(o.includes(y)){b=!1;break}}else return Mt;if(b)break;c=!1,p=!0,d=!0}else throw new Error("unexpected error occurred caused by nonexistent scan condition");n===O.RIGHT&&l++,n===O.DOWN&&h++}c=!1;let m=!1,_=!0,v=Mt;for(;!(l>=i||h>=r);){const T=this._mapController.whoAreThere(l,h);if(bt(T))break;const g=(S,A)=>{if(!o.includes(A))throw new Error(`currentVerb ${A} was passed in as unacceptable OperatorType`);const y=S.name;if(bt(u.effectRules)&&(u.effectRules=qt(new Map)),je(u.effectRules))if(u.effectRules.value.has(A)){const E=u.effectRules.value.get(A);E&&(E.push(y),u.effectRules.value.set(A,E))}else u.effectRules.value.set(A,[y]);else throw new Error("unexpected error cause by rulePattern.effectRules is not a some value")};let b=!1;if(_&&m){let S=!1;for(const A of T.value){const y=A.species;if(y===Gt.OPERATORS){const E=A.name;o.includes(E)&&(v=qt(E),S=!0)}else if(y===Gt.PROPERTIES){if(bt(v))throw new Error(`verb ${v} should not be none`);v.value===Ot.IS&&(g(A,v.value),S=!0)}else if(y===Gt.NOUNS){if(bt(v))throw new Error(`verb ${v} should not be none`);if(!o.includes(v.value))throw new Error(`currentVerb ${v} should be a verb operator`);g(A,v.value),S=!0}}S||(b=!0)}else if(_){let S=!1;for(const A of T.value)if(A.species===Gt.OPERATORS){const E=A.name;o.includes(E)&&(v=qt(E),S=!0)}if(!S)return Mt;m=!0,_=!1}else if(m){let S=!1;for(const A of T.value){if(bt(v))throw new Error(`verb ${v} should not be none`);if(!o.includes(v.value))throw new Error(`currentVerb ${v} should be a verb operator`);const y=A.species;(y===Gt.PROPERTIES&&v.value===Ot.IS||y===Gt.NOUNS)&&(g(A,v.value),S=!0)}S||(b=!0),m=!1,c=!0}else if(c){let S=!1;for(const A of T.value)A.name===Ot.AND&&(S=!0);S||(b=!0),c=!1,_=!0,m=!0}else return Mt;if(n===O.RIGHT&&l++,n===O.DOWN&&h++,b)break}return qt(u)}addRulesFromRulePattern(t){if(bt(t.primaryCharacters)||bt(t.effectRules))return;const s=[Ot.IS,Ot.HAS,Ot.MAKE];for(const i of t.primaryCharacters.value){const r=wf(i);for(const n of s){const o=t.effectRules.value.get(n);if(o)for(const a of o){const l={feature:a,on:[],near:[],facing:[]};je(t.conditionSettings)&&(l.on=t.conditionSettings.value.get(Ot.ON)||[],l.near=t.conditionSettings.value.get(Ot.NEAR)||[],l.facing=t.conditionSettings.value.get(Ot.FACING)||[]),this._ruleController.addFeature(r,n,l)}}}}findRulesFromMap(t){const s=t.maxX+1,i=t.maxY+1;for(let r=0;r<s;r++)for(let n=0;n<i;n++){const o=this._mapController.whoAreThere(r,n);if(!bt(o)){for(const a of o.value)if(a.species===Gt.NOUNS){const l=this.scanRule(r,n,s,i,O.RIGHT);je(l)&&this.addRulesFromRulePattern(l.value);const h=this.scanRule(r,n,s,i,O.DOWN);je(h)&&this.addRulesFromRulePattern(h.value)}}}}}const nA=(e,t)=>new rA(e,t),oA=async e=>{const t=V.getStageBuilder();V.getDispatchServer()&&V.disposeDispatchServer(),await V.loadResources(LT);const s=Nw();V.setMapController(s);const i=iA(s);V.setRuleController(i);const r=nA(i,s);V.setScanner(r);const n=eA();V.setDispatchServer(n),V.connectDispatchListener(n.commandListener),await t.removeScene();const o=await tA(e);await t.addGameScene(o),V.initDispatchServer(),V.initCommandWatchService()};let qf,Zf;const aA=e=>{Zf=async t=>{await e(t)}},lA=e=>{qf=async t=>{const s=V.getStageBuilder();V.disposeDispatchServer(),await Ri(300),await e(t),await s.removeScene()}},hA=()=>{V.disposeDispatchServer()},cA=()=>{V.initDispatchServer()};var Jf=(e=>(e.WIN="WIN",e.LEAVE="LEAVE",e.RESTART="RESTART",e))(Jf||{});class uA extends ds{async perform(){await Ri(Js),await qf(Jf.WIN)}async unperform(){return Promise.reject()}}const jc=(e,t)=>{const s=new uA(e);s.setPriority(9999999999999),t.addNewInstruction(s),t.pushInstructions()};class za extends ds{async perform(){await Ri(Js),this._subject.thingController.disconnect(),await V.getMapController().update(this._subject,be.DISAPPEAR),await V.getContainerBuilder().removeThingFromGameScene(this._subject)}async unperform(){await Ri(Js),await V.getMapController().update(this._subject,be.APPEAR)}}const oi=async(e,t)=>{const s=new za(e);s.setPriority(9999999990001),t.addNewInstruction(s),t.pushInstructions()},qr=async(e,t,s)=>{const i=new za(e),r=new za(t);i.setPriority(9999999990001),r.setPriority(9999999990001),s.addNewInstruction(i),s.addNewInstruction(r),s.pushInstructions()},dA=async(e,t,s,i)=>{const n=V.getRuleController(),o=V.getMapController(),a=n.$is(e,Et.YOU)||n.$is(e,Et.YOU2),l=n.$is(t,Et.YOU)||n.$is(t,Et.YOU2),h=n.$is(e,Et.FLOAT),c=n.$is(t,Et.FLOAT),u=Boolean(h===c),d=n.$is(e,Et.WIN),p=n.$is(t,Et.WIN);if(a&&d||l&&p||h===c&&(d&&l||p&&a))return jc(e,i),!0;if(n.$is(e,Et.PUSH))return await Pw(e,o,s)?(Uw(e,s,i),!0):!1;const m=n.$is(e,Et.OPEN),_=n.$is(t,Et.OPEN);if(m&&n.$is(t,Et.SHUT))return await qr(e,t,i),!0;if(_&&n.$is(e,Et.SHUT))return await qr(e,t,i),!0;const v=n.$is(e,Et.WEAK),T=n.$is(t,Et.WEAK);if(v&&T)return await qr(e,t,i),!0;if(v)return await oi(e,i),!0;if(T)return await oi(t,i),!0;if(v?!1:n.$is(e,Et.STOP))return!1;if(u){const F=n.$is(e,Et.SINK),L=n.$is(t,Et.SINK);if(F||L)return await qr(e,t,i),!0}const b=n.$is(e,Et.DEFEAT),S=n.$is(t,Et.DEFEAT);if(u){if(b&&l)return await oi(t,i),!0;if(S&&a)return await oi(e,i),!0}const A=n.$is(e,Et.HOT),y=n.$is(t,Et.HOT),E=n.$is(e,Et.MELT),I=n.$is(t,Et.MELT);if(u){if(A&&I)return await oi(t,i),!0;if(y&&E)return await oi(e,i),!0}return!0};var wi={Linear:{None:function(e){return e}},Quadratic:{In:function(e){return e*e},Out:function(e){return e*(2-e)},InOut:function(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)}},Cubic:{In:function(e){return e*e*e},Out:function(e){return--e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)}},Quartic:{In:function(e){return e*e*e*e},Out:function(e){return 1- --e*e*e*e},InOut:function(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)}},Quintic:{In:function(e){return e*e*e*e*e},Out:function(e){return--e*e*e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)}},Sinusoidal:{In:function(e){return 1-Math.cos(e*Math.PI/2)},Out:function(e){return Math.sin(e*Math.PI/2)},InOut:function(e){return .5*(1-Math.cos(Math.PI*e))}},Exponential:{In:function(e){return e===0?0:Math.pow(1024,e-1)},Out:function(e){return e===1?1:1-Math.pow(2,-10*e)},InOut:function(e){return e===0?0:e===1?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(-Math.pow(2,-10*(e-1))+2)}},Circular:{In:function(e){return 1-Math.sqrt(1-e*e)},Out:function(e){return Math.sqrt(1- --e*e)},InOut:function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)}},Elastic:{In:function(e){return e===0?0:e===1?1:-Math.pow(2,10*(e-1))*Math.sin((e-1.1)*5*Math.PI)},Out:function(e){return e===0?0:e===1?1:Math.pow(2,-10*e)*Math.sin((e-.1)*5*Math.PI)+1},InOut:function(e){return e===0?0:e===1?1:(e*=2,e<1?-.5*Math.pow(2,10*(e-1))*Math.sin((e-1.1)*5*Math.PI):.5*Math.pow(2,-10*(e-1))*Math.sin((e-1.1)*5*Math.PI)+1)}},Back:{In:function(e){var t=1.70158;return e*e*((t+1)*e-t)},Out:function(e){var t=1.70158;return--e*e*((t+1)*e+t)+1},InOut:function(e){var t=2.5949095;return(e*=2)<1?.5*(e*e*((t+1)*e-t)):.5*((e-=2)*e*((t+1)*e+t)+2)}},Bounce:{In:function(e){return 1-wi.Bounce.Out(1-e)},Out:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},InOut:function(e){return e<.5?wi.Bounce.In(e*2)*.5:wi.Bounce.Out(e*2-1)*.5+.5}}},Ji;typeof self>"u"&&typeof process<"u"&&process.hrtime?Ji=function(){var e=process.hrtime();return e[0]*1e3+e[1]/1e6}:typeof self<"u"&&self.performance!==void 0&&self.performance.now!==void 0?Ji=self.performance.now.bind(self.performance):Date.now!==void 0?Ji=Date.now:Ji=function(){return new Date().getTime()};var ci=Ji,fA=function(){function e(){this._tweens={},this._tweensAddedDuringUpdate={}}return e.prototype.getAll=function(){var t=this;return Object.keys(this._tweens).map(function(s){return t._tweens[s]})},e.prototype.removeAll=function(){this._tweens={}},e.prototype.add=function(t){this._tweens[t.getId()]=t,this._tweensAddedDuringUpdate[t.getId()]=t},e.prototype.remove=function(t){delete this._tweens[t.getId()],delete this._tweensAddedDuringUpdate[t.getId()]},e.prototype.update=function(t,s){t===void 0&&(t=ci()),s===void 0&&(s=!1);var i=Object.keys(this._tweens);if(i.length===0)return!1;for(;i.length>0;){this._tweensAddedDuringUpdate={};for(var r=0;r<i.length;r++){var n=this._tweens[i[r]],o=!s;n&&n.update(t,o)===!1&&!s&&delete this._tweens[i[r]]}i=Object.keys(this._tweensAddedDuringUpdate)}return!0},e}(),Qi={Linear:function(e,t){var s=e.length-1,i=s*t,r=Math.floor(i),n=Qi.Utils.Linear;return t<0?n(e[0],e[1],i):t>1?n(e[s],e[s-1],s-i):n(e[r],e[r+1>s?s:r+1],i-r)},Bezier:function(e,t){for(var s=0,i=e.length-1,r=Math.pow,n=Qi.Utils.Bernstein,o=0;o<=i;o++)s+=r(1-t,i-o)*r(t,o)*e[o]*n(i,o);return s},CatmullRom:function(e,t){var s=e.length-1,i=s*t,r=Math.floor(i),n=Qi.Utils.CatmullRom;return e[0]===e[s]?(t<0&&(r=Math.floor(i=s*(1+t))),n(e[(r-1+s)%s],e[r],e[(r+1)%s],e[(r+2)%s],i-r)):t<0?e[0]-(n(e[0],e[0],e[1],e[1],-i)-e[0]):t>1?e[s]-(n(e[s],e[s],e[s-1],e[s-1],i-s)-e[s]):n(e[r?r-1:0],e[r],e[s<r+1?s:r+1],e[s<r+2?s:r+2],i-r)},Utils:{Linear:function(e,t,s){return(t-e)*s+e},Bernstein:function(e,t){var s=Qi.Utils.Factorial;return s(e)/s(t)/s(e-t)},Factorial:function(){var e=[1];return function(t){var s=1;if(e[t])return e[t];for(var i=t;i>1;i--)s*=i;return e[t]=s,s}}(),CatmullRom:function(e,t,s,i,r){var n=(s-e)*.5,o=(i-t)*.5,a=r*r,l=r*a;return(2*t-2*s+n+o)*l+(-3*t+3*s-2*n-o)*a+n*r+t}}},Qf=function(){function e(){}return e.nextId=function(){return e._nextId++},e._nextId=0,e}(),tp=new fA,zc=function(){function e(t,s){s===void 0&&(s=tp),this._object=t,this._group=s,this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=wi.Linear.None,this._interpolationFunction=Qi.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._id=Qf.nextId(),this._isChainStopped=!1,this._goToEnd=!1}return e.prototype.getId=function(){return this._id},e.prototype.isPlaying=function(){return this._isPlaying},e.prototype.isPaused=function(){return this._isPaused},e.prototype.to=function(t,s){return this._valuesEnd=Object.create(t),s!==void 0&&(this._duration=s),this},e.prototype.duration=function(t){return this._duration=t,this},e.prototype.start=function(t){if(this._isPlaying)return this;if(this._group&&this._group.add(this),this._repeat=this._initialRepeat,this._reversed){this._reversed=!1;for(var s in this._valuesStartRepeat)this._swapEndStartRepeatValues(s),this._valuesStart[s]=this._valuesStartRepeat[s]}return this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=t!==void 0?typeof t=="string"?ci()+parseFloat(t):t:ci(),this._startTime+=this._delayTime,this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat),this},e.prototype._setupProperties=function(t,s,i,r){for(var n in i){var o=t[n],a=Array.isArray(o),l=a?"array":typeof o,h=!a&&Array.isArray(i[n]);if(!(l==="undefined"||l==="function")){if(h){var c=i[n];if(c.length===0)continue;c=c.map(this._handleRelativeValue.bind(this,o)),i[n]=[o].concat(c)}if((l==="object"||a)&&o&&!h){s[n]=a?[]:{};for(var u in o)s[n][u]=o[u];r[n]=a?[]:{},this._setupProperties(o,s[n],i[n],r[n])}else typeof s[n]>"u"&&(s[n]=o),a||(s[n]*=1),h?r[n]=i[n].slice().reverse():r[n]=s[n]||0}}},e.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group&&this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},e.prototype.end=function(){return this._goToEnd=!0,this.update(1/0),this},e.prototype.pause=function(t){return t===void 0&&(t=ci()),this._isPaused||!this._isPlaying?this:(this._isPaused=!0,this._pauseStart=t,this._group&&this._group.remove(this),this)},e.prototype.resume=function(t){return t===void 0&&(t=ci()),!this._isPaused||!this._isPlaying?this:(this._isPaused=!1,this._startTime+=t-this._pauseStart,this._pauseStart=0,this._group&&this._group.add(this),this)},e.prototype.stopChainedTweens=function(){for(var t=0,s=this._chainedTweens.length;t<s;t++)this._chainedTweens[t].stop();return this},e.prototype.group=function(t){return this._group=t,this},e.prototype.delay=function(t){return this._delayTime=t,this},e.prototype.repeat=function(t){return this._initialRepeat=t,this._repeat=t,this},e.prototype.repeatDelay=function(t){return this._repeatDelayTime=t,this},e.prototype.yoyo=function(t){return this._yoyo=t,this},e.prototype.easing=function(t){return this._easingFunction=t,this},e.prototype.interpolation=function(t){return this._interpolationFunction=t,this},e.prototype.chain=function(){for(var t=[],s=0;s<arguments.length;s++)t[s]=arguments[s];return this._chainedTweens=t,this},e.prototype.onStart=function(t){return this._onStartCallback=t,this},e.prototype.onUpdate=function(t){return this._onUpdateCallback=t,this},e.prototype.onRepeat=function(t){return this._onRepeatCallback=t,this},e.prototype.onComplete=function(t){return this._onCompleteCallback=t,this},e.prototype.onStop=function(t){return this._onStopCallback=t,this},e.prototype.update=function(t,s){if(t===void 0&&(t=ci()),s===void 0&&(s=!0),this._isPaused)return!0;var i,r,n=this._startTime+this._duration;if(!this._goToEnd&&!this._isPlaying){if(t>n)return!1;s&&this.start(t)}if(this._goToEnd=!1,t<this._startTime)return!0;this._onStartCallbackFired===!1&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),r=(t-this._startTime)/this._duration,r=this._duration===0||r>1?1:r;var o=this._easingFunction(r);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,o),this._onUpdateCallback&&this._onUpdateCallback(this._object,r),r===1)if(this._repeat>0){isFinite(this._repeat)&&this._repeat--;for(i in this._valuesStartRepeat)!this._yoyo&&typeof this._valuesEnd[i]=="string"&&(this._valuesStartRepeat[i]=this._valuesStartRepeat[i]+parseFloat(this._valuesEnd[i])),this._yoyo&&this._swapEndStartRepeatValues(i),this._valuesStart[i]=this._valuesStartRepeat[i];return this._yoyo&&(this._reversed=!this._reversed),this._repeatDelayTime!==void 0?this._startTime=t+this._repeatDelayTime:this._startTime=t+this._delayTime,this._onRepeatCallback&&this._onRepeatCallback(this._object),!0}else{this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var a=0,l=this._chainedTweens.length;a<l;a++)this._chainedTweens[a].start(this._startTime+this._duration);return this._isPlaying=!1,!1}return!0},e.prototype._updateProperties=function(t,s,i,r){for(var n in i)if(s[n]!==void 0){var o=s[n]||0,a=i[n],l=Array.isArray(t[n]),h=Array.isArray(a),c=!l&&h;c?t[n]=this._interpolationFunction(a,r):typeof a=="object"&&a?this._updateProperties(t[n],o,a,r):(a=this._handleRelativeValue(o,a),typeof a=="number"&&(t[n]=o+(a-o)*r))}},e.prototype._handleRelativeValue=function(t,s){return typeof s!="string"?s:s.charAt(0)==="+"||s.charAt(0)==="-"?t+parseFloat(s):parseFloat(s)},e.prototype._swapEndStartRepeatValues=function(t){var s=this._valuesStartRepeat[t],i=this._valuesEnd[t];typeof i=="string"?this._valuesStartRepeat[t]=this._valuesStartRepeat[t]+parseFloat(i):this._valuesStartRepeat[t]=this._valuesEnd[t],this._valuesEnd[t]=s},e}();Qf.nextId;var Qe=tp;Qe.getAll.bind(Qe);Qe.removeAll.bind(Qe);Qe.add.bind(Qe);Qe.remove.bind(Qe);var Vc=Qe.update.bind(Qe);class pA extends Mn{constructor(s,i,r,n,o,a,l,h,c){super(r);$(this,"_id");$(this,"_species");$(this,"_blockX");$(this,"_blockY");$(this,"_maxBlockX");$(this,"_maxBlockY");$(this,"_blockSize");$(this,"_towards");$(this,"thingController");this._id=Qs(),this.name=s,this._species=i,this._blockX=n,this._blockY=o,this._maxBlockX=l,this._maxBlockY=h,this._towards=c??0,this.updateTowards(this._towards),this._blockSize=a,this.height=a,this.width=a,this.anchor.set(.5),this.x=(this._blockX+.5)*this._blockSize,this.y=(this._blockY+.5)*this._blockSize,super.animationSpeed=.08,super.play()}bindThingController(s){this.thingController=s}setup(s){this.blockX=s.defaultBlockX,this.blockY=s.defaultBlockY,this.updateTowards(s.defaultTowards)}get blockX(){return Number(this._blockX)}set blockX(s){this._blockX=s;const i={x:this.x},r={x:(s+.5)*this._blockSize};let n=0;const o=a=>{n=requestAnimationFrame(o),Vc(a)};n=requestAnimationFrame(o),new zc(i).to(r,Js).onUpdate(()=>this.x=i.x).easing(wi.Quadratic.Out).onComplete(()=>cancelAnimationFrame(n)).start()}get blockY(){return Number(this._blockY)}set blockY(s){this._blockY=s;const i={y:this.y},r={y:(s+.5)*this._blockSize};let n=0;const o=a=>{n=requestAnimationFrame(o),Vc(a)};n=requestAnimationFrame(o),new zc(i).to(r,Js).easing(wi.Quadratic.Out).onUpdate(()=>this.y=i.y).onComplete(()=>cancelAnimationFrame(n)).start()}updateTowards(s){switch(s){case O.LEFT:this.scale.x=-1*Math.abs(this.scale.x);break;case O.RIGHT:this.scale.x=Math.abs(this.scale.x);break}this.towards=s}set towards(s){this._towards=s}get towards(){return this._towards}get id(){return this._id}get species(){return this._species}atRightEdge(){return this.blockX===this._maxBlockX}atLeftEdge(){return this.blockX===0}atTopEdge(){return this.blockY===0}atBottomEdge(){return this.blockY===this._maxBlockY}async moveUp(){await new Promise((s,i)=>{this.atTopEdge()?i():this.blockY--,s()})}async moveDown(){await new Promise((s,i)=>{this.atBottomEdge()?i():this.blockY++,s()})}async moveRight(){await new Promise((s,i)=>{this.atRightEdge()?i():this.blockX++,s()})}async moveLeft(){await new Promise((s,i)=>{this.atLeftEdge()?i():this.blockX--,s()})}async reverseTowards(){await new Promise((s,i)=>{this.towards===O.UNDEFINED?i():(this.updateTowards(io(this.towards)),s())})}handleBeside(){return Promise.resolve(void 0)}async handleEncounter(s,i){return await dA(this,s,i,this.thingController)}handleLeave(){return Promise.resolve(void 0)}}class mA{constructor(t,s){$(this,"_species");$(this,"_name");this._species=t,this._name=s}createInstance(t,s,i,r,n,o,a,l,h){return new pA(t,s,i,r,n,o,a,l,h)}}class Zr extends ds{constructor(s,i){super(s);$(this,"_towards");this._towards=i}async perform(){this._subject.updateTowards(this._towards)}async unperform(){this._subject.updateTowards(io(this._towards))}}class gA{constructor(t){$(this,"observeId");$(this,"_instructions");$(this,"_thing");this.observeId=Qs(),this._instructions=[],V.getDispatchServer().addObserver(this),this._thing=t,this._thing.bindThingController(this),V.getMapController().update(this._thing,be.APPEAR).then()}clearInstructions(){this._instructions=[]}addNewInstruction(t){this._instructions.push(t)}pushInstructions(){V.getDispatchServer().addInstructions(this._instructions),this.clearInstructions()}async update(t,s){if(!(V.getRuleController().$is(this._thing,Et.YOU)||V.getRuleController().$is(this._thing,Et.YOU2))||!await V.getMapController().canIEncounter(this._thing,(()=>{switch(s.value){case is.UP:return O.TOP;case is.DOWN:return O.DOWN;case is.LEFT:return O.LEFT;case is.RIGHT:return O.RIGHT;default:return O.UNDEFINED}})()))return;let n;switch(s.value){case is.UP:n=new ys.MoveUpInstruction(this._thing),this._thing.species===Gt.CHARACTERS&&this.addNewInstruction(new Zr(this._thing,O.TOP));break;case is.DOWN:n=new ys.MoveDownInstruction(this._thing),this._thing.species===Gt.CHARACTERS&&this.addNewInstruction(new Zr(this._thing,O.DOWN));break;case is.LEFT:n=new ys.MoveLeftInstruction(this._thing),this._thing.species===Gt.CHARACTERS&&this.addNewInstruction(new Zr(this._thing,O.LEFT));break;case is.RIGHT:n=new ys.MoveRightInstruction(this._thing),this._thing.species===Gt.CHARACTERS&&this.addNewInstruction(new Zr(this._thing,O.RIGHT));break;default:n=new Rl(this._thing);break}V.getDispatchServer().needScanRule(),this.addNewInstruction(n),this.pushInstructions()}stopDispatcher(){V.getDispatchServer().disableService()}disconnect(){V.getDispatchServer().deleteObserver(this)}}const _A=e=>new gA(e);class ep{}class xA extends ep{constructor(){super(...arguments);$(this,"_name");$(this,"_species");$(this,"_textures");$(this,"_defaultBlockX");$(this,"_defaultBlockY");$(this,"_blockSize");$(this,"_maxBlockX");$(this,"_maxBlockY");$(this,"_defaultTowards")}setArgs(s,i,r,n,o,a,l,h,c){this._name=s,this._species=i,this._textures=r,this._defaultBlockX=n,this._defaultBlockY=o,this._blockSize=a,this._maxBlockX=l,this._maxBlockY=h,this._defaultTowards=c}async execute(){return await new Promise((s,i)=>{const r=new mA(this._species,this._name).createInstance(this._name,this._species,this._textures,this._defaultBlockX,this._defaultBlockY,this._blockSize,this._maxBlockX,this._maxBlockY,this._defaultTowards);r&&s(r),i(r)})}}class vA extends ep{constructor(){super(...arguments);$(this,"_thing")}setArgs(s){this._thing=s}async execute(){return await new Promise(s=>{_A(this._thing),s()})}}class yA{async getThings(t){const s=[];for(const[{species:i,name:r},n]of t){const o=n.length;if(!o)break;const a=V.getSpriteAmountByName(r),l=V.getSpritesByName(r,Math.min(a,o));let h=[];bt(l)||(h=l.value);let c=0;for(const u of h)u.setup({...n[c++]});if(a<o){const u=o-a,d=V.getAnimationTextures(i,r),p=new xA,f=Cl(),{maxX:m,maxY:_}=V.getAppEdge();for(let v=0;v<u;v++){const T=n[c++];p.setArgs(r,i,d,T.defaultBlockX,T.defaultBlockY,f,m,_,T.defaultTowards),h.push(await p.execute())}}s.push(...h)}return s}async connectThingsToThingController(t){const s=new vA;for(const i of t)s.setArgs(i),await s.execute()}}const EA=()=>new yA,kl=NT(),V=Ew();V.bindAppToScreenService(kl);const bA=EA();V.setSpriteBuilder(bA);const TA=Rw();V.setContainerBuilder(TA);const wA=Sw(kl.stage);V.setStageBuilder(wA);const SA={gameView:kl.view,startLevel:oA,pause:hA,resume:cA,setYouGoneOutsideHandler:aA,setGameOverOutsideHandler:lA},jA=new Promise(e=>e(SA));export{CA as A,HA as B,$A as C,PA as D,WA as E,He as F,LA as G,jA as H,Bn as I,Jf as J,MA as K,kA as L,ju as a,BA as b,zm as c,og as d,nl as e,gm as f,tr as g,NA as h,Qr as i,er as j,GA as k,FA as l,Ya as m,hl as n,Xm as o,um as p,ee as q,OA as r,Vp as s,IA as t,xu as u,RA as v,rm as w,Km as x,DA as y,UA as z};
